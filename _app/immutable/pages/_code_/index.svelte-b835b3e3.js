import{S as sa,i as la,s as ua,e as Or,b as ke,f as Mt,g as $a,t as Wt,d as es,h as H,o as Om,U as Qt,V as Ir,j as Nm,O as Fu,l as Pe,m as Me,n as Ce,p as $,W as Np,q as tt,X as Vp,Q as Ou,R as Nu,T as Vu,Y as Ws,Z as $n,_ as eo,I as ne,K as Cc,E as co,$ as ts,J as Oi,r as Ee,u as Te,v as Dt,w as li,x as ui,y as ci,B as hi,a as pt,c as ft,M as aa,G as Pc,a0 as Vm,a1 as _d,P as q_,a2 as Z_,a3 as Um,a4 as jm,a5 as G_,C as gl,z as vl,a6 as Ph,A as xl}from"../../chunks/index-50f9e43e.js";import{a as Ec,u as Mh,S as K_,m as na,c as gd,b as X_,d as zr,e as Dh}from"../../chunks/Section-876c2dd7.js";import{b as Is}from"../../chunks/paths-1c47712a.js";import{c as Jl,w as Ar,d as Hi}from"../../chunks/singletons-2c3f9d32.js";var vd={},Sp={},kp=34,bc=10,Ep=13;function qm(c){return new Function("d","return {"+c.map(function(h,f){return JSON.stringify(h)+": d["+f+'] || ""'}).join(",")+"}")}function W_(c,h){var f=qm(c);return function(y,v){return h(f(y),v,c)}}function xd(c){var h=Object.create(null),f=[];return c.forEach(function(y){for(var v in y)v in h||f.push(h[v]=v)}),f}function ia(c,h){var f=c+"",y=f.length;return y<h?new Array(h-y+1).join(0)+f:f}function H_(c){return c<0?"-"+ia(-c,6):c>9999?"+"+ia(c,6):ia(c,4)}function J_(c){var h=c.getUTCHours(),f=c.getUTCMinutes(),y=c.getUTCSeconds(),v=c.getUTCMilliseconds();return isNaN(c)?"Invalid Date":H_(c.getUTCFullYear())+"-"+ia(c.getUTCMonth()+1,2)+"-"+ia(c.getUTCDate(),2)+(v?"T"+ia(h,2)+":"+ia(f,2)+":"+ia(y,2)+"."+ia(v,3)+"Z":y?"T"+ia(h,2)+":"+ia(f,2)+":"+ia(y,2)+"Z":f||h?"T"+ia(h,2)+":"+ia(f,2)+"Z":"")}function Y_(c){var h=new RegExp('["'+c+`
\r]`),f=c.charCodeAt(0);function y(j,N){var X,pe,De=v(j,function(Ie,rt){if(X)return X(Ie,rt-1);pe=Ie,X=N?W_(Ie,N):qm(Ie)});return De.columns=pe||[],De}function v(j,N){var X=[],pe=j.length,De=0,Ie=0,rt,Ge=pe<=0,Pt=!1;j.charCodeAt(pe-1)===bc&&--pe,j.charCodeAt(pe-1)===Ep&&--pe;function Tt(){if(Ge)return Sp;if(Pt)return Pt=!1,vd;var He,Vt=De,Ht;if(j.charCodeAt(Vt)===kp){for(;De++<pe&&j.charCodeAt(De)!==kp||j.charCodeAt(++De)===kp;);return(He=De)>=pe?Ge=!0:(Ht=j.charCodeAt(De++))===bc?Pt=!0:Ht===Ep&&(Pt=!0,j.charCodeAt(De)===bc&&++De),j.slice(Vt+1,He-1).replace(/""/g,'"')}for(;De<pe;){if((Ht=j.charCodeAt(He=De++))===bc)Pt=!0;else if(Ht===Ep)Pt=!0,j.charCodeAt(De)===bc&&++De;else if(Ht!==f)continue;return j.slice(Vt,He)}return Ge=!0,j.slice(Vt,pe)}for(;(rt=Tt())!==Sp;){for(var ct=[];rt!==vd&&rt!==Sp;)ct.push(rt),rt=Tt();N&&(ct=N(ct,Ie++))==null||X.push(ct)}return X}function x(j,N){return j.map(function(X){return N.map(function(pe){return L(X[pe])}).join(c)})}function a(j,N){return N==null&&(N=xd(j)),[N.map(L).join(c)].concat(x(j,N)).join(`
`)}function A(j,N){return N==null&&(N=xd(j)),x(j,N).join(`
`)}function I(j){return j.map(B).join(`
`)}function B(j){return j.map(L).join(c)}function L(j){return j==null?"":j instanceof Date?J_(j):h.test(j+="")?'"'+j.replace(/"/g,'""')+'"':j}return{parse:y,parseRows:v,format:a,formatBody:A,formatRows:I,formatRow:B,formatValue:L}}var Q_=Y_(","),$_=Q_.parse;function eg(c){for(var h in c){var f=c[h].trim(),y,v;if(!f)f=null;else if(f==="true")f=!0;else if(f==="false")f=!1;else if(f==="NaN")f=NaN;else if(!isNaN(y=+f))f=y;else if(v=f.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))tg&&!!v[4]&&!v[7]&&(f=f.replace(/-/g,"/").replace(/T/," ")),f=new Date(f);else continue;c[h]=f}return c}const tg=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function rg(c,h=window.fetch){let y=await(await h(c)).text();return await $_(y,eg)}function bl(c){let h=Math.round(c)%10;return c==11?"th":h==1?"st":h==2?"nd":h==3?"rd":"th"}function Lh(c){return c>0?"increase":c<0?"decrease":"nochange"}function gr(c,h="",f=0){return c!=0?Math.abs(c).toFixed(f)+h:h=="pp"?"n/c":"<1%)"}Jl.disable_scroll_handling;const bd=Jl.goto;Jl.invalidate;Jl.prefetch;Jl.prefetch_routes;Jl.before_navigate;Jl.after_navigate;function ig(c){return c===0?!0:c}function _l(c){return ig(c)?Array.isArray(c)?h=>c.map(f=>typeof f!="function"?h[f]:f(h)):typeof c!="function"?h=>h[c]:c:null}function ng(c){const h={};for(const f of c){if(Object(f)!==f)throw new TypeError("iterable for fromEntries should yield objects");const{"0":y,"1":v}=f;Object.defineProperty(h,y,{configurable:!0,enumerable:!0,writable:!0,value:v})}return h}function Tp(c,h={}){return ng(Object.entries(c).filter(([f,y])=>y!==void 0&&h[f]===void 0))}function og(c,h){if(!Array.isArray(c))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof c}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const f={},y=Object.keys(h),v=y.length;let x,a,A,I,B,L,j,N;const X=c.length;for(x=0;x<v;x+=1){for(I=y[x],j=h[I],B=null,L=null,a=0;a<X;a+=1)if(N=j(c[a]),Array.isArray(N)){const pe=N.length;for(A=0;A<pe;A+=1)N[A]!==void 0&&N[A]!==null&&Number.isNaN(N[A])===!1&&((B===null||N[A]<B)&&(B=N[A]),(L===null||N[A]>L)&&(L=N[A]))}else N!=null&&Number.isNaN(N)===!1&&((B===null||N<B)&&(B=N),(L===null||N>L)&&(L=N));f[I]=[B,L]}return f}function Zm(c=[],h){return Array.isArray(h)===!0?h.map((f,y)=>f===null?c[y]:f):c}function xh(c){return function([f,y]){return f?Zm(f[c],y):y}}function zh(c,h){return c==null||h==null?NaN:c<h?-1:c>h?1:c>=h?0:NaN}function ag(c,h){return c==null||h==null?NaN:h<c?-1:h>c?1:h>=c?0:NaN}function Gm(c){let h,f,y;c.length!==2?(h=zh,f=(A,I)=>zh(c(A),I),y=(A,I)=>c(A)-I):(h=c===zh||c===ag?c:sg,f=c,y=c);function v(A,I,B=0,L=A.length){if(B<L){if(h(I,I)!==0)return L;do{const j=B+L>>>1;f(A[j],I)<0?B=j+1:L=j}while(B<L)}return B}function x(A,I,B=0,L=A.length){if(B<L){if(h(I,I)!==0)return L;do{const j=B+L>>>1;f(A[j],I)<=0?B=j+1:L=j}while(B<L)}return B}function a(A,I,B=0,L=A.length){const j=v(A,I,B,L-1);return j>B&&y(A[j-1],I)>-y(A[j],I)?j-1:j}return{left:v,center:a,right:x}}function sg(){return 0}function lg(c){return c===null?NaN:+c}const ug=Gm(zh),cg=ug.right;Gm(lg).center;const hg=cg;class wd extends Map{constructor(h,f=dg){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:f}}),h!=null)for(const[y,v]of h)this.set(y,v)}get(h){return super.get(Sd(this,h))}has(h){return super.has(Sd(this,h))}set(h,f){return super.set(pg(this,h),f)}delete(h){return super.delete(fg(this,h))}}function Sd({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):f}function pg({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):(c.set(y,f),f)}function fg({_intern:c,_key:h},f){const y=h(f);return c.has(y)&&(f=c.get(y),c.delete(y)),f}function dg(c){return c!==null&&typeof c=="object"?c.valueOf():c}var Mp=Math.sqrt(50),Dp=Math.sqrt(10),Lp=Math.sqrt(2);function mg(c,h,f){var y,v=-1,x,a,A;if(h=+h,c=+c,f=+f,c===h&&f>0)return[c];if((y=h<c)&&(x=c,c=h,h=x),(A=Km(c,h,f))===0||!isFinite(A))return[];if(A>0){let I=Math.round(c/A),B=Math.round(h/A);for(I*A<c&&++I,B*A>h&&--B,a=new Array(x=B-I+1);++v<x;)a[v]=(I+v)*A}else{A=-A;let I=Math.round(c*A),B=Math.round(h*A);for(I/A<c&&++I,B/A>h&&--B,a=new Array(x=B-I+1);++v<x;)a[v]=(I+v)/A}return y&&a.reverse(),a}function Km(c,h,f){var y=(h-c)/Math.max(0,f),v=Math.floor(Math.log(y)/Math.LN10),x=y/Math.pow(10,v);return v>=0?(x>=Mp?10:x>=Dp?5:x>=Lp?2:1)*Math.pow(10,v):-Math.pow(10,-v)/(x>=Mp?10:x>=Dp?5:x>=Lp?2:1)}function yg(c,h,f){var y=Math.abs(h-c)/Math.max(0,f),v=Math.pow(10,Math.floor(Math.log(y)/Math.LN10)),x=y/v;return x>=Mp?v*=10:x>=Dp?v*=5:x>=Lp&&(v*=2),h<c?-v:v}function _g(c,h,f){c=+c,h=+h,f=(v=arguments.length)<2?(h=c,c=0,1):v<3?1:+f;for(var y=-1,v=Math.max(0,Math.ceil((h-c)/f))|0,x=new Array(v);++y<v;)x[y]=c+y*f;return x}function Vh(c,h){switch(arguments.length){case 0:break;case 1:this.range(c);break;default:this.range(h).domain(c);break}return this}const kd=Symbol("implicit");function Xm(){var c=new wd,h=[],f=[],y=kd;function v(x){let a=c.get(x);if(a===void 0){if(y!==kd)return y;c.set(x,a=h.push(x)-1)}return f[a%f.length]}return v.domain=function(x){if(!arguments.length)return h.slice();h=[],c=new wd;for(const a of x)c.has(a)||c.set(a,h.push(a)-1);return v},v.range=function(x){return arguments.length?(f=Array.from(x),v):f.slice()},v.unknown=function(x){return arguments.length?(y=x,v):y},v.copy=function(){return Xm(h,f).unknown(y)},Vh.apply(v,arguments),v}function Wm(){var c=Xm().unknown(void 0),h=c.domain,f=c.range,y=0,v=1,x,a,A=!1,I=0,B=0,L=.5;delete c.unknown;function j(){var N=h().length,X=v<y,pe=X?v:y,De=X?y:v;x=(De-pe)/Math.max(1,N-I+B*2),A&&(x=Math.floor(x)),pe+=(De-pe-x*(N-I))*L,a=x*(1-I),A&&(pe=Math.round(pe),a=Math.round(a));var Ie=_g(N).map(function(rt){return pe+x*rt});return f(X?Ie.reverse():Ie)}return c.domain=function(N){return arguments.length?(h(N),j()):h()},c.range=function(N){return arguments.length?([y,v]=N,y=+y,v=+v,j()):[y,v]},c.rangeRound=function(N){return[y,v]=N,y=+y,v=+v,A=!0,j()},c.bandwidth=function(){return a},c.step=function(){return x},c.round=function(N){return arguments.length?(A=!!N,j()):A},c.padding=function(N){return arguments.length?(I=Math.min(1,B=+N),j()):I},c.paddingInner=function(N){return arguments.length?(I=Math.min(1,N),j()):I},c.paddingOuter=function(N){return arguments.length?(B=+N,j()):B},c.align=function(N){return arguments.length?(L=Math.max(0,Math.min(1,N)),j()):L},c.copy=function(){return Wm(h(),[y,v]).round(A).paddingInner(I).paddingOuter(B).align(L)},Vh.apply(j(),arguments)}function Up(c,h,f){c.prototype=h.prototype=f,f.constructor=c}function Hm(c,h){var f=Object.create(c.prototype);for(var y in h)f[y]=h[y];return f}function Mc(){}var Ic=.7,Rh=1/Ic,Ru="\\s*([+-]?\\d+)\\s*",Ac="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ts="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gg=/^#([0-9a-f]{3,8})$/,vg=new RegExp(`^rgb\\(${Ru},${Ru},${Ru}\\)$`),xg=new RegExp(`^rgb\\(${Ts},${Ts},${Ts}\\)$`),bg=new RegExp(`^rgba\\(${Ru},${Ru},${Ru},${Ac}\\)$`),wg=new RegExp(`^rgba\\(${Ts},${Ts},${Ts},${Ac}\\)$`),Sg=new RegExp(`^hsl\\(${Ac},${Ts},${Ts}\\)$`),kg=new RegExp(`^hsla\\(${Ac},${Ts},${Ts},${Ac}\\)$`),Ed={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Up(Mc,zc,{copy(c){return Object.assign(new this.constructor,this,c)},displayable(){return this.rgb().displayable()},hex:Td,formatHex:Td,formatHex8:Eg,formatHsl:Tg,formatRgb:Id,toString:Id});function Td(){return this.rgb().formatHex()}function Eg(){return this.rgb().formatHex8()}function Tg(){return Jm(this).formatHsl()}function Id(){return this.rgb().formatRgb()}function zc(c){var h,f;return c=(c+"").trim().toLowerCase(),(h=gg.exec(c))?(f=h[1].length,h=parseInt(h[1],16),f===6?Ad(h):f===3?new oa(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):f===8?bh(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):f===4?bh(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=vg.exec(c))?new oa(h[1],h[2],h[3],1):(h=xg.exec(c))?new oa(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=bg.exec(c))?bh(h[1],h[2],h[3],h[4]):(h=wg.exec(c))?bh(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=Sg.exec(c))?Pd(h[1],h[2]/100,h[3]/100,1):(h=kg.exec(c))?Pd(h[1],h[2]/100,h[3]/100,h[4]):Ed.hasOwnProperty(c)?Ad(Ed[c]):c==="transparent"?new oa(NaN,NaN,NaN,0):null}function Ad(c){return new oa(c>>16&255,c>>8&255,c&255,1)}function bh(c,h,f,y){return y<=0&&(c=h=f=NaN),new oa(c,h,f,y)}function Ig(c){return c instanceof Mc||(c=zc(c)),c?(c=c.rgb(),new oa(c.r,c.g,c.b,c.opacity)):new oa}function Rp(c,h,f,y){return arguments.length===1?Ig(c):new oa(c,h,f,y==null?1:y)}function oa(c,h,f,y){this.r=+c,this.g=+h,this.b=+f,this.opacity=+y}Up(oa,Rp,Hm(Mc,{brighter(c){return c=c==null?Rh:Math.pow(Rh,c),new oa(this.r*c,this.g*c,this.b*c,this.opacity)},darker(c){return c=c==null?Ic:Math.pow(Ic,c),new oa(this.r*c,this.g*c,this.b*c,this.opacity)},rgb(){return this},clamp(){return new oa(Hl(this.r),Hl(this.g),Hl(this.b),Bh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zd,formatHex:zd,formatHex8:Ag,formatRgb:Cd,toString:Cd}));function zd(){return`#${Wl(this.r)}${Wl(this.g)}${Wl(this.b)}`}function Ag(){return`#${Wl(this.r)}${Wl(this.g)}${Wl(this.b)}${Wl((isNaN(this.opacity)?1:this.opacity)*255)}`}function Cd(){const c=Bh(this.opacity);return`${c===1?"rgb(":"rgba("}${Hl(this.r)}, ${Hl(this.g)}, ${Hl(this.b)}${c===1?")":`, ${c})`}`}function Bh(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function Hl(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function Wl(c){return c=Hl(c),(c<16?"0":"")+c.toString(16)}function Pd(c,h,f,y){return y<=0?c=h=f=NaN:f<=0||f>=1?c=h=NaN:h<=0&&(c=NaN),new Qa(c,h,f,y)}function Jm(c){if(c instanceof Qa)return new Qa(c.h,c.s,c.l,c.opacity);if(c instanceof Mc||(c=zc(c)),!c)return new Qa;if(c instanceof Qa)return c;c=c.rgb();var h=c.r/255,f=c.g/255,y=c.b/255,v=Math.min(h,f,y),x=Math.max(h,f,y),a=NaN,A=x-v,I=(x+v)/2;return A?(h===x?a=(f-y)/A+(f<y)*6:f===x?a=(y-h)/A+2:a=(h-f)/A+4,A/=I<.5?x+v:2-x-v,a*=60):A=I>0&&I<1?0:a,new Qa(a,A,I,c.opacity)}function zg(c,h,f,y){return arguments.length===1?Jm(c):new Qa(c,h,f,y==null?1:y)}function Qa(c,h,f,y){this.h=+c,this.s=+h,this.l=+f,this.opacity=+y}Up(Qa,zg,Hm(Mc,{brighter(c){return c=c==null?Rh:Math.pow(Rh,c),new Qa(this.h,this.s,this.l*c,this.opacity)},darker(c){return c=c==null?Ic:Math.pow(Ic,c),new Qa(this.h,this.s,this.l*c,this.opacity)},rgb(){var c=this.h%360+(this.h<0)*360,h=isNaN(c)||isNaN(this.s)?0:this.s,f=this.l,y=f+(f<.5?f:1-f)*h,v=2*f-y;return new oa(Ip(c>=240?c-240:c+120,v,y),Ip(c,v,y),Ip(c<120?c+240:c-120,v,y),this.opacity)},clamp(){return new Qa(Md(this.h),wh(this.s),wh(this.l),Bh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const c=Bh(this.opacity);return`${c===1?"hsl(":"hsla("}${Md(this.h)}, ${wh(this.s)*100}%, ${wh(this.l)*100}%${c===1?")":`, ${c})`}`}}));function Md(c){return c=(c||0)%360,c<0?c+360:c}function wh(c){return Math.max(0,Math.min(1,c||0))}function Ip(c,h,f){return(c<60?h+(f-h)*c/60:c<180?f:c<240?h+(f-h)*(240-c)/60:h)*255}const jp=c=>()=>c;function Cg(c,h){return function(f){return c+f*h}}function Pg(c,h,f){return c=Math.pow(c,f),h=Math.pow(h,f)-c,f=1/f,function(y){return Math.pow(c+y*h,f)}}function Mg(c){return(c=+c)==1?Ym:function(h,f){return f-h?Pg(h,f,c):jp(isNaN(h)?f:h)}}function Ym(c,h){var f=h-c;return f?Cg(c,f):jp(isNaN(c)?h:c)}const Dd=function c(h){var f=Mg(h);function y(v,x){var a=f((v=Rp(v)).r,(x=Rp(x)).r),A=f(v.g,x.g),I=f(v.b,x.b),B=Ym(v.opacity,x.opacity);return function(L){return v.r=a(L),v.g=A(L),v.b=I(L),v.opacity=B(L),v+""}}return y.gamma=c,y}(1);function Dg(c,h){h||(h=[]);var f=c?Math.min(h.length,c.length):0,y=h.slice(),v;return function(x){for(v=0;v<f;++v)y[v]=c[v]*(1-x)+h[v]*x;return y}}function Lg(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function Rg(c,h){var f=h?h.length:0,y=c?Math.min(f,c.length):0,v=new Array(y),x=new Array(f),a;for(a=0;a<y;++a)v[a]=qp(c[a],h[a]);for(;a<f;++a)x[a]=h[a];return function(A){for(a=0;a<y;++a)x[a]=v[a](A);return x}}function Bg(c,h){var f=new Date;return c=+c,h=+h,function(y){return f.setTime(c*(1-y)+h*y),f}}function Fh(c,h){return c=+c,h=+h,function(f){return c*(1-f)+h*f}}function Fg(c,h){var f={},y={},v;(c===null||typeof c!="object")&&(c={}),(h===null||typeof h!="object")&&(h={});for(v in h)v in c?f[v]=qp(c[v],h[v]):y[v]=h[v];return function(x){for(v in f)y[v]=f[v](x);return y}}var Bp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ap=new RegExp(Bp.source,"g");function Og(c){return function(){return c}}function Ng(c){return function(h){return c(h)+""}}function Vg(c,h){var f=Bp.lastIndex=Ap.lastIndex=0,y,v,x,a=-1,A=[],I=[];for(c=c+"",h=h+"";(y=Bp.exec(c))&&(v=Ap.exec(h));)(x=v.index)>f&&(x=h.slice(f,x),A[a]?A[a]+=x:A[++a]=x),(y=y[0])===(v=v[0])?A[a]?A[a]+=v:A[++a]=v:(A[++a]=null,I.push({i:a,x:Fh(y,v)})),f=Ap.lastIndex;return f<h.length&&(x=h.slice(f),A[a]?A[a]+=x:A[++a]=x),A.length<2?I[0]?Ng(I[0].x):Og(h):(h=I.length,function(B){for(var L=0,j;L<h;++L)A[(j=I[L]).i]=j.x(B);return A.join("")})}function qp(c,h){var f=typeof h,y;return h==null||f==="boolean"?jp(h):(f==="number"?Fh:f==="string"?(y=zc(h))?(h=y,Dd):Vg:h instanceof zc?Dd:h instanceof Date?Bg:Lg(h)?Dg:Array.isArray(h)?Rg:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?Fg:Fh)(c,h)}function Ug(c,h){return c=+c,h=+h,function(f){return Math.round(c*(1-f)+h*f)}}function jg(c){return function(){return c}}function qg(c){return+c}var Ld=[0,1];function Es(c){return c}function Fp(c,h){return(h-=c=+c)?function(f){return(f-c)/h}:jg(isNaN(h)?NaN:.5)}function Zg(c,h){var f;return c>h&&(f=c,c=h,h=f),function(y){return Math.max(c,Math.min(h,y))}}function Gg(c,h,f){var y=c[0],v=c[1],x=h[0],a=h[1];return v<y?(y=Fp(v,y),x=f(a,x)):(y=Fp(y,v),x=f(x,a)),function(A){return x(y(A))}}function Kg(c,h,f){var y=Math.min(c.length,h.length)-1,v=new Array(y),x=new Array(y),a=-1;for(c[y]<c[0]&&(c=c.slice().reverse(),h=h.slice().reverse());++a<y;)v[a]=Fp(c[a],c[a+1]),x[a]=f(h[a],h[a+1]);return function(A){var I=hg(c,A,1,y)-1;return x[I](v[I](A))}}function Qm(c,h){return h.domain(c.domain()).range(c.range()).interpolate(c.interpolate()).clamp(c.clamp()).unknown(c.unknown())}function $m(){var c=Ld,h=Ld,f=qp,y,v,x,a=Es,A,I,B;function L(){var N=Math.min(c.length,h.length);return a!==Es&&(a=Zg(c[0],c[N-1])),A=N>2?Kg:Gg,I=B=null,j}function j(N){return N==null||isNaN(N=+N)?x:(I||(I=A(c.map(y),h,f)))(y(a(N)))}return j.invert=function(N){return a(v((B||(B=A(h,c.map(y),Fh)))(N)))},j.domain=function(N){return arguments.length?(c=Array.from(N,qg),L()):c.slice()},j.range=function(N){return arguments.length?(h=Array.from(N),L()):h.slice()},j.rangeRound=function(N){return h=Array.from(N),f=Ug,L()},j.clamp=function(N){return arguments.length?(a=N?!0:Es,L()):a!==Es},j.interpolate=function(N){return arguments.length?(f=N,L()):f},j.unknown=function(N){return arguments.length?(x=N,j):x},function(N,X){return y=N,v=X,L()}}function Xg(){return $m()(Es,Es)}function Wg(c){return Math.abs(c=Math.round(c))>=1e21?c.toLocaleString("en").replace(/,/g,""):c.toString(10)}function Oh(c,h){if((f=(c=h?c.toExponential(h-1):c.toExponential()).indexOf("e"))<0)return null;var f,y=c.slice(0,f);return[y.length>1?y[0]+y.slice(2):y,+c.slice(f+1)]}function Uu(c){return c=Oh(Math.abs(c)),c?c[1]:NaN}function Hg(c,h){return function(f,y){for(var v=f.length,x=[],a=0,A=c[0],I=0;v>0&&A>0&&(I+A+1>y&&(A=Math.max(1,y-I)),x.push(f.substring(v-=A,v+A)),!((I+=A+1)>y));)A=c[a=(a+1)%c.length];return x.reverse().join(h)}}function Jg(c){return function(h){return h.replace(/[0-9]/g,function(f){return c[+f]})}}var Yg=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Nh(c){if(!(h=Yg.exec(c)))throw new Error("invalid format: "+c);var h;return new Zp({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}Nh.prototype=Zp.prototype;function Zp(c){this.fill=c.fill===void 0?" ":c.fill+"",this.align=c.align===void 0?">":c.align+"",this.sign=c.sign===void 0?"-":c.sign+"",this.symbol=c.symbol===void 0?"":c.symbol+"",this.zero=!!c.zero,this.width=c.width===void 0?void 0:+c.width,this.comma=!!c.comma,this.precision=c.precision===void 0?void 0:+c.precision,this.trim=!!c.trim,this.type=c.type===void 0?"":c.type+""}Zp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Qg(c){e:for(var h=c.length,f=1,y=-1,v;f<h;++f)switch(c[f]){case".":y=v=f;break;case"0":y===0&&(y=f),v=f;break;default:if(!+c[f])break e;y>0&&(y=0);break}return y>0?c.slice(0,y)+c.slice(v+1):c}var ey;function $g(c,h){var f=Oh(c,h);if(!f)return c+"";var y=f[0],v=f[1],x=v-(ey=Math.max(-8,Math.min(8,Math.floor(v/3)))*3)+1,a=y.length;return x===a?y:x>a?y+new Array(x-a+1).join("0"):x>0?y.slice(0,x)+"."+y.slice(x):"0."+new Array(1-x).join("0")+Oh(c,Math.max(0,h+x-1))[0]}function Rd(c,h){var f=Oh(c,h);if(!f)return c+"";var y=f[0],v=f[1];return v<0?"0."+new Array(-v).join("0")+y:y.length>v+1?y.slice(0,v+1)+"."+y.slice(v+1):y+new Array(v-y.length+2).join("0")}const Bd={"%":(c,h)=>(c*100).toFixed(h),b:c=>Math.round(c).toString(2),c:c=>c+"",d:Wg,e:(c,h)=>c.toExponential(h),f:(c,h)=>c.toFixed(h),g:(c,h)=>c.toPrecision(h),o:c=>Math.round(c).toString(8),p:(c,h)=>Rd(c*100,h),r:Rd,s:$g,X:c=>Math.round(c).toString(16).toUpperCase(),x:c=>Math.round(c).toString(16)};function Fd(c){return c}var Od=Array.prototype.map,Nd=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function ev(c){var h=c.grouping===void 0||c.thousands===void 0?Fd:Hg(Od.call(c.grouping,Number),c.thousands+""),f=c.currency===void 0?"":c.currency[0]+"",y=c.currency===void 0?"":c.currency[1]+"",v=c.decimal===void 0?".":c.decimal+"",x=c.numerals===void 0?Fd:Jg(Od.call(c.numerals,String)),a=c.percent===void 0?"%":c.percent+"",A=c.minus===void 0?"\u2212":c.minus+"",I=c.nan===void 0?"NaN":c.nan+"";function B(j){j=Nh(j);var N=j.fill,X=j.align,pe=j.sign,De=j.symbol,Ie=j.zero,rt=j.width,Ge=j.comma,Pt=j.precision,Tt=j.trim,ct=j.type;ct==="n"?(Ge=!0,ct="g"):Bd[ct]||(Pt===void 0&&(Pt=12),Tt=!0,ct="g"),(Ie||N==="0"&&X==="=")&&(Ie=!0,N="0",X="=");var He=De==="$"?f:De==="#"&&/[boxX]/.test(ct)?"0"+ct.toLowerCase():"",Vt=De==="$"?y:/[%p]/.test(ct)?a:"",Ht=Bd[ct],Rt=/[defgprs%]/.test(ct);Pt=Pt===void 0?6:/[gprs]/.test(ct)?Math.max(1,Math.min(21,Pt)):Math.max(0,Math.min(20,Pt));function gt(Fe){var At=He,ot=Vt,xt,Ve,Ue;if(ct==="c")ot=Ht(Fe)+ot,Fe="";else{Fe=+Fe;var _t=Fe<0||1/Fe<0;if(Fe=isNaN(Fe)?I:Ht(Math.abs(Fe),Pt),Tt&&(Fe=Qg(Fe)),_t&&+Fe==0&&pe!=="+"&&(_t=!1),At=(_t?pe==="("?pe:A:pe==="-"||pe==="("?"":pe)+At,ot=(ct==="s"?Nd[8+ey/3]:"")+ot+(_t&&pe==="("?")":""),Rt){for(xt=-1,Ve=Fe.length;++xt<Ve;)if(Ue=Fe.charCodeAt(xt),48>Ue||Ue>57){ot=(Ue===46?v+Fe.slice(xt+1):Fe.slice(xt))+ot,Fe=Fe.slice(0,xt);break}}}Ge&&!Ie&&(Fe=h(Fe,1/0));var fr=At.length+Fe.length+ot.length,zt=fr<rt?new Array(rt-fr+1).join(N):"";switch(Ge&&Ie&&(Fe=h(zt+Fe,zt.length?rt-ot.length:1/0),zt=""),X){case"<":Fe=At+Fe+ot+zt;break;case"=":Fe=At+zt+Fe+ot;break;case"^":Fe=zt.slice(0,fr=zt.length>>1)+At+Fe+ot+zt.slice(fr);break;default:Fe=zt+At+Fe+ot;break}return x(Fe)}return gt.toString=function(){return j+""},gt}function L(j,N){var X=B((j=Nh(j),j.type="f",j)),pe=Math.max(-8,Math.min(8,Math.floor(Uu(N)/3)))*3,De=Math.pow(10,-pe),Ie=Nd[8+pe/3];return function(rt){return X(De*rt)+Ie}}return{format:B,formatPrefix:L}}var Sh,ty,ry;tv({thousands:",",grouping:[3],currency:["$",""]});function tv(c){return Sh=ev(c),ty=Sh.format,ry=Sh.formatPrefix,Sh}function rv(c){return Math.max(0,-Uu(Math.abs(c)))}function iv(c,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Uu(h)/3)))*3-Uu(Math.abs(c)))}function nv(c,h){return c=Math.abs(c),h=Math.abs(h)-c,Math.max(0,Uu(h)-Uu(c))+1}function ov(c,h,f,y){var v=yg(c,h,f),x;switch(y=Nh(y==null?",f":y),y.type){case"s":{var a=Math.max(Math.abs(c),Math.abs(h));return y.precision==null&&!isNaN(x=iv(v,a))&&(y.precision=x),ry(y,a)}case"":case"e":case"g":case"p":case"r":{y.precision==null&&!isNaN(x=nv(v,Math.max(Math.abs(c),Math.abs(h))))&&(y.precision=x-(y.type==="e"));break}case"f":case"%":{y.precision==null&&!isNaN(x=rv(v))&&(y.precision=x-(y.type==="%")*2);break}}return ty(y)}function iy(c){var h=c.domain;return c.ticks=function(f){var y=h();return mg(y[0],y[y.length-1],f==null?10:f)},c.tickFormat=function(f,y){var v=h();return ov(v[0],v[v.length-1],f==null?10:f,y)},c.nice=function(f){f==null&&(f=10);var y=h(),v=0,x=y.length-1,a=y[v],A=y[x],I,B,L=10;for(A<a&&(B=a,a=A,A=B,B=v,v=x,x=B);L-- >0;){if(B=Km(a,A,f),B===I)return y[v]=a,y[x]=A,h(y);if(B>0)a=Math.floor(a/B)*B,A=Math.ceil(A/B)*B;else if(B<0)a=Math.ceil(a*B)/B,A=Math.floor(A*B)/B;else break;I=B}return c},c}function Ch(){var c=Xg();return c.copy=function(){return Qm(c,Ch())},Vh.apply(c,arguments),iy(c)}function Vd(c){return function(h){return h<0?-Math.pow(-h,c):Math.pow(h,c)}}function av(c){return c<0?-Math.sqrt(-c):Math.sqrt(c)}function sv(c){return c<0?-c*c:c*c}function lv(c){var h=c(Es,Es),f=1;function y(){return f===1?c(Es,Es):f===.5?c(av,sv):c(Vd(f),Vd(1/f))}return h.exponent=function(v){return arguments.length?(f=+v,y()):f},iy(h)}function ny(){var c=lv($m());return c.copy=function(){return Qm(c,ny()).exponent(c.exponent())},Vh.apply(c,arguments),c}function uv(){return ny.apply(null,arguments).exponent(.5)}const kc={x:Ch,y:Ch,z:Ch,r:uv};function cv(c){return c.constant?"symlog":c.base?"log":c.exponent?c.exponent()===.5?"sqrt":"pow":"other"}function Ud(c){return c}function hv(c){return h=>Math.log(c*h)}function pv(c){return h=>c*Math.exp(h)}function fv(c){return h=>Math.sign(h)*Math.log1p(Math.abs(h/c))}function dv(c){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*c}function kh(c){return function(f){return f<0?-Math.pow(-f,c):Math.pow(f,c)}}function mv(c){const h=cv(c);if(h==="log"){const f=Math.sign(c.domain()[0]);return{lift:hv(f),ground:pv(f),scaleType:h}}return h==="pow"?{lift:kh(1),ground:kh(1/1),scaleType:h}:h==="sqrt"?{lift:kh(.5),ground:kh(1/.5),scaleType:h}:h==="symlog"?{lift:fv(1),ground:dv(1),scaleType:h}:{lift:Ud,ground:Ud,scaleType:h}}function yv(c,h){if(typeof c.range!="function")throw new Error("Scale method `range` must be a function");if(typeof c.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return c.domain();c.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",c.domain()),c.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",c.range());const{lift:f,ground:y}=mv(c),v=c.domain()[0],x=Object.prototype.toString.call(v)==="[object Date]",[a,A]=c.domain().map(X=>f(x?X.getTime():X)),[I,B]=c.range(),L=h[0]||0,j=h[1]||0,N=(A-a)/(Math.abs(B-I)-L-j);return[a-L*N,j*N+A].map(X=>y(x?new Date(X):X))}function _v(c,h,f,y,v){let x,a;return v===!0?(x=0,a=100):(x=c==="r"?1:0,a=c==="y"?f:c==="r"?25:h),y===!0?[a,x]:[x,a]}function gv(c,h,f,y,v,x){return v?typeof v=="function"?v({width:h,height:f}):v:_v(c,h,f,y,x)}function Eh(c){return function([f,y,v,x,a,A,I,B,L,j]){if(y===null)return null;const N=gv(c,I,B,A,L,j),X=f===kc[c]?f():f.copy();return X.domain(Zm(y[c],v)).range(N),x&&X.domain(yv(X,x)),a===!0&&(typeof X.nice=="function"?X.nice():console.error(`[Layer Cake] You set \`${c}Nice: true\` but the ${c}Scale does not have a \`.nice\` method. Ignoring...`)),X}}function Th([c,h]){return f=>{const y=c(f);return Array.isArray(y)?y.map(v=>h(v)):h(y)}}function Ih([c]){if(typeof c=="function"){if(typeof c.range=="function")return c.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const Ah={x:!1,y:!0,z:!1,r:!1};const vv=c=>({element:c[0]&4,width:c[0]&256,height:c[0]&512,aspectRatio:c[0]&1024,containerWidth:c[0]&128,containerHeight:c[0]&64}),jd=c=>({element:c[2],width:c[8],height:c[9],aspectRatio:c[10],containerWidth:c[7],containerHeight:c[6]});function qd(c){let h,f,y;const v=c[90].default,x=Fu(v,c,c[89],jd);return{c(){h=Pe("div"),x&&x.c(),this.h()},l(a){h=Me(a,"DIV",{class:!0});var A=Ce(h);x&&x.l(A),A.forEach(H),this.h()},h(){$(h,"class","layercake-container svelte-vhzpsp"),Np(()=>c[92].call(h)),tt(h,"position",c[5],!1),tt(h,"top",c[5]==="absolute"?"0":null,!1),tt(h,"right",c[5]==="absolute"?"0":null,!1),tt(h,"bottom",c[5]==="absolute"?"0":null,!1),tt(h,"left",c[5]==="absolute"?"0":null,!1),tt(h,"pointer-events",c[4]===!1?"none":null,!1)},m(a,A){ke(a,h,A),x&&x.m(h,null),c[91](h),f=Vp(h,c[92].bind(h)),y=!0},p(a,A){x&&x.p&&(!y||A[0]&1988|A[2]&134217728)&&Ou(x,v,a,a[89],y?Vu(v,a[89],A,vv):Nu(a[89]),jd),A[0]&32&&tt(h,"position",a[5],!1),A[0]&32&&tt(h,"top",a[5]==="absolute"?"0":null,!1),A[0]&32&&tt(h,"right",a[5]==="absolute"?"0":null,!1),A[0]&32&&tt(h,"bottom",a[5]==="absolute"?"0":null,!1),A[0]&32&&tt(h,"left",a[5]==="absolute"?"0":null,!1),A[0]&16&&tt(h,"pointer-events",a[4]===!1?"none":null,!1)},i(a){y||(Mt(x,a),y=!0)},o(a){Wt(x,a),y=!1},d(a){a&&H(h),x&&x.d(a),c[91](null),f()}}}function xv(c){let h,f,y=(c[3]===!0||typeof window<"u")&&qd(c);return{c(){y&&y.c(),h=Or()},l(v){y&&y.l(v),h=Or()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,x){v[3]===!0||typeof window<"u"?y?(y.p(v,x),x[0]&8&&Mt(y,1)):(y=qd(v),y.c(),Mt(y,1),y.m(h.parentNode,h)):y&&($a(),Wt(y,1,1,()=>{y=null}),es())},i(v){f||(Mt(y),f=!0)},o(v){Wt(y),f=!1},d(v){y&&y.d(v),v&&H(h)}}}function bv(c,h,f){let y,v,x,a,A,I,B,L,j,N,X,pe,De,Ie,rt,Ge,Pt,Tt,ct,He,Vt,Ht,Rt,gt,Fe,At,ot,xt,Ve,Ue,_t,fr,zt,je,Ke,hr,Vr,Ji,Yi,_i,Gr,{$$slots:Ni={},$$scope:lr}=h,{ssr:Sr=!1}=h,{pointerEvents:dt=!0}=h,{position:Jt="relative"}=h,{percentRange:Gt=!1}=h,{width:Vi=void 0}=h,{height:Kr=void 0}=h,{containerWidth:Hr=Vi||100}=h,{containerHeight:Jr=Kr||100}=h,{element:Xr=void 0}=h,{x:Ui=void 0}=h,{y:Ei=void 0}=h,{z:Ri=void 0}=h,{r:sn=void 0}=h,{data:gi=[]}=h,{xDomain:Ti=void 0}=h,{yDomain:gn=void 0}=h,{zDomain:Er=void 0}=h,{rDomain:Yr=void 0}=h,{xNice:zo=!1}=h,{yNice:pi=!1}=h,{zNice:Ii=!1}=h,{rNice:ji=!1}=h,{xReverse:Co=Ah.x}=h,{yReverse:vn=Ah.y}=h,{zReverse:ho=Ah.z}=h,{rReverse:Un=Ah.r}=h,{xPadding:xn=void 0}=h,{yPadding:An=void 0}=h,{zPadding:Po=void 0}=h,{rPadding:Mo=void 0}=h,{xScale:Qi=kc.x}=h,{yScale:$i=kc.y}=h,{zScale:ln=kc.z}=h,{rScale:to=kc.r}=h,{xRange:jn=void 0}=h,{yRange:ar=void 0}=h,{zRange:M=void 0}=h,{rRange:F=void 0}=h,{padding:V={}}=h,{extents:K={}}=h,{flatData:J=void 0}=h,{custom:le={}}=h,ce=!1;Om(()=>{ce=!0});const U={},re=Ar(Gt);Qt(c,re,fe=>f(128,Ji=fe));const me=Ar(Hr);Qt(c,me,fe=>f(7,Vr=fe));const Re=Ar(Jr);Qt(c,Re,fe=>f(6,hr=fe));const Ne=Ar(Tp(K));Qt(c,Ne,fe=>f(127,Ke=fe));const be=Ar(gi);Qt(c,be,fe=>f(126,je=fe));const Be=Ar(J||gi);Qt(c,Be,fe=>f(125,zt=fe));const nt=Ar(V);Qt(c,nt,fe=>f(124,fr=fe));const it=Ar(_l(Ui));Qt(c,it,fe=>f(123,_t=fe));const we=Ar(_l(Ei));Qt(c,we,fe=>f(122,Ue=fe));const $e=Ar(_l(Ri));Qt(c,$e,fe=>f(121,Ve=fe));const qe=Ar(_l(sn));Qt(c,qe,fe=>f(120,xt=fe));const Xe=Ar(Ti);Qt(c,Xe,fe=>f(119,ot=fe));const jt=Ar(gn);Qt(c,jt,fe=>f(118,At=fe));const et=Ar(Er);Qt(c,et,fe=>f(117,Fe=fe));const Kt=Ar(Yr);Qt(c,Kt,fe=>f(116,gt=fe));const dr=Ar(zo);Qt(c,dr,fe=>f(115,Rt=fe));const Ft=Ar(pi);Qt(c,Ft,fe=>f(114,Ht=fe));const $t=Ar(Ii);Qt(c,$t,fe=>f(113,Vt=fe));const er=Ar(ji);Qt(c,er,fe=>f(112,He=fe));const ai=Ar(Co);Qt(c,ai,fe=>f(111,ct=fe));const rr=Ar(vn);Qt(c,rr,fe=>f(110,Tt=fe));const Cr=Ar(ho);Qt(c,Cr,fe=>f(109,Pt=fe));const Xt=Ar(Un);Qt(c,Xt,fe=>f(108,Ge=fe));const qt=Ar(xn);Qt(c,qt,fe=>f(107,rt=fe));const ir=Ar(An);Qt(c,ir,fe=>f(106,Ie=fe));const fi=Ar(Po);Qt(c,fi,fe=>f(105,De=fe));const ro=Ar(Mo);Qt(c,ro,fe=>f(104,pe=fe));const Pr=Ar(jn);Qt(c,Pr,fe=>f(103,X=fe));const Ur=Ar(ar);Qt(c,Ur,fe=>f(102,N=fe));const Zo=Ar(M);Qt(c,Zo,fe=>f(101,j=fe));const po=Ar(F);Qt(c,po,fe=>f(100,L=fe));const Mr=Ar(Qi);Qt(c,Mr,fe=>f(99,B=fe));const zn=Ar($i);Qt(c,zn,fe=>f(98,I=fe));const di=Ar(ln);Qt(c,di,fe=>f(97,A=fe));const jr=Ar(to);Qt(c,jr,fe=>f(96,a=fe));const Ai=Ar(U);Qt(c,Ai,fe=>f(94,v=fe));const yr=Ar(le);Qt(c,yr,fe=>f(95,x=fe));const Cn=Hi([it,we,$e,qe],([fe,ri,Ci,Tr])=>{const yo={};return fe&&(yo.x=fe),ri&&(yo.y=ri),Ci&&(yo.z=Ci),Tr&&(yo.r=Tr),yo}),qi=Hi([nt,me,Re],([fe])=>Object.assign({top:0,right:0,bottom:0,left:0},fe)),Go=Hi([me,Re,qi],([fe,ri,Ci])=>{const Tr={};return Tr.top=Ci.top,Tr.right=fe-Ci.right,Tr.bottom=ri-Ci.bottom,Tr.left=Ci.left,Tr.width=Tr.right-Tr.left,Tr.height=Tr.bottom-Tr.top,Tr.width<=0&&ce===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Tr.height<=0&&ce===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Tr}),Qr=Hi([Go],([fe])=>fe.width);Qt(c,Qr,fe=>f(8,Yi=fe));const fo=Hi([Go],([fe])=>fe.height);Qt(c,fo,fe=>f(9,_i=fe));const ei=Hi([Be,Cn,Ne],([fe,ri,Ci])=>{const Tr=Tp(ri,Ci);return Object.keys(Tr).length>0?{...og(fe,Tr),...Ci}:{}}),ti=Hi([ei,Xe],xh("x")),bn=Hi([ei,jt],xh("y")),zi=Hi([ei,et],xh("z")),io=Hi([ei,Kt],xh("r")),Pn=Hi([Mr,ei,ti,qt,dr,ai,Qr,fo,Pr,re],Eh("x")),mo=Hi([it,Pn],Th),en=Hi([zn,ei,bn,ir,Ft,rr,Qr,fo,Ur,re],Eh("y")),Do=Hi([we,en],Th),ba=Hi([di,ei,zi,fi,$t,Cr,Qr,fo,Zo,re],Eh("z")),wa=Hi([$e,ba],Th),Sa=Hi([jr,ei,io,ro,er,Xt,Qr,fo,po,re],Eh("r")),rs=Hi([qe,Sa],Th),qn=Hi([Pn],Ih),Ko=Hi([en],Ih),ca=Hi([ba],Ih),is=Hi([Sa],Ih),Mn=Hi([Qr,fo],([fe,ri])=>fe/ri);Qt(c,Mn,fe=>f(10,Gr=fe));function wn(fe){Ws[fe?"unshift":"push"](()=>{Xr=fe,f(2,Xr)})}function Zi(){Hr=this.clientWidth,Jr=this.clientHeight,f(0,Hr),f(1,Jr)}return c.$$set=fe=>{"ssr"in fe&&f(3,Sr=fe.ssr),"pointerEvents"in fe&&f(4,dt=fe.pointerEvents),"position"in fe&&f(5,Jt=fe.position),"percentRange"in fe&&f(51,Gt=fe.percentRange),"width"in fe&&f(52,Vi=fe.width),"height"in fe&&f(53,Kr=fe.height),"containerWidth"in fe&&f(0,Hr=fe.containerWidth),"containerHeight"in fe&&f(1,Jr=fe.containerHeight),"element"in fe&&f(2,Xr=fe.element),"x"in fe&&f(54,Ui=fe.x),"y"in fe&&f(55,Ei=fe.y),"z"in fe&&f(56,Ri=fe.z),"r"in fe&&f(57,sn=fe.r),"data"in fe&&f(58,gi=fe.data),"xDomain"in fe&&f(59,Ti=fe.xDomain),"yDomain"in fe&&f(60,gn=fe.yDomain),"zDomain"in fe&&f(61,Er=fe.zDomain),"rDomain"in fe&&f(62,Yr=fe.rDomain),"xNice"in fe&&f(63,zo=fe.xNice),"yNice"in fe&&f(64,pi=fe.yNice),"zNice"in fe&&f(65,Ii=fe.zNice),"rNice"in fe&&f(66,ji=fe.rNice),"xReverse"in fe&&f(67,Co=fe.xReverse),"yReverse"in fe&&f(68,vn=fe.yReverse),"zReverse"in fe&&f(69,ho=fe.zReverse),"rReverse"in fe&&f(70,Un=fe.rReverse),"xPadding"in fe&&f(71,xn=fe.xPadding),"yPadding"in fe&&f(72,An=fe.yPadding),"zPadding"in fe&&f(73,Po=fe.zPadding),"rPadding"in fe&&f(74,Mo=fe.rPadding),"xScale"in fe&&f(75,Qi=fe.xScale),"yScale"in fe&&f(76,$i=fe.yScale),"zScale"in fe&&f(77,ln=fe.zScale),"rScale"in fe&&f(78,to=fe.rScale),"xRange"in fe&&f(79,jn=fe.xRange),"yRange"in fe&&f(80,ar=fe.yRange),"zRange"in fe&&f(81,M=fe.zRange),"rRange"in fe&&f(82,F=fe.rRange),"padding"in fe&&f(83,V=fe.padding),"extents"in fe&&f(84,K=fe.extents),"flatData"in fe&&f(85,J=fe.flatData),"custom"in fe&&f(86,le=fe.custom),"$$scope"in fe&&f(89,lr=fe.$$scope)},c.$$.update=()=>{c.$$.dirty[1]&8388608&&Ui&&f(87,U.x=Ui,U),c.$$.dirty[1]&16777216&&Ei&&f(87,U.y=Ei,U),c.$$.dirty[1]&33554432&&Ri&&f(87,U.z=Ri,U),c.$$.dirty[1]&67108864&&sn&&f(87,U.r=sn,U),c.$$.dirty[1]&268435456&&Ti&&f(87,U.xDomain=Ti,U),c.$$.dirty[1]&536870912&&gn&&f(87,U.yDomain=gn,U),c.$$.dirty[1]&1073741824&&Er&&f(87,U.zDomain=Er,U),c.$$.dirty[2]&1&&Yr&&f(87,U.rDomain=Yr,U),c.$$.dirty[2]&131072&&jn&&f(87,U.xRange=jn,U),c.$$.dirty[2]&262144&&ar&&f(87,U.yRange=ar,U),c.$$.dirty[2]&524288&&M&&f(87,U.zRange=M,U),c.$$.dirty[2]&1048576&&F&&f(87,U.rRange=F,U),c.$$.dirty[1]&1048576&&Ir(re,Ji=Gt,Ji),c.$$.dirty[0]&1&&Ir(me,Vr=Hr,Vr),c.$$.dirty[0]&2&&Ir(Re,hr=Jr,hr),c.$$.dirty[2]&4194304&&Ir(Ne,Ke=Tp(K),Ke),c.$$.dirty[1]&134217728&&Ir(be,je=gi,je),c.$$.dirty[1]&134217728|c.$$.dirty[2]&8388608&&Ir(Be,zt=J||gi,zt),c.$$.dirty[2]&2097152&&Ir(nt,fr=V,fr),c.$$.dirty[1]&8388608&&Ir(it,_t=_l(Ui),_t),c.$$.dirty[1]&16777216&&Ir(we,Ue=_l(Ei),Ue),c.$$.dirty[1]&33554432&&Ir($e,Ve=_l(Ri),Ve),c.$$.dirty[1]&67108864&&Ir(qe,xt=_l(sn),xt),c.$$.dirty[1]&268435456&&Ir(Xe,ot=Ti,ot),c.$$.dirty[1]&536870912&&Ir(jt,At=gn,At),c.$$.dirty[1]&1073741824&&Ir(et,Fe=Er,Fe),c.$$.dirty[2]&1&&Ir(Kt,gt=Yr,gt),c.$$.dirty[2]&2&&Ir(dr,Rt=zo,Rt),c.$$.dirty[2]&4&&Ir(Ft,Ht=pi,Ht),c.$$.dirty[2]&8&&Ir($t,Vt=Ii,Vt),c.$$.dirty[2]&16&&Ir(er,He=ji,He),c.$$.dirty[2]&32&&Ir(ai,ct=Co,ct),c.$$.dirty[2]&64&&Ir(rr,Tt=vn,Tt),c.$$.dirty[2]&128&&Ir(Cr,Pt=ho,Pt),c.$$.dirty[2]&256&&Ir(Xt,Ge=Un,Ge),c.$$.dirty[2]&512&&Ir(qt,rt=xn,rt),c.$$.dirty[2]&1024&&Ir(ir,Ie=An,Ie),c.$$.dirty[2]&2048&&Ir(fi,De=Po,De),c.$$.dirty[2]&4096&&Ir(ro,pe=Mo,pe),c.$$.dirty[2]&131072&&Ir(Pr,X=jn,X),c.$$.dirty[2]&262144&&Ir(Ur,N=ar,N),c.$$.dirty[2]&524288&&Ir(Zo,j=M,j),c.$$.dirty[2]&1048576&&Ir(po,L=F,L),c.$$.dirty[2]&8192&&Ir(Mr,B=Qi,B),c.$$.dirty[2]&16384&&Ir(zn,I=$i,I),c.$$.dirty[2]&32768&&Ir(di,A=ln,A),c.$$.dirty[2]&65536&&Ir(jr,a=to,a),c.$$.dirty[2]&16777216&&Ir(yr,x=le,x),c.$$.dirty[2]&33554432&&Ir(Ai,v=U,v),c.$$.dirty[2]&67108864&&Nm("LayerCake",y)},f(88,y={activeGetters:Cn,width:Qr,height:fo,percentRange:re,aspectRatio:Mn,containerWidth:me,containerHeight:Re,x:it,y:we,z:$e,r:qe,custom:yr,data:be,xNice:dr,yNice:Ft,zNice:$t,rNice:er,xReverse:ai,yReverse:rr,zReverse:Cr,rReverse:Xt,xPadding:qt,yPadding:ir,zPadding:fi,rPadding:ro,padding:qi,flatData:Be,extents:ei,xDomain:ti,yDomain:bn,zDomain:zi,rDomain:io,xRange:qn,yRange:Ko,zRange:ca,rRange:is,config:Ai,xScale:Pn,xGet:mo,yScale:en,yGet:Do,zScale:ba,zGet:wa,rScale:Sa,rGet:rs}),[Hr,Jr,Xr,Sr,dt,Jt,hr,Vr,Yi,_i,Gr,re,me,Re,Ne,be,Be,nt,it,we,$e,qe,Xe,jt,et,Kt,dr,Ft,$t,er,ai,rr,Cr,Xt,qt,ir,fi,ro,Pr,Ur,Zo,po,Mr,zn,di,jr,Ai,yr,Qr,fo,Mn,Gt,Vi,Kr,Ui,Ei,Ri,sn,gi,Ti,gn,Er,Yr,zo,pi,Ii,ji,Co,vn,ho,Un,xn,An,Po,Mo,Qi,$i,ln,to,jn,ar,M,F,V,K,J,le,U,y,lr,Ni,wn,Zi]}class wv extends sa{constructor(h){super(),la(this,h,bv,xv,ua,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const Sv=c=>({element:c&1}),Zd=c=>({element:c[0]}),kv=c=>({element:c&1}),Gd=c=>({element:c[0]});function Ev(c){let h,f,y,v,x;const a=c[12].defs,A=Fu(a,c,c[11],Gd),I=c[12].default,B=Fu(I,c,c[11],Zd);return{c(){h=$n("svg"),f=$n("defs"),A&&A.c(),y=$n("g"),B&&B.c(),this.h()},l(L){h=eo(L,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var j=Ce(h);f=eo(j,"defs",{});var N=Ce(f);A&&A.l(N),N.forEach(H),y=eo(j,"g",{class:!0,transform:!0});var X=Ce(y);B&&B.l(X),X.forEach(H),j.forEach(H),this.h()},h(){$(y,"class","layercake-layout-svg_g"),$(y,"transform",v="translate("+c[7].left+", "+c[7].top+")"),$(h,"class","layercake-layout-svg svelte-u84d8d"),$(h,"viewBox",c[4]),$(h,"width",c[5]),$(h,"height",c[6]),tt(h,"z-index",c[2],!1),tt(h,"pointer-events",c[3]===!1?"none":null,!1)},m(L,j){ke(L,h,j),ne(h,f),A&&A.m(f,null),ne(h,y),B&&B.m(y,null),c[13](y),c[14](h),x=!0},p(L,[j]){A&&A.p&&(!x||j&2049)&&Ou(A,a,L,L[11],x?Vu(a,L[11],j,kv):Nu(L[11]),Gd),B&&B.p&&(!x||j&2049)&&Ou(B,I,L,L[11],x?Vu(I,L[11],j,Sv):Nu(L[11]),Zd),(!x||j&128&&v!==(v="translate("+L[7].left+", "+L[7].top+")"))&&$(y,"transform",v),(!x||j&16)&&$(h,"viewBox",L[4]),(!x||j&32)&&$(h,"width",L[5]),(!x||j&64)&&$(h,"height",L[6]),j&4&&tt(h,"z-index",L[2],!1),j&8&&tt(h,"pointer-events",L[3]===!1?"none":null,!1)},i(L){x||(Mt(A,L),Mt(B,L),x=!0)},o(L){Wt(A,L),Wt(B,L),x=!1},d(L){L&&H(h),A&&A.d(L),B&&B.d(L),c[13](null),c[14](null)}}}function Tv(c,h,f){let y,v,x,{$$slots:a={},$$scope:A}=h,{element:I=void 0}=h,{innerElement:B=void 0}=h,{zIndex:L=void 0}=h,{pointerEvents:j=void 0}=h,{viewBox:N=void 0}=h;const{containerWidth:X,containerHeight:pe,padding:De}=Cc("LayerCake");Qt(c,X,Ge=>f(5,y=Ge)),Qt(c,pe,Ge=>f(6,v=Ge)),Qt(c,De,Ge=>f(7,x=Ge));function Ie(Ge){Ws[Ge?"unshift":"push"](()=>{B=Ge,f(1,B)})}function rt(Ge){Ws[Ge?"unshift":"push"](()=>{I=Ge,f(0,I)})}return c.$$set=Ge=>{"element"in Ge&&f(0,I=Ge.element),"innerElement"in Ge&&f(1,B=Ge.innerElement),"zIndex"in Ge&&f(2,L=Ge.zIndex),"pointerEvents"in Ge&&f(3,j=Ge.pointerEvents),"viewBox"in Ge&&f(4,N=Ge.viewBox),"$$scope"in Ge&&f(11,A=Ge.$$scope)},[I,B,L,j,N,y,v,x,X,pe,De,A,a,Ie,rt]}class Iv extends sa{constructor(h){super(),la(this,h,Tv,Ev,ua,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Kd(c,h,f){const y=c.slice();return y[24]=h[f],y[26]=f,y}function Xd(c){let h,f,y,v;return{c(){h=$n("rect"),this.h()},l(x){h=eo(x,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ce(h).forEach(H),this.h()},h(){$(h,"class","group-rect"),$(h,"data-id",c[26]),$(h,"x",f=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),$(h,"y",y=c[13](c[12](c[24]))-1),$(h,"width",v=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),$(h,"height","3"),$(h,"fill","#CEDC20"),$(h,"stroke",c[0]),$(h,"stroke-width",c[1])},m(x,a){ke(x,h,a)},p(x,a){a&3200&&f!==(f=x[11].bandwidth?x[7](x[24]):x[7](x[24])[0])&&$(h,"x",f),a&13312&&y!==(y=x[13](x[12](x[24]))-1)&&$(h,"y",y),a&3584&&v!==(v=x[11].bandwidth?x[11].bandwidth():x[9](x[24]))&&$(h,"width",v),a&1&&$(h,"stroke",x[0]),a&2&&$(h,"stroke-width",x[1])},d(x){x&&H(h)}}}function Wd(c){let h,f,y,v,x,a,A,I,B=c[12]&&Xd(c);return{c(){h=$n("rect"),B&&B.c(),a=$n("text"),this.h()},l(L){h=eo(L,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ce(h).forEach(H),B&&B.l(L),a=eo(L,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Ce(a).forEach(H),this.h()},h(){$(h,"class","group-rect"),$(h,"data-id",c[26]),$(h,"x",f=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),$(h,"y",y=c[6](c[24])),$(h,"width",v=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),$(h,"height",x=c[8](c[24])),$(h,"fill",c[4]),$(h,"stroke",c[0]),$(h,"stroke-width",c[1]),$(a,"x",A=c[11].bandwidth?c[7](c[24])+c[11].bandwidth()/2:c[7](c[24])[0]),$(a,"y",I=c[6](c[24])-4),$(a,"dx",c[2]),$(a,"dy",c[3]),$(a,"text-anchor",c[5])},m(L,j){ke(L,h,j),B&&B.m(L,j),ke(L,a,j)},p(L,j){j&3200&&f!==(f=L[11].bandwidth?L[7](L[24]):L[7](L[24])[0])&&$(h,"x",f),j&1088&&y!==(y=L[6](L[24]))&&$(h,"y",y),j&3584&&v!==(v=L[11].bandwidth?L[11].bandwidth():L[9](L[24]))&&$(h,"width",v),j&1280&&x!==(x=L[8](L[24]))&&$(h,"height",x),j&16&&$(h,"fill",L[4]),j&1&&$(h,"stroke",L[0]),j&2&&$(h,"stroke-width",L[1]),L[12]?B?B.p(L,j):(B=Xd(L),B.c(),B.m(a.parentNode,a)):B&&(B.d(1),B=null),j&3200&&A!==(A=L[11].bandwidth?L[7](L[24])+L[11].bandwidth()/2:L[7](L[24])[0])&&$(a,"x",A),j&1088&&I!==(I=L[6](L[24])-4)&&$(a,"y",I),j&4&&$(a,"dx",L[2]),j&8&&$(a,"dy",L[3]),j&32&&$(a,"text-anchor",L[5])},d(L){L&&H(h),B&&B.d(L),L&&H(a)}}}function Av(c){let h,f=c[10],y=[];for(let v=0;v<f.length;v+=1)y[v]=Wd(Kd(c,f,v));return{c(){h=$n("g");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=eo(v,"g",{class:!0});var x=Ce(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(H),this.h()},h(){$(h,"class","column-group svelte-wgzwsk")},m(v,x){ke(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[x]){if(x&16383){f=v[10];let a;for(a=0;a<f.length;a+=1){const A=Kd(v,f,a);y[a]?y[a].p(A,x):(y[a]=Wd(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:co,o:co,d(v){v&&H(h),ts(y,v)}}}function zv(c,h,f){let y,v,x,a,A,I,B,L,j;const{data:N,xGet:X,yGet:pe,yRange:De,xScale:Ie,yScale:rt,y:Ge,z:Pt}=Cc("LayerCake");Qt(c,N,Fe=>f(10,I=Fe)),Qt(c,X,Fe=>f(7,A=Fe)),Qt(c,pe,Fe=>f(6,x=Fe)),Qt(c,De,Fe=>f(22,a=Fe)),Qt(c,Ie,Fe=>f(11,B=Fe)),Qt(c,rt,Fe=>f(13,j=Fe)),Qt(c,Pt,Fe=>f(12,L=Fe));let{stroke:Tt=""}=h,{strokeWidth:ct=0}=h,{dxTick:He=0}=h,{dyTick:Vt=0}=h,{formatVal:Ht=Fe=>Fe}=h,{fill:Rt="#00205b"}=h,{textAnchor:gt="middle"}=h;return c.$$set=Fe=>{"stroke"in Fe&&f(0,Tt=Fe.stroke),"strokeWidth"in Fe&&f(1,ct=Fe.strokeWidth),"dxTick"in Fe&&f(2,He=Fe.dxTick),"dyTick"in Fe&&f(3,Vt=Fe.dyTick),"formatVal"in Fe&&f(21,Ht=Fe.formatVal),"fill"in Fe&&f(4,Rt=Fe.fill),"textAnchor"in Fe&&f(5,gt=Fe.textAnchor)},c.$$.update=()=>{c.$$.dirty&128&&f(9,y=Fe=>{const At=A(Fe);return Math.max(0,At[1]-At[0])}),c.$$.dirty&4194368&&f(8,v=Fe=>a[0]-x(Fe))},[Tt,ct,He,Vt,Rt,gt,x,A,v,y,I,B,L,j,N,X,pe,De,Ie,rt,Pt,Ht,a]}class Cv extends sa{constructor(h){super(),la(this,h,zv,Av,ua,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,formatVal:21,fill:4,textAnchor:5})}}function Hd(c,h,f){const y=c.slice();return y[28]=h[f],y[30]=f,y}function Jd(c){let h,f,y,v;return{c(){h=$n("line"),this.h()},l(x){h=eo(x,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Ce(h).forEach(H),this.h()},h(){$(h,"y1",f=c[20]*-1),$(h,"y2",y=c[14]&&c[30]%2==0?c[10]+c[8]+2:c[10]+c[8]-13),$(h,"x1","0"),$(h,"x2","0"),$(h,"stroke",c[11]),$(h,"stroke-width",v=c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)?2:1),$(h,"class","svelte-fwjh80"),Oi(h,"baseline",c[13])},m(x,a){ke(x,h,a)},p(x,a){a&1048576&&f!==(f=x[20]*-1)&&$(h,"y1",f),a&17664&&y!==(y=x[14]&&x[30]%2==0?x[10]+x[8]+2:x[10]+x[8]-13)&&$(h,"y2",y),a&2048&&$(h,"stroke",x[11]),a&32784&&v!==(v=x[15]&&Array.isArray(x[4])&&x[30]==Math.floor(x[4].length/2)?2:1)&&$(h,"stroke-width",v),a&8192&&Oi(h,"baseline",x[13])},d(x){x&&H(h)}}}function Pv(c){let h=c[1](c[28])+"",f;return{c(){f=Ee(h)},l(y){f=Te(y,h)},m(y,v){ke(y,f,v)},p(y,v){v&262146&&h!==(h=y[1](y[28])+"")&&Dt(f,h)},d(y){y&&H(f)}}}function Mv(c){let h,f=c[1](c[28])+"",y,v;return{c(){h=Ee(c[5]),y=Ee(f),v=Ee(c[6])},l(x){h=Te(x,c[5]),y=Te(x,f),v=Te(x,c[6])},m(x,a){ke(x,h,a),ke(x,y,a),ke(x,v,a)},p(x,a){a&32&&Dt(h,x[5]),a&262146&&f!==(f=x[1](x[28])+"")&&Dt(y,f),a&64&&Dt(v,x[6])},d(x){x&&H(h),x&&H(y),x&&H(v)}}}function Yd(c){let h,f,y,v,x,a,A,I=c[0]!==!1&&Jd(c);function B(N,X){return N[30]==N[18].length-1?Mv:Pv}let L=B(c),j=L(c);return{c(){h=$n("g"),I&&I.c(),f=$n("text"),j.c(),this.h()},l(N){h=eo(N,"g",{class:!0,transform:!0});var X=Ce(h);I&&I.l(X),f=eo(X,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var pe=Ce(f);j.l(pe),pe.forEach(H),X.forEach(H),this.h()},h(){$(f,"x",y=c[7]||c[16]?c[17].bandwidth()/2:0),$(f,"y",v=c[3]?c[20]*-1-6:c[14]&&c[30]%2==0?c[8]+15:c[8]),$(f,"dx",x=c[24](c[30])=="start"?c[9]-2:c[24](c[30])=="end"?c[9]+2:c[9]),$(f,"dy",c[10]),$(f,"text-anchor",c[24](c[30])),$(f,"fill",c[12]),$(f,"class","svelte-fwjh80"),Oi(f,"bold",c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)),$(h,"class",a="tick tick-"+c[28]+" svelte-fwjh80"),$(h,"transform",A="translate("+c[17](c[28])+","+c[19][0]+")")},m(N,X){ke(N,h,X),I&&I.m(h,null),ne(h,f),j.m(f,null)},p(N,X){N[0]!==!1?I?I.p(N,X):(I=Jd(N),I.c(),I.m(h,f)):I&&(I.d(1),I=null),L===(L=B(N))&&j?j.p(N,X):(j.d(1),j=L(N),j&&(j.c(),j.m(f,null))),X&196736&&y!==(y=N[7]||N[16]?N[17].bandwidth()/2:0)&&$(f,"x",y),X&1065224&&v!==(v=N[3]?N[20]*-1-6:N[14]&&N[30]%2==0?N[8]+15:N[8])&&$(f,"y",v),X&512&&x!==(x=N[24](N[30])=="start"?N[9]-2:N[24](N[30])=="end"?N[9]+2:N[9])&&$(f,"dx",x),X&1024&&$(f,"dy",N[10]),X&4096&&$(f,"fill",N[12]),X&32784&&Oi(f,"bold",N[15]&&Array.isArray(N[4])&&N[30]==Math.floor(N[4].length/2)),X&262144&&a!==(a="tick tick-"+N[28]+" svelte-fwjh80")&&$(h,"class",a),X&917504&&A!==(A="translate("+N[17](N[28])+","+N[19][0]+")")&&$(h,"transform",A)},d(N){N&&H(h),I&&I.d(),j.d()}}}function Qd(c){let h,f,y;return{c(){h=$n("line"),this.h()},l(v){h=eo(v,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Ce(h).forEach(H),this.h()},h(){$(h,"class","baseline svelte-fwjh80"),$(h,"y1",c[20]),$(h,"y2","0"),$(h,"x1",f=c[17](0)),$(h,"x2",y=c[17](0)),$(h,"stroke",c[11])},m(v,x){ke(v,h,x)},p(v,x){x&1048576&&$(h,"y1",v[20]),x&131072&&f!==(f=v[17](0))&&$(h,"x1",f),x&131072&&y!==(y=v[17](0))&&$(h,"x2",y),x&2048&&$(h,"stroke",v[11])},d(v){v&&H(h)}}}function Dv(c){let h,f,y=c[18],v=[];for(let a=0;a<y.length;a+=1)v[a]=Yd(Hd(c,y,a));let x=c[2]===!0&&Qd(c);return{c(){h=$n("g");for(let a=0;a<v.length;a+=1)v[a].c();f=Or(),x&&x.c(),this.h()},l(a){h=eo(a,"g",{class:!0});var A=Ce(h);for(let I=0;I<v.length;I+=1)v[I].l(A);f=Or(),x&&x.l(A),A.forEach(H),this.h()},h(){$(h,"class","axis x-axis")},m(a,A){ke(a,h,A);for(let I=0;I<v.length;I+=1)v[I].m(h,null);ne(h,f),x&&x.m(h,null)},p(a,[A]){if(A&18874363){y=a[18];let I;for(I=0;I<y.length;I+=1){const B=Hd(a,y,I);v[I]?v[I].p(B,A):(v[I]=Yd(B),v[I].c(),v[I].m(h,f))}for(;I<v.length;I+=1)v[I].d(1);v.length=y.length}a[2]===!0?x?x.p(a,A):(x=Qd(a),x.c(),x.m(h,null)):x&&(x.d(1),x=null)},i:co,o:co,d(a){a&&H(h),ts(v,a),x&&x.d()}}}function Lv(c,h,f){let y,v,x,a,A;const{width:I,height:B,xScale:L,yScale:j,yRange:N}=Cc("LayerCake");Qt(c,B,Ve=>f(20,A=Ve)),Qt(c,L,Ve=>f(17,x=Ve)),Qt(c,N,Ve=>f(19,a=Ve));let{gridlines:X=!0}=h,{formatTick:pe=Ve=>Ve}=h,{baseline:De=!1}=h,{flipped:Ie=!1}=h,{snapTicks:rt=!1}=h,{ticks:Ge=void 0}=h,{prefix:Pt=""}=h,{suffix:Tt=""}=h,{xTick:ct=void 0}=h,{yTick:He=15}=h,{dxTick:Vt=0}=h,{dyTick:Ht=0}=h,{lineColor:Rt="#999"}=h,{textColor:gt="#555"}=h,{solid:Fe=!1}=h,{stagger:At=!1}=h,{median:ot=!0}=h;function xt(Ve){if(rt===!0){if(Ve===0)return"start";if(Ve===v.length-1)return"end"}return"middle"}return c.$$set=Ve=>{"gridlines"in Ve&&f(0,X=Ve.gridlines),"formatTick"in Ve&&f(1,pe=Ve.formatTick),"baseline"in Ve&&f(2,De=Ve.baseline),"flipped"in Ve&&f(3,Ie=Ve.flipped),"snapTicks"in Ve&&f(25,rt=Ve.snapTicks),"ticks"in Ve&&f(4,Ge=Ve.ticks),"prefix"in Ve&&f(5,Pt=Ve.prefix),"suffix"in Ve&&f(6,Tt=Ve.suffix),"xTick"in Ve&&f(7,ct=Ve.xTick),"yTick"in Ve&&f(8,He=Ve.yTick),"dxTick"in Ve&&f(9,Vt=Ve.dxTick),"dyTick"in Ve&&f(10,Ht=Ve.dyTick),"lineColor"in Ve&&f(11,Rt=Ve.lineColor),"textColor"in Ve&&f(12,gt=Ve.textColor),"solid"in Ve&&f(13,Fe=Ve.solid),"stagger"in Ve&&f(14,At=Ve.stagger),"median"in Ve&&f(15,ot=Ve.median)},c.$$.update=()=>{c.$$.dirty&131072&&f(16,y=typeof x.bandwidth=="function"),c.$$.dirty&196624&&f(18,v=Array.isArray(Ge)?Ge:y?x.domain():x.ticks(Ge))},[X,pe,De,Ie,Ge,Pt,Tt,ct,He,Vt,Ht,Rt,gt,Fe,At,ot,y,x,v,a,A,B,L,N,xt,rt]}class Rv extends sa{constructor(h){super(),la(this,h,Lv,Dv,ua,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function Bv(c){let h,f,y,v;return h=new Cv({props:{fill:c[1],formatVal:c[5]}}),y=new Rv({props:{gridlines:!1}}),{c(){li(h.$$.fragment),f=pt(),li(y.$$.fragment)},l(x){ui(h.$$.fragment,x),f=ft(x),ui(y.$$.fragment,x)},m(x,a){ci(h,x,a),ke(x,f,a),ci(y,x,a),v=!0},p(x,a){const A={};a&2&&(A.fill=x[1]),a&32&&(A.formatVal=x[5]),h.$set(A)},i(x){v||(Mt(h.$$.fragment,x),Mt(y.$$.fragment,x),v=!0)},o(x){Wt(h.$$.fragment,x),Wt(y.$$.fragment,x),v=!1},d(x){hi(h,x),x&&H(f),hi(y,x)}}}function Fv(c){let h,f;return h=new Iv({props:{$$slots:{default:[Bv]},$$scope:{ctx:c}}}),{c(){li(h.$$.fragment)},l(y){ui(h.$$.fragment,y)},m(y,v){ci(h,y,v),f=!0},p(y,v){const x={};v&1058&&(x.$$scope={dirty:v,ctx:y}),h.$set(x)},i(y){f||(Mt(h.$$.fragment,y),f=!0)},o(y){Wt(h.$$.fragment,y),f=!1},d(y){hi(h,y)}}}function Ov(c){let h,f,y;return f=new wv({props:{padding:{top:15,right:0,bottom:20,left:0},x:c[2],y:c[3],z:c[4],xScale:Wm().paddingInner([.02]).round(!0),xDomain:c[7],yDomain:c[6],zDomain:c[6],data:c[0],$$slots:{default:[Fv]},$$scope:{ctx:c}}}),{c(){h=Pe("div"),li(f.$$.fragment),this.h()},l(v){h=Me(v,"DIV",{class:!0});var x=Ce(h);ui(f.$$.fragment,x),x.forEach(H),this.h()},h(){$(h,"class","chart-container svelte-s9z6lx")},m(v,x){ke(v,h,x),ci(f,h,null),y=!0},p(v,[x]){const a={};x&4&&(a.x=v[2]),x&8&&(a.y=v[3]),x&16&&(a.z=v[4]),x&128&&(a.xDomain=v[7]),x&64&&(a.yDomain=v[6]),x&64&&(a.zDomain=v[6]),x&1&&(a.data=v[0]),x&1058&&(a.$$scope={dirty:x,ctx:v}),f.$set(a)},i(v){y||(Mt(f.$$.fragment,v),y=!0)},o(v){Wt(f.$$.fragment,v),y=!1},d(v){v&&H(h),hi(f)}}}function Nv(c,h,f){let y,v,x,{data:a}=h,{suffix:A="%"}=h,{decimals:I=0}=h,{fill:B="#00205B"}=h,{xKey:L="x"}=h,{yKey:j="y"}=h,{zKey:N=null}=h;return c.$$set=X=>{"data"in X&&f(0,a=X.data),"suffix"in X&&f(8,A=X.suffix),"decimals"in X&&f(9,I=X.decimals),"fill"in X&&f(1,B=X.fill),"xKey"in X&&f(2,L=X.xKey),"yKey"in X&&f(3,j=X.yKey),"zKey"in X&&f(4,N=X.zKey)},c.$$.update=()=>{c.$$.dirty&5&&f(7,y=a.map(X=>X[L])),c.$$.dirty&9&&f(6,v=[0,Math.max(...a.map(X=>X[j]))]),c.$$.dirty&768&&f(5,x=X=>X.toFixed(I)+A)},[a,B,L,j,N,x,v,y,A,I]}class Vv extends sa{constructor(h){super(),la(this,h,Nv,Ov,ua,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function $d(c,h,f){const y=c.slice();return y[7]=h[f],y[9]=f,y}function em(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=tm($d(c,f,v));return{c(){h=$n("svg");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=eo(v,"svg",{class:!0});var x=Ce(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(H),this.h()},h(){$(h,"class","stack svelte-q6mgyr")},m(v,x){ke(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,x){if(x&31){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=$d(v,f,a);y[a]?y[a].p(A,x):(y[a]=tm(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){v&&H(h),ts(y,v)}}}function tm(c){let h,f;return{c(){h=$n("rect"),this.h()},l(y){h=eo(y,"rect",{class:!0,x:!0,style:!0}),Ce(h).forEach(H),this.h()},h(){$(h,"class","cell svelte-q6mgyr"),$(h,"x",f=c[4][c[9]]/c[3]*100+"%"),tt(h,"width",c[7][c[1]]/c[3]*100+"%"),tt(h,"fill",c[2][c[9]])},m(y,v){ke(y,h,v)},p(y,v){v&24&&f!==(f=y[4][y[9]]/y[3]*100+"%")&&$(h,"x",f),v&11&&tt(h,"width",y[7][y[1]]/y[3]*100+"%"),v&4&&tt(h,"fill",y[2][y[9]])},d(y){y&&H(h)}}}function Uv(c){let h,f=c[3]&&c[4]&&em(c);return{c(){f&&f.c(),h=Or()},l(y){f&&f.l(y),h=Or()},m(y,v){f&&f.m(y,v),ke(y,h,v)},p(y,[v]){y[3]&&y[4]?f?f.p(y,v):(f=em(y),f.c(),f.m(h.parentNode,h)):f&&(f.d(1),f=null)},i:co,o:co,d(y){f&&f.d(y),y&&H(h)}}}function jv(c,h,f){let{data:y}=h,{xKey:v="x"}=h,{yKey:x="y"}=h,{colors:a=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,A,I;function B(){f(3,A=y.map(j=>j[x]).reduce((j,N)=>j+N,0));let L=[0];y.forEach(j=>L.push(L[L.length-1]+j[x])),f(4,I=L)}return c.$$set=L=>{"data"in L&&f(0,y=L.data),"xKey"in L&&f(5,v=L.xKey),"yKey"in L&&f(1,x=L.yKey),"colors"in L&&f(2,a=L.colors)},c.$$.update=()=>{c.$$.dirty&3&&(y||x)&&B()},[y,x,a,A,I,v]}class oy extends sa{constructor(h){super(),la(this,h,jv,Uv,ua,{data:0,xKey:5,yKey:1,colors:2})}}function rm(c,h,f){const y=c.slice();return y[12]=h[f],y[14]=f,y}function qv(c){let h,f,y=c[6](c[12][c[3]])+"",v,x;return{c(){h=Pe("span"),f=Ee("(NI "),v=Ee(y),x=Ee(")"),this.h()},l(a){h=Me(a,"SPAN",{class:!0,style:!0});var A=Ce(h);f=Te(A,"(NI "),v=Te(A,y),x=Te(A,")"),A.forEach(H),this.h()},h(){$(h,"class",""),tt(h,"color","#3878C5")},m(a,A){ke(a,h,A),ne(h,f),ne(h,v),ne(h,x)},p(a,A){A&9&&y!==(y=a[6](a[12][a[3]])+"")&&Dt(v,y)},d(a){a&&H(h)}}}function Zv(c){let h,f,y=gr(Math.round(c[12][c[3]]),"%)")+"",v;return{c(){h=Pe("span"),f=Ee("(2001 "),v=Ee(y),this.h()},l(x){h=Me(x,"SPAN",{class:!0,style:!0});var a=Ce(h);f=Te(a,"(2001 "),v=Te(a,y),a.forEach(H),this.h()},h(){$(h,"class",""),tt(h,"color","#3878C5")},m(x,a){ke(x,h,a),ne(h,f),ne(h,v)},p(x,a){a&9&&y!==(y=gr(Math.round(x[12][x[3]]),"%)")+"")&&Dt(v,y)},d(x){x&&H(h)}}}function im(c){let h,f,y,v,x=c[12][c[1]]+"",a,A,I=c[6](c[12][c[2]])+"",B,L,j;function N(De,Ie){if(De[3]=="prev")return Zv;if(De[3])return qv}let X=N(c),pe=X&&X(c);return{c(){h=Pe("li"),f=$n("svg"),y=$n("rect"),v=pt(),a=Ee(x),A=pt(),B=Ee(I),L=pt(),pe&&pe.c(),j=pt(),this.h()},l(De){h=Me(De,"LI",{style:!0,class:!0});var Ie=Ce(h);f=eo(Ie,"svg",{width:!0,height:!0,class:!0});var rt=Ce(f);y=eo(rt,"rect",{width:!0,height:!0,style:!0});var Ge=Ce(y);Ge.forEach(H),rt.forEach(H),v=ft(Ie),a=Te(Ie,x),A=ft(Ie),B=Te(Ie,I),L=ft(Ie),pe&&pe.l(Ie),j=ft(Ie),Ie.forEach(H),this.h()},h(){$(y,"width","20"),$(y,"height","30"),tt(y,"fill",c[4][c[14]]),$(f,"width","20"),$(f,"height","30"),$(f,"class","bullet svelte-89uh35"),tt(h,"color",c[5]),$(h,"class","svelte-89uh35")},m(De,Ie){ke(De,h,Ie),ne(h,f),ne(f,y),ne(h,v),ne(h,a),ne(h,A),ne(h,B),ne(h,L),pe&&pe.m(h,null),ne(h,j)},p(De,Ie){Ie&16&&tt(y,"fill",De[4][De[14]]),Ie&3&&x!==(x=De[12][De[1]]+"")&&Dt(a,x),Ie&5&&I!==(I=De[6](De[12][De[2]])+"")&&Dt(B,I),X===(X=N(De))&&pe?pe.p(De,Ie):(pe&&pe.d(1),pe=X&&X(De),pe&&(pe.c(),pe.m(h,j))),Ie&32&&tt(h,"color",De[5])},d(De){De&&H(h),pe&&pe.d()}}}function Gv(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=im(rm(c,f,v));return{c(){h=Pe("ul");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=Me(v,"UL",{class:!0});var x=Ce(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(H),this.h()},h(){$(h,"class","svelte-89uh35")},m(v,x){ke(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[x]){if(x&127){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=rm(v,f,a);y[a]?y[a].p(A,x):(y[a]=im(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:co,o:co,d(v){v&&H(h),ts(y,v)}}}function Kv(c,h,f){let y,{data:v}=h,{xKey:x="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:I=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,{textColor:B="#555"}=h,{mutedColor:L="#999"}=h,{decimals:j=null}=h,{round:N=!1}=h;function X(pe){let De;return j?De=(pe/y*100).toFixed(j)+"%":pe/y*100<1?De="<1%":De=(pe/y*100).toFixed(0)+"%",De}return c.$$set=pe=>{"data"in pe&&f(0,v=pe.data),"xKey"in pe&&f(1,x=pe.xKey),"yKey"in pe&&f(2,a=pe.yKey),"zKey"in pe&&f(3,A=pe.zKey),"colors"in pe&&f(4,I=pe.colors),"textColor"in pe&&f(5,B=pe.textColor),"mutedColor"in pe&&f(7,L=pe.mutedColor),"decimals"in pe&&f(8,j=pe.decimals),"round"in pe&&f(9,N=pe.round)},c.$$.update=()=>{c.$$.dirty&5&&(y=v.map(pe=>pe[a]).reduce((pe,De)=>pe+De,0)),c.$$.dirty&9&&v.map(pe=>pe[A]).reduce((pe,De)=>pe+De,0)},[v,x,a,A,I,B,X,L,j,N]}class Xv extends sa{constructor(h){super(),la(this,h,Kv,Gv,ua,{data:0,xKey:1,yKey:2,zKey:3,colors:4,textColor:5,mutedColor:7,decimals:8,round:9})}}function nm(c){let h,f,y,v;f=new oy({props:{data:c[0],yKey:c[4],colors:c[5]}});let x=c[7]&&om(c);return{c(){h=Pe("div"),li(f.$$.fragment),y=pt(),x&&x.c(),this.h()},l(a){h=Me(a,"DIV",{class:!0,style:!0});var A=Ce(h);ui(f.$$.fragment,A),y=ft(A),x&&x.l(A),A.forEach(H),this.h()},h(){$(h,"class","chart svelte-1tebgpk"),tt(h,"height",c[1]*.28+"px")},m(a,A){ke(a,h,A),ci(f,h,null),ne(h,y),x&&x.m(h,null),v=!0},p(a,A){const I={};A&1&&(I.data=a[0]),A&16&&(I.yKey=a[4]),A&32&&(I.colors=a[5]),f.$set(I),a[7]?x?x.p(a,A):(x=om(a),x.c(),x.m(h,null)):x&&(x.d(1),x=null),(!v||A&2)&&tt(h,"height",a[1]*.28+"px")},i(a){v||(Mt(f.$$.fragment,a),v=!0)},o(a){Wt(f.$$.fragment,a),v=!1},d(a){a&&H(h),hi(f),x&&x.d()}}}function om(c){let h,f;return{c(){h=Pe("div"),f=Ee(c[7]),this.h()},l(y){h=Me(y,"DIV",{class:!0});var v=Ce(h);f=Te(v,c[7]),v.forEach(H),this.h()},h(){$(h,"class","label svelte-1tebgpk")},m(y,v){ke(y,h,v),ne(h,f)},p(y,v){v&128&&Dt(f,y[7])},d(y){y&&H(h)}}}function Wv(c){let h,f,y,v,x,a,A;f=new oy({props:{data:c[0],yKey:c[3],colors:c[5]}});let I=c[4]&&nm(c);return a=new Xv({props:{data:c[0],xKey:c[2],yKey:c[3],zKey:c[4],decimals:c[6],colors:c[5]}}),{c(){h=Pe("div"),li(f.$$.fragment),y=pt(),I&&I.c(),v=pt(),x=Pe("div"),li(a.$$.fragment),this.h()},l(B){h=Me(B,"DIV",{class:!0,style:!0});var L=Ce(h);ui(f.$$.fragment,L),L.forEach(H),y=ft(B),I&&I.l(B),v=ft(B),x=Me(B,"DIV",{class:!0});var j=Ce(x);ui(a.$$.fragment,j),j.forEach(H),this.h()},h(){$(h,"class","chart svelte-1tebgpk"),tt(h,"padding-top","3px"),tt(h,"height",(c[4]?c[1]*.72:c[1])+"px"),$(x,"class","legend svelte-1tebgpk")},m(B,L){ke(B,h,L),ci(f,h,null),ke(B,y,L),I&&I.m(B,L),ke(B,v,L),ke(B,x,L),ci(a,x,null),A=!0},p(B,[L]){const j={};L&1&&(j.data=B[0]),L&8&&(j.yKey=B[3]),L&32&&(j.colors=B[5]),f.$set(j),(!A||L&18)&&tt(h,"height",(B[4]?B[1]*.72:B[1])+"px"),B[4]?I?(I.p(B,L),L&16&&Mt(I,1)):(I=nm(B),I.c(),Mt(I,1),I.m(v.parentNode,v)):I&&($a(),Wt(I,1,1,()=>{I=null}),es());const N={};L&1&&(N.data=B[0]),L&4&&(N.xKey=B[2]),L&8&&(N.yKey=B[3]),L&16&&(N.zKey=B[4]),L&64&&(N.decimals=B[6]),L&32&&(N.colors=B[5]),a.$set(N)},i(B){A||(Mt(f.$$.fragment,B),Mt(I),Mt(a.$$.fragment,B),A=!0)},o(B){Wt(f.$$.fragment,B),Wt(I),Wt(a.$$.fragment,B),A=!1},d(B){B&&H(h),hi(f),B&&H(y),I&&I.d(B),B&&H(v),B&&H(x),hi(a)}}}function Hv(c,h,f){let{data:y}=h,{height:v=80}=h,{xKey:x="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:I=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,{decimals:B=null}=h,{label:L=null}=h;return c.$$set=j=>{"data"in j&&f(0,y=j.data),"height"in j&&f(1,v=j.height),"xKey"in j&&f(2,x=j.xKey),"yKey"in j&&f(3,a=j.yKey),"zKey"in j&&f(4,A=j.zKey),"colors"in j&&f(5,I=j.colors),"decimals"in j&&f(6,B=j.decimals),"label"in j&&f(7,L=j.label)},[y,v,x,a,A,I,B,L]}class wc extends sa{constructor(h){super(),la(this,h,Hv,Wv,ua,{data:0,height:1,xKey:2,yKey:3,zKey:4,colors:5,decimals:6,label:7})}}var Jv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yv={rgb2hsl:Dc,rgb2hsv:Uh,rgb2hwb:Lc,rgb2cmyk:Rc,rgb2keyword:Bc,rgb2xyz:Gp,rgb2lab:Kp,rgb2lch:Qv,hsl2rgb:jh,hsl2hsv:$v,hsl2hwb:e0,hsl2cmyk:t0,hsl2keyword:r0,hsv2rgb:qh,hsv2hsl:i0,hsv2hwb:n0,hsv2cmyk:o0,hsv2keyword:a0,hwb2rgb:Fc,hwb2hsl:s0,hwb2hsv:l0,hwb2cmyk:u0,hwb2keyword:c0,cmyk2rgb:Oc,cmyk2hsl:h0,cmyk2hsv:p0,cmyk2hwb:f0,cmyk2keyword:d0,keyword2rgb:Yl,keyword2hsl:g0,keyword2hsv:v0,keyword2hwb:x0,keyword2cmyk:b0,keyword2lab:w0,keyword2xyz:S0,xyz2rgb:ay,xyz2lab:sy,xyz2lch:m0,lab2xyz:Xp,lab2rgb:ly,lab2lch:Wp,lch2lab:Hp,lch2xyz:y0,lch2rgb:_0};function Dc(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v=Math.min(h,f,y),x=Math.max(h,f,y),a=x-v,A,I,B;return x==v?A=0:h==x?A=(f-y)/a:f==x?A=2+(y-h)/a:y==x&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),B=(v+x)/2,x==v?I=0:B<=.5?I=a/(x+v):I=a/(2-x-v),[A,I*100,B*100]}function Uh(c){var h=c[0],f=c[1],y=c[2],v=Math.min(h,f,y),x=Math.max(h,f,y),a=x-v,A,I,B;return x==0?I=0:I=a/x*1e3/10,x==v?A=0:h==x?A=(f-y)/a:f==x?A=2+(y-h)/a:y==x&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),B=x/255*1e3/10,[A,I,B]}function Lc(c){var h=c[0],f=c[1],x=c[2],y=Dc(c)[0],v=1/255*Math.min(h,Math.min(f,x)),x=1-1/255*Math.max(h,Math.max(f,x));return[y,v*100,x*100]}function Rc(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v,x,a,A;return A=Math.min(1-h,1-f,1-y),v=(1-h-A)/(1-A)||0,x=(1-f-A)/(1-A)||0,a=(1-y-A)/(1-A)||0,[v*100,x*100,a*100,A*100]}function Bc(c){return uy[JSON.stringify(c)]}function Gp(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92,y=y>.04045?Math.pow((y+.055)/1.055,2.4):y/12.92;var v=h*.4124+f*.3576+y*.1805,x=h*.2126+f*.7152+y*.0722,a=h*.0193+f*.1192+y*.9505;return[v*100,x*100,a*100]}function Kp(c){var h=Gp(c),f=h[0],y=h[1],v=h[2],x,a,A;return f/=95.047,y/=100,v/=108.883,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,x=116*y-16,a=500*(f-y),A=200*(y-v),[x,a,A]}function Qv(c){return Wp(Kp(c))}function jh(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v,x,a,A,I;if(f==0)return I=y*255,[I,I,I];y<.5?x=y*(1+f):x=y+f-y*f,v=2*y-x,A=[0,0,0];for(var B=0;B<3;B++)a=h+1/3*-(B-1),a<0&&a++,a>1&&a--,6*a<1?I=v+(x-v)*6*a:2*a<1?I=x:3*a<2?I=v+(x-v)*(2/3-a)*6:I=v,A[B]=I*255;return A}function $v(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,x;return y===0?[0,0,0]:(y*=2,f*=y<=1?y:2-y,x=(y+f)/2,v=2*f/(y+f),[h,v*100,x*100])}function e0(c){return Lc(jh(c))}function t0(c){return Rc(jh(c))}function r0(c){return Bc(jh(c))}function qh(c){var h=c[0]/60,f=c[1]/100,I=c[2]/100,y=Math.floor(h)%6,v=h-Math.floor(h),x=255*I*(1-f),a=255*I*(1-f*v),A=255*I*(1-f*(1-v)),I=255*I;switch(y){case 0:return[I,A,x];case 1:return[a,I,x];case 2:return[x,I,A];case 3:return[x,a,I];case 4:return[A,x,I];case 5:return[I,x,a]}}function i0(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,x;return x=(2-f)*y,v=f*y,v/=x<=1?x:2-x,v=v||0,x/=2,[h,v*100,x*100]}function n0(c){return Lc(qh(c))}function o0(c){return Rc(qh(c))}function a0(c){return Bc(qh(c))}function Fc(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v=f+y,x,a,A,I;switch(v>1&&(f/=v,y/=v),x=Math.floor(6*h),a=1-y,A=6*h-x,(x&1)!=0&&(A=1-A),I=f+A*(a-f),x){default:case 6:case 0:r=a,g=I,b=f;break;case 1:r=I,g=a,b=f;break;case 2:r=f,g=a,b=I;break;case 3:r=f,g=I,b=a;break;case 4:r=I,g=f,b=a;break;case 5:r=a,g=f,b=I;break}return[r*255,g*255,b*255]}function s0(c){return Dc(Fc(c))}function l0(c){return Uh(Fc(c))}function u0(c){return Rc(Fc(c))}function c0(c){return Bc(Fc(c))}function Oc(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v=c[3]/100,x,a,A;return x=1-Math.min(1,h*(1-v)+v),a=1-Math.min(1,f*(1-v)+v),A=1-Math.min(1,y*(1-v)+v),[x*255,a*255,A*255]}function h0(c){return Dc(Oc(c))}function p0(c){return Uh(Oc(c))}function f0(c){return Lc(Oc(c))}function d0(c){return Bc(Oc(c))}function ay(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v,x,a;return v=h*3.2406+f*-1.5372+y*-.4986,x=h*-.9689+f*1.8758+y*.0415,a=h*.0557+f*-.204+y*1.057,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,x=x>.0031308?1.055*Math.pow(x,1/2.4)-.055:x=x*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,v=Math.min(Math.max(0,v),1),x=Math.min(Math.max(0,x),1),a=Math.min(Math.max(0,a),1),[v*255,x*255,a*255]}function sy(c){var h=c[0],f=c[1],y=c[2],v,x,a;return h/=95.047,f/=100,y/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*f-16,x=500*(h-f),a=200*(f-y),[v,x,a]}function m0(c){return Wp(sy(c))}function Xp(c){var h=c[0],f=c[1],y=c[2],v,x,a,A;return h<=8?(x=h*100/903.3,A=7.787*(x/100)+16/116):(x=100*Math.pow((h+16)/116,3),A=Math.pow(x/100,1/3)),v=v/95.047<=.008856?v=95.047*(f/500+A-16/116)/7.787:95.047*Math.pow(f/500+A,3),a=a/108.883<=.008859?a=108.883*(A-y/200-16/116)/7.787:108.883*Math.pow(A-y/200,3),[v,x,a]}function Wp(c){var h=c[0],f=c[1],y=c[2],v,x,a;return v=Math.atan2(y,f),x=v*360/2/Math.PI,x<0&&(x+=360),a=Math.sqrt(f*f+y*y),[h,a,x]}function ly(c){return ay(Xp(c))}function Hp(c){var h=c[0],f=c[1],y=c[2],v,x,a;return a=y/360*2*Math.PI,v=f*Math.cos(a),x=f*Math.sin(a),[h,v,x]}function y0(c){return Xp(Hp(c))}function _0(c){return ly(Hp(c))}function Yl(c){return Op[c]}function g0(c){return Dc(Yl(c))}function v0(c){return Uh(Yl(c))}function x0(c){return Lc(Yl(c))}function b0(c){return Rc(Yl(c))}function w0(c){return Kp(Yl(c))}function S0(c){return Gp(Yl(c))}var Op={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},uy={};for(var am in Op)uy[JSON.stringify(Op[am])]=am;var zp=Yv,Xl=function(){return new Nc};for(var Sc in zp){Xl[Sc+"Raw"]=function(c){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),zp[c](h)}}(Sc);var sm=/(\w+)2(\w+)/.exec(Sc),Cp=sm[1],k0=sm[2];Xl[Cp]=Xl[Cp]||{},Xl[Cp][k0]=Xl[Sc]=function(c){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var f=zp[c](h);if(typeof f=="string"||f===void 0)return f;for(var y=0;y<f.length;y++)f[y]=Math.round(f[y]);return f}}(Sc)}var Nc=function(){this.convs={}};Nc.prototype.routeSpace=function(c,h){var f=h[0];return f===void 0?this.getValues(c):(typeof f=="number"&&(f=Array.prototype.slice.call(h)),this.setValues(c,f))};Nc.prototype.setValues=function(c,h){return this.space=c,this.convs={},this.convs[c]=h,this};Nc.prototype.getValues=function(c){var h=this.convs[c];if(!h){var f=this.space,y=this.convs[f];h=Xl[f][c](y),this.convs[c]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(c){Nc.prototype[c]=function(h){return this.routeSpace(c,arguments)}});var E0=Xl,Pp=E0,T0=function(c){var h,f,y,v;if(h=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(c)){var x=h[1],a=x.replace(/a$/,""),A=a==="cmyk"?4:3;f=Pp[a],y=h[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map(function(B,L){return/%$/.test(B)&&L===A?parseFloat(B)/100:(/%$/.test(B),parseFloat(B))}),x===a&&y.push(1),v=y[A]===void 0?1:y[A],y=y.slice(0,A),f[a]=function(){return y}}else if(/^#[A-Fa-f0-9]+$/.test(c)){var a=c.replace(/^#/,""),A=a.length;f=Pp.rgb,y=a.split(A===3?/(.)/:/(..)/),y=y.filter(Boolean).map(function(j){return parseInt(A===3?j+j:j,16)}),v=1,f.rgb=function(){return y},y[0]||(y[0]=0),y[1]||(y[1]=0),y[2]||(y[2]=0)}else f=Pp.keyword,f.keyword=function(){return c},y=c,v=1;var I={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{I.rgb=f.rgb(y)}catch{}try{I.hsl=f.hsl(y)}catch{}try{I.hsv=f.hsv(y)}catch{}try{I.cmyk=f.cmyk(y)}catch{}try{I.keyword=f.keyword(y)}catch{}return I.rgb&&(I.hex="#"+I.rgb.map(function(B){var L=B.toString(16);return L.length===1?"0"+L:L}).join("")),I.rgb&&(I.rgba=I.rgb.concat(v)),I.hsl&&(I.hsla=I.hsl.concat(v)),I.hsv&&(I.hsva=I.hsv.concat(v)),I.cmyk&&(I.cmyka=I.cmyk.concat(v)),I};function I0(c){let h,f;const y=c[5].default,v=Fu(y,c,c[4],null);return{c(){h=Pe("span"),v&&v.c(),this.h()},l(x){h=Me(x,"SPAN",{class:!0,style:!0,role:!0});var a=Ce(h);v&&v.l(a),a.forEach(H),this.h()},h(){$(h,"class","em svelte-s1t2y4"),tt(h,"background-color",c[0]),tt(h,"color",c[2]),$(h,"role","presentation"),Oi(h,"nowrap",c[1])},m(x,a){ke(x,h,a),v&&v.m(h,null),f=!0},p(x,[a]){v&&v.p&&(!f||a&16)&&Ou(v,y,x,x[4],f?Vu(y,x[4],a,null):Nu(x[4]),null),(!f||a&1)&&tt(h,"background-color",x[0]),(!f||a&4)&&tt(h,"color",x[2]),a&2&&Oi(h,"nowrap",x[1])},i(x){f||(Mt(v,x),f=!0)},o(x){Wt(v,x),f=!1},d(x){x&&H(h),v&&v.d(x)}}}function A0(c,h,f){let y,{$$slots:v={},$$scope:x}=h,{color:a="lightgrey"}=h,{nowrap:A=!0}=h;function I(L){return(L[0]*299+L[1]*587+L[2]*114)/1e3>125?"black":"white"}let B="black";return c.$$set=L=>{"color"in L&&f(0,a=L.color),"nowrap"in L&&f(1,A=L.nowrap),"$$scope"in L&&f(4,x=L.$$scope)},c.$$.update=()=>{c.$$.dirty&1&&f(3,y=T0(a).rgb),c.$$.dirty&8&&y&&f(2,B=I(y))},[a,A,B,y,x,v]}class Zh extends sa{constructor(h){super(),la(this,h,A0,I0,ua,{color:0,nowrap:1})}}function lm(c,h,f){const y=c.slice();return y[33]=h[f],y[36]=h,y[35]=f,y}function um(c,h,f){const y=c.slice();return y[33]=h[f],y[34]=h,y[35]=f,y}function z0(c){let h,f,y=(c[0]?c[0]:"Select one")+"",v,x,a,A,I,B;return{c(){h=Pe("a"),f=Pe("span"),v=Ee(y),x=pt(),a=Pe("span"),A=Ee("\xA0"),this.h()},l(L){h=Me(L,"A",{id:!0,class:!0});var j=Ce(h);f=Me(j,"SPAN",{class:!0});var N=Ce(f);v=Te(N,y),N.forEach(H),x=ft(j),a=Me(j,"SPAN",{class:!0});var X=Ce(a);A=Te(X,"\xA0"),X.forEach(H),j.forEach(H),this.h()},h(){$(f,"class","svelte-4ddz8j"),$(a,"class","button svelte-4ddz8j"),Oi(a,"search",c[3]),Oi(a,"down",!c[3]),$(h,"id","toggle"),$(h,"class","svelte-4ddz8j")},m(L,j){ke(L,h,j),ne(h,f),ne(f,v),ne(h,x),ne(h,a),ne(a,A),I||(B=aa(h,"click",c[12]),I=!0)},p(L,j){j[0]&1&&y!==(y=(L[0]?L[0]:"Select one")+"")&&Dt(v,y),j[0]&8&&Oi(a,"search",L[3]),j[0]&8&&Oi(a,"down",!L[3])},d(L){L&&H(h),I=!1,B()}}}function C0(c){let h,f,y=c[5][c[1]]+"",v,x,a,A,I,B,L,j=c[2]&&cm(c);return{c(){h=Pe("a"),f=Pe("span"),v=Ee(y),x=pt(),j&&j.c(),a=pt(),A=Pe("span"),I=Ee("\xA0"),this.h()},l(N){h=Me(N,"A",{id:!0,class:!0});var X=Ce(h);f=Me(X,"SPAN",{class:!0});var pe=Ce(f);v=Te(pe,y),x=ft(pe),j&&j.l(pe),pe.forEach(H),a=ft(X),A=Me(X,"SPAN",{class:!0});var De=Ce(A);I=Te(De,"\xA0"),De.forEach(H),X.forEach(H),this.h()},h(){$(f,"class","selection svelte-4ddz8j"),$(A,"class","button close svelte-4ddz8j"),$(h,"id","toggle"),$(h,"class","selected svelte-4ddz8j")},m(N,X){ke(N,h,X),ne(h,f),ne(f,v),ne(f,x),j&&j.m(f,null),ne(h,a),ne(h,A),ne(A,I),B||(L=[aa(A,"click",c[14]),aa(h,"click",c[12])],B=!0)},p(N,X){X[0]&34&&y!==(y=N[5][N[1]]+"")&&Dt(v,y),N[2]?j?j.p(N,X):(j=cm(N),j.c(),j.m(f,null)):j&&(j.d(1),j=null)},d(N){N&&H(h),j&&j.d(),B=!1,Pc(L)}}}function cm(c){let h,f=c[5][c[2]]+"",y;return{c(){h=Pe("small"),y=Ee(f),this.h()},l(v){h=Me(v,"SMALL",{class:!0});var x=Ce(h);y=Te(x,f),x.forEach(H),this.h()},h(){$(h,"class","svelte-4ddz8j")},m(v,x){ke(v,h,x),ne(h,y)},p(v,x){x[0]&36&&f!==(f=v[5][v[2]]+"")&&Dt(y,f)},d(v){v&&H(h)}}}function hm(c){let h,f,y,v,x,a;function A(L,j){return L[4].length<3?L0:L[8][0]&&L[2]?D0:L[8][0]?M0:P0}let I=A(c),B=I(c);return{c(){h=Pe("div"),f=Pe("input"),y=pt(),v=Pe("ul"),B.c(),this.h()},l(L){h=Me(L,"DIV",{id:!0,style:!0,class:!0});var j=Ce(h);f=Me(j,"INPUT",{type:!0,placeholder:!0,autocomplete:!0,onfocus:!0,class:!0}),y=ft(j),v=Me(j,"UL",{class:!0});var N=Ce(v);B.l(N),N.forEach(H),j.forEach(H),this.h()},h(){$(f,"type","text"),$(f,"placeholder",""),$(f,"autocomplete","false"),f.autofocus="autofocus",$(f,"onfocus","this.select()"),$(f,"class","svelte-4ddz8j"),$(v,"class","svelte-4ddz8j"),$(h,"id","dropdown"),tt(h,"top","0"),$(h,"class","svelte-4ddz8j")},m(L,j){ke(L,h,j),ne(h,f),_d(f,c[4]),c[24](f),ne(h,y),ne(h,v),B.m(v,null),c[31](h),f.focus(),x||(a=[aa(f,"input",c[23]),aa(f,"keyup",c[16])],x=!0)},p(L,j){j[0]&16&&f.value!==L[4]&&_d(f,L[4]),I===(I=A(L))&&B?B.p(L,j):(B.d(1),B=I(L),B&&(B.c(),B.m(v,null)))},d(L){L&&H(h),c[24](null),B.d(),c[31](null),x=!1,Pc(a)}}}function P0(c){let h,f;return{c(){h=Pe("li"),f=Ee("No results"),this.h()},l(y){h=Me(y,"LI",{class:!0});var v=Ce(h);f=Te(v,"No results"),v.forEach(H),this.h()},h(){$(h,"class","svelte-4ddz8j")},m(y,v){ke(y,h,v),ne(h,f)},p:co,d(y){y&&H(h)}}}function M0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=pm(lm(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Or()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=Or()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);ke(v,h,x)},p(v,x){if(x[0]&10626){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=lm(v,f,a);y[a]?y[a].p(A,x):(y[a]=pm(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){ts(y,v),v&&H(h)}}}function D0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=fm(um(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Or()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=Or()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);ke(v,h,x)},p(v,x){if(x[0]&10630){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=um(v,f,a);y[a]?y[a].p(A,x):(y[a]=fm(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){ts(y,v),v&&H(h)}}}function L0(c){let h,f;return{c(){h=Pe("li"),f=Ee("Type a name..."),this.h()},l(y){h=Me(y,"LI",{class:!0});var v=Ce(h);f=Te(v,"Type a name..."),v.forEach(H),this.h()},h(){$(h,"class","svelte-4ddz8j")},m(y,v){ke(y,h,v),ne(h,f)},p:co,d(y){y&&H(h)}}}function pm(c){let h,f=c[33][c[1]]+"",y,v,x=c[35],a,A;function I(){return c[28](c[33])}function B(){return c[29](c[35])}const L=()=>c[30](h,x),j=()=>c[30](null,x);return{c(){h=Pe("li"),y=Ee(f),v=pt(),this.h()},l(N){h=Me(N,"LI",{class:!0});var X=Ce(h);y=Te(X,f),v=ft(X),X.forEach(H),this.h()},h(){$(h,"class","svelte-4ddz8j"),Oi(h,"highlight",c[7]==c[35])},m(N,X){ke(N,h,X),ne(h,y),ne(h,v),L(),a||(A=[aa(h,"click",I),aa(h,"mouseover",B)],a=!0)},p(N,X){c=N,X[0]&258&&f!==(f=c[33][c[1]]+"")&&Dt(y,f),x!==c[35]&&(j(),x=c[35],L()),X[0]&128&&Oi(h,"highlight",c[7]==c[35])},d(N){N&&H(h),j(),a=!1,Pc(A)}}}function fm(c){let h,f=c[33][c[1]]+"",y,v,x,a=c[33][c[2]]+"",A,I,B=c[35],L,j;function N(){return c[25](c[33])}function X(){return c[26](c[35])}const pe=()=>c[27](h,B),De=()=>c[27](null,B);return{c(){h=Pe("li"),y=Ee(f),v=pt(),x=Pe("small"),A=Ee(a),I=pt(),this.h()},l(Ie){h=Me(Ie,"LI",{class:!0});var rt=Ce(h);y=Te(rt,f),v=ft(rt),x=Me(rt,"SMALL",{class:!0});var Ge=Ce(x);A=Te(Ge,a),Ge.forEach(H),I=ft(rt),rt.forEach(H),this.h()},h(){$(x,"class","svelte-4ddz8j"),$(h,"class","svelte-4ddz8j"),Oi(h,"highlight",c[7]==c[35])},m(Ie,rt){ke(Ie,h,rt),ne(h,y),ne(h,v),ne(h,x),ne(x,A),ne(h,I),pe(),L||(j=[aa(h,"click",N),aa(h,"mouseover",X)],L=!0)},p(Ie,rt){c=Ie,rt[0]&258&&f!==(f=c[33][c[1]]+"")&&Dt(y,f),rt[0]&260&&a!==(a=c[33][c[2]]+"")&&Dt(A,a),B!==c[35]&&(De(),B=c[35],pe()),rt[0]&128&&Oi(h,"highlight",c[7]==c[35])},d(Ie){Ie&&H(h),De(),L=!1,Pc(j)}}}function R0(c){let h,f,y,v;function x(B,L){return B[5]&&!B[3]?C0:z0}let a=x(c),A=a(c),I=c[6]&&hm(c);return{c(){h=Pe("div"),A.c(),f=pt(),I&&I.c(),this.h()},l(B){h=Me(B,"DIV",{id:!0,class:!0});var L=Ce(h);A.l(L),f=ft(L),I&&I.l(L),L.forEach(H),this.h()},h(){$(h,"id","select"),$(h,"class","svelte-4ddz8j"),Oi(h,"active",c[6])},m(B,L){ke(B,h,L),A.m(h,null),ne(h,f),I&&I.m(h,null),y||(v=[aa(window,"click",c[17]),aa(h,"keydown",c[15])],y=!0)},p(B,L){a===(a=x(B))&&A?A.p(B,L):(A.d(1),A=a(B),A&&(A.c(),A.m(h,f))),B[6]?I?I.p(B,L):(I=hm(B),I.c(),I.m(h,null)):I&&(I.d(1),I=null),L[0]&64&&Oi(h,"active",B[6])},i:co,o:co,d(B){B&&H(h),A.d(),I&&I.d(),y=!1,Pc(v)}}}function B0(c){return new Promise(h=>setTimeout(h,c))}function F0(c,h,f){let y;const v=Vm();let{options:x}=h,{selected:a=null}=h,{placeholder:A="Enter a town or area name"}=h,{value:I="code"}=h,{label:B="name"}=h,{group:L=null}=h,{search:j=!1}=h,N=a,X=a?x.find(je=>{je[I]==a[I]}):null,pe=!1,De="",Ie=null,rt,Ge,Pt,Tt=[];function ct(je){je.stopPropagation(),f(4,De=""),f(6,pe=!pe),B0(10).then(()=>{Pt&&pe&&Pt.focus()})}function He(je){f(18,a=je),f(6,pe=!1),v("select",{selected:je,value:je[I]})}function Vt(je){je.stopPropagation(),f(18,a=null),f(21,N=null),f(5,X=null),v("select",{selected:null,value:null})}function Ht(je){pe&&rt[0]&&Number.isInteger(Ie)&&(je.keyCode===38?(f(7,Ie-=Ie>0?1:0),Tt[Ie].scrollIntoView({block:"nearest",inline:"start"})):je.keyCode===40&&(f(7,Ie+=Ie<rt.length-1?1:0),Tt[Ie].scrollIntoView({block:"nearest",inline:"end"})))}function Rt(je){rt[0]&&Number.isInteger(Ie)&&je.keyCode===13&&He(rt[Ie])}function gt(je){je.target!==Ge&&(f(6,pe=!1),f(7,Ie=0))}function Fe(){De=this.value,f(4,De)}function At(je){Ws[je?"unshift":"push"](()=>{Pt=je,f(10,Pt)})}const ot=je=>He(je),xt=je=>f(7,Ie=je);function Ve(je,Ke){Ws[je?"unshift":"push"](()=>{Tt[Ke]=je,f(11,Tt)})}const Ue=je=>He(je),_t=je=>f(7,Ie=je);function fr(je,Ke){Ws[je?"unshift":"push"](()=>{Tt[Ke]=je,f(11,Tt)})}function zt(je){Ws[je?"unshift":"push"](()=>{Ge=je,f(9,Ge)})}return c.$$set=je=>{"options"in je&&f(19,x=je.options),"selected"in je&&f(18,a=je.selected),"placeholder"in je&&f(0,A=je.placeholder),"value"in je&&f(20,I=je.value),"label"in je&&f(1,B=je.label),"group"in je&&f(2,L=je.group),"search"in je&&f(3,j=je.search)},c.$$.update=()=>{c.$$.dirty[0]&16&&f(22,y=De?new RegExp(De,"i"):null),c.$$.dirty[0]&4718594&&(f(8,rt=y?x.filter(je=>y.test(je[B])):x),f(7,Ie=0)),c.$$.dirty[0]&3932160&&N!=a&&(f(5,X=x.find(je=>je[I]==a[I])),f(21,N=a))},[A,B,L,j,De,X,pe,Ie,rt,Ge,Pt,Tt,ct,He,Vt,Ht,Rt,gt,a,x,I,N,y,Fe,At,ot,xt,Ve,Ue,_t,fr,zt]}class O0 extends sa{constructor(h){super(),la(this,h,F0,R0,ua,{options:19,selected:18,placeholder:0,value:20,label:1,group:2,search:3},null,[-1,-1])}}var Tc={exports:{}};(function(c,h){(function(f,y){c.exports=y()})(Jv,function(){var f,y,v;function x(a,A){if(!f)f=A;else if(!y)y=A;else{var I="var sharedChunk = {}; ("+f+")(sharedChunk); ("+y+")(sharedChunk);",B={};f(B),v=A(B),typeof window<"u"&&(v.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}return x(["exports"],function(a){function A(e,t){return e(t={exports:{}},t.exports),t.exports}var I=B;function B(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}B.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},B.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},B.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},B.prototype.solveCurveX=function(e,t){var i,l,p,d,_;for(t===void 0&&(t=1e-6),p=e,_=0;_<8;_++){if(d=this.sampleCurveX(p)-e,Math.abs(d)<t)return p;var k=this.sampleCurveDerivativeX(p);if(Math.abs(k)<1e-6)break;p-=d/k}if((p=e)<(i=0))return i;if(p>(l=1))return l;for(;i<l;){if(d=this.sampleCurveX(p),Math.abs(d-e)<t)return p;e>d?i=p:l=p,p=.5*(l-i)+i}return p},B.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var L=j;function j(e,t){this.x=e,this.y=t}j.prototype={clone:function(){return new j(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),p=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},j.convert=function(e){return e instanceof j?e:Array.isArray(e)?new j(e[0],e[1]):e};var N=typeof self<"u"?self:{},X=Math.pow(2,53)-1;function pe(e,t,i,l){var p=new I(e,t,i,l);return function(d){return p.solve(d)}}var De=pe(.25,.1,.25,1);function Ie(e,t,i){return Math.min(i,Math.max(t,e))}function rt(e,t,i){var l=i-t,p=((e-t)%l+l)%l+t;return p===t?i:p}function Ge(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}var Pt=1;function Tt(){return Pt++}function ct(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function He(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Vt(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Ht(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Rt(e,t,i){var l={};for(var p in e)l[p]=t.call(i||this,e[p],p,e);return l}function gt(e,t,i){var l={};for(var p in e)t.call(i||this,e[p],p,e)&&(l[p]=e[p]);return l}function Fe(e){return Array.isArray(e)?e.map(Fe):typeof e=="object"&&e?Rt(e,Fe):e}var At={};function ot(e){At[e]||(typeof console<"u"&&console.warn(e),At[e]=!0)}function xt(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function Ve(e){for(var t=0,i=0,l=e.length,p=l-1,d=void 0,_=void 0;i<l;p=i++)t+=((_=e[p]).x-(d=e[i]).x)*(d.y+_.y);return t}function Ue(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function _t(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,p,d,_){var k=d||_;return t[p]=!k||k.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var fr=null;function zt(e){if(fr==null){var t=e.navigator?e.navigator.userAgent:null;fr=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return fr}function je(e){try{var t=N[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Ke,hr,Vr,Ji,Yi=N.performance&&N.performance.now?N.performance.now.bind(N.performance):Date.now.bind(Date),_i=N.requestAnimationFrame||N.mozRequestAnimationFrame||N.webkitRequestAnimationFrame||N.msRequestAnimationFrame,Gr=N.cancelAnimationFrame||N.mozCancelAnimationFrame||N.webkitCancelAnimationFrame||N.msCancelAnimationFrame,Ni={now:Yi,frame:function(e){var t=_i(e);return{cancel:function(){return Gr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=N.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Ke||(Ke=N.document.createElement("a")),Ke.href=e,Ke.href},hardwareConcurrency:N.navigator&&N.navigator.hardwareConcurrency||4,get devicePixelRatio(){return N.devicePixelRatio},get prefersReducedMotion(){return!!N.matchMedia&&(hr==null&&(hr=N.matchMedia("(prefers-reduced-motion: reduce)")),hr.matches)}},lr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Sr={supported:!1,testSupport:function(e){!dt&&Ji&&(Jt?Gt(e):Vr=e)}},dt=!1,Jt=!1;function Gt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Ji),e.isContextLost())return;Sr.supported=!0}catch{}e.deleteTexture(t),dt=!0}N.document&&((Ji=N.document.createElement("img")).onload=function(){Vr&&Gt(Vr),Vr=null,Jt=!0},Ji.onerror=function(){dt=!0,Vr=null},Ji.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Vi="01",Kr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Hr(e){return e.indexOf("mapbox:")===0}Kr.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Vi,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Kr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Kr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Kr.prototype.normalizeStyleURL=function(e,t){if(!Hr(e))return e;var i=Ei(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeGlyphsURL=function(e,t){if(!Hr(e))return e;var i=Ei(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeSourceURL=function(e,t){if(!Hr(e))return e;var i=Ei(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeSpriteURL=function(e,t,i,l){var p=Ei(e);return Hr(e)?(p.path="/styles/v1"+p.path+"/sprite"+t+i,this._makeAPIURL(p,this._customAccessToken||l)):(p.path+=""+t+i,Ri(p))},Kr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Hr(e))return e;var i=Ei(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Ni.devicePixelRatio>=2||t===512?"@2x":"")+(Sr.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(p){for(var d=0,_=p;d<_.length;d+=1){var k=_[d].match(/^access_token=(.*)$/);if(k)return k[1]}return null}(i.params)||lr.ACCESS_TOKEN;return lr.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Kr.prototype.canonicalizeTileURL=function(e,t){var i=Ei(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var p=i.params;return t&&(p=p.filter(function(d){return!d.match(/^access_token=/)})),p.length&&(l+="?"+p.join("&")),l},Kr.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&Hr(t),l=[],p=0,d=e.tiles||[];p<d.length;p+=1){var _=d[p];Xr(_)?l.push(this.canonicalizeTileURL(_,i)):l.push(_)}return l},Kr.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=Ei(lr.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var p=e.params.indexOf("secure");p>=0&&e.params.splice(p,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!lr.REQUIRE_ACCESS_TOKEN)return Ri(e);if(!(t=t||lr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(d){return d.indexOf("access_token")===-1}),e.params.push("access_token="+t),Ri(e)};var Jr=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Xr(e){return Jr.test(e)}var Ui=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ei(e){var t=e.match(Ui);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Ri(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function sn(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(N.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var gi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};gi.prototype.getStorageKey=function(e){var t,i=sn(lr.ACCESS_TOKEN);return t=i&&i.u?N.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,p){return String.fromCharCode(Number("0x"+p))})):lr.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},gi.prototype.fetchEventData=function(){var e=je("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=N.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var p=N.localStorage.getItem(i);p&&(this.anonId=p)}catch{ot("Unable to read from LocalStorage")}},gi.prototype.saveEventData=function(){var e=je("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{N.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&N.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{ot("Unable to write to LocalStorage")}},gi.prototype.processRequests=function(e){},gi.prototype.postEvent=function(e,t,i,l){var p=this;if(lr.EVENTS_URL){var d=Ei(lr.EVENTS_URL);d.params.push("access_token="+(l||lr.ACCESS_TOKEN||""));var _={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Vi,userId:this.anonId},k=t?Ge(_,t):_,T={url:Ri(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=ar(T,function(z){p.pendingRequest=null,i(z),p.saveEventData(),p.processRequests(l)})}},gi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Ti,gn,Er=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,p,d){this.skuToken=p,(lr.EVENTS_URL&&d||lr.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(_){return Hr(_)||Xr(_)}))&&this.queueRequest({id:l,timestamp:Date.now()},d)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var p=this.queue.shift(),d=p.id,_=p.timestamp;d&&this.success[d]||(this.anonId||this.fetchEventData(),He(this.anonId)||(this.anonId=ct()),this.postEvent(_,{skuToken:this.skuToken},function(k){k||d&&(l.success[d]=!0)},i))}},t}(gi),Yr=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){lr.EVENTS_URL&&lr.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(p){return Hr(p)||Xr(p)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var p=sn(lr.ACCESS_TOKEN),d=p?p.u:lr.ACCESS_TOKEN,_=d!==this.eventData.tokenU;He(this.anonId)||(this.anonId=ct(),_=!0);var k=this.queue.shift();if(this.eventData.lastSuccess){var T=new Date(this.eventData.lastSuccess),z=new Date(k),P=(k-this.eventData.lastSuccess)/864e5;_=_||P>=1||P<-1||T.getDate()!==z.getDate()}else _=!0;if(!_)return this.processRequests();this.postEvent(k,{"enabled.telemetry":!1},function(D){D||(l.eventData.lastSuccess=k,l.eventData.tokenU=d)},i)}},t}(gi)),zo=Yr.postTurnstileEvent.bind(Yr),pi=new Er,Ii=pi.postMapLoadEvent.bind(pi),ji=500,Co=50;function vn(){N.caches&&!Ti&&(Ti=N.caches.open("mapbox-tiles"))}function ho(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Un,xn=1/0;function An(){return Un==null&&(Un=N.OffscreenCanvas&&new N.OffscreenCanvas(1,1).getContext("2d")&&typeof N.createImageBitmap=="function"),Un}var Po={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Po);var Mo=function(e){function t(i,l,p){l===401&&Xr(p)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=p,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Qi=Ue()?function(){return self.worker&&self.worker.referrer}:function(){return(N.location.protocol==="blob:"?N.parent:N).location.href},$i,ln,to=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(Qi())&&!/^\w+:/.test(i))){if(N.fetch&&N.Request&&N.AbortController&&N.Request.prototype.hasOwnProperty("signal"))return function(l,p){var d,_=new N.AbortController,k=new N.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Qi(),signal:_.signal}),T=!1,z=!1,P=(d=k.url).indexOf("sku=")>0&&Xr(d);l.type==="json"&&k.headers.set("Accept","application/json");var D=function(q,Q,ee){if(!z){if(q&&q.message!=="SecurityError"&&ot(q),Q&&ee)return O(Q);var ue=Date.now();N.fetch(k).then(function(oe){if(oe.ok){var de=P?oe.clone():null;return O(oe,de,ue)}return p(new Mo(oe.statusText,oe.status,l.url))}).catch(function(oe){oe.code!==20&&p(new Error(oe.message))})}},O=function(q,Q,ee){(l.type==="arrayBuffer"?q.arrayBuffer():l.type==="json"?q.json():q.text()).then(function(ue){z||(Q&&ee&&function(oe,de,_e){if(vn(),Ti){var ve={status:de.status,statusText:de.statusText,headers:new N.Headers};de.headers.forEach(function(Le,Ze){return ve.headers.set(Ze,Le)});var Se=_t(de.headers.get("Cache-Control")||"");Se["no-store"]||(Se["max-age"]&&ve.headers.set("Expires",new Date(_e+1e3*Se["max-age"]).toUTCString()),new Date(ve.headers.get("Expires")).getTime()-_e<42e4||function(Le,Ze){if(gn===void 0)try{new Response(new ReadableStream),gn=!0}catch{gn=!1}gn?Ze(Le.body):Le.blob().then(Ze)}(de,function(Le){var Ze=new N.Response(Le,ve);vn(),Ti&&Ti.then(function(Qe){return Qe.put(ho(oe.url),Ze)}).catch(function(Qe){return ot(Qe.message)})}))}}(k,Q,ee),T=!0,p(null,ue,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(function(ue){z||p(new Error(ue.message))})};return P?function(q,Q){if(vn(),!Ti)return Q(null);var ee=ho(q.url);Ti.then(function(ue){ue.match(ee).then(function(oe){var de=function(_e){if(!_e)return!1;var ve=new Date(_e.headers.get("Expires")||0),Se=_t(_e.headers.get("Cache-Control")||"");return ve>Date.now()&&!Se["no-cache"]}(oe);ue.delete(ee),de&&ue.put(ee,oe.clone()),Q(null,oe,de)}).catch(Q)}).catch(Q)}(k,D):D(null,null),{cancel:function(){z=!0,T||_.abort()}}}(e,t);if(Ue()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,p){var d=new N.XMLHttpRequest;for(var _ in d.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(d.responseType="arraybuffer"),l.headers)d.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=l.credentials==="include",d.onerror=function(){p(new Error(d.statusText))},d.onload=function(){if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){var k=d.response;if(l.type==="json")try{k=JSON.parse(d.response)}catch(T){return p(T)}p(null,k,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else p(new Mo(d.statusText,d.status,l.url))},d.send(l.body),{cancel:function(){return d.abort()}}}(e,t)},jn=function(e,t){return to(Ge(e,{type:"arrayBuffer"}),t)},ar=function(e,t){return to(Ge(e,{method:"POST"}),t)},M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";$i=[],ln=0;var F=function(e,t){if(Sr.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ln>=lr.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return $i.push(i),i}ln++;var l=!1,p=function(){if(!l)for(l=!0,ln--;$i.length&&ln<lr.MAX_PARALLEL_IMAGE_REQUESTS;){var _=$i.shift();_.cancelled||(_.cancel=F(_.requestParameters,_.callback).cancel)}},d=jn(e,function(_,k,T,z){p(),_?t(_):k&&(An()?function(P,D){var O=new N.Blob([new Uint8Array(P)],{type:"image/png"});N.createImageBitmap(O).then(function(q){D(null,q)}).catch(function(q){D(new Error("Could not load image because of "+q.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(k,t):function(P,D,O,q){var Q=new N.Image,ee=N.URL;Q.onload=function(){D(null,Q),ee.revokeObjectURL(Q.src),Q.onload=null,N.requestAnimationFrame(function(){Q.src=M})},Q.onerror=function(){return D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ue=new N.Blob([new Uint8Array(P)],{type:"image/png"});Q.cacheControl=O,Q.expires=q,Q.src=P.byteLength?ee.createObjectURL(ue):M}(k,t,T,z))});return{cancel:function(){d.cancel(),p()}}};function V(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function K(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var J=function(e,t){t===void 0&&(t={}),Ge(this,t),this.type=e},le=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",Ge({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(J),ce=function(){};ce.prototype.on=function(e,t){return this._listeners=this._listeners||{},V(e,t,this._listeners),this},ce.prototype.off=function(e,t){return K(e,t,this._listeners),K(e,t,this._oneTimeListeners),this},ce.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},V(e,t,this._oneTimeListeners),this},ce.prototype.fire=function(e,t){typeof e=="string"&&(e=new J(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,p=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<p.length;l+=1)p[l].call(this,e);for(var d=0,_=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];d<_.length;d+=1){var k=_[d];K(i,k,this._oneTimeListeners),k.call(this,e)}var T=this._eventedParent;T&&(Ge(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(e))}else e instanceof le&&console.error(e.error);return this},ce.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},ce.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var U={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},re=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function me(e){var t=e.value;return t?[new re(e.key,t,"constants have been deprecated as of v8")]:[]}function Re(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}function Ne(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function be(e){if(Array.isArray(e))return e.map(be);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=be(e[i]);return t}return Ne(e)}var Be=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),nt=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var p=l[i];this.bindings[p[0]]=p[1]}};nt.prototype.concat=function(e){return new nt(this,e)},nt.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},nt.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var it={kind:"null"},we={kind:"number"},$e={kind:"string"},qe={kind:"boolean"},Xe={kind:"color"},jt={kind:"object"},et={kind:"value"},Kt={kind:"collator"},dr={kind:"formatted"},Ft={kind:"resolvedImage"};function $t(e,t){return{kind:"array",itemType:e,N:t}}function er(e){if(e.kind==="array"){var t=er(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ai=[it,we,$e,qe,Xe,dr,jt,$t(et),Ft];function rr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!rr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=ai;i<l.length;i+=1)if(!rr(l[i],t))return null}}return"Expected "+er(e)+" but found "+er(t)+" instead."}function Cr(e,t){return t.some(function(i){return i.kind===e.kind})}function Xt(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var qt=A(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(k){return(k=Math.round(k))<0?0:k>255?255:k}function p(k){return l(k[k.length-1]==="%"?parseFloat(k)/100*255:parseInt(k))}function d(k){return(T=k[k.length-1]==="%"?parseFloat(k)/100:parseFloat(k))<0?0:T>1?1:T;var T}function _(k,T,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?k+(T-k)*z*6:2*z<1?T:3*z<2?k+(T-k)*(2/3-z)*6:k}try{t.parseCSSColor=function(k){var T,z=k.replace(/ /g,"").toLowerCase();if(z in i)return i[z].slice();if(z[0]==="#")return z.length===4?(T=parseInt(z.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:z.length===7&&(T=parseInt(z.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var P=z.indexOf("("),D=z.indexOf(")");if(P!==-1&&D+1===z.length){var O=z.substr(0,P),q=z.substr(P+1,D-(P+1)).split(","),Q=1;switch(O){case"rgba":if(q.length!==4)return null;Q=d(q.pop());case"rgb":return q.length!==3?null:[p(q[0]),p(q[1]),p(q[2]),Q];case"hsla":if(q.length!==4)return null;Q=d(q.pop());case"hsl":if(q.length!==3)return null;var ee=(parseFloat(q[0])%360+360)%360/360,ue=d(q[1]),oe=d(q[2]),de=oe<=.5?oe*(ue+1):oe+ue-oe*ue,_e=2*oe-de;return[l(255*_(_e,de,ee+1/3)),l(255*_(_e,de,ee)),l(255*_(_e,de,ee-1/3)),Q];default:return null}}return null}}catch{}}).parseCSSColor,ir=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};ir.parse=function(e){if(e){if(e instanceof ir)return e;if(typeof e=="string"){var t=qt(e);if(t)return new ir(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ir.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},ir.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ir.black=new ir(0,0,0,1),ir.white=new ir(1,1,1,1),ir.transparent=new ir(0,0,0,0),ir.red=new ir(1,0,0,1);var fi=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};fi.prototype.compare=function(e,t){return this.collator.compare(e,t)},fi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ro=function(e,t,i,l,p){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=p},Pr=function(e){this.sections=e};Pr.fromString=function(e){return new Pr([new ro(e,null,null,null,null)])},Pr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Pr.factory=function(e){return e instanceof Pr?e:Pr.fromString(e)},Pr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Pr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(p)}}return e};var Ur=function(e){this.name=e.name,this.available=e.available};function Zo(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function po(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ir||e instanceof fi||e instanceof Pr||e instanceof Ur)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!po(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!po(e[l]))return!1;return!0}return!1}function Mr(e){if(e===null)return it;if(typeof e=="string")return $e;if(typeof e=="boolean")return qe;if(typeof e=="number")return we;if(e instanceof ir)return Xe;if(e instanceof fi)return Kt;if(e instanceof Pr)return dr;if(e instanceof Ur)return Ft;if(Array.isArray(e)){for(var t,i=e.length,l=0,p=e;l<p.length;l+=1){var d=Mr(p[l]);if(t){if(t===d)continue;t=et;break}t=d}return $t(t||et,i)}return jt}function zn(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ir||e instanceof Pr||e instanceof Ur?e.toString():JSON.stringify(e)}Ur.prototype.toString=function(){return this.name},Ur.fromString=function(e){return e?new Ur({name:e,available:!1}):null},Ur.prototype.serialize=function(){return["image",this.name]};var di=function(e,t){this.type=e,this.value=t};di.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!po(e[1]))return t.error("invalid value");var i=e[1],l=Mr(i),p=t.expectedType;return l.kind!=="array"||l.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(l=p),new di(l,i)},di.prototype.evaluate=function(){return this.value},di.prototype.eachChild=function(){},di.prototype.outputDefined=function(){return!0},di.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ir?["rgba"].concat(this.value.toArray()):this.value instanceof Pr?this.value.serialize():this.value};var jr=function(e){this.name="ExpressionEvaluationError",this.message=e};jr.prototype.toJSON=function(){return this.message};var Ai={string:$e,number:we,boolean:qe,object:jt},yr=function(e,t){this.type=e,this.args=t};yr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,p=e[0];if(p==="array"){var d,_;if(e.length>2){var k=e[1];if(typeof k!="string"||!(k in Ai)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);d=Ai[k],l++}else d=et;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);_=e[2],l++}i=$t(d,_)}else i=Ai[p];for(var T=[];l<e.length;l++){var z=t.parse(e[l],l,et);if(!z)return null;T.push(z)}return new yr(i,T)},yr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!rr(this.type,Mr(i)))return i;if(t===this.args.length-1)throw new jr("Expected value to be of type "+er(this.type)+", but found "+er(Mr(i))+" instead.")}return null},yr.prototype.eachChild=function(e){this.args.forEach(e)},yr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},yr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(p){return p.serialize()}))};var Cn=function(e){this.type=dr,this.sections=e};Cn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],p=!1,d=1;d<=e.length-1;++d){var _=e[d];if(p&&typeof _=="object"&&!Array.isArray(_)){p=!1;var k=null;if(_["font-scale"]&&!(k=t.parse(_["font-scale"],1,we)))return null;var T=null;if(_["text-font"]&&!(T=t.parse(_["text-font"],1,$t($e))))return null;var z=null;if(_["text-color"]&&!(z=t.parse(_["text-color"],1,Xe)))return null;var P=l[l.length-1];P.scale=k,P.font=T,P.textColor=z}else{var D=t.parse(e[d],1,et);if(!D)return null;var O=D.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,l.push({content:D,scale:null,font:null,textColor:null})}}return new Cn(l)},Cn.prototype.evaluate=function(e){return new Pr(this.sections.map(function(t){var i=t.content.evaluate(e);return Mr(i)===Ft?new ro("",i,null,null,null):new ro(zn(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Cn.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},Cn.prototype.outputDefined=function(){return!1},Cn.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),e.push(p)}return e};var qi=function(e){this.type=Ft,this.input=e};qi.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,$e);return i?new qi(i):t.error("No image name provided.")},qi.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Ur.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},qi.prototype.eachChild=function(e){e(this.input)},qi.prototype.outputDefined=function(){return!1},qi.prototype.serialize=function(){return["image",this.input.serialize()]};var Go={"to-boolean":qe,"to-color":Xe,"to-number":we,"to-string":$e},Qr=function(e,t){this.type=e,this.args=t};Qr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Go[i],p=[],d=1;d<e.length;d++){var _=t.parse(e[d],d,et);if(!_)return null;p.push(_)}return new Qr(l,p)},Qr.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,i,l=0,p=this.args;l<p.length;l+=1){if(i=null,(t=p[l].evaluate(e))instanceof ir)return t;if(typeof t=="string"){var d=e.parseColor(t);if(d)return d}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Zo(t[0],t[1],t[2],t[3])))return new ir(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new jr(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var _=null,k=0,T=this.args;k<T.length;k+=1){if((_=T[k].evaluate(e))===null)return 0;var z=Number(_);if(!isNaN(z))return z}throw new jr("Could not convert "+JSON.stringify(_)+" to number.")}return this.type.kind==="formatted"?Pr.fromString(zn(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ur.fromString(zn(this.args[0].evaluate(e))):zn(this.args[0].evaluate(e))},Qr.prototype.eachChild=function(e){this.args.forEach(e)},Qr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Qr.prototype.serialize=function(){if(this.type.kind==="formatted")return new Cn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new qi(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var fo=["Unknown","Point","LineString","Polygon"],ei=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ei.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ei.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?fo[this.feature.type]:this.feature.type:null},ei.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ei.prototype.canonicalID=function(){return this.canonical},ei.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ei.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ir.parse(e)),t};var ti=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};ti.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ti.prototype.eachChild=function(e){this.args.forEach(e)},ti.prototype.outputDefined=function(){return!1},ti.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ti.parse=function(e,t){var i,l=e[0],p=ti.definitions[l];if(!p)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var d=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,k=_.filter(function(kt){var lt=kt[0];return!Array.isArray(lt)||lt.length===e.length-1}),T=null,z=0,P=k;z<P.length;z+=1){var D=P[z],O=D[0],q=D[1];T=new Tr(t.registry,t.path,null,t.scope);for(var Q=[],ee=!1,ue=1;ue<e.length;ue++){var oe=e[ue],de=Array.isArray(O)?O[ue-1]:O.type,_e=T.parse(oe,1+Q.length,de);if(!_e){ee=!0;break}Q.push(_e)}if(!ee)if(Array.isArray(O)&&O.length!==Q.length)T.error("Expected "+O.length+" arguments, but found "+Q.length+" instead.");else{for(var ve=0;ve<Q.length;ve++){var Se=Array.isArray(O)?O[ve]:O.type,Le=Q[ve];T.concat(ve+1).checkSubtype(Se,Le.type)}if(T.errors.length===0)return new ti(l,d,q,Q)}}if(k.length===1)(i=t.errors).push.apply(i,T.errors);else{for(var Ze=(k.length?k:_).map(function(kt){var lt;return lt=kt[0],Array.isArray(lt)?"("+lt.map(er).join(", ")+")":"("+er(lt.type)+"...)"}).join(" | "),Qe=[],vt=1;vt<e.length;vt++){var st=t.parse(e[vt],1+Qe.length);if(!st)return null;Qe.push(er(st.type))}t.error("Expected arguments of type "+Ze+", but found ("+Qe.join(", ")+") instead.")}return null},ti.register=function(e,t){for(var i in ti.definitions=t,t)e[i]=ti};var bn=function(e,t,i){this.type=Kt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function zi(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function io(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Pn(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(i*p*8192),Math.round(l*p*8192)]}function mo(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function en(e,t){for(var i,l,p,d,_,k,T,z=!1,P=0,D=t.length;P<D;P++)for(var O=t[P],q=0,Q=O.length;q<Q-1;q++){if((d=(i=e)[0]-(l=O[q])[0])*(T=i[1]-(p=O[q+1])[1])-(k=i[0]-p[0])*(_=i[1]-l[1])==0&&d*k<=0&&_*T<=0)return!1;mo(e,O[q],O[q+1])&&(z=!z)}return z}function Do(e,t){for(var i=0;i<t.length;i++)if(en(e,t[i]))return!0;return!1}function ba(e,t,i,l){var p=l[0]-i[0],d=l[1]-i[1],_=(e[0]-i[0])*d-p*(e[1]-i[1]),k=(t[0]-i[0])*d-p*(t[1]-i[1]);return _>0&&k<0||_<0&&k>0}function wa(e,t,i){for(var l=0,p=i;l<p.length;l+=1)for(var d=p[l],_=0;_<d.length-1;++_)if((D=[(P=d[_+1])[0]-(z=d[_])[0],P[1]-z[1]])[0]*(O=[(T=t)[0]-(k=e)[0],T[1]-k[1]])[1]-D[1]*O[0]!=0&&ba(k,T,z,P)&&ba(z,P,k,T))return!0;var k,T,z,P,D,O;return!1}function Sa(e,t){for(var i=0;i<e.length;++i)if(!en(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(wa(e[l],e[l+1],t))return!1;return!0}function rs(e,t){for(var i=0;i<t.length;i++)if(Sa(e,t[i]))return!0;return!1}function qn(e,t,i){for(var l=[],p=0;p<e.length;p++){for(var d=[],_=0;_<e[p].length;_++){var k=Pn(e[p][_],i);zi(t,k),d.push(k)}l.push(d)}return l}function Ko(e,t,i){for(var l=[],p=0;p<e.length;p++){var d=qn(e[p],t,i);l.push(d)}return l}function ca(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var p=.5*l,d=e[0]-i[0]>p?-l:i[0]-e[0]>p?l:0;d===0&&(d=e[0]-i[2]>p?-l:i[2]-e[0]>p?l:0),e[0]+=d}zi(t,e)}function is(e,t,i,l){for(var p=8192*Math.pow(2,l.z),d=[8192*l.x,8192*l.y],_=[],k=0,T=e;k<T.length;k+=1)for(var z=0,P=T[k];z<P.length;z+=1){var D=P[z],O=[D.x+d[0],D.y+d[1]];ca(O,t,i,p),_.push(O)}return _}function Mn(e,t,i,l){for(var p,d=8192*Math.pow(2,l.z),_=[8192*l.x,8192*l.y],k=[],T=0,z=e;T<z.length;T+=1){for(var P=[],D=0,O=z[T];D<O.length;D+=1){var q=O[D],Q=[q.x+_[0],q.y+_[1]];zi(t,Q),P.push(Q)}k.push(P)}if(t[2]-t[0]<=d/2){(p=t)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(var ee=0,ue=k;ee<ue.length;ee+=1)for(var oe=0,de=ue[ee];oe<de.length;oe+=1)ca(de[oe],t,i,d)}return k}bn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,qe);if(!l)return null;var p=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,qe);if(!p)return null;var d=null;return i.locale&&!(d=t.parse(i.locale,1,$e))?null:new bn(l,p,d)},bn.prototype.evaluate=function(e){return new fi(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},bn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},bn.prototype.outputDefined=function(){return!1},bn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var wn=function(e,t){this.type=qe,this.geojson=e,this.geometries=t};function Zi(e){if(e instanceof ti&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof wn)return!1;var t=!0;return e.eachChild(function(i){t&&!Zi(i)&&(t=!1)}),t}function fe(e){if(e instanceof ti&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!fe(i)&&(t=!1)}),t}function ri(e,t){if(e instanceof ti&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!ri(l,t)&&(i=!1)}),i}wn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(po(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var p=i.features[l].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new wn(i,i.features[l].geometry)}else if(i.type==="Feature"){var d=i.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new wn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new wn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},wn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=qn(i.coordinates,p,d),k=is(t.geometry(),l,p,d);if(!io(l,p))return!1;for(var T=0,z=k;T<z.length;T+=1)if(!en(z[T],_))return!1}if(i.type==="MultiPolygon"){var P=Ko(i.coordinates,p,d),D=is(t.geometry(),l,p,d);if(!io(l,p))return!1;for(var O=0,q=D;O<q.length;O+=1)if(!Do(q[O],P))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=qn(i.coordinates,p,d),k=Mn(t.geometry(),l,p,d);if(!io(l,p))return!1;for(var T=0,z=k;T<z.length;T+=1)if(!Sa(z[T],_))return!1}if(i.type==="MultiPolygon"){var P=Ko(i.coordinates,p,d),D=Mn(t.geometry(),l,p,d);if(!io(l,p))return!1;for(var O=0,q=D;O<q.length;O+=1)if(!rs(q[O],P))return!1}return!0}(e,this.geometries)}return!1},wn.prototype.eachChild=function(){},wn.prototype.outputDefined=function(){return!0},wn.prototype.serialize=function(){return["within",this.geojson]};var Ci=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Ci.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Ci(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Ci.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ci.prototype.eachChild=function(){},Ci.prototype.outputDefined=function(){return!1},Ci.prototype.serialize=function(){return["var",this.name]};var Tr=function(e,t,i,l,p){t===void 0&&(t=[]),l===void 0&&(l=new nt),p===void 0&&(p=[]),this.registry=e,this.path=t,this.key=t.map(function(d){return"["+d+"]"}).join(""),this.scope=l,this.errors=p,this.expectedType=i};function yo(e,t){for(var i,l=e.length-1,p=0,d=l,_=0;p<=d;)if((i=e[_=Math.floor((p+d)/2)])<=t){if(_===l||t<e[_+1])return _;p=_+1}else{if(!(i>t))throw new jr("Input is not a number.");d=_-1}return 0}Tr.prototype.parse=function(e,t,i,l,p){return p===void 0&&(p={}),t?this.concat(t,i,l)._parse(e,p):this._parse(e,p)},Tr.prototype._parse=function(e,t){function i(z,P,D){return D==="assert"?new yr(P,[z]):D==="coerce"?new Qr(P,[z]):z}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var p=this.registry[l];if(p){var d=p.parse(e,this);if(!d)return null;if(this.expectedType){var _=this.expectedType,k=d.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||k.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(_,k))return null}else d=i(d,_,t.typeAnnotation||"coerce");else d=i(d,_,t.typeAnnotation||"assert")}if(!(d instanceof di)&&d.type.kind!=="resolvedImage"&&function z(P){if(P instanceof Ci)return z(P.boundExpression);if(P instanceof ti&&P.name==="error"||P instanceof bn||P instanceof wn)return!1;var D=P instanceof Qr||P instanceof yr,O=!0;return P.eachChild(function(q){O=D?O&&z(q):O&&q instanceof di}),!!O&&Zi(P)&&ri(P,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(d)){var T=new ei;try{d=new di(d.type,d.evaluate(T))}catch(z){return this.error(z.message),null}}return d}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Tr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,p=i?this.scope.concat(i):this.scope;return new Tr(this.registry,l,t||null,p,this.errors)},Tr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(p){return"["+p+"]"}).join("");this.errors.push(new Be(l,e))},Tr.prototype.checkSubtype=function(e,t){var i=rr(e,t);return i&&this.error(i),i};var Sn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,p=i;l<p.length;l+=1){var d=p[l],_=d[1];this.labels.push(d[0]),this.outputs.push(_)}};function qr(e,t,i){return e*(1-i)+t*i}Sn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,we);if(!i)return null;var l=[],p=null;t.expectedType&&t.expectedType.kind!=="value"&&(p=t.expectedType);for(var d=1;d<e.length;d+=2){var _=d===1?-1/0:e[d],k=e[d+1],T=d,z=d+1;if(typeof _!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(l.length&&l[l.length-1][0]>=_)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);var P=t.parse(k,z,p);if(!P)return null;p=p||P.type,l.push([_,P])}return new Sn(p,i,l)},Sn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;return l>=t[p-1]?i[p-1].evaluate(e):i[yo(t,l)].evaluate(e)},Sn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Sn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Sn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Lo=Object.freeze({__proto__:null,number:qr,color:function(e,t,i){return new ir(qr(e.r,t.r,i),qr(e.g,t.g,i),qr(e.b,t.b,i),qr(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,p){return qr(l,t[p],i)})}}),Hs=6/29*3*(6/29),wl=Math.PI/180,ka=180/Math.PI;function As(e){return e>.008856451679035631?Math.pow(e,1/3):e/Hs+4/29}function _o(e){return e>6/29?e*e*e:Hs*(e-4/29)}function Zn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ro(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Js(e){var t=Ro(e.r),i=Ro(e.g),l=Ro(e.b),p=As((.4124564*t+.3575761*i+.1804375*l)/.95047),d=As((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*d-16,a:500*(p-d),b:200*(d-As((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function Va(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*_o(t),i=.95047*_o(i),l=1.08883*_o(l),new ir(Zn(3.2404542*i-1.5371385*t-.4985314*l),Zn(-.969266*i+1.8760108*t+.041556*l),Zn(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Sl(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var Ua={forward:Js,reverse:Va,interpolate:function(e,t,i){return{l:qr(e.l,t.l,i),a:qr(e.a,t.a,i),b:qr(e.b,t.b,i),alpha:qr(e.alpha,t.alpha,i)}}},Bo={forward:function(e){var t=Js(e),i=t.l,l=t.a,p=t.b,d=Math.atan2(p,l)*ka;return{h:d<0?d+360:d,c:Math.sqrt(l*l+p*p),l:i,alpha:e.a}},reverse:function(e){var t=e.h*wl,i=e.c;return Va({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Sl(e.h,t.h,i),c:qr(e.c,t.c,i),l:qr(e.l,t.l,i),alpha:qr(e.alpha,t.alpha,i)}}},ja=Object.freeze({__proto__:null,lab:Ua,hcl:Bo}),Bi=function(e,t,i,l,p){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var d=0,_=p;d<_.length;d+=1){var k=_[d],T=k[1];this.labels.push(k[0]),this.outputs.push(T)}};function zs(e,t,i,l){var p=l-i,d=e-i;return p===0?0:t===1?d/p:(Math.pow(t,d)-1)/(Math.pow(t,p)-1)}Bi.interpolationFactor=function(e,t,i,l){var p=0;if(e.name==="exponential")p=zs(t,e.base,i,l);else if(e.name==="linear")p=zs(t,1,i,l);else if(e.name==="cubic-bezier"){var d=e.controlPoints;p=new I(d[0],d[1],d[2],d[3]).solve(zs(t,1,i,l))}return p},Bi.parse=function(e,t){var i=e[0],l=e[1],p=e[2],d=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var _=l[1];if(typeof _!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:_}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var k=l.slice(1);if(k.length!==4||k.some(function(ue){return typeof ue!="number"||ue<0||ue>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(p=t.parse(p,2,we)))return null;var T=[],z=null;i==="interpolate-hcl"||i==="interpolate-lab"?z=Xe:t.expectedType&&t.expectedType.kind!=="value"&&(z=t.expectedType);for(var P=0;P<d.length;P+=2){var D=d[P],O=d[P+1],q=P+3,Q=P+4;if(typeof D!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(T.length&&T[T.length-1][0]>=D)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);var ee=t.parse(O,Q,z);if(!ee)return null;z=z||ee.type,T.push([D,ee])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new Bi(z,i,l,p,T):t.error("Type "+er(z)+" is not interpolatable.")},Bi.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;if(l>=t[p-1])return i[p-1].evaluate(e);var d=yo(t,l),_=Bi.interpolationFactor(this.interpolation,l,t[d],t[d+1]),k=i[d].evaluate(e),T=i[d+1].evaluate(e);return this.operator==="interpolate"?Lo[this.type.kind.toLowerCase()](k,T,_):this.operator==="interpolate-hcl"?Bo.reverse(Bo.interpolate(Bo.forward(k),Bo.forward(T),_)):Ua.reverse(Ua.interpolate(Ua.forward(k),Ua.forward(T),_))},Bi.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Bi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Bi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var Dn=function(e,t){this.type=e,this.args=t};Dn.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var p=[],d=0,_=e.slice(1);d<_.length;d+=1){var k=t.parse(_[d],1+p.length,i,void 0,{typeAnnotation:"omit"});if(!k)return null;i=i||k.type,p.push(k)}var T=l&&p.some(function(z){return rr(l,z.type)});return new Dn(T?et:i,p)},Dn.prototype.evaluate=function(e){for(var t,i=null,l=0,p=0,d=this.args;p<d.length&&(l++,(i=d[p].evaluate(e))&&i instanceof Ur&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);p+=1);return i},Dn.prototype.eachChild=function(e){this.args.forEach(e)},Dn.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Dn.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var un=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};un.prototype.evaluate=function(e){return this.result.evaluate(e)},un.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},un.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var p=e[l];if(typeof p!="string")return t.error("Expected string, but found "+typeof p+" instead.",l);if(/[^a-zA-Z0-9_]/.test(p))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var d=t.parse(e[l+1],l+1);if(!d)return null;i.push([p,d])}var _=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return _?new un(i,_):null},un.prototype.outputDefined=function(){return this.result.outputDefined()},un.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var ha=function(e,t,i){this.type=e,this.index=t,this.input=i};ha.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,we),l=t.parse(e[2],2,$t(t.expectedType||et));return i&&l?new ha(l.type.itemType,i,l):null},ha.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new jr("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new jr("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new jr("Array index must be an integer, but found "+t+" instead.");return i[t]},ha.prototype.eachChild=function(e){e(this.index),e(this.input)},ha.prototype.outputDefined=function(){return!1},ha.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ea=function(e,t){this.type=qe,this.needle=e,this.haystack=t};Ea.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,et),l=t.parse(e[2],2,et);return i&&l?Cr(i.type,[qe,$e,we,it,et])?new Ea(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+er(i.type)+" instead"):null},Ea.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!Xt(t,["boolean","string","number","null"]))throw new jr("Expected first argument to be of type boolean, string, number or null, but found "+er(Mr(t))+" instead.");if(!Xt(i,["string","array"]))throw new jr("Expected second argument to be of type array or string, but found "+er(Mr(i))+" instead.");return i.indexOf(t)>=0},Ea.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Ea.prototype.outputDefined=function(){return!0},Ea.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var pa=function(e,t,i){this.type=we,this.needle=e,this.haystack=t,this.fromIndex=i};pa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,et),l=t.parse(e[2],2,et);if(!i||!l)return null;if(!Cr(i.type,[qe,$e,we,it,et]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+er(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,we);return p?new pa(i,l,p):null}return new pa(i,l)},pa.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!Xt(t,["boolean","string","number","null"]))throw new jr("Expected first argument to be of type boolean, string, number or null, but found "+er(Mr(t))+" instead.");if(!Xt(i,["string","array"]))throw new jr("Expected second argument to be of type array or string, but found "+er(Mr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},pa.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},pa.prototype.outputDefined=function(){return!1},pa.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Xo=function(e,t,i,l,p,d){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=p,this.otherwise=d};Xo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var p={},d=[],_=2;_<e.length-1;_+=2){var k=e[_],T=e[_+1];Array.isArray(k)||(k=[k]);var z=t.concat(_);if(k.length===0)return z.error("Expected at least one branch label.");for(var P=0,D=k;P<D.length;P+=1){var O=D[P];if(typeof O!="number"&&typeof O!="string")return z.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return z.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof O=="number"&&Math.floor(O)!==O)return z.error("Numeric branch labels must be integer values.");if(i){if(z.checkSubtype(i,Mr(O)))return null}else i=Mr(O);if(p[String(O)]!==void 0)return z.error("Branch labels must be unique.");p[String(O)]=d.length}var q=t.parse(T,_,l);if(!q)return null;l=l||q.type,d.push(q)}var Q=t.parse(e[1],1,et);if(!Q)return null;var ee=t.parse(e[e.length-1],e.length-1,l);return ee?Q.type.kind!=="value"&&t.concat(1).checkSubtype(i,Q.type)?null:new Xo(i,l,Q,p,d,ee):null},Xo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Mr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Xo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Xo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Xo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},p=0,d=Object.keys(this.cases).sort();p<d.length;p+=1){var _=d[p];(D=l[this.cases[_]])===void 0?(l[this.cases[_]]=i.length,i.push([this.cases[_],[_]])):i[D][1].push(_)}for(var k=function(q){return e.inputType.kind==="number"?Number(q):q},T=0,z=i;T<z.length;T+=1){var P=z[T],D=P[0],O=P[1];t.push(O.length===1?k(O[0]):O.map(k)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var cn=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};cn.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],p=1;p<e.length-1;p+=2){var d=t.parse(e[p],p,qe);if(!d)return null;var _=t.parse(e[p+1],p+1,i);if(!_)return null;l.push([d,_]),i=i||_.type}var k=t.parse(e[e.length-1],e.length-1,i);return k?new cn(i,l,k):null},cn.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];if(l[0].evaluate(e))return p.evaluate(e)}return this.otherwise.evaluate(e)},cn.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];e(l[0]),e(p)}e(this.otherwise)},cn.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},cn.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var fa=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function Cs(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function go(e,t,i,l){return l.compare(t,i)===0}function Dr(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function p(d,_,k){this.type=qe,this.lhs=d,this.rhs=_,this.collator=k,this.hasUntypedArgument=d.type.kind==="value"||_.type.kind==="value"}return p.parse=function(d,_){if(d.length!==3&&d.length!==4)return _.error("Expected two or three arguments.");var k=d[0],T=_.parse(d[1],1,et);if(!T)return null;if(!Cs(k,T.type))return _.concat(1).error('"'+k+`" comparisons are not supported for type '`+er(T.type)+"'.");var z=_.parse(d[2],2,et);if(!z)return null;if(!Cs(k,z.type))return _.concat(2).error('"'+k+`" comparisons are not supported for type '`+er(z.type)+"'.");if(T.type.kind!==z.type.kind&&T.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot compare types '"+er(T.type)+"' and '"+er(z.type)+"'.");l&&(T.type.kind==="value"&&z.type.kind!=="value"?T=new yr(z.type,[T]):T.type.kind!=="value"&&z.type.kind==="value"&&(z=new yr(T.type,[z])));var P=null;if(d.length===4){if(T.type.kind!=="string"&&z.type.kind!=="string"&&T.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(!(P=_.parse(d[3],3,Kt)))return null}return new p(T,z,P)},p.prototype.evaluate=function(d){var _=this.lhs.evaluate(d),k=this.rhs.evaluate(d);if(l&&this.hasUntypedArgument){var T=Mr(_),z=Mr(k);if(T.kind!==z.kind||T.kind!=="string"&&T.kind!=="number")throw new jr('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+T.kind+", "+z.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var P=Mr(_),D=Mr(k);if(P.kind!=="string"||D.kind!=="string")return t(d,_,k)}return this.collator?i(d,_,k,this.collator.evaluate(d)):t(d,_,k)},p.prototype.eachChild=function(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)},p.prototype.outputDefined=function(){return!0},p.prototype.serialize=function(){var d=[e];return this.eachChild(function(_){d.push(_.serialize())}),d},p}()}fa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,et),l=t.parse(e[2],2,we);if(!i||!l)return null;if(!Cr(i.type,[$t(et),$e,et]))return t.error("Expected first argument to be of type array or string, but found "+er(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,we);return p?new fa(i.type,i,l,p):null}return new fa(i.type,i,l)},fa.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!Xt(t,["string","array"]))throw new jr("Expected first argument to be of type array or string, but found "+er(Mr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},fa.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},fa.prototype.outputDefined=function(){return!1},fa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ys=Dr("==",function(e,t,i){return t===i},go),Gn=Dr("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!go(0,t,i,l)}),hn=Dr("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),kl=Dr(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),da=Dr("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),El=Dr(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),Ta=function(e,t,i,l,p){this.type=$e,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=p};Ta.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,we);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var p=null;if(l.locale&&!(p=t.parse(l.locale,1,$e)))return null;var d=null;if(l.currency&&!(d=t.parse(l.currency,1,$e)))return null;var _=null;if(l["min-fraction-digits"]&&!(_=t.parse(l["min-fraction-digits"],1,we)))return null;var k=null;return l["max-fraction-digits"]&&!(k=t.parse(l["max-fraction-digits"],1,we))?null:new Ta(i,p,d,_,k)},Ta.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Ta.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Ta.prototype.outputDefined=function(){return!1},Ta.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ln=function(e){this.type=we,this.input=e};Ln.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+er(i.type)+" instead."):new Ln(i):null},Ln.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new jr("Expected value to be of type string or array, but found "+er(Mr(t))+" instead.")},Ln.prototype.eachChild=function(e){e(this.input)},Ln.prototype.outputDefined=function(){return!1},Ln.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ia={"==":Ys,"!=":Gn,">":kl,"<":hn,">=":El,"<=":da,array:yr,at:ha,boolean:yr,case:cn,coalesce:Dn,collator:bn,format:Cn,image:qi,in:Ea,"index-of":pa,interpolate:Bi,"interpolate-hcl":Bi,"interpolate-lab":Bi,length:Ln,let:un,literal:di,match:Xo,number:yr,"number-format":Ta,object:yr,slice:fa,step:Sn,string:yr,"to-boolean":Qr,"to-color":Qr,"to-number":Qr,"to-string":Qr,var:Ci,within:wn};function pn(e,t){var i=t[0],l=t[1],p=t[2],d=t[3];i=i.evaluate(e),l=l.evaluate(e),p=p.evaluate(e);var _=d?d.evaluate(e):1,k=Zo(i,l,p,_);if(k)throw new jr(k);return new ir(i/255*_,l/255*_,p/255*_,_)}function Tl(e,t){return e in t}function Aa(e,t){var i=t[e];return i===void 0?null:i}function vi(e){return{type:e}}function Ql(e){return{result:"success",value:e}}function za(e){return{result:"error",value:e}}function xi(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Il(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Ca(e){return!!e.expression&&e.expression.interpolated}function mr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function ge(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function bt(e){return e}function Rn(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function Fo(e,t,i,l,p){return Rn(typeof i===p?l[i]:void 0,e.default,t.default)}function ns(e,t,i){if(mr(i)!=="number")return Rn(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var p=yo(e.stops.map(function(d){return d[0]}),i);return e.stops[p][1]}function qa(e,t,i){var l=e.base!==void 0?e.base:1;if(mr(i)!=="number")return Rn(e.default,t.default);var p=e.stops.length;if(p===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[p-1][0])return e.stops[p-1][1];var d=yo(e.stops.map(function(D){return D[0]}),i),_=function(D,O,q,Q){var ee=Q-q,ue=D-q;return ee===0?0:O===1?ue/ee:(Math.pow(O,ue)-1)/(Math.pow(O,ee)-1)}(i,l,e.stops[d][0],e.stops[d+1][0]),k=e.stops[d][1],T=e.stops[d+1][1],z=Lo[t.type]||bt;if(e.colorSpace&&e.colorSpace!=="rgb"){var P=ja[e.colorSpace];z=function(D,O){return P.reverse(P.interpolate(P.forward(D),P.forward(O),_))}}return typeof k.evaluate=="function"?{evaluate:function(){for(var D=[],O=arguments.length;O--;)D[O]=arguments[O];var q=k.evaluate.apply(void 0,D),Q=T.evaluate.apply(void 0,D);if(q!==void 0&&Q!==void 0)return z(q,Q,_)}}:z(k,T,_)}function no(e,t,i){return t.type==="color"?i=ir.parse(i):t.type==="formatted"?i=Pr.fromString(i.toString()):t.type==="resolvedImage"?i=Ur.fromString(i.toString()):mr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Rn(i,e.default,t.default)}ti.register(Ia,{error:[{kind:"error"},[$e],function(e,t){throw new jr(t[0].evaluate(e))}],typeof:[$e,[et],function(e,t){return er(Mr(t[0].evaluate(e)))}],"to-rgba":[$t(we,4),[Xe],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Xe,[we,we,we],pn],rgba:[Xe,[we,we,we,we],pn],has:{type:qe,overloads:[[[$e],function(e,t){return Tl(t[0].evaluate(e),e.properties())}],[[$e,jt],function(e,t){var i=t[1];return Tl(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:et,overloads:[[[$e],function(e,t){return Aa(t[0].evaluate(e),e.properties())}],[[$e,jt],function(e,t){var i=t[1];return Aa(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[et,[$e],function(e,t){return Aa(t[0].evaluate(e),e.featureState||{})}],properties:[jt,[],function(e){return e.properties()}],"geometry-type":[$e,[],function(e){return e.geometryType()}],id:[et,[],function(e){return e.id()}],zoom:[we,[],function(e){return e.globals.zoom}],"heatmap-density":[we,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[we,[],function(e){return e.globals.lineProgress||0}],accumulated:[et,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[we,vi(we),function(e,t){for(var i=0,l=0,p=t;l<p.length;l+=1)i+=p[l].evaluate(e);return i}],"*":[we,vi(we),function(e,t){for(var i=1,l=0,p=t;l<p.length;l+=1)i*=p[l].evaluate(e);return i}],"-":{type:we,overloads:[[[we,we],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[we],function(e,t){return-t[0].evaluate(e)}]]},"/":[we,[we,we],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[we,[we,we],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[we,[],function(){return Math.LN2}],pi:[we,[],function(){return Math.PI}],e:[we,[],function(){return Math.E}],"^":[we,[we,we],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[we,[we],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[we,[we],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[we,[we],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[we,[we],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[we,[we],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[we,[we],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[we,[we],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[we,[we],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[we,[we],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[we,[we],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[we,vi(we),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[we,vi(we),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[we,[we],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[we,[we],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[we,[we],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[we,[we],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[qe,[$e,et],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[qe,[et],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[qe,[$e],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[qe,[$e,et],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<d}],"filter-id-<":[qe,[et],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[qe,[$e,et],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>d}],"filter-id->":[qe,[et],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[qe,[$e,et],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<=d}],"filter-id-<=":[qe,[et],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[qe,[$e,et],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>=d}],"filter-id->=":[qe,[et],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[qe,[et],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[qe,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[qe,[$t($e)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[qe,[$t(et)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[qe,[$e,$t(et)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[qe,[$e,$t(et)],function(e,t){var i=t[0],l=t[1];return function(p,d,_,k){for(;_<=k;){var T=_+k>>1;if(d[T]===p)return!0;d[T]>p?k=T-1:_=T+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:qe,overloads:[[[qe,qe],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[vi(qe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:qe,overloads:[[[qe,qe],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[vi(qe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[qe,[qe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[qe,[$e],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[$e,[$e],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[$e,[$e],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[$e,vi(et),function(e,t){return t.map(function(i){return zn(i.evaluate(e))}).join("")}],"resolved-locale":[$e,[Kt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var vo=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new ei,this._defaultValue=t?function(i){return i.type==="color"&&ge(i.default)?new ir(0,0,0,0):i.type==="color"?ir.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function Oo(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Ia}function kn(e,t){var i=new Tr(Ia,[],t?function(p){var d={color:Xe,string:$e,number:we,enum:$e,boolean:qe,formatted:dr,resolvedImage:Ft};return p.type==="array"?$t(d[p.value]||et,p.length):d[p.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Ql(new vo(l,t)):za(i.errors)}vo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d,this.expression.evaluate(this._evaluator)},vo.prototype.evaluate=function(e,t,i,l,p,d){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d||null;try{var _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new jr("Expected value to be one of "+Object.keys(this._enumValues).map(function(k){return JSON.stringify(k)}).join(", ")+", but found "+JSON.stringify(_)+" instead.");return _}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}};var No=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!fe(t.expression)};No.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},No.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)};var xo=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!fe(t.expression),this.interpolationType=l};function Za(e,t){if((e=kn(e,t)).result==="error")return e;var i=e.value.expression,l=Zi(i);if(!l&&!xi(t))return za([new Be("","data expressions not supported")]);var p=ri(i,["zoom"]);if(!p&&!Il(t))return za([new Be("","zoom expressions not supported")]);var d=function _(k){var T=null;if(k instanceof un)T=_(k.result);else if(k instanceof Dn)for(var z=0,P=k.args;z<P.length&&!(T=_(P[z]));z+=1);else(k instanceof Sn||k instanceof Bi)&&k.input instanceof ti&&k.input.name==="zoom"&&(T=k);return T instanceof Be||k.eachChild(function(D){var O=_(D);O instanceof Be?T=O:!T&&O?T=new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):T&&O&&T!==O&&(T=new Be("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),T}(i);return d||p?d instanceof Be?za([d]):d instanceof Bi&&!Ca(t)?za([new Be("",'"interpolate" expressions cannot be used with this property')]):Ql(d?new xo(l?"camera":"composite",e.value,d.labels,d instanceof Bi?d.interpolation:void 0):new No(l?"constant":"source",e.value)):za([new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}xo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},xo.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)},xo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?Bi.interpolationFactor(this.interpolationType,e,t,i):0};var Ga=function(e,t){this._parameters=e,this._specification=t,Re(this,function i(l,p){var d,_,k,T=p.type==="color",z=l.stops&&typeof l.stops[0][0]=="object",P=z||!(z||l.property!==void 0),D=l.type||(Ca(p)?"exponential":"interval");if(T&&((l=Re({},l)).stops&&(l.stops=l.stops.map(function(st){return[st[0],ir.parse(st[1])]})),l.default=ir.parse(l.default?l.default:p.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!ja[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(D==="exponential")d=qa;else if(D==="interval")d=ns;else if(D==="categorical"){d=Fo,_=Object.create(null);for(var O=0,q=l.stops;O<q.length;O+=1){var Q=q[O];_[Q[0]]=Q[1]}k=typeof l.stops[0][0]}else{if(D!=="identity")throw new Error('Unknown function type "'+D+'"');d=no}if(z){for(var ee={},ue=[],oe=0;oe<l.stops.length;oe++){var de=l.stops[oe],_e=de[0].zoom;ee[_e]===void 0&&(ee[_e]={zoom:_e,type:l.type,property:l.property,default:l.default,stops:[]},ue.push(_e)),ee[_e].stops.push([de[0].value,de[1]])}for(var ve=[],Se=0,Le=ue;Se<Le.length;Se+=1){var Ze=Le[Se];ve.push([ee[Ze].zoom,i(ee[Ze],p)])}var Qe={name:"linear"};return{kind:"composite",interpolationType:Qe,interpolationFactor:Bi.interpolationFactor.bind(void 0,Qe),zoomStops:ve.map(function(st){return st[0]}),evaluate:function(st,kt){var lt=st.zoom;return qa({stops:ve,base:l.base},p,lt).evaluate(lt,kt)}}}if(P){var vt=D==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:vt,interpolationFactor:Bi.interpolationFactor.bind(void 0,vt),zoomStops:l.stops.map(function(st){return st[0]}),evaluate:function(st){return d(l,p,st.zoom,_,k)}}}return{kind:"source",evaluate:function(st,kt){var lt=kt&&kt.properties?kt.properties[l.property]:void 0;return lt===void 0?Rn(l.default,p.default):d(l,p,lt,_,k)}}}(this._parameters,this._specification))};function bo(e){var t=e.key,i=e.value,l=e.valueSpec||{},p=e.objectElementValidators||{},d=e.style,_=e.styleSpec,k=[],T=mr(i);if(T!=="object")return[new re(t,i,"object expected, "+T+" found")];for(var z in i){var P=z.split(".")[0],D=l[P]||l["*"],O=void 0;if(p[P])O=p[P];else if(l[P])O=ur;else if(p["*"])O=p["*"];else{if(!l["*"]){k.push(new re(t,i[z],'unknown property "'+z+'"'));continue}O=ur}k=k.concat(O({key:(t&&t+".")+z,value:i[z],valueSpec:D,style:d,styleSpec:_,object:i,objectKey:z},i))}for(var q in l)p[q]||l[q].required&&l[q].default===void 0&&i[q]===void 0&&k.push(new re(t,i,'missing required property "'+q+'"'));return k}function Al(e){var t=e.value,i=e.valueSpec,l=e.style,p=e.styleSpec,d=e.key,_=e.arrayElementValidator||ur;if(mr(t)!=="array")return[new re(d,t,"array expected, "+mr(t)+" found")];if(i.length&&t.length!==i.length)return[new re(d,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new re(d,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var k={type:i.value,values:i.values};p.$version<7&&(k.function=i.function),mr(i.value)==="object"&&(k=i.value);for(var T=[],z=0;z<t.length;z++)T=T.concat(_({array:t,arrayIndex:z,value:t[z],valueSpec:k,style:l,styleSpec:p,key:d+"["+z+"]"}));return T}function zl(e){var t=e.key,i=e.value,l=e.valueSpec,p=mr(i);return p==="number"&&i!=i&&(p="NaN"),p!=="number"?[new re(t,i,"number expected, "+p+" found")]:"minimum"in l&&i<l.minimum?[new re(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new re(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function Cl(e){var t,i,l,p=e.valueSpec,d=Ne(e.value.type),_={},k=d!=="categorical"&&e.value.property===void 0,T=!k,z=mr(e.value.stops)==="array"&&mr(e.value.stops[0])==="array"&&mr(e.value.stops[0][0])==="object",P=bo({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(q){if(d==="identity")return[new re(q.key,q.value,'identity function may not have a "stops" property')];var Q=[],ee=q.value;return Q=Q.concat(Al({key:q.key,value:ee,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:D})),mr(ee)==="array"&&ee.length===0&&Q.push(new re(q.key,ee,"array must have at least one stop")),Q},default:function(q){return ur({key:q.key,value:q.value,valueSpec:p,style:q.style,styleSpec:q.styleSpec})}}});return d==="identity"&&k&&P.push(new re(e.key,e.value,'missing required property "property"')),d==="identity"||e.value.stops||P.push(new re(e.key,e.value,'missing required property "stops"')),d==="exponential"&&e.valueSpec.expression&&!Ca(e.valueSpec)&&P.push(new re(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(T&&!xi(e.valueSpec)?P.push(new re(e.key,e.value,"property functions not supported")):k&&!Il(e.valueSpec)&&P.push(new re(e.key,e.value,"zoom functions not supported"))),d!=="categorical"&&!z||e.value.property!==void 0||P.push(new re(e.key,e.value,'"property" property is required')),P;function D(q){var Q=[],ee=q.value,ue=q.key;if(mr(ee)!=="array")return[new re(ue,ee,"array expected, "+mr(ee)+" found")];if(ee.length!==2)return[new re(ue,ee,"array length 2 expected, length "+ee.length+" found")];if(z){if(mr(ee[0])!=="object")return[new re(ue,ee,"object expected, "+mr(ee[0])+" found")];if(ee[0].zoom===void 0)return[new re(ue,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new re(ue,ee,"object stop key must have value")];if(l&&l>Ne(ee[0].zoom))return[new re(ue,ee[0].zoom,"stop zoom values must appear in ascending order")];Ne(ee[0].zoom)!==l&&(l=Ne(ee[0].zoom),i=void 0,_={}),Q=Q.concat(bo({key:ue+"[0]",value:ee[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:zl,value:O}}))}else Q=Q.concat(O({key:ue+"[0]",value:ee[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},ee));return Oo(be(ee[1]))?Q.concat([new re(ue+"[1]",ee[1],"expressions are not allowed in function stops.")]):Q.concat(ur({key:ue+"[1]",value:ee[1],valueSpec:p,style:q.style,styleSpec:q.styleSpec}))}function O(q,Q){var ee=mr(q.value),ue=Ne(q.value),oe=q.value!==null?q.value:Q;if(t){if(ee!==t)return[new re(q.key,oe,ee+" stop domain type must match previous stop domain type "+t)]}else t=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new re(q.key,oe,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&d!=="categorical"){var de="number expected, "+ee+" found";return xi(p)&&d===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new re(q.key,oe,de)]}return d!=="categorical"||ee!=="number"||isFinite(ue)&&Math.floor(ue)===ue?d!=="categorical"&&ee==="number"&&i!==void 0&&ue<i?[new re(q.key,oe,"stop domain values must appear in ascending order")]:(i=ue,d==="categorical"&&ue in _?[new re(q.key,oe,"stop domain values must be unique")]:(_[ue]=!0,[])):[new re(q.key,oe,"integer expected, found "+ue)]}}function tn(e){var t=(e.expressionContext==="property"?Za:kn)(be(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new re(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new re(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!fe(i))return[new re(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!fe(i))return[new re(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!ri(i,["zoom","feature-state"]))return[new re(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Zi(i))return[new re(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wo(e){var t=e.key,i=e.value,l=e.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(Ne(i))===-1&&p.push(new re(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Ne(i))===-1&&p.push(new re(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),p}function Ps(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!Ps(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Ga.deserialize=function(e){return new Ga(e._parameters,e._specification)},Ga.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ma={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ms(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Ps(e)||(e=wo(e));var t=kn(e,ma);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,p){return t.value.evaluate(i,l,{},p)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var p=1;p<l.length;p++)if(i(l[p]))return!0;return!1}(e)}}function $l(e,t){return e<t?-1:e>t?1:0}function wo(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Qs(e[1],e[2],"=="):i==="!="?Ds(Qs(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Qs(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(wo))):i==="all"?["all"].concat(e.slice(1).map(wo)):i==="none"?["all"].concat(e.slice(1).map(wo).map(Ds)):i==="in"?$s(e[1],e.slice(2)):i==="!in"?Ds($s(e[1],e.slice(2))):i==="has"?Pl(e[1]):i==="!has"?Ds(Pl(e[1])):i!=="within"||e}function Qs(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function $s(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort($l)]]:["filter-in-small",e,["literal",t]]}}function Pl(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Ds(e){return["!",e]}function el(e){return Ps(be(e.value))?tn(Re({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,p=i.key;if(mr(l)!=="array")return[new re(p,l,"array expected, "+mr(l)+" found")];var d,_=i.styleSpec,k=[];if(l.length<1)return[new re(p,l,"filter array must have at least 1 element")];switch(k=k.concat(Wo({key:p+"[0]",value:l[0],valueSpec:_.filter_operator,style:i.style,styleSpec:i.styleSpec})),Ne(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Ne(l[1])==="$type"&&k.push(new re(p,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&k.push(new re(p,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(d=mr(l[1]))!=="string"&&k.push(new re(p+"[1]",l[1],"string expected, "+d+" found"));for(var T=2;T<l.length;T++)d=mr(l[T]),Ne(l[1])==="$type"?k=k.concat(Wo({key:p+"["+T+"]",value:l[T],valueSpec:_.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&k.push(new re(p+"["+T+"]",l[T],"string, number, or boolean expected, "+d+" found"));break;case"any":case"all":case"none":for(var z=1;z<l.length;z++)k=k.concat(t({key:p+"["+z+"]",value:l[z],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=mr(l[1]),l.length!==2?k.push(new re(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="string"&&k.push(new re(p+"[1]",l[1],"string expected, "+d+" found"));break;case"within":d=mr(l[1]),l.length!==2?k.push(new re(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="object"&&k.push(new re(p+"[1]",l[1],"object expected, "+d+" found"))}return k}(e)}function tl(e,t){var i=e.key,l=e.style,p=e.styleSpec,d=e.value,_=e.objectKey,k=p[t+"_"+e.layerType];if(!k)return[];var T=_.match(/^(.*)-transition$/);if(t==="paint"&&T&&k[T[1]]&&k[T[1]].transition)return ur({key:i,value:d,valueSpec:p.transition,style:l,styleSpec:p});var z,P=e.valueSpec||k[_];if(!P)return[new re(i,d,'unknown property "'+_+'"')];if(mr(d)==="string"&&xi(P)&&!P.tokens&&(z=/^{([^}]+)}$/.exec(d)))return[new re(i,d,'"'+_+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(z[1])+" }`.")];var D=[];return e.layerType==="symbol"&&(_==="text-field"&&l&&!l.glyphs&&D.push(new re(i,d,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&ge(be(d))&&Ne(d.type)==="identity"&&D.push(new re(i,d,'"text-font" does not support identity functions'))),D.concat(ur({key:e.key,value:d,valueSpec:P,style:l,styleSpec:p,expressionContext:"property",propertyType:t,propertyKey:_}))}function So(e){return tl(e,"paint")}function os(e){return tl(e,"layout")}function rl(e){var t=[],i=e.value,l=e.key,p=e.style,d=e.styleSpec;i.type||i.ref||t.push(new re(l,i,'either "type" or "ref" is required'));var _,k=Ne(i.type),T=Ne(i.ref);if(i.id)for(var z=Ne(i.id),P=0;P<e.arrayIndex;P++){var D=p.layers[P];Ne(D.id)===z&&t.push(new re(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+D.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(Q){Q in i&&t.push(new re(l,i[Q],'"'+Q+'" is prohibited for ref layers'))}),p.layers.forEach(function(Q){Ne(Q.id)===T&&(_=Q)}),_?_.ref?t.push(new re(l,i.ref,"ref cannot reference another ref layer")):k=Ne(_.type):t.push(new re(l,i.ref,'ref layer "'+T+'" not found'));else if(k!=="background")if(i.source){var O=p.sources&&p.sources[i.source],q=O&&Ne(O.type);O?q==="vector"&&k==="raster"?t.push(new re(l,i.source,'layer "'+i.id+'" requires a raster source')):q==="raster"&&k!=="raster"?t.push(new re(l,i.source,'layer "'+i.id+'" requires a vector source')):q!=="vector"||i["source-layer"]?q==="raster-dem"&&k!=="hillshade"?t.push(new re(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!i.paint||!i.paint["line-gradient"]||q==="geojson"&&O.lineMetrics||t.push(new re(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new re(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new re(l,i.source,'source "'+i.source+'" not found'))}else t.push(new re(l,i,'missing required property "source"'));return t=t.concat(bo({key:l,value:i,valueSpec:d.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ur({key:l+".type",value:i.type,valueSpec:d.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:el,layout:function(Q){return bo({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return os(Re({layerType:k},ee))}}})},paint:function(Q){return bo({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return So(Re({layerType:k},ee))}}})}}}))}function Pa(e){var t=e.value,i=e.key,l=mr(t);return l!=="string"?[new re(i,t,"string expected, "+l+" found")]:[]}var Zr={promoteId:function(e){var t=e.key,i=e.value;if(mr(i)==="string")return Pa({key:t,value:i});var l=[];for(var p in i)l.push.apply(l,Pa({key:t+"."+p,value:i[p]}));return l}};function Ls(e){var t=e.value,i=e.key,l=e.styleSpec,p=e.style;if(!t.type)return[new re(i,t,'"type" is required')];var d,_=Ne(t.type);switch(_){case"vector":case"raster":case"raster-dem":return bo({key:i,value:t,valueSpec:l["source_"+_.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Zr});case"geojson":if(d=bo({key:i,value:t,valueSpec:l.source_geojson,style:p,styleSpec:l,objectElementValidators:Zr}),t.cluster)for(var k in t.clusterProperties){var T=t.clusterProperties[k],z=T[0],P=typeof z=="string"?[z,["accumulated"],["get",k]]:z;d.push.apply(d,tn({key:i+"."+k+".map",value:T[1],expressionContext:"cluster-map"})),d.push.apply(d,tn({key:i+"."+k+".reduce",value:P,expressionContext:"cluster-reduce"}))}return d;case"video":return bo({key:i,value:t,valueSpec:l.source_video,style:p,styleSpec:l});case"image":return bo({key:i,value:t,valueSpec:l.source_image,style:p,styleSpec:l});case"canvas":return[new re(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wo({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:l})}}function Ma(e){var t=e.value,i=e.styleSpec,l=i.light,p=e.style,d=[],_=mr(t);if(t===void 0)return d;if(_!=="object")return d.concat([new re("light",t,"object expected, "+_+" found")]);for(var k in t){var T=k.match(/^(.*)-transition$/);d=d.concat(T&&l[T[1]]&&l[T[1]].transition?ur({key:k,value:t[k],valueSpec:i.transition,style:p,styleSpec:i}):l[k]?ur({key:k,value:t[k],valueSpec:l[k],style:p,styleSpec:i}):[new re(k,t[k],'unknown property "'+k+'"')])}return d}var Vo={"*":function(){return[]},array:Al,boolean:function(e){var t=e.value,i=e.key,l=mr(t);return l!=="boolean"?[new re(i,t,"boolean expected, "+l+" found")]:[]},number:zl,color:function(e){var t=e.key,i=e.value,l=mr(i);return l!=="string"?[new re(t,i,"color expected, "+l+" found")]:qt(i)===null?[new re(t,i,'color expected, "'+i+'" found')]:[]},constants:me,enum:Wo,filter:el,function:Cl,layer:rl,object:bo,source:Ls,light:Ma,string:Pa,formatted:function(e){return Pa(e).length===0?[]:tn(e)},resolvedImage:function(e){return Pa(e).length===0?[]:tn(e)}};function ur(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&ge(Ne(t))?Cl(e):i.expression&&Oo(be(t))?tn(e):i.type&&Vo[i.type]?Vo[i.type](e):bo(Re({},e,{valueSpec:i.type?l[i.type]:i}))}function Lr(e){var t=e.value,i=e.key,l=Pa(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new re(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new re(i,t,'"glyphs" url must include a "{range}" token'))),l}function Kn(e,t){t===void 0&&(t=U);var i=[];return i=i.concat(ur({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Lr,"*":function(){return[]}}})),e.constants&&(i=i.concat(me({key:"constants",value:e.constants,style:e,styleSpec:t}))),ko(i)}function ko(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function Ka(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return ko(e.apply(this,t))}}Kn.source=Ka(Ls),Kn.light=Ka(Ma),Kn.layer=Ka(rl),Kn.filter=Ka(el),Kn.paintProperty=Ka(So),Kn.layoutProperty=Ka(os);var as=Kn,eu=as.light,tu=as.paintProperty,ss=as.layoutProperty;function ls(e,t){var i=!1;if(t&&t.length)for(var l=0,p=t;l<p.length;l+=1)e.fire(new le(new Error(p[l].message))),i=!0;return i}var Ho=bi;function bi(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var p=new Int32Array(this.arrayBuffer);e=p[0],this.d=(t=p[1])+2*(i=p[2]);for(var d=0;d<this.d*this.d;d++){var _=p[3+d],k=p[3+d+1];l.push(_===k?null:p.subarray(_,k))}var T=p[3+l.length+1];this.keys=p.subarray(p[3+l.length],T),this.bboxes=p.subarray(T),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var z=0;z<this.d*this.d;z++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var P=i/t*e;this.min=-P,this.max=e+P}bi.prototype.insert=function(e,t,i,l,p){this._forEachCell(t,i,l,p,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(p)},bi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},bi.prototype._insertCell=function(e,t,i,l,p,d){this.cells[p].push(d)},bi.prototype.query=function(e,t,i,l,p){var d=this.min,_=this.max;if(e<=d&&t<=d&&_<=i&&_<=l&&!p)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(e,t,i,l,this._queryCell,k,{},p),k},bi.prototype._queryCell=function(e,t,i,l,p,d,_,k){var T=this.cells[p];if(T!==null)for(var z=this.keys,P=this.bboxes,D=0;D<T.length;D++){var O=T[D];if(_[O]===void 0){var q=4*O;(k?k(P[q+0],P[q+1],P[q+2],P[q+3]):e<=P[q+2]&&t<=P[q+3]&&i>=P[q+0]&&l>=P[q+1])?(_[O]=!0,d.push(z[O])):_[O]=!1}}},bi.prototype._forEachCell=function(e,t,i,l,p,d,_,k){for(var T=this._convertToCellCoord(e),z=this._convertToCellCoord(t),P=this._convertToCellCoord(i),D=this._convertToCellCoord(l),O=T;O<=P;O++)for(var q=z;q<=D;q++){var Q=this.d*q+O;if((!k||k(this._convertFromCellCoord(O),this._convertFromCellCoord(q),this._convertFromCellCoord(O+1),this._convertFromCellCoord(q+1)))&&p.call(this,e,t,i,l,Q,d,_,k))return}},bi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},bi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},bi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var p=new Int32Array(t+i+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var d=t,_=0;_<e.length;_++){var k=e[_];p[3+_]=d,p.set(k,d),d+=k.length}return p[3+e.length]=d,p.set(this.keys,d),p[3+e.length+1]=d+=this.keys.length,p.set(this.bboxes,d),d+=this.bboxes.length,p.buffer};var us=N.ImageData,il=N.ImageBitmap,si={};function at(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),si[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Gi in at("Object",Object),Ho.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ho.deserialize=function(e){return new Ho(e.buffer)},at("Grid",Ho),at("Color",ir),at("Error",Error),at("ResolvedImage",Ur),at("StylePropertyFunction",Ga),at("StyleExpression",vo,{omit:["_evaluator"]}),at("ZoomDependentExpression",xo),at("ZoomConstantExpression",No),at("CompoundExpression",ti,{omit:["_evaluate"]}),Ia)Ia[Gi]._classRegistryKey||at("Expression_"+Gi,Ia[Gi]);function Rs(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Da(e){return il&&e instanceof il}function Eo(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Rs(e)||Da(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof us)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],p=0,d=e;p<d.length;p+=1)l.push(Eo(d[p],t));return l}if(typeof e=="object"){var _=e.constructor,k=_._classRegistryKey;if(!k)throw new Error("can't serialize object of unregistered class");var T=_.serialize?_.serialize(e,t):{};if(!_.serialize){for(var z in e)if(e.hasOwnProperty(z)&&!(si[k].omit.indexOf(z)>=0)){var P=e[z];T[z]=si[k].shallow.indexOf(z)>=0?P:Eo(P,t)}e instanceof Error&&(T.message=e.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return k!=="Object"&&(T.$name=k),T}throw new Error("can't serialize object of type "+typeof e)}function Bn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Rs(e)||Da(e)||ArrayBuffer.isView(e)||e instanceof us)return e;if(Array.isArray(e))return e.map(Bn);if(typeof e=="object"){var t=e.$name||"Object",i=si[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),p=0,d=Object.keys(e);p<d.length;p+=1){var _=d[p];if(_!=="$name"){var k=e[_];l[_]=si[t].shallow.indexOf(_)>=0?k:Bn(k)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var nl=function(){this.first=!0};nl.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var Ye={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function ol(e){for(var t=0,i=e;t<i.length;t+=1)if(cs(i[t].charCodeAt(0)))return!0;return!1}function cs(e){return!(e!==746&&e!==747&&(e<4352||!(Ye["Bopomofo Extended"](e)||Ye.Bopomofo(e)||Ye["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Ye["CJK Compatibility Ideographs"](e)||Ye["CJK Compatibility"](e)||Ye["CJK Radicals Supplement"](e)||Ye["CJK Strokes"](e)||!(!Ye["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Ye["CJK Unified Ideographs Extension A"](e)||Ye["CJK Unified Ideographs"](e)||Ye["Enclosed CJK Letters and Months"](e)||Ye["Hangul Compatibility Jamo"](e)||Ye["Hangul Jamo Extended-A"](e)||Ye["Hangul Jamo Extended-B"](e)||Ye["Hangul Jamo"](e)||Ye["Hangul Syllables"](e)||Ye.Hiragana(e)||Ye["Ideographic Description Characters"](e)||Ye.Kanbun(e)||Ye["Kangxi Radicals"](e)||Ye["Katakana Phonetic Extensions"](e)||Ye.Katakana(e)&&e!==12540||!(!Ye["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Ye["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Ye["Unified Canadian Aboriginal Syllabics"](e)||Ye["Unified Canadian Aboriginal Syllabics Extended"](e)||Ye["Vertical Forms"](e)||Ye["Yijing Hexagram Symbols"](e)||Ye["Yi Syllables"](e)||Ye["Yi Radicals"](e))))}function al(e){return!(cs(e)||function(t){return!!(Ye["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ye["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ye["Letterlike Symbols"](t)||Ye["Number Forms"](t)||Ye["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ye["Control Pictures"](t)&&t!==9251||Ye["Optical Character Recognition"](t)||Ye["Enclosed Alphanumerics"](t)||Ye["Geometric Shapes"](t)||Ye["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ye["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ye["CJK Symbols and Punctuation"](t)||Ye.Katakana(t)||Ye["Private Use Area"](t)||Ye["CJK Compatibility Forms"](t)||Ye["Small Form Variants"](t)||Ye["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function oo(e){return e>=1424&&e<=2303||Ye["Arabic Presentation Forms-A"](e)||Ye["Arabic Presentation Forms-B"](e)}function Fn(e,t){return!(!t&&oo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Ye.Khmer(e))}function ya(e){for(var t=0,i=e;t<i.length;t+=1)if(oo(i[t].charCodeAt(0)))return!0;return!1}var Bs=null,En="unavailable",Jo=null,Ml=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(En="error"),Bs&&Bs(e)};function hs(){ju.fire(new J("pluginStateChange",{pluginStatus:En,pluginURL:Jo}))}var ju=new ce,qu=function(){return En},_a=function(){if(En!=="deferred"||!Jo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");En="loading",hs(),Jo&&jn({url:Jo},function(e){e?Ml(e):(En="loaded",hs())})},Uo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return En==="loaded"||Uo.applyArabicShaping!=null},isLoading:function(){return En==="loading"},setState:function(e){En=e.pluginStatus,Jo=e.pluginURL},isParsed:function(){return Uo.applyArabicShaping!=null&&Uo.processBidirectionalText!=null&&Uo.processStyledBidirectionalText!=null},getPluginURL:function(){return Jo}},cr=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new nl,this.transition={})};cr.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,p=t;l<p.length;l+=1)if(!Fn(p[l].charCodeAt(0),i))return!1;return!0}(e,Uo.isLoaded())},cr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},cr.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var La=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(ge(i))return new Ga(i,l);if(Oo(i)){var p=Za(i,l);if(p.result==="error")throw new Error(p.value.map(function(_){return _.key+": "+_.message}).join(", "));return p.value}var d=i;return typeof i=="string"&&l.type==="color"&&(d=ir.parse(i)),{kind:"constant",evaluate:function(){return d}}}(t===void 0?e.specification.default:t,e.specification)};La.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},La.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var Yo=function(e){this.property=e,this.value=new La(e,void 0)};Yo.prototype.transitioned=function(e,t){return new Fs(this.property,this.value,t,Ge({},e.transition,this.transition),e.now)},Yo.prototype.untransitioned=function(){return new Fs(this.property,this.value,null,{},0)};var Tn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Tn.prototype.getValue=function(e){return Fe(this._values[e].value.value)},Tn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Yo(this._values[e].property)),this._values[e].value=new La(this._values[e].property,t===null?void 0:Fe(t))},Tn.prototype.getTransition=function(e){return Fe(this._values[e].transition)},Tn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Yo(this._values[e].property)),this._values[e].transition=Fe(t)||void 0},Tn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p);var d=this.getTransition(l);d!==void 0&&(e[l+"-transition"]=d)}return e},Tn.prototype.transitioned=function(e,t){for(var i=new ps(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var d=p[l];i._values[d]=this._values[d].transitioned(e,t._values[d])}return i},Tn.prototype.untransitioned=function(){for(var e=new ps(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var Fs=function(e,t,i,l,p){this.property=e,this.value=t,this.begin=p+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};Fs.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,p=this.value.possiblyEvaluate(e,t,i),d=this.prior;if(d){if(l>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(l<this.begin)return d.possiblyEvaluate(e,t,i);var _=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(e,t,i),p,function(k){if(k<=0)return 0;if(k>=1)return 1;var T=k*k,z=T*k;return 4*(k<.5?z:3*(k-T)+z-.75)}(_))}return p};var ps=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};ps.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Dl(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l},ps.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ga=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ga.prototype.getValue=function(e){return Fe(this._values[e].value)},ga.prototype.setValue=function(e,t){this._values[e]=new La(this._values[e].property,t===null?void 0:Fe(t))},ga.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p)}return e},ga.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Dl(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l};var Xn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};Xn.prototype.isConstant=function(){return this.value.kind==="constant"},Xn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Xn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var Dl=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Dl.prototype.get=function(e){return this._values[e]};var wt=function(e){this.specification=e};wt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},wt.prototype.interpolate=function(e,t,i){var l=Lo[this.specification.type];return l?l(e,t,i):e};var mt=function(e,t){this.specification=e,this.overrides=t};mt.prototype.possiblyEvaluate=function(e,t,i,l){return new Xn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},mt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Xn(this,{kind:"constant",value:void 0},e.parameters);var l=Lo[this.specification.type];return l?new Xn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},mt.prototype.evaluate=function(e,t,i,l,p,d){return e.kind==="constant"?e.value:e.evaluate(t,i,l,p,d)};var ru=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,p,d){if(i.value===void 0)return new Xn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var _=i.expression.evaluate(l,null,{},p,d),k=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,T=this._calculate(k,k,k,l);return new Xn(this,{kind:"constant",value:T},l)}if(i.expression.kind==="camera"){var z=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new Xn(this,{kind:"constant",value:z},l)}return new Xn(this,i.expression,l)},t.prototype.evaluate=function(i,l,p,d,_,k){if(i.kind==="source"){var T=i.evaluate(l,p,d,_,k);return this._calculate(T,T,T,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,d),i.evaluate({zoom:Math.floor(l.zoom)},p,d),i.evaluate({zoom:Math.floor(l.zoom)+1},p,d),l):i.value},t.prototype._calculate=function(i,l,p,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}},t.prototype.interpolate=function(i){return i},t}(mt),Wn=function(e){this.specification=e};Wn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var p=e.expression.evaluate(t,null,{},i,l);return this._calculate(p,p,p,t)}return this._calculate(e.expression.evaluate(new cr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new cr(Math.floor(t.zoom),t)),e.expression.evaluate(new cr(Math.floor(t.zoom+1),t)),t)}},Wn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},Wn.prototype.interpolate=function(e){return e};var va=function(e){this.specification=e};va.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},va.prototype.interpolate=function(){return!1};var In=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new La(i,void 0),p=this.defaultTransitionablePropertyValues[t]=new Yo(i);this.defaultTransitioningPropertyValues[t]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};at("DataDrivenProperty",mt),at("DataConstantProperty",wt),at("CrossFadedDataDrivenProperty",ru),at("CrossFadedProperty",Wn),at("ColorRampProperty",va);var Ra=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ga(l.layout)),l.paint)){for(var p in this._transitionablePaint=new Tn(l.paint),i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(var d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Dl(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,p){p===void 0&&(p={}),l!=null&&this._validate(ss,"layers."+this.id+".layout."+i,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Ht(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,p){if(p===void 0&&(p={}),l!=null&&this._validate(tu,"layers."+this.id+".paint."+i,i,l,p))return!1;if(Ht(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var d=this._transitionablePaint._values[i],_=d.property.specification["property-type"]==="cross-faded-data-driven",k=d.value.isDataDriven(),T=d.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var z=this._transitionablePaint._values[i].value;return z.isDataDriven()||k||_||this._handleOverridablePaintPropertyUpdate(i,T,z)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),gt(i,function(l,p){return!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,p,d,_){return _===void 0&&(_={}),(!_||_.validate!==!1)&&ls(this,i.call(as,{key:l,layerType:this.type,objectKey:p,value:d,styleSpec:U,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof Xn&&xi(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(ce),Zu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},iu=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Rr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function fn(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(p){var d=Zu[p.type].BYTES_PER_ELEMENT,_=i=Vc(i,Math.max(t,d)),k=p.components||1;return l=Math.max(l,d),i+=d*k,{name:p.name,type:p.type,components:k,offset:_}}),size:Vc(i,Math.max(l,t)),alignment:t}}function Vc(e,t){return Math.ceil(e/t)*t}Rr.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Rr.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Rr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Rr.prototype.clear=function(){this.length=0},Rr.prototype.resize=function(e){this.reserve(e),this.length=e},Rr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Rr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Os=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.int16[d+0]=l,this.int16[d+1]=p,i},t}(Rr);Os.prototype.bytesPerElement=4,at("StructArrayLayout2i4",Os);var Gu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var k=4*i;return this.int16[k+0]=l,this.int16[k+1]=p,this.int16[k+2]=d,this.int16[k+3]=_,i},t}(Rr);Gu.prototype.bytesPerElement=8,at("StructArrayLayout4i8",Gu);var Xa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,k)},t.prototype.emplace=function(i,l,p,d,_,k,T){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=k,this.int16[z+5]=T,i},t}(Rr);Xa.prototype.bytesPerElement=12,at("StructArrayLayout2i4i12",Xa);var To=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,k)},t.prototype.emplace=function(i,l,p,d,_,k,T){var z=4*i,P=8*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.uint8[P+4]=d,this.uint8[P+5]=_,this.uint8[P+6]=k,this.uint8[P+7]=T,i},t}(Rr);To.prototype.bytesPerElement=8,at("StructArrayLayout2i4ub8",To);var sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.float32[d+0]=l,this.float32[d+1]=p,i},t}(Rr);sl.prototype.bytesPerElement=8,at("StructArrayLayout2f8",sl);var Ba=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,T,z,P,D){var O=this.length;return this.resize(O+1),this.emplace(O,i,l,p,d,_,k,T,z,P,D)},t.prototype.emplace=function(i,l,p,d,_,k,T,z,P,D,O){var q=10*i;return this.uint16[q+0]=l,this.uint16[q+1]=p,this.uint16[q+2]=d,this.uint16[q+3]=_,this.uint16[q+4]=k,this.uint16[q+5]=T,this.uint16[q+6]=z,this.uint16[q+7]=P,this.uint16[q+8]=D,this.uint16[q+9]=O,i},t}(Rr);Ba.prototype.bytesPerElement=20,at("StructArrayLayout10ui20",Ba);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,T,z,P,D,O,q){var Q=this.length;return this.resize(Q+1),this.emplace(Q,i,l,p,d,_,k,T,z,P,D,O,q)},t.prototype.emplace=function(i,l,p,d,_,k,T,z,P,D,O,q,Q){var ee=12*i;return this.int16[ee+0]=l,this.int16[ee+1]=p,this.int16[ee+2]=d,this.int16[ee+3]=_,this.uint16[ee+4]=k,this.uint16[ee+5]=T,this.uint16[ee+6]=z,this.uint16[ee+7]=P,this.int16[ee+8]=D,this.int16[ee+9]=O,this.int16[ee+10]=q,this.int16[ee+11]=Q,i},t}(Rr);nu.prototype.bytesPerElement=24,at("StructArrayLayout4i4ui4i24",nu);var ll=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.float32[_+0]=l,this.float32[_+1]=p,this.float32[_+2]=d,i},t}(Rr);ll.prototype.bytesPerElement=12,at("StructArrayLayout3f12",ll);var Ll=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Rr);Ll.prototype.bytesPerElement=4,at("StructArrayLayout1ul4",Ll);var Ku=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,T,z,P){var D=this.length;return this.resize(D+1),this.emplace(D,i,l,p,d,_,k,T,z,P)},t.prototype.emplace=function(i,l,p,d,_,k,T,z,P,D){var O=10*i,q=5*i;return this.int16[O+0]=l,this.int16[O+1]=p,this.int16[O+2]=d,this.int16[O+3]=_,this.int16[O+4]=k,this.int16[O+5]=T,this.uint32[q+3]=z,this.uint16[O+8]=P,this.uint16[O+9]=D,i},t}(Rr);Ku.prototype.bytesPerElement=20,at("StructArrayLayout6i1ul2ui20",Ku);var ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,k)},t.prototype.emplace=function(i,l,p,d,_,k,T){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=k,this.int16[z+5]=T,i},t}(Rr);ul.prototype.bytesPerElement=12,at("StructArrayLayout2i2i2i12",ul);var Ns=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_){var k=this.length;return this.resize(k+1),this.emplace(k,i,l,p,d,_)},t.prototype.emplace=function(i,l,p,d,_,k){var T=4*i,z=8*i;return this.float32[T+0]=l,this.float32[T+1]=p,this.float32[T+2]=d,this.int16[z+6]=_,this.int16[z+7]=k,i},t}(Rr);Ns.prototype.bytesPerElement=16,at("StructArrayLayout2f1f2i16",Ns);var Xu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var k=12*i,T=3*i;return this.uint8[k+0]=l,this.uint8[k+1]=p,this.float32[T+1]=d,this.float32[T+2]=_,i},t}(Rr);Xu.prototype.bytesPerElement=12,at("StructArrayLayout2ub2f12",Xu);var fs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.uint16[_+0]=l,this.uint16[_+1]=p,this.uint16[_+2]=d,i},t}(Rr);fs.prototype.bytesPerElement=6,at("StructArrayLayout3ui6",fs);var ds=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,T,z,P,D,O,q,Q,ee,ue,oe,de){var _e=this.length;return this.resize(_e+1),this.emplace(_e,i,l,p,d,_,k,T,z,P,D,O,q,Q,ee,ue,oe,de)},t.prototype.emplace=function(i,l,p,d,_,k,T,z,P,D,O,q,Q,ee,ue,oe,de,_e){var ve=24*i,Se=12*i,Le=48*i;return this.int16[ve+0]=l,this.int16[ve+1]=p,this.uint16[ve+2]=d,this.uint16[ve+3]=_,this.uint32[Se+2]=k,this.uint32[Se+3]=T,this.uint32[Se+4]=z,this.uint16[ve+10]=P,this.uint16[ve+11]=D,this.uint16[ve+12]=O,this.float32[Se+7]=q,this.float32[Se+8]=Q,this.uint8[Le+36]=ee,this.uint8[Le+37]=ue,this.uint8[Le+38]=oe,this.uint32[Se+10]=de,this.int16[ve+22]=_e,i},t}(Rr);ds.prototype.bytesPerElement=48,at("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ds);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,T,z,P,D,O,q,Q,ee,ue,oe,de,_e,ve,Se,Le,Ze,Qe,vt,st,kt,lt,or){var Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,i,l,p,d,_,k,T,z,P,D,O,q,Q,ee,ue,oe,de,_e,ve,Se,Le,Ze,Qe,vt,st,kt,lt,or)},t.prototype.emplace=function(i,l,p,d,_,k,T,z,P,D,O,q,Q,ee,ue,oe,de,_e,ve,Se,Le,Ze,Qe,vt,st,kt,lt,or,Bt){var yt=34*i,sr=17*i;return this.int16[yt+0]=l,this.int16[yt+1]=p,this.int16[yt+2]=d,this.int16[yt+3]=_,this.int16[yt+4]=k,this.int16[yt+5]=T,this.int16[yt+6]=z,this.int16[yt+7]=P,this.uint16[yt+8]=D,this.uint16[yt+9]=O,this.uint16[yt+10]=q,this.uint16[yt+11]=Q,this.uint16[yt+12]=ee,this.uint16[yt+13]=ue,this.uint16[yt+14]=oe,this.uint16[yt+15]=de,this.uint16[yt+16]=_e,this.uint16[yt+17]=ve,this.uint16[yt+18]=Se,this.uint16[yt+19]=Le,this.uint16[yt+20]=Ze,this.uint16[yt+21]=Qe,this.uint16[yt+22]=vt,this.uint32[sr+12]=st,this.float32[sr+13]=kt,this.float32[sr+14]=lt,this.float32[sr+15]=or,this.float32[sr+16]=Bt,i},t}(Rr);ou.prototype.bytesPerElement=68,at("StructArrayLayout8i15ui1ul4f68",ou);var ms=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Rr);ms.prototype.bytesPerElement=4,at("StructArrayLayout1f4",ms);var Qo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.int16[_+0]=l,this.int16[_+1]=p,this.int16[_+2]=d,i},t}(Rr);Qo.prototype.bytesPerElement=6,at("StructArrayLayout3i6",Qo);var Wu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=4*i;return this.uint32[2*i+0]=l,this.uint16[_+2]=p,this.uint16[_+3]=d,i},t}(Rr);Wu.prototype.bytesPerElement=8,at("StructArrayLayout1ul2ui8",Wu);var Rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.uint16[d+0]=l,this.uint16[d+1]=p,i},t}(Rr);Rl.prototype.bytesPerElement=4,at("StructArrayLayout2ui4",Rl);var Hu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Rr);Hu.prototype.bytesPerElement=2,at("StructArrayLayout1ui2",Hu);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var k=4*i;return this.float32[k+0]=l,this.float32[k+1]=p,this.float32[k+2]=d,this.float32[k+3]=_,i},t}(Rr);au.prototype.bytesPerElement=16,at("StructArrayLayout4f16",au);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new L(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(iu);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(Ku);at("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(iu);o.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(ds);at("PlacedSymbolArray",u);var m=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(iu);m.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new m(this,i)},t}(ou);at("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(ms);at("GlyphOffsetArray",S);var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(Qo);at("SymbolLineVertexArray",E);var C=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(iu);C.prototype.size=8;var R=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new C(this,i)},t}(Wu);at("FeatureIndexArray",R);var Z=fn([{name:"a_pos",components:2,type:"Int16"}],4).members,G=function(e){e===void 0&&(e=[]),this.segments=e};function W(e,t){return 256*(e=Ie(Math.floor(e),0,255))+Ie(Math.floor(t),0,255)}G.prototype.prepareSegment=function(e,t,i,l){var p=this.segments[this.segments.length-1];return e>G.MAX_VERTEX_ARRAY_LENGTH&&ot("Max vertices per segment is "+G.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!p||p.vertexLength+e>G.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==l)&&(p={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(p.sortKey=l),this.segments.push(p)),p},G.prototype.get=function(){return this.segments},G.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},G.simpleSegment=function(e,t,i,l){return new G([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},G.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,at("SegmentVector",G);var ie=fn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),te=A(function(e){e.exports=function(t,i){var l,p,d,_,k,T,z,P;for(p=t.length-(l=3&t.length),d=i,k=3432918353,T=461845907,P=0;P<p;)z=255&t.charCodeAt(P)|(255&t.charCodeAt(++P))<<8|(255&t.charCodeAt(++P))<<16|(255&t.charCodeAt(++P))<<24,++P,d=27492+(65535&(_=5*(65535&(d=(d^=z=(65535&(z=(z=(65535&z)*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*T+(((z>>>16)*T&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(z=0,l){case 3:z^=(255&t.charCodeAt(P+2))<<16;case 2:z^=(255&t.charCodeAt(P+1))<<8;case 1:d^=z=(65535&(z=(z=(65535&(z^=255&t.charCodeAt(P)))*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*T+(((z>>>16)*T&65535)<<16)&4294967295}return d^=t.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}),se=A(function(e){e.exports=function(t,i){for(var l,p=t.length,d=i^p,_=0;p>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(_)|(255&t.charCodeAt(++_))<<8|(255&t.charCodeAt(++_))<<16|(255&t.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++_;switch(p){case 3:d^=(255&t.charCodeAt(_+2))<<16;case 2:d^=(255&t.charCodeAt(_+1))<<8;case 1:d=1540483477*(65535&(d^=255&t.charCodeAt(_)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0}}),Y=te,ae=se;Y.murmur3=te,Y.murmur2=ae;var he=function(){this.ids=[],this.positions=[],this.indexed=!1};he.prototype.add=function(e,t,i,l){this.ids.push(Ae(e)),this.positions.push(t,i,l)},he.prototype.getPositions=function(e){for(var t=Ae(e),i=0,l=this.ids.length-1;i<l;){var p=i+l>>1;this.ids[p]>=t?l=p:i=p+1}for(var d=[];this.ids[i]===t;)d.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return d},he.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function p(d,_,k,T){for(;k<T;){for(var z=d[k+T>>1],P=k-1,D=T+1;;){do P++;while(d[P]<z);do D--;while(d[D]>z);if(P>=D)break;xe(d,P,D),xe(_,3*P,3*D),xe(_,3*P+1,3*D+1),xe(_,3*P+2,3*D+2)}D-k<T-D?(p(d,_,k,D),k=D+1):(p(d,_,D+1,T),T=D)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},he.deserialize=function(e){var t=new he;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ye=Math.pow(2,53)-1;function Ae(e){var t=+e;return!isNaN(t)&&t<=ye?t:Y(String(e))}function xe(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}at("FeaturePositionMap",he);var ze=function(e,t){this.gl=e.gl,this.location=t},Oe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(ze),Je=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(ze),We=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(ze),ut=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(ze),St=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(ze),Ct=function(e){function t(i,l){e.call(this,i,l),this.current=ir.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(ze),It=new Float32Array(16),vr=function(e){function t(i,l){e.call(this,i,l),this.current=It}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(ze);function ht(e){return[W(255*e.r,255*e.g),W(255*e.b,255*e.a)]}var Zt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Zt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Zt.prototype.getBinding=function(e,t,i){return this.type==="color"?new Ct(e,t):new Je(e,t)};var nr=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};nr.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},nr.prototype.setUniform=function(e,t,i,l){var p=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)},nr.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new St(e,t):new Je(e,t)};var Ut=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(p){return{name:"a_"+p,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Ut.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.paintVertexArray.length,_=this.expression.evaluate(new cr(0),t,{},l,[],p);this.paintVertexArray.resize(e),this._setPaintValue(d,e,_)},Ut.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,p)},Ut.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=ht(i),p=e;p<t;p++)this.paintVertexArray.emplace(p,l[0],l[1]);else{for(var d=e;d<t;d++)this.paintVertexArray.emplace(d,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Ut.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ut.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Nt=function(e,t,i,l,p,d){this.expression=e,this.uniformNames=t.map(function(_){return"u_"+_+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=t.map(function(_){return{name:"a_"+_,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new d};Nt.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.expression.evaluate(new cr(this.zoom),t,{},l,[],p),_=this.expression.evaluate(new cr(this.zoom+1),t,{},l,[],p),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,d,_)},Nt.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:this.zoom},i,l),d=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,p,d)},Nt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var p=ht(i),d=ht(l),_=e;_<t;_++)this.paintVertexArray.emplace(_,p[0],p[1],d[0],d[1]);else{for(var k=e;k<t;k++)this.paintVertexArray.emplace(k,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Nt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Nt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Nt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=Ie(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Nt.prototype.getBinding=function(e,t,i){return new Je(e,t)};var tr=function(e,t,i,l,p,d){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=d,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p};tr.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},tr.prototype.updatePaintArray=function(e,t,i,l,p){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],p)},tr.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var p=l[i.min],d=l[i.mid],_=l[i.max];if(p&&d&&_)for(var k=e;k<t;k++)this.zoomInPaintVertexArray.emplace(k,d.tl[0],d.tl[1],d.br[0],d.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],d.pixelRatio,p.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,d.tl[0],d.tl[1],d.br[0],d.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],d.pixelRatio,_.pixelRatio)}},tr.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ie.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ie.members,this.expression.isStateDependent))},tr.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ot=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var p in e.paint._values)if(i(p)){var d=e.paint.get(p);if(d instanceof Xn&&xi(d.property.specification)){var _=rn(p,e.type),k=d.value,T=d.property.specification.type,z=d.property.useIntegerZoom,P=d.property.specification["property-type"],D=P==="cross-faded"||P==="cross-faded-data-driven";if(k.kind==="constant")this.binders[p]=D?new nr(k.value,_):new Zt(k.value,_,T),l.push("/u_"+p);else if(k.kind==="source"||D){var O=wi(p,T,"source");this.binders[p]=D?new tr(k,T,z,t,O,e.id):new Ut(k,_,T,O),l.push("/a_"+p)}else{var q=wi(p,T,"composite");this.binders[p]=new Nt(k,_,T,z,t,q),l.push("/z_"+p)}}}this.cacheKey=l.sort().join("")};Ot.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ut||t instanceof Nt?t.maxValue:0},Ot.prototype.populatePaintArrays=function(e,t,i,l,p){for(var d in this.binders){var _=this.binders[d];(_ instanceof Ut||_ instanceof Nt||_ instanceof tr)&&_.populatePaintArray(e,t,i,l,p)}},Ot.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof nr&&l.setConstantPatternPositions(e,t)}},Ot.prototype.updatePaintArrays=function(e,t,i,l,p){var d=!1;for(var _ in e)for(var k=0,T=t.getPositions(_);k<T.length;k+=1){var z=T[k],P=i.feature(z.index);for(var D in this.binders){var O=this.binders[D];if((O instanceof Ut||O instanceof Nt||O instanceof tr)&&O.expression.isStateDependent===!0){var q=l.paint.get(D);O.expression=q.value,O.updatePaintArray(z.start,z.end,P,e[_],p),d=!0}}}return d},Ot.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Zt||i instanceof nr)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Ot.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ut||i instanceof Nt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof tr)for(var p=0;p<ie.members.length;p++)e.push(ie.members[p].name)}return e},Ot.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Zt||i instanceof nr||i instanceof Nt)for(var l=0,p=i.uniformNames;l<p.length;l+=1)e.push(p[l])}return e},Ot.prototype.getPaintVertexBuffers=function(){return this._buffers},Ot.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var p=this.binders[l];if(p instanceof Zt||p instanceof nr||p instanceof Nt)for(var d=0,_=p.uniformNames;d<_.length;d+=1){var k=_[d];if(t[k]){var T=p.getBinding(e,t[k],k);i.push({name:k,property:l,binding:T})}}}return i},Ot.prototype.setUniforms=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1){var _=d[p],k=_.name,T=_.property;this.binders[T].setUniform(_.binding,l,i.get(T),k)}},Ot.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof tr){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Ut||i instanceof Nt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Ot.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Ut||i instanceof Nt||i instanceof tr)&&i.upload(e)}this.updatePaintBuffers()},Ot.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ut||t instanceof Nt||t instanceof tr)&&t.destroy()}};var Lt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,p=e;l<p.length;l+=1){var d=p[l];this.programConfigurations[d.id]=new Ot(d,t,i)}this.needsUpload=!1,this._featureMap=new he,this._bufferOffset=0};function rn(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function wi(e,t,i){var l={color:{source:sl,composite:au},number:{source:ms,composite:sl}},p=function(d){return{"line-pattern":{source:Ba,composite:Ba},"fill-pattern":{source:Ba,composite:Ba},"fill-extrusion-pattern":{source:Ba,composite:Ba}}[d]}(e);return p&&p[i]||l[t][i]}Lt.prototype.populatePaintArrays=function(e,t,i,l,p,d){for(var _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,t,l,p,d);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Lt.prototype.updatePaintArrays=function(e,t,i,l){for(var p=0,d=i;p<d.length;p+=1){var _=d[p];this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,t,_,l)||this.needsUpload}},Lt.prototype.get=function(e){return this.programConfigurations[e]},Lt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Lt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},at("ConstantBinder",Zt),at("CrossFadedConstantBinder",nr),at("SourceExpressionBinder",Ut),at("CrossFadedCompositeBinder",tr),at("CompositeExpressionBinder",Nt),at("ProgramConfiguration",Ot,{omit:["_buffers"]}),at("ProgramConfigurationSet",Lt);var On=Math.pow(2,14)-1,dn=-On-1;function mi(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var p=i[l],d=0;d<p.length;d++){var _=p[d],k=Math.round(_.x*t),T=Math.round(_.y*t);_.x=Ie(k,dn,On),_.y=Ie(T,dn,On),(k<_.x||k>_.x+1||T<_.y||T>_.y+1)&&ot("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function Pi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?mi(e):[]}}function Io(e,t,i,l,p){e.emplaceBack(2*t+(l+1)/2,2*i+(p+1)/2)}var Hn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Os,this.indexArray=new fs,this.segments=new G,this.programConfigurations=new Lt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function ys(e,t){for(var i=0;i<e.length;i++)if(Fa(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Fa(e,t[l]))return!0;return!!Bl(e,t)}function ao(e,t,i){return!!Fa(e,t)||!!_s(t,e,i)}function xa(e,t){if(e.length===1)return Fl(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],p=0;p<l.length;p++)if(Fa(e,l[p]))return!0;for(var d=0;d<e.length;d++)if(Fl(t,e[d]))return!0;for(var _=0;_<t.length;_++)if(Bl(e,t[_]))return!0;return!1}function $o(e,t,i){if(e.length>1){if(Bl(e,t))return!0;for(var l=0;l<t.length;l++)if(_s(t[l],e,i))return!0}for(var p=0;p<e.length;p++)if(_s(e[p],t,i))return!0;return!1}function Bl(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],p=e[i+1],d=0;d<t.length-1;d++)if(cl(l,p,t[d],t[d+1]))return!0;return!1}function cl(e,t,i,l){return xt(e,i,l)!==xt(t,i,l)&&xt(e,t,i)!==xt(e,t,l)}function _s(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var p=1;p<t.length;p++)if(hl(e,t[p-1],t[p])<l)return!0;return!1}function hl(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var p=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(p<0?t:p>1?i:i.sub(t)._mult(p)._add(t))}function Fl(e,t){for(var i,l,p,d=!1,_=0;_<e.length;_++)for(var k=0,T=(i=e[_]).length-1;k<i.length;T=k++)(l=i[k]).y>t.y!=(p=i[T]).y>t.y&&t.x<(p.x-l.x)*(t.y-l.y)/(p.y-l.y)+l.x&&(d=!d);return d}function Fa(e,t){for(var i=!1,l=0,p=e.length-1;l<e.length;p=l++){var d=e[l],_=e[p];d.y>t.y!=_.y>t.y&&t.x<(_.x-d.x)*(t.y-d.y)/(_.y-d.y)+d.x&&(i=!i)}return i}function Ol(e,t,i){var l=i[0],p=i[2];if(e.x<l.x&&t.x<l.x||e.x>p.x&&t.x>p.x||e.y<l.y&&t.y<l.y||e.y>p.y&&t.y>p.y)return!1;var d=xt(e,t,i[0]);return d!==xt(e,t,i[1])||d!==xt(e,t,i[2])||d!==xt(e,t,i[3])}function Oa(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function nn(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Wa(e,t,i,l,p){if(!t[0]&&!t[1])return e;var d=L.convert(t)._mult(p);i==="viewport"&&d._rotate(-l);for(var _=[],k=0;k<e.length;k++)_.push(e[k].sub(d));return _}Hn.prototype.populate=function(e,t,i){var l=this.layers[0],p=[],d=null;l.type==="circle"&&(d=l.layout.get("circle-sort-key"));for(var _=0,k=e;_<k.length;_+=1){var T=k[_],z=T.feature,P=T.id,D=T.index,O=T.sourceLayerIndex,q=this.layers[0]._featureFilter.needGeometry,Q=Pi(z,q);if(this.layers[0]._featureFilter.filter(new cr(this.zoom),Q,i)){var ee=d?d.evaluate(Q,{},i):void 0,ue={id:P,properties:z.properties,type:z.type,sourceLayerIndex:O,index:D,geometry:q?Q.geometry:mi(z),patterns:{},sortKey:ee};p.push(ue)}}d&&p.sort(function(Qe,vt){return Qe.sortKey-vt.sortKey});for(var oe=0,de=p;oe<de.length;oe+=1){var _e=de[oe],ve=_e.geometry,Se=_e.index,Le=_e.sourceLayerIndex,Ze=e[Se].feature;this.addFeature(_e,ve,Se,i),t.featureIndex.insert(Ze,ve,Se,Le,this.index)}},Hn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Hn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Hn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Hn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Hn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Hn.prototype.addFeature=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1)for(var _=0,k=d[p];_<k.length;_+=1){var T=k[_],z=T.x,P=T.y;if(!(z<0||z>=8192||P<0||P>=8192)){var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),O=D.vertexLength;Io(this.layoutVertexArray,z,P,-1,-1),Io(this.layoutVertexArray,z,P,1,-1),Io(this.layoutVertexArray,z,P,1,1),Io(this.layoutVertexArray,z,P,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+3,O+2),D.vertexLength+=4,D.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},at("CircleBucket",Hn,{omit:["layers"]});var gs=new In({"circle-sort-key":new mt(U.layout_circle["circle-sort-key"])}),Vs={paint:new In({"circle-radius":new mt(U.paint_circle["circle-radius"]),"circle-color":new mt(U.paint_circle["circle-color"]),"circle-blur":new mt(U.paint_circle["circle-blur"]),"circle-opacity":new mt(U.paint_circle["circle-opacity"]),"circle-translate":new wt(U.paint_circle["circle-translate"]),"circle-translate-anchor":new wt(U.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wt(U.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wt(U.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mt(U.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mt(U.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mt(U.paint_circle["circle-stroke-opacity"])}),layout:gs},kr=typeof Float32Array<"u"?Float32Array:Array;function jo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function so(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],k=t[4],T=t[5],z=t[6],P=t[7],D=t[8],O=t[9],q=t[10],Q=t[11],ee=t[12],ue=t[13],oe=t[14],de=t[15],_e=i[0],ve=i[1],Se=i[2],Le=i[3];return e[0]=_e*l+ve*k+Se*D+Le*ee,e[1]=_e*p+ve*T+Se*O+Le*ue,e[2]=_e*d+ve*z+Se*q+Le*oe,e[3]=_e*_+ve*P+Se*Q+Le*de,e[4]=(_e=i[4])*l+(ve=i[5])*k+(Se=i[6])*D+(Le=i[7])*ee,e[5]=_e*p+ve*T+Se*O+Le*ue,e[6]=_e*d+ve*z+Se*q+Le*oe,e[7]=_e*_+ve*P+Se*Q+Le*de,e[8]=(_e=i[8])*l+(ve=i[9])*k+(Se=i[10])*D+(Le=i[11])*ee,e[9]=_e*p+ve*T+Se*O+Le*ue,e[10]=_e*d+ve*z+Se*q+Le*oe,e[11]=_e*_+ve*P+Se*Q+Le*de,e[12]=(_e=i[12])*l+(ve=i[13])*k+(Se=i[14])*D+(Le=i[15])*ee,e[13]=_e*p+ve*T+Se*O+Le*ue,e[14]=_e*d+ve*z+Se*q+Le*oe,e[15]=_e*_+ve*P+Se*Q+Le*de,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Us,Gh=so;function su(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3];return e[0]=i[0]*l+i[4]*p+i[8]*d+i[12]*_,e[1]=i[1]*l+i[5]*p+i[9]*d+i[13]*_,e[2]=i[2]*l+i[6]*p+i[10]*d+i[14]*_,e[3]=i[3]*l+i[7]*p+i[11]*d+i[15]*_,e}Us=new kr(3),kr!=Float32Array&&(Us[0]=0,Us[1]=0,Us[2]=0),function(){var e=new kr(4);kr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Kh=(function(){var e=new kr(2);kr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Vs)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Hn(i)},t.prototype.queryRadius=function(i){var l=i;return Oa("circle-radius",this,l)+Oa("circle-stroke-width",this,l)+nn(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,T,z){for(var P=Wa(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,T),D=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),O=this.paint.get("circle-pitch-alignment")==="map",q=O?P:function(Ze,Qe){return Ze.map(function(vt){return Nl(vt,Qe)})}(P,z),Q=O?D*T:D,ee=0,ue=d;ee<ue.length;ee+=1)for(var oe=0,de=ue[ee];oe<de.length;oe+=1){var _e=de[oe],ve=O?_e:Nl(_e,z),Se=Q,Le=su([],[_e.x,_e.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Se*=Le[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Se*=k.cameraToCenterDistance/Le[3]),ao(q,ve,Se))return!0}return!1},t}(Ra));function Nl(e,t){var i=su([],[e.x,e.y,0,1],t);return new L(i[0]/i[3],i[1]/i[3])}var Uc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Hn);function pl(e,t,i,l){var p=t.width,d=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==p*d*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(p*d*i);return e.width=p,e.height=d,e.data=l,e}function lu(e,t,i){var l=t.width,p=t.height;if(l!==e.width||p!==e.height){var d=pl({},{width:l,height:p},i);Xh(e,d,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,p)},i),e.width=l,e.height=p,e.data=d.data}}function Xh(e,t,i,l,p,d){if(p.width===0||p.height===0)return t;if(p.width>e.width||p.height>e.height||i.x>e.width-p.width||i.y>e.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||l.x>t.width-p.width||l.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");for(var _=e.data,k=t.data,T=0;T<p.height;T++)for(var z=((i.y+T)*e.width+i.x)*d,P=((l.y+T)*t.width+l.x)*d,D=0;D<p.width*d;D++)k[P+D]=_[z+D];return t}at("HeatmapBucket",Uc,{omit:["layers"]});var Vl=function(e,t){pl(this,e,1,t)};Vl.prototype.resize=function(e){lu(this,e,1)},Vl.prototype.clone=function(){return new Vl({width:this.width,height:this.height},new Uint8Array(this.data))},Vl.copy=function(e,t,i,l,p){Xh(e,t,i,l,p,1)};var Ao=function(e,t){pl(this,e,4,t)};Ao.prototype.resize=function(e){lu(this,e,4)},Ao.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Ao.prototype.clone=function(){return new Ao({width:this.width,height:this.height},new Uint8Array(this.data))},Ao.copy=function(e,t,i,l,p){Xh(e,t,i,l,p,4)},at("AlphaImage",Vl),at("RGBAImage",Ao);var hy={paint:new In({"heatmap-radius":new mt(U.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mt(U.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wt(U.paint_heatmap["heatmap-intensity"]),"heatmap-color":new va(U.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wt(U.paint_heatmap["heatmap-opacity"])})};function Jp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,p=e.image||new Ao({width:i,height:l}),d=function(Q,ee,ue){t[e.evaluationKey]=ue;var oe=e.expression.evaluate(t);p.data[Q+ee+0]=Math.floor(255*oe.r/oe.a),p.data[Q+ee+1]=Math.floor(255*oe.g/oe.a),p.data[Q+ee+2]=Math.floor(255*oe.b/oe.a),p.data[Q+ee+3]=Math.floor(255*oe.a)};if(e.clips)for(var _=0,k=0;_<l;++_,k+=4*i)for(var T=0,z=0;T<i;T++,z+=4){var P=T/(i-1),D=e.clips[_];d(k,z,D.start*(1-P)+D.end*P)}else for(var O=0,q=0;O<i;O++,q+=4)d(0,q,O/(i-1));return p}var py=function(e){function t(i){e.call(this,i,hy),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Uc(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Jp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ra),fy={paint:new In({"hillshade-illumination-direction":new wt(U.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wt(U.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wt(U.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wt(U.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wt(U.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wt(U.paint_hillshade["hillshade-accent-color"])})},dy=function(e){function t(i){e.call(this,i,fy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ra),my=fn([{name:"a_pos",components:2,type:"Int16"}],4).members,Wh=jc,yy=jc;function jc(e,t,i){i=i||2;var l,p,d,_,k,T,z,P=t&&t.length,D=P?t[0]*i:e.length,O=Yp(e,0,D,i,!0),q=[];if(!O||O.next===O.prev)return q;if(P&&(O=function(ee,ue,oe,de){var _e,ve,Se,Le=[];for(_e=0,ve=ue.length;_e<ve;_e++)(Se=Yp(ee,ue[_e]*de,_e<ve-1?ue[_e+1]*de:ee.length,de,!1))===Se.next&&(Se.steiner=!0),Le.push(ky(Se));for(Le.sort(by),_e=0;_e<Le.length;_e++)wy(Le[_e],oe),oe=fl(oe,oe.next);return oe}(e,t,O,i)),e.length>80*i){l=d=e[0],p=_=e[1];for(var Q=i;Q<D;Q+=i)(k=e[Q])<l&&(l=k),(T=e[Q+1])<p&&(p=T),k>d&&(d=k),T>_&&(_=T);z=(z=Math.max(d-l,_-p))!==0?1/z:0}return Ju(O,q,i,l,p,z),q}function Yp(e,t,i,l,p){var d,_;if(p===Yh(e,t,i,l)>0)for(d=t;d<i;d+=l)_=ef(d,e[d],e[d+1],_);else for(d=i-l;d>=t;d-=l)_=ef(d,e[d],e[d+1],_);return _&&qc(_,_.next)&&(Qu(_),_=_.next),_}function fl(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!qc(l,l.next)&&Ki(l.prev,l,l.next)!==0)l=l.next;else{if(Qu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function Ju(e,t,i,l,p,d,_){if(e){!_&&d&&function(P,D,O,q){var Q=P;do Q.z===null&&(Q.z=Hh(Q.x,Q.y,D,O,q)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==P);Q.prevZ.nextZ=null,Q.prevZ=null,function(ee){var ue,oe,de,_e,ve,Se,Le,Ze,Qe=1;do{for(oe=ee,ee=null,ve=null,Se=0;oe;){for(Se++,de=oe,Le=0,ue=0;ue<Qe&&(Le++,de=de.nextZ);ue++);for(Ze=Qe;Le>0||Ze>0&&de;)Le!==0&&(Ze===0||!de||oe.z<=de.z)?(_e=oe,oe=oe.nextZ,Le--):(_e=de,de=de.nextZ,Ze--),ve?ve.nextZ=_e:ee=_e,_e.prevZ=ve,ve=_e;oe=de}ve.nextZ=null,Qe*=2}while(Se>1)}(Q)}(e,l,p,d);for(var k,T,z=e;e.prev!==e.next;)if(k=e.prev,T=e.next,d?gy(e,l,p,d):_y(e))t.push(k.i/i),t.push(e.i/i),t.push(T.i/i),Qu(e),e=T.next,z=T.next;else if((e=T)===z){_?_===1?Ju(e=vy(fl(e),t,i),t,i,l,p,d,2):_===2&&xy(e,t,i,l,p,d):Ju(fl(e),t,i,l,p,d,1);break}}}function _y(e){var t=e.prev,i=e,l=e.next;if(Ki(t,i,l)>=0)return!1;for(var p=e.next.next;p!==e.prev;){if(uu(t.x,t.y,i.x,i.y,l.x,l.y,p.x,p.y)&&Ki(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function gy(e,t,i,l){var p=e.prev,d=e,_=e.next;if(Ki(p,d,_)>=0)return!1;for(var k=p.x>d.x?p.x>_.x?p.x:_.x:d.x>_.x?d.x:_.x,T=p.y>d.y?p.y>_.y?p.y:_.y:d.y>_.y?d.y:_.y,z=Hh(p.x<d.x?p.x<_.x?p.x:_.x:d.x<_.x?d.x:_.x,p.y<d.y?p.y<_.y?p.y:_.y:d.y<_.y?d.y:_.y,t,i,l),P=Hh(k,T,t,i,l),D=e.prevZ,O=e.nextZ;D&&D.z>=z&&O&&O.z<=P;){if(D!==e.prev&&D!==e.next&&uu(p.x,p.y,d.x,d.y,_.x,_.y,D.x,D.y)&&Ki(D.prev,D,D.next)>=0||(D=D.prevZ,O!==e.prev&&O!==e.next&&uu(p.x,p.y,d.x,d.y,_.x,_.y,O.x,O.y)&&Ki(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;D&&D.z>=z;){if(D!==e.prev&&D!==e.next&&uu(p.x,p.y,d.x,d.y,_.x,_.y,D.x,D.y)&&Ki(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;O&&O.z<=P;){if(O!==e.prev&&O!==e.next&&uu(p.x,p.y,d.x,d.y,_.x,_.y,O.x,O.y)&&Ki(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function vy(e,t,i){var l=e;do{var p=l.prev,d=l.next.next;!qc(p,d)&&Qp(p,l,l.next,d)&&Yu(p,d)&&Yu(d,p)&&(t.push(p.i/i),t.push(l.i/i),t.push(d.i/i),Qu(l),Qu(l.next),l=e=d),l=l.next}while(l!==e);return fl(l)}function xy(e,t,i,l,p,d){var _=e;do{for(var k=_.next.next;k!==_.prev;){if(_.i!==k.i&&Ey(_,k)){var T=$p(_,k);return _=fl(_,_.next),T=fl(T,T.next),Ju(_,t,i,l,p,d),void Ju(T,t,i,l,p,d)}k=k.next}_=_.next}while(_!==e)}function by(e,t){return e.x-t.x}function wy(e,t){if(t=function(l,p){var d,_=p,k=l.x,T=l.y,z=-1/0;do{if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){var P=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(P<=k&&P>z){if(z=P,P===k){if(T===_.y)return _;if(T===_.next.y)return _.next}d=_.x<_.next.x?_:_.next}}_=_.next}while(_!==p);if(!d)return null;if(k===z)return d;var D,O=d,q=d.x,Q=d.y,ee=1/0;_=d;do k>=_.x&&_.x>=q&&k!==_.x&&uu(T<Q?k:z,T,q,Q,T<Q?z:k,T,_.x,_.y)&&(D=Math.abs(T-_.y)/(k-_.x),Yu(_,l)&&(D<ee||D===ee&&(_.x>d.x||_.x===d.x&&Sy(d,_)))&&(d=_,ee=D)),_=_.next;while(_!==O);return d}(e,t)){var i=$p(t,e);fl(t,t.next),fl(i,i.next)}}function Sy(e,t){return Ki(e.prev,e,t.prev)<0&&Ki(t.next,e,e.next)<0}function Hh(e,t,i,l,p){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*p)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*p)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ky(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function uu(e,t,i,l,p,d,_,k){return(p-_)*(t-k)-(e-_)*(d-k)>=0&&(e-_)*(l-k)-(i-_)*(t-k)>=0&&(i-_)*(d-k)-(p-_)*(l-k)>=0}function Ey(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==l.i&&p.next.i!==l.i&&Qp(p,p.next,i,l))return!0;p=p.next}while(p!==i);return!1}(e,t)&&(Yu(e,t)&&Yu(t,e)&&function(i,l){var p=i,d=!1,_=(i.x+l.x)/2,k=(i.y+l.y)/2;do p.y>k!=p.next.y>k&&p.next.y!==p.y&&_<(p.next.x-p.x)*(k-p.y)/(p.next.y-p.y)+p.x&&(d=!d),p=p.next;while(p!==i);return d}(e,t)&&(Ki(e.prev,e,t.prev)||Ki(e,t.prev,t))||qc(e,t)&&Ki(e.prev,e,e.next)>0&&Ki(t.prev,t,t.next)>0)}function Ki(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function qc(e,t){return e.x===t.x&&e.y===t.y}function Qp(e,t,i,l){var p=Gc(Ki(e,t,i)),d=Gc(Ki(e,t,l)),_=Gc(Ki(i,l,e)),k=Gc(Ki(i,l,t));return p!==d&&_!==k||!(p!==0||!Zc(e,i,t))||!(d!==0||!Zc(e,l,t))||!(_!==0||!Zc(i,e,l))||!(k!==0||!Zc(i,t,l))}function Zc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Gc(e){return e>0?1:e<0?-1:0}function Yu(e,t){return Ki(e.prev,e,e.next)<0?Ki(e,t,e.next)>=0&&Ki(e,e.prev,t)>=0:Ki(e,t,e.prev)<0||Ki(e,e.next,t)<0}function $p(e,t){var i=new Jh(e.i,e.x,e.y),l=new Jh(t.i,t.x,t.y),p=e.next,d=t.prev;return e.next=t,t.prev=e,i.next=p,p.prev=i,l.next=i,i.prev=l,d.next=l,l.prev=d,l}function ef(e,t,i,l){var p=new Jh(e,t,i);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function Qu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Jh(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yh(e,t,i,l){for(var p=0,d=t,_=i-l;d<i;d+=l)p+=(e[_]-e[d])*(e[d+1]+e[_+1]),_=d;return p}function Ty(e,t,i,l,p){(function d(_,k,T,z,P){for(;z>T;){if(z-T>600){var D=z-T+1,O=k-T+1,q=Math.log(D),Q=.5*Math.exp(2*q/3),ee=.5*Math.sqrt(q*Q*(D-Q)/D)*(O-D/2<0?-1:1);d(_,k,Math.max(T,Math.floor(k-O*Q/D+ee)),Math.min(z,Math.floor(k+(D-O)*Q/D+ee)),P)}var ue=_[k],oe=T,de=z;for($u(_,T,k),P(_[z],ue)>0&&$u(_,T,z);oe<de;){for($u(_,oe,de),oe++,de--;P(_[oe],ue)<0;)oe++;for(;P(_[de],ue)>0;)de--}P(_[T],ue)===0?$u(_,T,de):$u(_,++de,z),de<=k&&(T=de+1),k<=de&&(z=de-1)}})(e,t,i||0,l||e.length-1,p||Iy)}function $u(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function Iy(e,t){return e<t?-1:e>t?1:0}function Qh(e,t){var i=e.length;if(i<=1)return[e];for(var l,p,d=[],_=0;_<i;_++){var k=Ve(e[_]);k!==0&&(e[_].area=Math.abs(k),p===void 0&&(p=k<0),p===k<0?(l&&d.push(l),l=[e[_]]):l.push(e[_]))}if(l&&d.push(l),t>1)for(var T=0;T<d.length;T++)d[T].length<=t||(Ty(d[T],t,1,d[T].length-1,Ay),d[T]=d[T].slice(0,t));return d}function Ay(e,t){return t.area-e.area}function $h(e,t,i){for(var l=i.patternDependencies,p=!1,d=0,_=t;d<_.length;d+=1){var k=_[d].paint.get(e+"-pattern");k.isConstant()||(p=!0);var T=k.constantOr(null);T&&(p=!0,l[T.to]=!0,l[T.from]=!0)}return p}function ep(e,t,i,l,p){for(var d=p.patternDependencies,_=0,k=t;_<k.length;_+=1){var T=k[_],z=T.paint.get(e+"-pattern").value;if(z.kind!=="constant"){var P=z.evaluate({zoom:l-1},i,{},p.availableImages),D=z.evaluate({zoom:l},i,{},p.availableImages),O=z.evaluate({zoom:l+1},i,{},p.availableImages);D=D&&D.name?D.name:D,O=O&&O.name?O.name:O,d[P=P&&P.name?P.name:P]=!0,d[D]=!0,d[O]=!0,i.patterns[T.id]={min:P,mid:D,max:O}}}return i}jc.deviation=function(e,t,i,l){var p=t&&t.length,d=Math.abs(Yh(e,0,p?t[0]*i:e.length,i));if(p)for(var _=0,k=t.length;_<k;_++)d-=Math.abs(Yh(e,t[_]*i,_<k-1?t[_+1]*i:e.length,i));var T=0;for(_=0;_<l.length;_+=3){var z=l[_]*i,P=l[_+1]*i,D=l[_+2]*i;T+=Math.abs((e[z]-e[D])*(e[P+1]-e[z+1])-(e[z]-e[P])*(e[D+1]-e[z+1]))}return d===0&&T===0?0:Math.abs((T-d)/d)},jc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,p=0;p<e.length;p++){for(var d=0;d<e[p].length;d++)for(var _=0;_<t;_++)i.vertices.push(e[p][d][_]);p>0&&i.holes.push(l+=e[p-1].length)}return i},Wh.default=yy;var Ha=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Os,this.indexArray=new fs,this.indexArray2=new Rl,this.programConfigurations=new Lt(e.layers,e.zoom),this.segments=new G,this.segments2=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ha.prototype.populate=function(e,t,i){this.hasPattern=$h("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var k=_[d],T=k.feature,z=k.id,P=k.index,D=k.sourceLayerIndex,O=this.layers[0]._featureFilter.needGeometry,q=Pi(T,O);if(this.layers[0]._featureFilter.filter(new cr(this.zoom),q,i)){var Q=l?l.evaluate(q,{},i,t.availableImages):void 0,ee={id:z,properties:T.properties,type:T.type,sourceLayerIndex:D,index:P,geometry:O?q.geometry:mi(T),patterns:{},sortKey:Q};p.push(ee)}}l&&p.sort(function(Ze,Qe){return Ze.sortKey-Qe.sortKey});for(var ue=0,oe=p;ue<oe.length;ue+=1){var de=oe[ue],_e=de.geometry,ve=de.index,Se=de.sourceLayerIndex;if(this.hasPattern){var Le=ep("fill",this.layers,de,this.zoom,t);this.patternFeatures.push(Le)}else this.addFeature(de,_e,ve,i,{});t.featureIndex.insert(e[ve].feature,_e,ve,Se,this.index)}},Ha.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ha.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},Ha.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ha.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ha.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,my),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ha.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ha.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=Qh(t,500);d<_.length;d+=1){for(var k=_[d],T=0,z=0,P=k;z<P.length;z+=1)T+=P[z].length;for(var D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),O=D.vertexLength,q=[],Q=[],ee=0,ue=k;ee<ue.length;ee+=1){var oe=ue[ee];if(oe.length!==0){oe!==k[0]&&Q.push(q.length/2);var de=this.segments2.prepareSegment(oe.length,this.layoutVertexArray,this.indexArray2),_e=de.vertexLength;this.layoutVertexArray.emplaceBack(oe[0].x,oe[0].y),this.indexArray2.emplaceBack(_e+oe.length-1,_e),q.push(oe[0].x),q.push(oe[0].y);for(var ve=1;ve<oe.length;ve++)this.layoutVertexArray.emplaceBack(oe[ve].x,oe[ve].y),this.indexArray2.emplaceBack(_e+ve-1,_e+ve),q.push(oe[ve].x),q.push(oe[ve].y);de.vertexLength+=oe.length,de.primitiveLength+=oe.length}}for(var Se=Wh(q,Q),Le=0;Le<Se.length;Le+=3)this.indexArray.emplaceBack(O+Se[Le],O+Se[Le+1],O+Se[Le+2]);D.vertexLength+=T,D.primitiveLength+=Se.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},at("FillBucket",Ha,{omit:["layers","patternFeatures"]});var zy=new In({"fill-sort-key":new mt(U.layout_fill["fill-sort-key"])}),Cy={paint:new In({"fill-antialias":new wt(U.paint_fill["fill-antialias"]),"fill-opacity":new mt(U.paint_fill["fill-opacity"]),"fill-color":new mt(U.paint_fill["fill-color"]),"fill-outline-color":new mt(U.paint_fill["fill-outline-color"]),"fill-translate":new wt(U.paint_fill["fill-translate"]),"fill-translate-anchor":new wt(U.paint_fill["fill-translate-anchor"]),"fill-pattern":new ru(U.paint_fill["fill-pattern"])}),layout:zy},Py=function(e){function t(i){e.call(this,i,Cy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ha(i)},t.prototype.queryRadius=function(){return nn(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,T){return xa(Wa(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,T),d)},t.prototype.isTileClipped=function(){return!0},t}(Ra),My=fn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,tf=cu;function cu(e,t,i,l,p){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=p,e.readFields(Dy,this,t)}function Dy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,p){for(var d=l.readVarint()+l.pos;l.pos<d;){var _=p._keys[l.readVarint()],k=p._values[l.readVarint()];p.properties[_]=k}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Ly(e){for(var t,i,l=0,p=0,d=e.length,_=d-1;p<d;_=p++)l+=((i=e[_]).x-(t=e[p]).x)*(t.y+i.y);return l}cu.types=["Unknown","Point","LineString","Polygon"],cu.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,p=0,d=0,_=0,k=[];e.pos<i;){if(p<=0){var T=e.readVarint();l=7&T,p=T>>3}if(p--,l===1||l===2)d+=e.readSVarint(),_+=e.readSVarint(),l===1&&(t&&k.push(t),t=[]),t.push(new L(d,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&k.push(t),k},cu.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,p=0,d=0,_=1/0,k=-1/0,T=1/0,z=-1/0;e.pos<t;){if(l<=0){var P=e.readVarint();i=7&P,l=P>>3}if(l--,i===1||i===2)(p+=e.readSVarint())<_&&(_=p),p>k&&(k=p),(d+=e.readSVarint())<T&&(T=d),d>z&&(z=d);else if(i!==7)throw new Error("unknown command "+i)}return[_,T,k,z]},cu.prototype.toGeoJSON=function(e,t,i){var l,p,d=this.extent*Math.pow(2,i),_=this.extent*e,k=this.extent*t,T=this.loadGeometry(),z=cu.types[this.type];function P(q){for(var Q=0;Q<q.length;Q++){var ee=q[Q];q[Q]=[360*(ee.x+_)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+k)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<T.length;l++)D[l]=T[l][0];P(T=D);break;case 2:for(l=0;l<T.length;l++)P(T[l]);break;case 3:for(T=function(q){var Q=q.length;if(Q<=1)return[q];for(var ee,ue,oe=[],de=0;de<Q;de++){var _e=Ly(q[de]);_e!==0&&(ue===void 0&&(ue=_e<0),ue===_e<0?(ee&&oe.push(ee),ee=[q[de]]):ee.push(q[de]))}return ee&&oe.push(ee),oe}(T),l=0;l<T.length;l++)for(p=0;p<T[l].length;p++)P(T[l][p])}T.length===1?T=T[0]:z="Multi"+z;var O={type:"Feature",geometry:{type:z,coordinates:T},properties:this.properties};return"id"in this&&(O.id=this.id),O};var rf=nf;function nf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ry,this,t),this.length=this._features.length}function Ry(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var p=null,d=l.readVarint()+l.pos;l.pos<d;){var _=l.readVarint()>>3;p=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return p}(i))}function By(e,t,i){if(e===3){var l=new rf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}nf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new tf(this._pbf,t,this.extent,this._keys,this._values)};var hu={VectorTile:function(e,t){this.layers=e.readFields(By,{},t)},VectorTileFeature:tf,VectorTileLayer:rf},Fy=hu.VectorTileFeature.types,tp=Math.pow(2,13);function ec(e,t,i,l,p,d,_,k){e.emplaceBack(t,i,2*Math.floor(l*tp)+_,p*tp*2,d*tp*2,Math.round(k))}var Ja=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Xa,this.indexArray=new fs,this.programConfigurations=new Lt(e.layers,e.zoom),this.segments=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Oy(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ja.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=$h("fill-extrusion",this.layers,t);for(var l=0,p=e;l<p.length;l+=1){var d=p[l],_=d.feature,k=d.id,T=d.index,z=d.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,D=Pi(_,P);if(this.layers[0]._featureFilter.filter(new cr(this.zoom),D,i)){var O={id:k,sourceLayerIndex:z,index:T,geometry:P?D.geometry:mi(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(ep("fill-extrusion",this.layers,O,this.zoom,t)):this.addFeature(O,O.geometry,T,i,{}),t.featureIndex.insert(_,O.geometry,T,z,this.index,!0)}}},Ja.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.features;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},Ja.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ja.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ja.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ja.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,My),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ja.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ja.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=Qh(t,500);d<_.length;d+=1){for(var k=_[d],T=0,z=0,P=k;z<P.length;z+=1)T+=P[z].length;for(var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),O=0,q=k;O<q.length;O+=1){var Q=q[O];if(Q.length!==0&&!((sr=Q).every(function(Yt){return Yt.x<0})||sr.every(function(Yt){return Yt.x>8192})||sr.every(function(Yt){return Yt.y<0})||sr.every(function(Yt){return Yt.y>8192})))for(var ee=0,ue=0;ue<Q.length;ue++){var oe=Q[ue];if(ue>=1){var de=Q[ue-1];if(!Oy(oe,de)){D.vertexLength+4>G.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _e=oe.sub(de)._perp()._unit(),ve=de.dist(oe);ee+ve>32768&&(ee=0),ec(this.layoutVertexArray,oe.x,oe.y,_e.x,_e.y,0,0,ee),ec(this.layoutVertexArray,oe.x,oe.y,_e.x,_e.y,0,1,ee),ec(this.layoutVertexArray,de.x,de.y,_e.x,_e.y,0,0,ee+=ve),ec(this.layoutVertexArray,de.x,de.y,_e.x,_e.y,0,1,ee);var Se=D.vertexLength;this.indexArray.emplaceBack(Se,Se+2,Se+1),this.indexArray.emplaceBack(Se+1,Se+2,Se+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+T>G.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),Fy[e.type]==="Polygon"){for(var Le=[],Ze=[],Qe=D.vertexLength,vt=0,st=k;vt<st.length;vt+=1){var kt=st[vt];if(kt.length!==0){kt!==k[0]&&Ze.push(Le.length/2);for(var lt=0;lt<kt.length;lt++){var or=kt[lt];ec(this.layoutVertexArray,or.x,or.y,0,0,1,1,0),Le.push(or.x),Le.push(or.y)}}}for(var Bt=Wh(Le,Ze),yt=0;yt<Bt.length;yt+=3)this.indexArray.emplaceBack(Qe+Bt[yt],Qe+Bt[yt+2],Qe+Bt[yt+1]);D.primitiveLength+=Bt.length/3,D.vertexLength+=T}}var sr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},at("FillExtrusionBucket",Ja,{omit:["layers","features"]});var Ny={paint:new In({"fill-extrusion-opacity":new wt(U["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mt(U["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wt(U["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wt(U["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ru(U["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mt(U["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mt(U["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wt(U["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Vy=function(e){function t(i){e.call(this,i,Ny)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ja(i)},t.prototype.queryRadius=function(){return nn(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,T,z){var P=Wa(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,T),D=this.paint.get("fill-extrusion-height").evaluate(l,p),O=this.paint.get("fill-extrusion-base").evaluate(l,p),q=function(ee,ue,oe,de){for(var _e=[],ve=0,Se=ee;ve<Se.length;ve+=1){var Le=Se[ve],Ze=[Le.x,Le.y,0,1];su(Ze,Ze,ue),_e.push(new L(Ze[0]/Ze[3],Ze[1]/Ze[3]))}return _e}(P,z),Q=function(ee,ue,oe,de){for(var _e=[],ve=[],Se=de[8]*ue,Le=de[9]*ue,Ze=de[10]*ue,Qe=de[11]*ue,vt=de[8]*oe,st=de[9]*oe,kt=de[10]*oe,lt=de[11]*oe,or=0,Bt=ee;or<Bt.length;or+=1){for(var yt=[],sr=[],Yt=0,_r=Bt[or];Yt<_r.length;Yt+=1){var Et=_r[Yt],br=Et.x,ni=Et.y,Si=de[0]*br+de[4]*ni+de[12],yi=de[1]*br+de[5]*ni+de[13],oi=de[2]*br+de[6]*ni+de[14],ki=de[3]*br+de[7]*ni+de[15],on=oi+Ze,an=ki+Qe,Yn=Si+vt,yn=yi+st,Qn=oi+kt,Mi=ki+lt,_n=new L((Si+Se)/an,(yi+Le)/an);_n.z=on/an,yt.push(_n);var pr=new L(Yn/Mi,yn/Mi);pr.z=Qn/Mi,sr.push(pr)}_e.push(yt),ve.push(sr)}return[_e,ve]}(d,O,D,z);return function(ee,ue,oe){var de=1/0;xa(oe,ue)&&(de=of(oe,ue[0]));for(var _e=0;_e<ue.length;_e++)for(var ve=ue[_e],Se=ee[_e],Le=0;Le<ve.length-1;Le++){var Ze=ve[Le],Qe=[Ze,ve[Le+1],Se[Le+1],Se[Le],Ze];ys(oe,Qe)&&(de=Math.min(de,of(oe,Qe)))}return de!==1/0&&de}(Q[0],Q[1],q)},t}(Ra);function tc(e,t){return e.x*t.x+e.y*t.y}function of(e,t){if(e.length===1){for(var i,l=0,p=t[l++];!i||p.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var d=t[l],_=e[0],k=i.sub(p),T=d.sub(p),z=_.sub(p),P=tc(k,k),D=tc(k,T),O=tc(T,T),q=tc(z,k),Q=tc(z,T),ee=P*O-D*D,ue=(O*q-D*Q)/ee,oe=(P*Q-D*q)/ee,de=p.z*(1-ue-oe)+i.z*ue+d.z*oe;if(isFinite(de))return de}return 1/0}for(var _e=1/0,ve=0,Se=t;ve<Se.length;ve+=1)_e=Math.min(_e,Se[ve].z);return _e}var Uy=fn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,jy=fn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,qy=hu.VectorTileFeature.types,Zy=Math.cos(Math.PI/180*37.5),af=Math.pow(2,14)/.5,lo=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new To,this.layoutVertexArray2=new sl,this.indexArray=new fs,this.programConfigurations=new Lt(e.layers,e.zoom),this.segments=new G,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};lo.prototype.populate=function(e,t,i){this.hasPattern=$h("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var k=_[d],T=k.feature,z=k.id,P=k.index,D=k.sourceLayerIndex,O=this.layers[0]._featureFilter.needGeometry,q=Pi(T,O);if(this.layers[0]._featureFilter.filter(new cr(this.zoom),q,i)){var Q=l?l.evaluate(q,{},i):void 0,ee={id:z,properties:T.properties,type:T.type,sourceLayerIndex:D,index:P,geometry:O?q.geometry:mi(T),patterns:{},sortKey:Q};p.push(ee)}}l&&p.sort(function(Ze,Qe){return Ze.sortKey-Qe.sortKey});for(var ue=0,oe=p;ue<oe.length;ue+=1){var de=oe[ue],_e=de.geometry,ve=de.index,Se=de.sourceLayerIndex;if(this.hasPattern){var Le=ep("line",this.layers,de,this.zoom,t);this.patternFeatures.push(Le)}else this.addFeature(de,_e,ve,i,{});t.featureIndex.insert(e[ve].feature,_e,ve,Se,this.index)}},lo.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},lo.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},lo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},lo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},lo.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,jy)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Uy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},lo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},lo.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},lo.prototype.addFeature=function(e,t,i,l,p){var d=this.layers[0].layout,_=d.get("line-join").evaluate(e,{}),k=d.get("line-cap"),T=d.get("line-miter-limit"),z=d.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var P=0,D=t;P<D.length;P+=1)this.addLine(D[P],e,_,k,T,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},lo.prototype.addLine=function(e,t,i,l,p,d){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var _=0;_<e.length-1;_++)this.totalDistance+=e[_].dist(e[_+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var k=qy[t.type]==="Polygon",T=e.length;T>=2&&e[T-1].equals(e[T-2]);)T--;for(var z=0;z<T-1&&e[z].equals(e[z+1]);)z++;if(!(T<(k?3:2))){i==="bevel"&&(p=1.05);var P,D=this.overscaling<=16?122880/(512*this.overscaling):0,O=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray),q=void 0,Q=void 0,ee=void 0,ue=void 0;this.e1=this.e2=-1,k&&(ue=e[z].sub(P=e[T-2])._unit()._perp());for(var oe=z;oe<T;oe++)if(!(Q=oe===T-1?k?e[z+1]:void 0:e[oe+1])||!e[oe].equals(Q)){ue&&(ee=ue),P&&(q=P),P=e[oe],ue=Q?Q.sub(P)._unit()._perp():ee;var de=(ee=ee||ue).add(ue);de.x===0&&de.y===0||de._unit();var _e=ee.x*ue.x+ee.y*ue.y,ve=de.x*ue.x+de.y*ue.y,Se=ve!==0?1/ve:1/0,Le=2*Math.sqrt(2-2*ve),Ze=ve<Zy&&q&&Q,Qe=ee.x*ue.y-ee.y*ue.x>0;if(Ze&&oe>z){var vt=P.dist(q);if(vt>2*D){var st=P.sub(P.sub(q)._mult(D/vt)._round());this.updateDistance(q,st),this.addCurrentVertex(st,ee,0,0,O),q=st}}var kt=q&&Q,lt=kt?i:k?"butt":l;if(kt&&lt==="round"&&(Se<d?lt="miter":Se<=2&&(lt="fakeround")),lt==="miter"&&Se>p&&(lt="bevel"),lt==="bevel"&&(Se>2&&(lt="flipbevel"),Se<p&&(lt="miter")),q&&this.updateDistance(q,P),lt==="miter")de._mult(Se),this.addCurrentVertex(P,de,0,0,O);else if(lt==="flipbevel"){if(Se>100)de=ue.mult(-1);else{var or=Se*ee.add(ue).mag()/ee.sub(ue).mag();de._perp()._mult(or*(Qe?-1:1))}this.addCurrentVertex(P,de,0,0,O),this.addCurrentVertex(P,de.mult(-1),0,0,O)}else if(lt==="bevel"||lt==="fakeround"){var Bt=-Math.sqrt(Se*Se-1),yt=Qe?Bt:0,sr=Qe?0:Bt;if(q&&this.addCurrentVertex(P,ee,yt,sr,O),lt==="fakeround")for(var Yt=Math.round(180*Le/Math.PI/20),_r=1;_r<Yt;_r++){var Et=_r/Yt;if(Et!==.5){var br=Et-.5;Et+=Et*br*(Et-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*br*br+(.848013+_e*(.215638*_e-1.06021)))}var ni=ue.sub(ee)._mult(Et)._add(ee)._unit()._mult(Qe?-1:1);this.addHalfVertex(P,ni.x,ni.y,!1,Qe,0,O)}Q&&this.addCurrentVertex(P,ue,-yt,-sr,O)}else if(lt==="butt")this.addCurrentVertex(P,de,0,0,O);else if(lt==="square"){var Si=q?1:-1;this.addCurrentVertex(P,de,Si,Si,O)}else lt==="round"&&(q&&(this.addCurrentVertex(P,ee,0,0,O),this.addCurrentVertex(P,ee,1,1,O,!0)),Q&&(this.addCurrentVertex(P,ue,-1,-1,O,!0),this.addCurrentVertex(P,ue,0,0,O)));if(Ze&&oe<T-1){var yi=P.dist(Q);if(yi>2*D){var oi=P.add(Q.sub(P)._mult(D/yi)._round());this.updateDistance(P,oi),this.addCurrentVertex(oi,ue,0,0,O),P=oi}}}}},lo.prototype.addCurrentVertex=function(e,t,i,l,p,d){d===void 0&&(d=!1);var _=t.y*l-t.x,k=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,d,!1,i,p),this.addHalfVertex(e,_,k,d,!0,-l,p),this.distance>af/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,p,d))},lo.prototype.addHalfVertex=function(e,t,i,l,p,d,_){var k=.5*(this.lineClips?this.scaledDistance*(af-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(p?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(d===0?0:d<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var T=_.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),_.primitiveLength++),p?this.e2=T:this.e1=T},lo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},lo.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},at("LineBucket",lo,{omit:["layers","patternFeatures"]});var Gy=new In({"line-cap":new wt(U.layout_line["line-cap"]),"line-join":new mt(U.layout_line["line-join"]),"line-miter-limit":new wt(U.layout_line["line-miter-limit"]),"line-round-limit":new wt(U.layout_line["line-round-limit"]),"line-sort-key":new mt(U.layout_line["line-sort-key"])}),sf={paint:new In({"line-opacity":new mt(U.paint_line["line-opacity"]),"line-color":new mt(U.paint_line["line-color"]),"line-translate":new wt(U.paint_line["line-translate"]),"line-translate-anchor":new wt(U.paint_line["line-translate-anchor"]),"line-width":new mt(U.paint_line["line-width"]),"line-gap-width":new mt(U.paint_line["line-gap-width"]),"line-offset":new mt(U.paint_line["line-offset"]),"line-blur":new mt(U.paint_line["line-blur"]),"line-dasharray":new Wn(U.paint_line["line-dasharray"]),"line-pattern":new ru(U.paint_line["line-pattern"]),"line-gradient":new va(U.paint_line["line-gradient"])}),layout:Gy},lf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new cr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,p,d){return l=Ge({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,p,d)},t}(mt))(sf.paint.properties["line-width"].specification);lf.useIntegerZoom=!0;var Ky=function(e){function t(i){e.call(this,i,sf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Sn,this.gradientVersion=(this.gradientVersion+1)%X)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=lf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new lo(i)},t.prototype.queryRadius=function(i){var l=i,p=uf(Oa("line-width",this,l),Oa("line-gap-width",this,l)),d=Oa("line-offset",this,l);return p/2+Math.abs(d)+nn(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,T){var z=Wa(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,T),P=T/2*uf(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),D=this.paint.get("line-offset").evaluate(l,p);return D&&(d=function(O,q){for(var Q=[],ee=new L(0,0),ue=0;ue<O.length;ue++){for(var oe=O[ue],de=[],_e=0;_e<oe.length;_e++){var ve=oe[_e],Se=oe[_e+1],Le=_e===0?ee:ve.sub(oe[_e-1])._unit()._perp(),Ze=_e===oe.length-1?ee:Se.sub(ve)._unit()._perp(),Qe=Le._add(Ze)._unit();Qe._mult(1/(Qe.x*Ze.x+Qe.y*Ze.y)),de.push(Qe._mult(q)._add(ve))}Q.push(de)}return Q}(d,D*T)),function(O,q,Q){for(var ee=0;ee<q.length;ee++){var ue=q[ee];if(O.length>=3){for(var oe=0;oe<ue.length;oe++)if(Fa(O,ue[oe]))return!0}if($o(O,ue,Q))return!0}return!1}(z,d,P)},t.prototype.isTileClipped=function(){return!0},t}(Ra);function uf(e,t){return t>0?t+2*e:e}var Xy=fn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wy=fn([{name:"a_projected_pos",components:3,type:"Float32"}],4),Hy=(fn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),fn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),cf=(fn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),fn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Jy=fn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Yy(e,t,i){return e.sections.forEach(function(l){l.text=function(p,d,_){var k=d.layout.get("text-transform").evaluate(_,{});return k==="uppercase"?p=p.toLocaleUpperCase():k==="lowercase"&&(p=p.toLocaleLowerCase()),Uo.applyArabicShaping&&(p=Uo.applyArabicShaping(p)),p}(l.text,t,i)}),e}fn([{name:"triangle",components:3,type:"Uint16"}]),fn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),fn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),fn([{type:"Float32",name:"offsetX"}]),fn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var rc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},hf=function(e,t,i,l,p){var d,_,k=8*p-l-1,T=(1<<k)-1,z=T>>1,P=-7,D=i?p-1:0,O=i?-1:1,q=e[t+D];for(D+=O,d=q&(1<<-P)-1,q>>=-P,P+=k;P>0;d=256*d+e[t+D],D+=O,P-=8);for(_=d&(1<<-P)-1,d>>=-P,P+=l;P>0;_=256*_+e[t+D],D+=O,P-=8);if(d===0)d=1-z;else{if(d===T)return _?NaN:1/0*(q?-1:1);_+=Math.pow(2,l),d-=z}return(q?-1:1)*_*Math.pow(2,d-l)},pf=function(e,t,i,l,p,d){var _,k,T,z=8*d-p-1,P=(1<<z)-1,D=P>>1,O=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=l?0:d-1,Q=l?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,_=P):(_=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-_))<1&&(_--,T*=2),(t+=_+D>=1?O/T:O*Math.pow(2,1-D))*T>=2&&(_++,T/=2),_+D>=P?(k=0,_=P):_+D>=1?(k=(t*T-1)*Math.pow(2,p),_+=D):(k=t*Math.pow(2,D-1)*Math.pow(2,p),_=0));p>=8;e[i+q]=255&k,q+=Q,k/=256,p-=8);for(_=_<<p|k,z+=p;z>0;e[i+q]=255&_,q+=Q,_/=256,z-=8);e[i+q-Q]|=128*ee},Kc=Wr;function Wr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Wr.Varint=0,Wr.Fixed64=1,Wr.Bytes=2,Wr.Fixed32=5;var ff=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function js(e){return e.type===Wr.Bytes?e.readVarint()+e.pos:e.pos+1}function pu(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function df(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var p=i.pos-1;p>=e;p--)i.buf[p+l]=i.buf[p]}function Qy(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function $y(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function e_(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function t_(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function r_(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function i_(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function n_(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function o_(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function a_(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Xc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function fu(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function mf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function s_(e,t,i){e===1&&i.readMessage(l_,t)}function l_(e,t,i){if(e===3){var l=i.readMessage(u_,{}),p=l.width,d=l.height,_=l.left,k=l.top,T=l.advance;t.push({id:l.id,bitmap:new Vl({width:p+6,height:d+6},l.bitmap),metrics:{width:p,height:d,left:_,top:k,advance:T}})}}function u_(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function yf(e){for(var t=0,i=0,l=0,p=e;l<p.length;l+=1){var d=p[l];t+=d.w*d.h,i=Math.max(i,d.w)}e.sort(function(ee,ue){return ue.h-ee.h});for(var _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],k=0,T=0,z=0,P=e;z<P.length;z+=1)for(var D=P[z],O=_.length-1;O>=0;O--){var q=_[O];if(!(D.w>q.w||D.h>q.h)){if(D.x=q.x,D.y=q.y,T=Math.max(T,D.y+D.h),k=Math.max(k,D.x+D.w),D.w===q.w&&D.h===q.h){var Q=_.pop();O<_.length&&(_[O]=Q)}else D.h===q.h?(q.x+=D.w,q.w-=D.w):D.w===q.w?(q.y+=D.h,q.h-=D.h):(_.push({x:q.x+D.w,y:q.y,w:q.w-D.w,h:D.h}),q.y+=D.h,q.h-=D.h);break}}return{w:k,h:T,fill:t/(k*T)||0}}Wr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),p=l>>3,d=this.pos;this.type=7&l,e(p,t,this),this.pos===d&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Xc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=mf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Xc(this.buf,this.pos)+4294967296*Xc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Xc(this.buf,this.pos)+4294967296*mf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=hf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=hf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(p,d,_){var k,T,z=_.buf;if(k=(112&(T=z[_.pos++]))>>4,T<128||(k|=(127&(T=z[_.pos++]))<<3,T<128)||(k|=(127&(T=z[_.pos++]))<<10,T<128)||(k|=(127&(T=z[_.pos++]))<<17,T<128)||(k|=(127&(T=z[_.pos++]))<<24,T<128)||(k|=(1&(T=z[_.pos++]))<<31,T<128))return pu(p,k,d);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ff?function(i,l,p){return ff.decode(i.subarray(l,p))}(this.buf,t,e):function(i,l,p){for(var d="",_=l;_<p;){var k,T,z,P=i[_],D=null,O=P>239?4:P>223?3:P>191?2:1;if(_+O>p)break;O===1?P<128&&(D=P):O===2?(192&(k=i[_+1]))==128&&(D=(31&P)<<6|63&k)<=127&&(D=null):O===3?(T=i[_+2],(192&(k=i[_+1]))==128&&(192&T)==128&&((D=(15&P)<<12|(63&k)<<6|63&T)<=2047||D>=55296&&D<=57343)&&(D=null)):O===4&&(T=i[_+2],z=i[_+3],(192&(k=i[_+1]))==128&&(192&T)==128&&(192&z)==128&&((D=(15&P)<<18|(63&k)<<12|(63&T)<<6|63&z)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,O=1):D>65535&&(D-=65536,d+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),d+=String.fromCharCode(D),_+=O}return d}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Wr.Bytes)return e.push(this.readVarint(t));var i=js(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Wr.Bytes)return e.push(this.readSVarint());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Wr.Bytes)return e.push(this.readBoolean());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Wr.Bytes)return e.push(this.readFloat());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Wr.Bytes)return e.push(this.readDouble());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Wr.Bytes)return e.push(this.readFixed32());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Wr.Bytes)return e.push(this.readSFixed32());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Wr.Bytes)return e.push(this.readFixed64());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Wr.Bytes)return e.push(this.readSFixed64());var t=js(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Wr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Wr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Wr.Fixed32)this.pos+=4;else{if(t!==Wr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),fu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),fu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),fu(this.buf,-1&e,this.pos),fu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),fu(this.buf,-1&e,this.pos),fu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,p;if(t>=0?(l=t%4294967296|0,p=t/4294967296|0):(p=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,p=p+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(d,_,k){k.buf[k.pos++]=127&d|128,d>>>=7,k.buf[k.pos++]=127&d|128,d>>>=7,k.buf[k.pos++]=127&d|128,d>>>=7,k.buf[k.pos++]=127&d|128,k.buf[k.pos]=127&(d>>>=7)}(l,0,i),function(d,_){var k=(7&d)<<4;_.buf[_.pos++]|=k|((d>>>=3)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d)))))}(p,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,p,d){for(var _,k,T=0;T<p.length;T++){if((_=p.charCodeAt(T))>55295&&_<57344){if(!k){_>56319||T+1===p.length?(l[d++]=239,l[d++]=191,l[d++]=189):k=_;continue}if(_<56320){l[d++]=239,l[d++]=191,l[d++]=189,k=_;continue}_=k-55296<<10|_-56320|65536,k=null}else k&&(l[d++]=239,l[d++]=191,l[d++]=189,k=null);_<128?l[d++]=_:(_<2048?l[d++]=_>>6|192:(_<65536?l[d++]=_>>12|224:(l[d++]=_>>18|240,l[d++]=_>>12&63|128),l[d++]=_>>6&63|128),l[d++]=63&_|128)}return d}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&df(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),pf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),pf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&df(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Wr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Qy,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,$y,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,r_,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,e_,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,t_,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,i_,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,n_,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,o_,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,a_,t)},writeBytesField:function(e,t){this.writeTag(e,Wr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Wr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Wr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Wr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Wr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Wr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Wr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Wr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Wr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Wr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Wc=function(e,t){var i=t.pixelRatio,l=t.version,p=t.stretchX,d=t.stretchY,_=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=p,this.stretchY=d,this.content=_,this.version=l},ic={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};ic.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ic.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ic.tlbr.get=function(){return this.tl.concat(this.br)},ic.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Wc.prototype,ic);var nc=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var p=[];this.addImages(e,i,p),this.addImages(t,l,p);var d=yf(p),_=new Ao({width:d.w||1,height:d.h||1});for(var k in e){var T=e[k],z=i[k].paddedRect;Ao.copy(T.data,_,{x:0,y:0},{x:z.x+1,y:z.y+1},T.data)}for(var P in t){var D=t[P],O=l[P].paddedRect,q=O.x+1,Q=O.y+1,ee=D.data.width,ue=D.data.height;Ao.copy(D.data,_,{x:0,y:0},{x:q,y:Q},D.data),Ao.copy(D.data,_,{x:0,y:ue-1},{x:q,y:Q-1},{width:ee,height:1}),Ao.copy(D.data,_,{x:0,y:0},{x:q,y:Q+ue},{width:ee,height:1}),Ao.copy(D.data,_,{x:ee-1,y:0},{x:q-1,y:Q},{width:1,height:ue}),Ao.copy(D.data,_,{x:0,y:0},{x:q+ee,y:Q},{width:1,height:ue})}this.image=_,this.iconPositions=i,this.patternPositions=l};nc.prototype.addImages=function(e,t,i){for(var l in e){var p=e[l],d={x:0,y:0,w:p.data.width+2,h:p.data.height+2};i.push(d),t[l]=new Wc(d,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},nc.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},nc.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},at("ImagePosition",Wc),at("ImageAtlas",nc);var ea={horizontal:1,vertical:2,horizontalOnly:3},du=function(){this.scale=1,this.fontStack="",this.imageName=null};du.forText=function(e,t){var i=new du;return i.scale=e||1,i.fontStack=t,i},du.forImage=function(e){var t=new du;return t.imageName=e,t};var Jn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Hc(e,t,i,l,p,d,_,k,T,z,P,D,O,q,Q,ee){var ue,oe=Jn.fromFeature(e,p);D===ea.vertical&&oe.verticalizePunctuation();var de=Uo.processBidirectionalText,_e=Uo.processStyledBidirectionalText;if(de&&oe.sections.length===1){ue=[];for(var ve=0,Se=de(oe.toString(),rp(oe,z,d,t,l,q,Q));ve<Se.length;ve+=1){var Le=Se[ve],Ze=new Jn;Ze.text=Le,Ze.sections=oe.sections;for(var Qe=0;Qe<Le.length;Qe++)Ze.sectionIndex.push(0);ue.push(Ze)}}else if(_e){ue=[];for(var vt=0,st=_e(oe.text,oe.sectionIndex,rp(oe,z,d,t,l,q,Q));vt<st.length;vt+=1){var kt=st[vt],lt=new Jn;lt.text=kt[0],lt.sectionIndex=kt[1],lt.sections=oe.sections,ue.push(lt)}}else ue=function(yt,sr){for(var Yt=[],_r=yt.text,Et=0,br=0,ni=sr;br<ni.length;br+=1){var Si=ni[br];Yt.push(yt.substring(Et,Si)),Et=Si}return Et<_r.length&&Yt.push(yt.substring(Et,_r.length)),Yt}(oe,rp(oe,z,d,t,l,q,Q));var or=[],Bt={positionedLines:or,text:oe.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(yt,sr,Yt,_r,Et,br,ni,Si,yi,oi,ki,on){for(var an=0,Yn=-17,yn=0,Qn=0,Mi=Si==="right"?1:Si==="left"?0:.5,_n=0,pr=0,Nr=Et;pr<Nr.length;pr+=1){var Br=Nr[pr];Br.trim();var xr=Br.getMaxScale(),uo=24*(xr-1),Nn={positionedGlyphs:[],lineOffset:0};yt.positionedLines[_n]=Nn;var $r=Nn.positionedGlyphs,Fi=0;if(Br.length()){for(var Vn=0;Vn<Br.length();Vn++){var wr=Br.getSection(Vn),vs=Br.getSectionIndex(Vn),ta=Br.getCharCode(Vn),xs=0,Di=null,bs=null,Na=null,wu=24,Zl=!(yi===ea.horizontal||!ki&&!cs(ta)||ki&&(Jc[ta]||(Ks=ta,Ye.Arabic(Ks)||Ye["Arabic Supplement"](Ks)||Ye["Arabic Extended-A"](Ks)||Ye["Arabic Presentation Forms-A"](Ks)||Ye["Arabic Presentation Forms-B"](Ks))));if(wr.imageName){var Su=_r[wr.imageName];if(!Su)continue;Na=wr.imageName,yt.iconsInText=yt.iconsInText||!0,bs=Su.paddedRect;var Gs=Su.displaySize;wr.scale=24*wr.scale/on,xs=uo+(24-Gs[1]*wr.scale),wu=(Di={width:Gs[0],height:Gs[1],left:1,top:-3,advance:Zl?Gs[1]:Gs[0]}).advance;var ku=Zl?Gs[0]*wr.scale-24*xr:Gs[1]*wr.scale-24*xr;ku>0&&ku>Fi&&(Fi=ku)}else{var oh=Yt[wr.fontStack],Eu=oh&&oh[ta];if(Eu&&Eu.rect)bs=Eu.rect,Di=Eu.metrics;else{var sc=sr[wr.fontStack],ah=sc&&sc[ta];if(!ah)continue;Di=ah.metrics}xs=24*(xr-wr.scale)}Zl?(yt.verticalizable=!0,$r.push({glyph:ta,imageName:Na,x:an,y:Yn+xs,vertical:Zl,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:vs,metrics:Di,rect:bs}),an+=wu*wr.scale+oi):($r.push({glyph:ta,imageName:Na,x:an,y:Yn+xs,vertical:Zl,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:vs,metrics:Di,rect:bs}),an+=Di.advance*wr.scale+oi)}$r.length!==0&&(yn=Math.max(an-oi,yn),h_($r,0,$r.length-1,Mi,Fi)),an=0;var sh=br*xr+Fi;Nn.lineOffset=Math.max(Fi,uo),Yn+=sh,Qn=Math.max(sh,Qn),++_n}else Yn+=br,++_n}var Ks,lc=Yn- -17,Tu=ip(ni),ml=Tu.horizontalAlign,Iu=Tu.verticalAlign;(function(lh,uh,uc,cc,ch,hc,pc,fc,hh){var Au,ph=(uh-uc)*ch;Au=hc!==pc?-fc*cc- -17:(-cc*hh+.5)*pc;for(var zu=0,dc=lh;zu<dc.length;zu+=1)for(var Gl=0,mc=dc[zu].positionedGlyphs;Gl<mc.length;Gl+=1){var Cu=mc[Gl];Cu.x+=ph,Cu.y+=Au}})(yt.positionedLines,Mi,ml,Iu,yn,Qn,br,lc,Et.length),yt.top+=-Iu*lc,yt.bottom=yt.top+lc,yt.left+=-ml*yn,yt.right=yt.left+yn}(Bt,t,i,l,ue,_,k,T,D,z,O,ee),!function(yt){for(var sr=0,Yt=yt;sr<Yt.length;sr+=1)if(Yt[sr].positionedGlyphs.length!==0)return!1;return!0}(or)&&Bt}Jn.fromFeature=function(e,t){for(var i=new Jn,l=0;l<e.sections.length;l++){var p=e.sections[l];p.image?i.addImageSection(p):i.addTextSection(p,t)}return i},Jn.prototype.length=function(){return this.text.length},Jn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Jn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Jn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Jn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,p=e.charCodeAt(i-1)||null;t+=l&&al(l)&&!rc[e[i+1]]||p&&al(p)&&!rc[e[i-1]]||!rc[e[i]]?e[i]:rc[e[i]]}return t}(this.text)},Jn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Jc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Jc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},Jn.prototype.substring=function(e,t){var i=new Jn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},Jn.prototype.toString=function(){return this.text},Jn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},Jn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(du.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},Jn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(du.forImage(t)),this.sectionIndex.push(this.sections.length-1)):ot("Reached maximum number of images 6401")}else ot("Can't add FormattedSection with an empty image.")},Jn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Jc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qo={};function _f(e,t,i,l,p,d){if(t.imageName){var _=l[t.imageName];return _?_.displaySize[0]*t.scale*24/d+p:0}var k=i[t.fontStack],T=k&&k[e];return T?T.metrics.advance*t.scale+p:0}function gf(e,t,i,l){var p=Math.pow(e-t,2);return l?e<t?p/2:2*p:p+Math.abs(i)*i}function c_(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function vf(e,t,i,l,p,d){for(var _=null,k=gf(t,i,p,d),T=0,z=l;T<z.length;T+=1){var P=z[T],D=gf(t-P.x,i,p,d)+P.badness;D<=k&&(_=P,k=D)}return{index:e,x:t,priorBreak:_,badness:k}}function rp(e,t,i,l,p,d,_){if(d!=="point")return[];if(!e)return[];for(var k,T=[],z=function(ue,oe,de,_e,ve,Se){for(var Le=0,Ze=0;Ze<ue.length();Ze++){var Qe=ue.getSection(Ze);Le+=_f(ue.getCharCode(Ze),Qe,_e,ve,oe,Se)}return Le/Math.max(1,Math.ceil(Le/de))}(e,t,i,l,p,_),P=e.text.indexOf("\u200B")>=0,D=0,O=0;O<e.length();O++){var q=e.getSection(O),Q=e.getCharCode(O);if(Jc[Q]||(D+=_f(Q,q,l,p,t,_)),O<e.length()-1){var ee=!((k=Q)<11904||!(Ye["Bopomofo Extended"](k)||Ye.Bopomofo(k)||Ye["CJK Compatibility Forms"](k)||Ye["CJK Compatibility Ideographs"](k)||Ye["CJK Compatibility"](k)||Ye["CJK Radicals Supplement"](k)||Ye["CJK Strokes"](k)||Ye["CJK Symbols and Punctuation"](k)||Ye["CJK Unified Ideographs Extension A"](k)||Ye["CJK Unified Ideographs"](k)||Ye["Enclosed CJK Letters and Months"](k)||Ye["Halfwidth and Fullwidth Forms"](k)||Ye.Hiragana(k)||Ye["Ideographic Description Characters"](k)||Ye["Kangxi Radicals"](k)||Ye["Katakana Phonetic Extensions"](k)||Ye.Katakana(k)||Ye["Vertical Forms"](k)||Ye["Yi Radicals"](k)||Ye["Yi Syllables"](k)));(qo[Q]||ee||q.imageName)&&T.push(vf(O+1,D,z,T,c_(Q,e.getCharCode(O+1),ee&&P),!1))}}return function ue(oe){return oe?ue(oe.priorBreak).concat(oe.index):[]}(vf(e.length(),D,z,T,0,!0))}function ip(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function h_(e,t,i,l,p){if(l||p)for(var d=e[i],_=(e[i].x+d.metrics.advance*d.scale)*l,k=t;k<=i;k++)e[k].x-=_,e[k].y+=p}function xf(e,t,i,l,p,d){var _,k=e.image;if(k.content){var T=k.content,z=k.pixelRatio||1;_=[T[0]/z,T[1]/z,k.displaySize[0]-T[2]/z,k.displaySize[1]-T[3]/z]}var P,D,O,q,Q=t.left*d,ee=t.right*d;i==="width"||i==="both"?(q=p[0]+Q-l[3],D=p[0]+ee+l[1]):D=(q=p[0]+(Q+ee-k.displaySize[0])/2)+k.displaySize[0];var ue=t.top*d,oe=t.bottom*d;return i==="height"||i==="both"?(P=p[1]+ue-l[0],O=p[1]+oe+l[2]):O=(P=p[1]+(ue+oe-k.displaySize[1])/2)+k.displaySize[1],{image:k,top:P,right:D,bottom:O,left:q,collisionPadding:_}}qo[10]=!0,qo[32]=!0,qo[38]=!0,qo[40]=!0,qo[41]=!0,qo[43]=!0,qo[45]=!0,qo[47]=!0,qo[173]=!0,qo[183]=!0,qo[8203]=!0,qo[8208]=!0,qo[8211]=!0,qo[8231]=!0;var mu=function(e){function t(i,l,p,d){e.call(this,i,l),this.angle=p,d!==void 0&&(this.segment=d)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(L);function np(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new cr(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,p=i.interpolationType,d=0;d<l.length&&l[d]<=e;)d++;for(var _=d=Math.max(0,d-1);_<l.length&&l[_]<e+1;)_++;_=Math.min(l.length-1,_);var k=l[d],T=l[_];return i.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:k,maxZoom:T,minSize:i.evaluate(new cr(k)),maxSize:i.evaluate(new cr(T)),interpolationType:p}}function bf(e,t,i){var l=t.uSize,p=i.lowerSize;return e.kind==="source"?p/128:e.kind==="composite"?qr(p/128,i.upperSize/128,t.uSizeT):l}function wf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var p=e.interpolationType,d=p?Ie(Bi.interpolationFactor(p,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=qr(e.minSize,e.maxSize,d):i=d}return{uSizeT:i,uSize:l}}at("Anchor",mu);var p_=Object.freeze({__proto__:null,getSizeData:np,evaluateSizeForFeature:bf,evaluateSizeForZoom:wf,SIZE_PACK_FACTOR:128});function Sf(e,t,i,l,p){if(t.segment===void 0)return!0;for(var d=t,_=t.segment+1,k=0;k>-i/2;){if(--_<0)return!1;k-=e[_].dist(d),d=e[_]}k+=e[_].dist(e[_+1]),_++;for(var T=[],z=0;k<i/2;){var P=e[_],D=e[_+1];if(!D)return!1;var O=e[_-1].angleTo(P)-P.angleTo(D);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:k,angleDelta:O}),z+=O;k-T[0].distance>l;)z-=T.shift().angleDelta;if(z>p)return!1;_++,k+=P.dist(D)}return!0}function kf(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Ef(e,t,i){return e?.6*t*i:0}function Tf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function f_(e,t,i,l,p,d){for(var _=Ef(i,p,d),k=Tf(i,l)*d,T=0,z=kf(e)/2,P=0;P<e.length-1;P++){var D=e[P],O=e[P+1],q=D.dist(O);if(T+q>z){var Q=(z-T)/q,ee=qr(D.x,O.x,Q),ue=qr(D.y,O.y,Q),oe=new mu(ee,ue,O.angleTo(D),P);return oe._round(),!_||Sf(e,oe,k,_,t)?oe:void 0}T+=q}}function d_(e,t,i,l,p,d,_,k,T){var z=Ef(l,d,_),P=Tf(l,p),D=P*_,O=e[0].x===0||e[0].x===T||e[0].y===0||e[0].y===T;return t-D<t/4&&(t=D+t/4),function q(Q,ee,ue,oe,de,_e,ve,Se,Le){for(var Ze=_e/2,Qe=kf(Q),vt=0,st=ee-ue,kt=[],lt=0;lt<Q.length-1;lt++){for(var or=Q[lt],Bt=Q[lt+1],yt=or.dist(Bt),sr=Bt.angleTo(or);st+ue<vt+yt;){var Yt=((st+=ue)-vt)/yt,_r=qr(or.x,Bt.x,Yt),Et=qr(or.y,Bt.y,Yt);if(_r>=0&&_r<Le&&Et>=0&&Et<Le&&st-Ze>=0&&st+Ze<=Qe){var br=new mu(_r,Et,sr,lt);br._round(),oe&&!Sf(Q,br,_e,oe,de)||kt.push(br)}}vt+=yt}return Se||kt.length||ve||(kt=q(Q,vt/2,ue,oe,de,_e,ve,!0,Le)),kt}(e,O?t/2*k%t:(P/2+2*d)*_*k%t,t,z,i,D,O,!1,T)}function If(e,t,i,l,p){for(var d=[],_=0;_<e.length;_++)for(var k=e[_],T=void 0,z=0;z<k.length-1;z++){var P=k[z],D=k[z+1];P.x<t&&D.x<t||(P.x<t?P=new L(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x<t&&(D=new L(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y<i&&D.y<i||(P.y<i?P=new L(P.x+(i-P.y)/(D.y-P.y)*(D.x-P.x),i)._round():D.y<i&&(D=new L(P.x+(i-P.y)/(D.y-P.y)*(D.x-P.x),i)._round()),P.x>=l&&D.x>=l||(P.x>=l?P=new L(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x>=l&&(D=new L(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y>=p&&D.y>=p||(P.y>=p?P=new L(P.x+(p-P.y)/(D.y-P.y)*(D.x-P.x),p)._round():D.y>=p&&(D=new L(P.x+(p-P.y)/(D.y-P.y)*(D.x-P.x),p)._round()),T&&P.equals(T[T.length-1])||d.push(T=[P]),T.push(D)))))}return d}function Af(e,t,i,l){var p=[],d=e.image,_=d.pixelRatio,k=d.paddedRect.w-2,T=d.paddedRect.h-2,z=e.right-e.left,P=e.bottom-e.top,D=d.stretchX||[[0,k]],O=d.stretchY||[[0,T]],q=function(_r,Et){return _r+Et[1]-Et[0]},Q=D.reduce(q,0),ee=O.reduce(q,0),ue=k-Q,oe=T-ee,de=0,_e=Q,ve=0,Se=ee,Le=0,Ze=ue,Qe=0,vt=oe;if(d.content&&l){var st=d.content;de=Yc(D,0,st[0]),ve=Yc(O,0,st[1]),_e=Yc(D,st[0],st[2]),Se=Yc(O,st[1],st[3]),Le=st[0]-de,Qe=st[1]-ve,Ze=st[2]-st[0]-_e,vt=st[3]-st[1]-Se}var kt=function(_r,Et,br,ni){var Si=Qc(_r.stretch-de,_e,z,e.left),yi=$c(_r.fixed-Le,Ze,_r.stretch,Q),oi=Qc(Et.stretch-ve,Se,P,e.top),ki=$c(Et.fixed-Qe,vt,Et.stretch,ee),on=Qc(br.stretch-de,_e,z,e.left),an=$c(br.fixed-Le,Ze,br.stretch,Q),Yn=Qc(ni.stretch-ve,Se,P,e.top),yn=$c(ni.fixed-Qe,vt,ni.stretch,ee),Qn=new L(Si,oi),Mi=new L(on,oi),_n=new L(on,Yn),pr=new L(Si,Yn),Nr=new L(yi/_,ki/_),Br=new L(an/_,yn/_),xr=t*Math.PI/180;if(xr){var uo=Math.sin(xr),Nn=Math.cos(xr),$r=[Nn,-uo,uo,Nn];Qn._matMult($r),Mi._matMult($r),pr._matMult($r),_n._matMult($r)}var Fi=_r.stretch+_r.fixed,Vn=Et.stretch+Et.fixed;return{tl:Qn,tr:Mi,bl:pr,br:_n,tex:{x:d.paddedRect.x+1+Fi,y:d.paddedRect.y+1+Vn,w:br.stretch+br.fixed-Fi,h:ni.stretch+ni.fixed-Vn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Nr,pixelOffsetBR:Br,minFontScaleX:Ze/_/z,minFontScaleY:vt/_/P,isSDF:i}};if(l&&(d.stretchX||d.stretchY))for(var lt=zf(D,ue,Q),or=zf(O,oe,ee),Bt=0;Bt<lt.length-1;Bt++)for(var yt=lt[Bt],sr=lt[Bt+1],Yt=0;Yt<or.length-1;Yt++)p.push(kt(yt,or[Yt],sr,or[Yt+1]));else p.push(kt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:T+1}));return p}function Yc(e,t,i){for(var l=0,p=0,d=e;p<d.length;p+=1){var _=d[p];l+=Math.max(t,Math.min(i,_[1]))-Math.max(t,Math.min(i,_[0]))}return l}function zf(e,t,i){for(var l=[{fixed:-1,stretch:0}],p=0,d=e;p<d.length;p+=1){var _=d[p],k=_[0],T=_[1],z=l[l.length-1];l.push({fixed:k-z.stretch,stretch:z.stretch}),l.push({fixed:k-z.stretch,stretch:z.stretch+(T-k)})}return l.push({fixed:t+1,stretch:i}),l}function Qc(e,t,i,l){return e/t*i+l}function $c(e,t,i,l){return e-t*i/l}var eh=function(e,t,i,l,p,d,_,k,T,z){if(this.boxStartIndex=e.length,T){var P=d.top,D=d.bottom,O=d.collisionPadding;O&&(P-=O[1],D+=O[3]);var q=D-P;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{var Q=d.top*_-k,ee=d.bottom*_+k,ue=d.left*_-k,oe=d.right*_+k,de=d.collisionPadding;if(de&&(ue-=de[0]*_,Q-=de[1]*_,oe+=de[2]*_,ee+=de[3]*_),z){var _e=new L(ue,Q),ve=new L(oe,Q),Se=new L(ue,ee),Le=new L(oe,ee),Ze=z*Math.PI/180;_e._rotate(Ze),ve._rotate(Ze),Se._rotate(Ze),Le._rotate(Ze),ue=Math.min(_e.x,ve.x,Se.x,Le.x),oe=Math.max(_e.x,ve.x,Se.x,Le.x),Q=Math.min(_e.y,ve.y,Se.y,Le.y),ee=Math.max(_e.y,ve.y,Se.y,Le.y)}e.emplaceBack(t.x,t.y,ue,Q,oe,ee,i,l,p)}this.boxEndIndex=e.length},yu=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=m_),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function m_(e,t){return e<t?-1:e>t?1:0}function y_(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,p=1/0,d=-1/0,_=-1/0,k=e[0],T=0;T<k.length;T++){var z=k[T];(!T||z.x<l)&&(l=z.x),(!T||z.y<p)&&(p=z.y),(!T||z.x>d)&&(d=z.x),(!T||z.y>_)&&(_=z.y)}var P=Math.min(d-l,_-p),D=P/2,O=new yu([],__);if(P===0)return new L(l,p);for(var q=l;q<d;q+=P)for(var Q=p;Q<_;Q+=P)O.push(new _u(q+D,Q+D,D,e));for(var ee=function(de){for(var _e=0,ve=0,Se=0,Le=de[0],Ze=0,Qe=Le.length,vt=Qe-1;Ze<Qe;vt=Ze++){var st=Le[Ze],kt=Le[vt],lt=st.x*kt.y-kt.x*st.y;ve+=(st.x+kt.x)*lt,Se+=(st.y+kt.y)*lt,_e+=3*lt}return new _u(ve/_e,Se/_e,0,de)}(e),ue=O.length;O.length;){var oe=O.pop();(oe.d>ee.d||!ee.d)&&(ee=oe,i&&console.log("found best %d after %d probes",Math.round(1e4*oe.d)/1e4,ue)),oe.max-ee.d<=t||(O.push(new _u(oe.p.x-(D=oe.h/2),oe.p.y-D,D,e)),O.push(new _u(oe.p.x+D,oe.p.y-D,D,e)),O.push(new _u(oe.p.x-D,oe.p.y+D,D,e)),O.push(new _u(oe.p.x+D,oe.p.y+D,D,e)),ue+=4)}return i&&(console.log("num probes: "+ue),console.log("best distance: "+ee.d)),ee.p}function __(e,t){return t.max-e.max}function _u(e,t,i,l){this.p=new L(e,t),this.h=i,this.d=function(p,d){for(var _=!1,k=1/0,T=0;T<d.length;T++)for(var z=d[T],P=0,D=z.length,O=D-1;P<D;O=P++){var q=z[P],Q=z[O];q.y>p.y!=Q.y>p.y&&p.x<(Q.x-q.x)*(p.y-q.y)/(Q.y-q.y)+q.x&&(_=!_),k=Math.min(k,hl(p,q,Q))}return(_?1:-1)*Math.sqrt(k)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}yu.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},yu.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},yu.prototype.peek=function(){return this.data[0]},yu.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var p=e-1>>1,d=t[p];if(i(l,d)>=0)break;t[e]=d,e=p}t[e]=l},yu.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,p=t[e];e<l;){var d=1+(e<<1),_=t[d],k=d+1;if(k<this.length&&i(t[k],_)<0&&(d=k,_=t[k]),i(_,p)>=0)break;t[e]=_,e=d}t[e]=p};var op=Number.POSITIVE_INFINITY;function Cf(e,t){return t[1]!==op?function(i,l,p){var d=0,_=0;switch(l=Math.abs(l),p=Math.abs(p),i){case"top-right":case"top-left":case"top":_=p-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-p}switch(i){case"top-right":case"bottom-right":case"right":d=-l;break;case"top-left":case"bottom-left":case"left":d=l}return[d,_]}(e,t[0],t[1]):function(i,l){var p=0,d=0;l<0&&(l=0);var _=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":d=_-7;break;case"bottom-right":case"bottom-left":d=7-_;break;case"bottom":d=7-l;break;case"top":d=l-7}switch(i){case"top-right":case"bottom-right":p=-_;break;case"top-left":case"bottom-left":p=_;break;case"left":p=l;break;case"right":p=-l}return[p,d]}(e,t[0])}function ap(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Pf(e,t,i,l,p,d,_,k,T,z,P,D,O,q,Q){var ee=function(ve,Se,Le,Ze,Qe,vt,st,kt){for(var lt=Ze.layout.get("text-rotate").evaluate(vt,{})*Math.PI/180,or=[],Bt=0,yt=Se.positionedLines;Bt<yt.length;Bt+=1)for(var sr=yt[Bt],Yt=0,_r=sr.positionedGlyphs;Yt<_r.length;Yt+=1){var Et=_r[Yt];if(Et.rect){var br=Et.rect||{},ni=4,Si=!0,yi=1,oi=0,ki=(Qe||kt)&&Et.vertical,on=Et.metrics.advance*Et.scale/2;if(kt&&Se.verticalizable&&(oi=sr.lineOffset/2-(Et.imageName?-(24-Et.metrics.width*Et.scale)/2:24*(Et.scale-1))),Et.imageName){var an=st[Et.imageName];Si=an.sdf,ni=1/(yi=an.pixelRatio)}var Yn=Qe?[Et.x+on,Et.y]:[0,0],yn=Qe?[0,0]:[Et.x+on+Le[0],Et.y+Le[1]-oi],Qn=[0,0];ki&&(Qn=yn,yn=[0,0]);var Mi=(Et.metrics.left-ni)*Et.scale-on+yn[0],_n=(-Et.metrics.top-ni)*Et.scale+yn[1],pr=Mi+br.w*Et.scale/yi,Nr=_n+br.h*Et.scale/yi,Br=new L(Mi,_n),xr=new L(pr,_n),uo=new L(Mi,Nr),Nn=new L(pr,Nr);if(ki){var $r=new L(-on,on- -17),Fi=-Math.PI/2,Vn=12-on,wr=new L(22-Vn,-(Et.imageName?Vn:0)),vs=new(Function.prototype.bind.apply(L,[null].concat(Qn)));Br._rotateAround(Fi,$r)._add(wr)._add(vs),xr._rotateAround(Fi,$r)._add(wr)._add(vs),uo._rotateAround(Fi,$r)._add(wr)._add(vs),Nn._rotateAround(Fi,$r)._add(wr)._add(vs)}if(lt){var ta=Math.sin(lt),xs=Math.cos(lt),Di=[xs,-ta,ta,xs];Br._matMult(Di),xr._matMult(Di),uo._matMult(Di),Nn._matMult(Di)}var bs=new L(0,0),Na=new L(0,0);or.push({tl:Br,tr:xr,bl:uo,br:Nn,tex:br,writingMode:Se.writingMode,glyphOffset:Yn,sectionIndex:Et.sectionIndex,isSDF:Si,pixelOffsetTL:bs,pixelOffsetBR:Na,minFontScaleX:0,minFontScaleY:0})}}return or}(0,i,k,p,d,_,l,e.allowVerticalPlacement),ue=e.textSizeData,oe=null;ue.kind==="source"?(oe=[128*p.layout.get("text-size").evaluate(_,{})])[0]>32640&&ot(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ue.kind==="composite"&&((oe=[128*q.compositeTextSizes[0].evaluate(_,{},Q),128*q.compositeTextSizes[1].evaluate(_,{},Q)])[0]>32640||oe[1]>32640)&&ot(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ee,oe,k,d,_,z,t,T.lineStartIndex,T.lineLength,O,Q);for(var de=0,_e=P;de<_e.length;de+=1)D[_e[de]]=e.text.placedSymbolArray.length-1;return 4*ee.length}function Mf(e){for(var t in e)return e[t];return null}function g_(e,t,i,l){var p=e.compareText;if(t in p){for(var d=p[t],_=d.length-1;_>=0;_--)if(l.dist(d[_])<i)return!0}else p[t]=[];return p[t].push(l),!1}var v_=hu.VectorTileFeature.types,x_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function th(e,t,i,l,p,d,_,k,T,z,P,D,O){var q=k?Math.min(32640,Math.round(k[0])):0,Q=k?Math.min(32640,Math.round(k[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*p),d,_,(q<<1)+(T?1:0),Q,16*z,16*P,256*D,256*O)}function sp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function b_(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(ya(i[t].text))return!0;return!1}var gu=function(e){this.layoutVertexArray=new nu,this.indexArray=new fs,this.programConfigurations=e,this.segments=new G,this.dynamicLayoutVertexArray=new ll,this.opacityVertexArray=new Ll,this.placedSymbolArray=new u};gu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},gu.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xy.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Wy.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,x_,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},gu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},at("SymbolBuffers",gu);var oc=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new G,this.collisionVertexArray=new Xu};oc.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hy.members,!0)},oc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},at("CollisionBuffers",oc);var Fr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jo([]),this.placementViewportMatrix=jo([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=np(this.zoom,t["text-size"]),this.iconSizeData=np(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),p=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(d){return ea[d]})),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id}),this.sourceID=e.sourceID};Fr.prototype.createArrays=function(){this.text=new gu(new Lt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new gu(new Lt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new E,this.symbolInstances=new w},Fr.prototype.calculateGlyphDependencies=function(e,t,i,l,p){for(var d=0;d<e.length;d++)if(t[e.charCodeAt(d)]=!0,(i||l)&&p){var _=rc[e.charAt(d)];_&&(t[_.charCodeAt(0)]=!0)}},Fr.prototype.populate=function(e,t,i){var l=this.layers[0],p=l.layout,d=p.get("text-font"),_=p.get("text-field"),k=p.get("icon-image"),T=(_.value.kind!=="constant"||_.value.value instanceof Pr&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(d.value.kind!=="constant"||d.value.value.length>0),z=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,P=p.get("symbol-sort-key");if(this.features=[],T||z){for(var D=t.iconDependencies,O=t.glyphDependencies,q=t.availableImages,Q=new cr(this.zoom),ee=0,ue=e;ee<ue.length;ee+=1){var oe=ue[ee],de=oe.feature,_e=oe.id,ve=oe.index,Se=oe.sourceLayerIndex,Le=l._featureFilter.needGeometry,Ze=Pi(de,Le);if(l._featureFilter.filter(Q,Ze,i)){Le||(Ze.geometry=mi(de));var Qe=void 0;if(T){var vt=l.getValueAndResolveTokens("text-field",Ze,i,q),st=Pr.factory(vt);b_(st)&&(this.hasRTLText=!0),(!this.hasRTLText||qu()==="unavailable"||this.hasRTLText&&Uo.isParsed())&&(Qe=Yy(st,l,Ze))}var kt=void 0;if(z){var lt=l.getValueAndResolveTokens("icon-image",Ze,i,q);kt=lt instanceof Ur?lt:Ur.fromString(lt)}if(Qe||kt){var or=this.sortFeaturesByKey?P.evaluate(Ze,{},i):void 0;if(this.features.push({id:_e,text:Qe,icon:kt,index:ve,sourceLayerIndex:Se,geometry:Ze.geometry,properties:de.properties,type:v_[de.type],sortKey:or}),kt&&(D[kt.name]=!0),Qe){var Bt=d.evaluate(Ze,{},i).join(","),yt=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ea.vertical)>=0;for(var sr=0,Yt=Qe.sections;sr<Yt.length;sr+=1){var _r=Yt[sr];if(_r.image)D[_r.image.name]=!0;else{var Et=ol(Qe.toString()),br=_r.fontStack||Bt,ni=O[br]=O[br]||{};this.calculateGlyphDependencies(_r.text,ni,yt,this.allowVerticalPlacement,Et)}}}}}}p.get("symbol-placement")==="line"&&(this.features=function(Si){var yi={},oi={},ki=[],on=0;function an($r){ki.push(Si[$r]),on++}function Yn($r,Fi,Vn){var wr=oi[$r];return delete oi[$r],oi[Fi]=wr,ki[wr].geometry[0].pop(),ki[wr].geometry[0]=ki[wr].geometry[0].concat(Vn[0]),wr}function yn($r,Fi,Vn){var wr=yi[Fi];return delete yi[Fi],yi[$r]=wr,ki[wr].geometry[0].shift(),ki[wr].geometry[0]=Vn[0].concat(ki[wr].geometry[0]),wr}function Qn($r,Fi,Vn){var wr=Vn?Fi[0][Fi[0].length-1]:Fi[0][0];return $r+":"+wr.x+":"+wr.y}for(var Mi=0;Mi<Si.length;Mi++){var _n=Si[Mi],pr=_n.geometry,Nr=_n.text?_n.text.toString():null;if(Nr){var Br=Qn(Nr,pr),xr=Qn(Nr,pr,!0);if(Br in oi&&xr in yi&&oi[Br]!==yi[xr]){var uo=yn(Br,xr,pr),Nn=Yn(Br,xr,ki[uo].geometry);delete yi[Br],delete oi[xr],oi[Qn(Nr,ki[Nn].geometry,!0)]=Nn,ki[uo].geometry=null}else Br in oi?Yn(Br,xr,pr):xr in yi?yn(Br,xr,pr):(an(Mi),yi[Br]=on-1,oi[xr]=on-1)}else an(Mi)}return ki.filter(function($r){return $r.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Si,yi){return Si.sortKey-yi.sortKey})}},Fr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Fr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Fr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Fr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Fr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Fr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Fr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),p=e.dist(t[e.segment]),d={},_=e.segment+1;_<t.length;_++)d[_]={x:t[_].x,y:t[_].y,tileUnitDistanceFromAnchor:l},_<t.length-1&&(l+=t[_+1].dist(t[_]));for(var k=e.segment||0;k>=0;k--)d[k]={x:t[k].x,y:t[k].y,tileUnitDistanceFromAnchor:p},k>0&&(p+=t[k-1].dist(t[k]));for(var T=0;T<t.length;T++){var z=d[T];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Fr.prototype.addSymbols=function(e,t,i,l,p,d,_,k,T,z,P,D){for(var O=e.indexArray,q=e.layoutVertexArray,Q=e.segments.prepareSegment(4*t.length,q,O,this.canOverlap?d.sortKey:void 0),ee=this.glyphOffsetArray.length,ue=Q.vertexLength,oe=this.allowVerticalPlacement&&_===ea.vertical?Math.PI/2:0,de=d.text&&d.text.sections,_e=0;_e<t.length;_e++){var ve=t[_e],Se=ve.tl,Le=ve.tr,Ze=ve.bl,Qe=ve.br,vt=ve.tex,st=ve.pixelOffsetTL,kt=ve.pixelOffsetBR,lt=ve.minFontScaleX,or=ve.minFontScaleY,Bt=ve.glyphOffset,yt=ve.isSDF,sr=ve.sectionIndex,Yt=Q.vertexLength,_r=Bt[1];th(q,k.x,k.y,Se.x,_r+Se.y,vt.x,vt.y,i,yt,st.x,st.y,lt,or),th(q,k.x,k.y,Le.x,_r+Le.y,vt.x+vt.w,vt.y,i,yt,kt.x,st.y,lt,or),th(q,k.x,k.y,Ze.x,_r+Ze.y,vt.x,vt.y+vt.h,i,yt,st.x,kt.y,lt,or),th(q,k.x,k.y,Qe.x,_r+Qe.y,vt.x+vt.w,vt.y+vt.h,i,yt,kt.x,kt.y,lt,or),sp(e.dynamicLayoutVertexArray,k,oe),O.emplaceBack(Yt,Yt+1,Yt+2),O.emplaceBack(Yt+1,Yt+2,Yt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Bt[0]),_e!==t.length-1&&sr===t[_e+1].sectionIndex||e.programConfigurations.populatePaintArrays(q.length,d,d.index,{},D,de&&de[sr])}e.placedSymbolArray.emplaceBack(k.x,k.y,ee,this.glyphOffsetArray.length-ee,ue,T,z,k.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],_,0,!1,0,P)},Fr.prototype._addCollisionDebugVertex=function(e,t,i,l,p,d){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,p,Math.round(d.x),Math.round(d.y))},Fr.prototype.addCollisionDebugVertices=function(e,t,i,l,p,d,_){var k=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),T=k.vertexLength,z=p.layoutVertexArray,P=p.collisionVertexArray,D=_.anchorX,O=_.anchorY;this._addCollisionDebugVertex(z,P,d,D,O,new L(e,t)),this._addCollisionDebugVertex(z,P,d,D,O,new L(i,t)),this._addCollisionDebugVertex(z,P,d,D,O,new L(i,l)),this._addCollisionDebugVertex(z,P,d,D,O,new L(e,l)),k.vertexLength+=4;var q=p.indexArray;q.emplaceBack(T,T+1),q.emplaceBack(T+1,T+2),q.emplaceBack(T+2,T+3),q.emplaceBack(T+3,T),k.primitiveLength+=4},Fr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var p=e;p<t;p++){var d=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(d.x1,d.y1,d.x2,d.y2,l?this.textCollisionBox:this.iconCollisionBox,d.anchorPoint,i)}},Fr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new oc(ul,cf.members,Rl),this.iconCollisionBox=new oc(ul,cf.members,Rl);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Fr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,p,d,_,k,T){for(var z={},P=t;P<i;P++){var D=e.get(P);z.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},z.textFeatureIndex=D.featureIndex;break}for(var O=l;O<p;O++){var q=e.get(O);z.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},z.verticalTextFeatureIndex=q.featureIndex;break}for(var Q=d;Q<_;Q++){var ee=e.get(Q);z.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},z.iconFeatureIndex=ee.featureIndex;break}for(var ue=k;ue<T;ue++){var oe=e.get(ue);z.verticalIconBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},z.verticalIconFeatureIndex=oe.featureIndex;break}return z},Fr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Fr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Fr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Fr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Fr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Fr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Fr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,p=i.vertexStartIndex;p<l;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)},Fr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],p=[],d=[],_=0;_<this.symbolInstances.length;++_){d.push(_);var k=this.symbolInstances.get(_);l.push(0|Math.round(t*k.anchorX+i*k.anchorY)),p.push(k.featureIndex)}return d.sort(function(T,z){return l[T]-l[z]||p[z]-p[T]}),d},Fr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Fr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var p=this.symbolInstances.get(l[i]);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(function(d,_,k){d>=0&&k.indexOf(d)===_&&t.addIndicesForPlacedSymbol(t.text,d)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},at("SymbolBucket",Fr,{omit:["layers","collisionBoxArray","features","compareText"]}),Fr.MAX_GLYPHS=65535,Fr.addDynamicAttributes=sp;var w_=new In({"symbol-placement":new wt(U.layout_symbol["symbol-placement"]),"symbol-spacing":new wt(U.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wt(U.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mt(U.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wt(U.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wt(U.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new wt(U.layout_symbol["icon-ignore-placement"]),"icon-optional":new wt(U.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wt(U.layout_symbol["icon-rotation-alignment"]),"icon-size":new mt(U.layout_symbol["icon-size"]),"icon-text-fit":new wt(U.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wt(U.layout_symbol["icon-text-fit-padding"]),"icon-image":new mt(U.layout_symbol["icon-image"]),"icon-rotate":new mt(U.layout_symbol["icon-rotate"]),"icon-padding":new wt(U.layout_symbol["icon-padding"]),"icon-keep-upright":new wt(U.layout_symbol["icon-keep-upright"]),"icon-offset":new mt(U.layout_symbol["icon-offset"]),"icon-anchor":new mt(U.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wt(U.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wt(U.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wt(U.layout_symbol["text-rotation-alignment"]),"text-field":new mt(U.layout_symbol["text-field"]),"text-font":new mt(U.layout_symbol["text-font"]),"text-size":new mt(U.layout_symbol["text-size"]),"text-max-width":new mt(U.layout_symbol["text-max-width"]),"text-line-height":new wt(U.layout_symbol["text-line-height"]),"text-letter-spacing":new mt(U.layout_symbol["text-letter-spacing"]),"text-justify":new mt(U.layout_symbol["text-justify"]),"text-radial-offset":new mt(U.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wt(U.layout_symbol["text-variable-anchor"]),"text-anchor":new mt(U.layout_symbol["text-anchor"]),"text-max-angle":new wt(U.layout_symbol["text-max-angle"]),"text-writing-mode":new wt(U.layout_symbol["text-writing-mode"]),"text-rotate":new mt(U.layout_symbol["text-rotate"]),"text-padding":new wt(U.layout_symbol["text-padding"]),"text-keep-upright":new wt(U.layout_symbol["text-keep-upright"]),"text-transform":new mt(U.layout_symbol["text-transform"]),"text-offset":new mt(U.layout_symbol["text-offset"]),"text-allow-overlap":new wt(U.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new wt(U.layout_symbol["text-ignore-placement"]),"text-optional":new wt(U.layout_symbol["text-optional"])}),lp={paint:new In({"icon-opacity":new mt(U.paint_symbol["icon-opacity"]),"icon-color":new mt(U.paint_symbol["icon-color"]),"icon-halo-color":new mt(U.paint_symbol["icon-halo-color"]),"icon-halo-width":new mt(U.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mt(U.paint_symbol["icon-halo-blur"]),"icon-translate":new wt(U.paint_symbol["icon-translate"]),"icon-translate-anchor":new wt(U.paint_symbol["icon-translate-anchor"]),"text-opacity":new mt(U.paint_symbol["text-opacity"]),"text-color":new mt(U.paint_symbol["text-color"],{runtimeType:Xe,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new mt(U.paint_symbol["text-halo-color"]),"text-halo-width":new mt(U.paint_symbol["text-halo-width"]),"text-halo-blur":new mt(U.paint_symbol["text-halo-blur"]),"text-translate":new wt(U.paint_symbol["text-translate"]),"text-translate-anchor":new wt(U.paint_symbol["text-translate-anchor"])}),layout:w_},vu=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:it,this.defaultValue=e};vu.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},vu.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},vu.prototype.outputDefined=function(){return!1},vu.prototype.serialize=function(){return null},at("FormatSectionOverride",vu,{omit:["defaultValue"]});var S_=function(e){function t(i){e.call(this,i,lp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var p=this.layout.get("text-writing-mode");if(p){for(var d=[],_=0,k=p;_<k.length;_+=1){var T=k[_];d.indexOf(T)<0&&d.push(T)}this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,p,d){var _=this.layout.get(i).evaluate(l,{},p,d),k=this._unevaluatedLayout._values[i];return k.isDataDriven()||Oo(k.value)||!_?_:function(T,z){return z.replace(/{([^{}]+)}/g,function(P,D){return D in T?String(T[D]):""})}(l.properties,_)},t.prototype.createBucket=function(i){return new Fr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=lp.paint.overridableProperties;i<l.length;i+=1){var p=l[i];if(t.hasPaintOverride(this.layout,p)){var d,_=this.paint.get(p),k=new vu(_),T=new vo(k,_.property.specification);d=_.value.kind==="constant"||_.value.kind==="source"?new No("source",T):new xo("composite",T,_.value.zoomStops,_.value._interpolationType),this.paint._values[p]=new Xn(_.property,d,_.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var p=i.get("text-field"),d=lp.paint.properties[l],_=!1,k=function(P){for(var D=0,O=P;D<O.length;D+=1)if(d.overrides&&d.overrides.hasOverride(O[D]))return void(_=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Pr)k(p.value.value.sections);else if(p.value.kind==="source"){var T=function(P){_||(P instanceof di&&Mr(P.value)===dr?k(P.value.sections):P instanceof Cn?k(P.sections):P.eachChild(T))},z=p.value;z._styleExpression&&T(z._styleExpression.expression)}return _},t}(Ra),k_={paint:new In({"background-color":new wt(U.paint_background["background-color"]),"background-pattern":new Wn(U.paint_background["background-pattern"]),"background-opacity":new wt(U.paint_background["background-opacity"])})},E_=function(e){function t(i){e.call(this,i,k_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ra),T_={paint:new In({"raster-opacity":new wt(U.paint_raster["raster-opacity"]),"raster-hue-rotate":new wt(U.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wt(U.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wt(U.paint_raster["raster-brightness-max"]),"raster-saturation":new wt(U.paint_raster["raster-saturation"]),"raster-contrast":new wt(U.paint_raster["raster-contrast"]),"raster-resampling":new wt(U.paint_raster["raster-resampling"]),"raster-fade-duration":new wt(U.paint_raster["raster-fade-duration"])})},I_=function(e){function t(i){e.call(this,i,T_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ra),A_=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Ra),z_={circle:Kh,heatmap:py,hillshade:dy,fill:Py,"fill-extrusion":Vy,line:Ky,symbol:S_,background:E_,raster:I_},Df=N.HTMLImageElement,Lf=N.HTMLCanvasElement,Rf=N.HTMLVideoElement,Bf=N.ImageData,rh=N.ImageBitmap,Ul=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Ul.prototype.update=function(e,t,i){var l=e.width,p=e.height,d=!(this.size&&this.size[0]===l&&this.size[1]===p||i),_=this.context,k=_.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!t||t.premultiply!==!1)),d)this.size=[l,p],e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||rh&&e instanceof rh?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,l,p,0,this.format,k.UNSIGNED_BYTE,e.data);else{var T=i||{x:0,y:0},z=T.x,P=T.y;e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||rh&&e instanceof rh?k.texSubImage2D(k.TEXTURE_2D,0,z,P,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,z,P,l,p,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)},Ul.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Ul.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ul.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var up=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};up.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},up.prototype.remove=function(){delete this._channel,this._callback=function(){}};var xu=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Vt(["receive","process"],this),this.invoker=new up(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ue()?e:N};function Ff(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}xu.prototype.send=function(e,t,i,l,p){var d=this;p===void 0&&(p=!1);var _=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[_]=i);var k=zt(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:e,hasCallback:!!i,targetMapId:l,mustQueue:p,sourceMapId:this.mapId,data:Eo(t,k)},k),{cancel:function(){i&&delete d.callbacks[_],d.target.postMessage({id:_,type:"<cancel>",targetMapId:l,sourceMapId:d.mapId})}}},xu.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else Ue()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},xu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},xu.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Bn(t.error)):l(null,Bn(t.data)))}else{var p=!1,d=zt(this.globalScope)?void 0:[],_=t.hasCallback?function(P,D){p=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:P?Eo(P):null,data:Eo(D,d)},d)}:function(P){p=!0},k=null,T=Bn(t.data);if(this.parent[t.type])k=this.parent[t.type](t.sourceMapId,T,_);else if(this.parent.getWorkerSource){var z=t.type.split(".");k=this.parent.getWorkerSource(t.sourceMapId,z[0],T.source)[z[1]](T,_)}else _(new Error("Could not find function "+t.type));!p&&k&&k.cancel&&(this.cancelCallbacks[e]=k.cancel)}},xu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Xi=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Xi.prototype.setNorthEast=function(e){return this._ne=e instanceof ii?new ii(e.lng,e.lat):ii.convert(e),this},Xi.prototype.setSouthWest=function(e){return this._sw=e instanceof ii?new ii(e.lng,e.lat):ii.convert(e),this},Xi.prototype.extend=function(e){var t,i,l=this._sw,p=this._ne;if(e instanceof ii)t=e,i=e;else{if(!(e instanceof Xi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Xi.convert(e)):this.extend(ii.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||p?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),p.lng=Math.max(i.lng,p.lng),p.lat=Math.max(i.lat,p.lat)):(this._sw=new ii(t.lng,t.lat),this._ne=new ii(i.lng,i.lat)),this},Xi.prototype.getCenter=function(){return new ii((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Xi.prototype.getSouthWest=function(){return this._sw},Xi.prototype.getNorthEast=function(){return this._ne},Xi.prototype.getNorthWest=function(){return new ii(this.getWest(),this.getNorth())},Xi.prototype.getSouthEast=function(){return new ii(this.getEast(),this.getSouth())},Xi.prototype.getWest=function(){return this._sw.lng},Xi.prototype.getSouth=function(){return this._sw.lat},Xi.prototype.getEast=function(){return this._ne.lng},Xi.prototype.getNorth=function(){return this._ne.lat},Xi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Xi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Xi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Xi.prototype.contains=function(e){var t=ii.convert(e),i=t.lng,l=t.lat,p=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&p},Xi.convert=function(e){return!e||e instanceof Xi?e:new Xi(e)};var ii=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ii.prototype.wrap=function(){return new ii(rt(this.lng,-180,180),this.lat)},ii.prototype.toArray=function(){return[this.lng,this.lat]},ii.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ii.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,p=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(p,1))},ii.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Xi(new ii(this.lng-i,this.lat-t),new ii(this.lng+i,this.lat+t))},ii.convert=function(e){if(e instanceof ii)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ii(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ii(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Of=2*Math.PI*63710088e-1;function Nf(e){return Of*Math.cos(e*Math.PI/180)}function Vf(e){return(180+e)/360}function Uf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function jf(e,t){return e/Nf(t)}function cp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var jl=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};jl.fromLngLat=function(e,t){t===void 0&&(t=0);var i=ii.convert(e);return new jl(Vf(i.lng),Uf(i.lat),jf(t,i.lat))},jl.prototype.toLngLat=function(){return new ii(360*this.x-180,cp(this.y))},jl.prototype.toAltitude=function(){return this.z*Nf(cp(this.y))},jl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Of*(e=cp(this.y),1/Math.cos(e*Math.PI/180));var e};var ql=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=ac(0,e,e,t,i)};ql.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},ql.prototype.url=function(e,t){var i,l,p,d,_,k=(l=this.y,p=this.z,d=Ff(256*(i=this.x),256*(l=Math.pow(2,p)-l-1),p),_=Ff(256*(i+1),256*(l+1),p),d[0]+","+d[1]+","+_[0]+","+_[1]),T=function(z,P,D){for(var O,q="",Q=z;Q>0;Q--)q+=(P&(O=1<<Q-1)?1:0)+(D&O?2:0);return q}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",k)},ql.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new L(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},ql.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qf=function(e,t){this.wrap=e,this.canonical=t,this.key=ac(e,t.z,t.z,t.x,t.y)},Wi=function(e,t,i,l,p){this.overscaledZ=e,this.wrap=t,this.canonical=new ql(i,+l,+p),this.key=ac(t,e,i,l,p)};function ac(e,t,i,l,p){(e*=2)<0&&(e=-1*e-1);var d=1<<i;return(d*d*e+d*p+l).toString(36)+i.toString(36)+t.toString(36)}Wi.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Wi.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Wi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Wi(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Wi.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?ac(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):ac(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Wi.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Wi.prototype.children=function(e){if(this.overscaledZ>=e)return[new Wi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Wi(t,this.wrap,t,i,l),new Wi(t,this.wrap,t,i+1,l),new Wi(t,this.wrap,t,i,l+1),new Wi(t,this.wrap,t,i+1,l+1)]},Wi.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Wi.prototype.wrapped=function(){return new Wi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Wi.prototype.unwrapTo=function(e){return new Wi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Wi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Wi.prototype.toUnwrapped=function(){return new qf(this.wrap,this.canonical)},Wi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Wi.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new jl(e.x-this.wrap,e.y))},at("CanonicalTileID",ql),at("OverscaledTileID",Wi,{omit:["posMatrix"]});var qs=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return ot('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var p=0;p<l;p++)this.data[this._idx(-1,p)]=this.data[this._idx(0,p)],this.data[this._idx(l,p)]=this.data[this._idx(l-1,p)],this.data[this._idx(p,-1)]=this.data[this._idx(p,0)],this.data[this._idx(p,l)]=this.data[this._idx(p,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};qs.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},qs.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},qs.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},qs.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},qs.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},qs.prototype.getPixels=function(){return new Ao({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},qs.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,p=t*this.dim+this.dim,d=i*this.dim,_=i*this.dim+this.dim;switch(t){case-1:l=p-1;break;case 1:p=l+1}switch(i){case-1:d=_-1;break;case 1:_=d+1}for(var k=-t*this.dim,T=-i*this.dim,z=d;z<_;z++)for(var P=l;P<p;P++)this.data[this._idx(P,z)]=e.data[this._idx(P+k,z+T)]},at("DEMData",qs);var ih=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};ih.prototype.encode=function(e){return this._stringToNumber[e]},ih.prototype.decode=function(e){return this._numberToString[e]};var nh=function(e,t,i,l,p){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=p},hp={geometry:{configurable:!0}};hp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},hp.geometry.set=function(e){this._geometry=e},nh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(nh.prototype,hp);var bu=function(){this.state={},this.stateChanges={},this.deletedStates={}};bu.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Ge(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var p in this.deletedStates[e]={},this.state[e])p!==l&&(this.deletedStates[e][p]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var d in this.deletedStates[e][l]={},this.state[e][l])i[d]||(this.deletedStates[e][l][d]=null);else for(var _ in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][_]===null&&delete this.deletedStates[e][l][_]},bu.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},bu.prototype.getState=function(e,t){var i=String(t),l=Ge({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var p=this.deletedStates[e][t];if(p===null)return{};for(var d in p)delete l[d]}return l},bu.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},bu.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var p={};for(var d in this.stateChanges[l])this.state[l][d]||(this.state[l][d]={}),Ge(this.state[l][d],this.stateChanges[l][d]),p[d]=this.state[l][d];i[l]=p}for(var _ in this.deletedStates){this.state[_]=this.state[_]||{};var k={};if(this.deletedStates[_]===null)for(var T in this.state[_])k[T]={},this.state[_][T]={};else for(var z in this.deletedStates[_]){if(this.deletedStates[_][z]===null)this.state[_][z]={};else for(var P=0,D=Object.keys(this.deletedStates[_][z]);P<D.length;P+=1)delete this.state[_][z][D[P]];k[z]=this.state[_][z]}i[_]=i[_]||{},Ge(i[_],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var O in e)e[O].setFeatureState(i,t)};var Zs=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ho(8192,16,0),this.grid3D=new Ho(8192,16,0),this.featureIndexArray=new R,this.promoteId=t};function Zf(e,t,i,l,p){return Rt(e,function(d,_){var k=t instanceof Dl?t.get(_):null;return k&&k.evaluate?k.evaluate(i,l,p):k})}function Gf(e){for(var t=1/0,i=1/0,l=-1/0,p=-1/0,d=0,_=e;d<_.length;d+=1){var k=_[d];t=Math.min(t,k.x),i=Math.min(i,k.y),l=Math.max(l,k.x),p=Math.max(p,k.y)}return{minX:t,minY:i,maxX:l,maxY:p}}function C_(e,t){return t-e}Zs.prototype.insert=function(e,t,i,l,p,d){var _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,p);for(var k=d?this.grid3D:this.grid,T=0;T<t.length;T++){for(var z=t[T],P=[1/0,1/0,-1/0,-1/0],D=0;D<z.length;D++){var O=z[D];P[0]=Math.min(P[0],O.x),P[1]=Math.min(P[1],O.y),P[2]=Math.max(P[2],O.x),P[3]=Math.max(P[3],O.y)}P[0]<8192&&P[1]<8192&&P[2]>=0&&P[3]>=0&&k.insert(_,P[0],P[1],P[2],P[3])}},Zs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new hu.VectorTile(new Kc(this.rawTileData)).layers,this.sourceLayerCoder=new ih(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Zs.prototype.query=function(e,t,i,l){var p=this;this.loadVTLayers();for(var d=e.params||{},_=8192/e.tileSize/e.scale,k=Ms(d.filter),T=e.queryGeometry,z=e.queryPadding*_,P=Gf(T),D=this.grid.query(P.minX-z,P.minY-z,P.maxX+z,P.maxY+z),O=Gf(e.cameraQueryGeometry),q=this.grid3D.query(O.minX-z,O.minY-z,O.maxX+z,O.maxY+z,function(ve,Se,Le,Ze){return function(Qe,vt,st,kt,lt){for(var or=0,Bt=Qe;or<Bt.length;or+=1){var yt=Bt[or];if(vt<=yt.x&&st<=yt.y&&kt>=yt.x&&lt>=yt.y)return!0}var sr=[new L(vt,st),new L(vt,lt),new L(kt,lt),new L(kt,st)];if(Qe.length>2){for(var Yt=0,_r=sr;Yt<_r.length;Yt+=1)if(Fa(Qe,_r[Yt]))return!0}for(var Et=0;Et<Qe.length-1;Et++)if(Ol(Qe[Et],Qe[Et+1],sr))return!0;return!1}(e.cameraQueryGeometry,ve-z,Se-z,Le+z,Ze+z)}),Q=0,ee=q;Q<ee.length;Q+=1)D.push(ee[Q]);D.sort(C_);for(var ue,oe={},de=function(ve){var Se=D[ve];if(Se!==ue){ue=Se;var Le=p.featureIndexArray.get(Se),Ze=null;p.loadMatchingFeature(oe,Le.bucketIndex,Le.sourceLayerIndex,Le.featureIndex,k,d.layers,d.availableImages,t,i,l,function(Qe,vt,st){return Ze||(Ze=mi(Qe)),vt.queryIntersectsFeature(T,Qe,st,Ze,p.z,e.transform,_,e.pixelPosMatrix)})}},_e=0;_e<D.length;_e++)de(_e);return oe},Zs.prototype.loadMatchingFeature=function(e,t,i,l,p,d,_,k,T,z,P){var D=this.bucketLayerIDs[t];if(!d||function(Qe,vt){for(var st=0;st<Qe.length;st++)if(vt.indexOf(Qe[st])>=0)return!0;return!1}(d,D)){var O=this.sourceLayerCoder.decode(i),q=this.vtLayers[O].feature(l);if(p.needGeometry){var Q=Pi(q,!0);if(!p.filter(new cr(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!p.filter(new cr(this.tileID.overscaledZ),q))return;for(var ee=this.getId(q,O),ue=0;ue<D.length;ue++){var oe=D[ue];if(!(d&&d.indexOf(oe)<0)){var de=k[oe];if(de){var _e={};ee!==void 0&&z&&(_e=z.getState(de.sourceLayer||"_geojsonTileLayer",ee));var ve=Ge({},T[oe]);ve.paint=Zf(ve.paint,de.paint,q,_e,_),ve.layout=Zf(ve.layout,de.layout,q,_e,_);var Se=!P||P(q,de,_e);if(Se){var Le=new nh(q,this.z,this.x,this.y,ee);Le.layer=ve;var Ze=e[oe];Ze===void 0&&(Ze=e[oe]=[]),Ze.push({featureIndex:l,feature:Le,intersectionZ:Se})}}}}}},Zs.prototype.lookupSymbolFeatures=function(e,t,i,l,p,d,_,k){var T={};this.loadVTLayers();for(var z=Ms(p),P=0,D=e;P<D.length;P+=1)this.loadMatchingFeature(T,i,l,D[P],z,d,_,k,t);return T},Zs.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,p=i[t];l<p.length;l+=1)if(e===p[l])return!0;return!1},Zs.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},at("FeatureIndex",Zs,{omit:["rawTileData","sourceLayerCoder"]});var mn=function(e,t){this.tileID=e,this.uid=Tt(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};mn.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Ni.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},mn.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},mn.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(z,P){var D={};if(!P)return D;for(var O=function(){var ee=Q[q],ue=ee.layerIds.map(function(_e){return P.getLayer(_e)}).filter(Boolean);if(ue.length!==0){ee.layers=ue,ee.stateDependentLayerIds&&(ee.stateDependentLayers=ee.stateDependentLayerIds.map(function(_e){return ue.filter(function(ve){return ve.id===_e})[0]}));for(var oe=0,de=ue;oe<de.length;oe+=1)D[de[oe].id]=ee}},q=0,Q=z;q<Q.length;q+=1)O();return D}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var p=this.buckets[l];if(p instanceof Fr){if(this.hasSymbolBuckets=!0,!i)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var d in this.buckets){var _=this.buckets[d];if(_ instanceof Fr&&_.hasRTLText){this.hasRTLText=!0,Uo.isLoading()||Uo.isLoaded()||qu()!=="deferred"||_a();break}}for(var k in this.queryPadding=0,this.buckets){var T=this.buckets[k];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(k).queryRadius(T))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},mn.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},mn.prototype.getBucket=function(e){return this.buckets[e.id]},mn.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ul(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ul(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},mn.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},mn.prototype.queryRenderedFeatures=function(e,t,i,l,p,d,_,k,T,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:p,scale:d,tileSize:this.tileSize,pixelPosMatrix:z,transform:k,params:_,queryPadding:this.queryPadding*T},e,t,i):{}},mn.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),p=t?t.sourceLayer:"",d=l._geojsonTileLayer||l[p];if(d)for(var _=Ms(t&&t.filter),k=this.tileID.canonical,T=k.z,z=k.x,P=k.y,D={z:T,x:z,y:P},O=0;O<d.length;O++){var q=d.feature(O);if(_.needGeometry){var Q=Pi(q,!0);if(!_.filter(new cr(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!_.filter(new cr(this.tileID.overscaledZ),q))continue;var ee=i.getId(q,p),ue=new nh(q,T,z,P,ee);ue.tile=D,e.push(ue)}}},mn.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},mn.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},mn.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=_t(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),p=!1;if(this.expirationTime>l)p=!1;else if(t)if(this.expirationTime<t)p=!0;else{var d=this.expirationTime-t;d?this.expirationTime=l+Math.max(d,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},mn.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},mn.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var p=this.buckets[l],d=p.layers[0].sourceLayer||"_geojsonTileLayer",_=i[d],k=e[d];if(_&&k&&Object.keys(k).length!==0){p.update(k,_,this.imageAtlas&&this.imageAtlas.patternPositions||{});var T=t&&t.style&&t.style.getLayer(l);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(p)))}}}},mn.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},mn.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ni.now()},mn.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},mn.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Ni.now()+e},mn.prototype.setDependencies=function(e,t){for(var i={},l=0,p=t;l<p.length;l+=1)i[p[l]]=!0;this.dependencies[e]=i},mn.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var p=this.dependencies[l[i]];if(p){for(var d=0,_=t;d<_.length;d+=1)if(p[_[d]])return!0}}return!1};var dl=N.performance,Kf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},dl.mark(this._marks.start)};Kf.prototype.finish=function(){dl.mark(this._marks.end);var e=dl.getEntriesByName(this._marks.measure);return e.length===0&&(dl.measure(this._marks.measure,this._marks.start,this._marks.end),e=dl.getEntriesByName(this._marks.measure),dl.clearMarks(this._marks.start),dl.clearMarks(this._marks.end),dl.clearMeasures(this._marks.measure)),e},a.Actor=xu,a.AlphaImage=Vl,a.CanonicalTileID=ql,a.CollisionBoxArray=s,a.Color=ir,a.DEMData=qs,a.DataConstantProperty=wt,a.DictionaryCoder=ih,a.EXTENT=8192,a.ErrorEvent=le,a.EvaluationParameters=cr,a.Event=J,a.Evented=ce,a.FeatureIndex=Zs,a.FillBucket=Ha,a.FillExtrusionBucket=Ja,a.ImageAtlas=nc,a.ImagePosition=Wc,a.LineBucket=lo,a.LngLat=ii,a.LngLatBounds=Xi,a.MercatorCoordinate=jl,a.ONE_EM=24,a.OverscaledTileID=Wi,a.Point=L,a.Point$1=L,a.Properties=In,a.Protobuf=Kc,a.RGBAImage=Ao,a.RequestManager=Kr,a.RequestPerformance=Kf,a.ResourceType=Po,a.SegmentVector=G,a.SourceFeatureState=bu,a.StructArrayLayout1ui2=Hu,a.StructArrayLayout2f1f2i16=Ns,a.StructArrayLayout2i4=Os,a.StructArrayLayout3ui6=fs,a.StructArrayLayout4i8=Gu,a.SymbolBucket=Fr,a.Texture=Ul,a.Tile=mn,a.Transitionable=Tn,a.Uniform1f=Je,a.Uniform1i=Oe,a.Uniform2f=We,a.Uniform3f=ut,a.Uniform4f=St,a.UniformColor=Ct,a.UniformMatrix4f=vr,a.UnwrappedTileID=qf,a.ValidationError=re,a.WritingMode=ea,a.ZoomHistory=nl,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=sp,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,p=new Array(e.length),d=null;e.forEach(function(_,k){t(_,function(T,z){T&&(d=T),p[k]=z,--l==0&&i(d,p)})})},a.bezier=pe,a.bindAll=Vt,a.browser=Ni,a.cacheEntryPossiblyAdded=function(e){++xn>Co&&(e.getActor().send("enforceCacheSizeLimit",ji),xn=0)},a.clamp=Ie,a.clearTileCache=function(e){var t=N.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=If,a.clone=function(e){var t=new kr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=Fe,a.clone$2=function(e){var t=new kr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=Jy,a.config=lr,a.create=function(){var e=new kr(16);return kr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new kr(9);return kr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new kr(4);return kr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=A,a.createExpression=kn,a.createLayout=fn,a.createStyleLayer=function(e){return e.type==="custom"?new A_(e):new z_[e.type](e)},a.cross=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=i[0],k=i[1],T=i[2];return e[0]=p*T-d*k,e[1]=d*_-l*T,e[2]=l*k-p*_,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var p in t)if(!e(t[p],i[p]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=De,a.emitValidationErrors=ls,a.endsWith=Ht,a.enforceCacheSizeLimit=function(e){vn(),Ti&&Ti.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=bf,a.evaluateSizeForZoom=wf,a.evaluateVariableOffset=Cf,a.evented=ju,a.extend=Ge,a.featureFilter=Ms,a.filterObject=gt,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=ip,a.getAnchorJustification=ap,a.getArrayBuffer=jn,a.getImage=F,a.getJSON=function(e,t){return to(Ge(e,{type:"json"}),t)},a.getRTLTextPluginStatus=qu,a.getReferrer=Qi,a.getVideo=function(e,t){var i,l,p=N.document.createElement("video");p.muted=!0,p.onloadstart=function(){t(null,p)};for(var d=0;d<e.length;d++){var _=N.document.createElement("source");i=e[d],l=void 0,(l=N.document.createElement("a")).href=i,(l.protocol!==N.document.location.protocol||l.host!==N.document.location.host)&&(p.crossOrigin="Anonymous"),_.src=e[d],p.appendChild(_)}return{cancel:function(){}}},a.identity=jo,a.invert=function(e,t){var i=t[0],l=t[1],p=t[2],d=t[3],_=t[4],k=t[5],T=t[6],z=t[7],P=t[8],D=t[9],O=t[10],q=t[11],Q=t[12],ee=t[13],ue=t[14],oe=t[15],de=i*k-l*_,_e=i*T-p*_,ve=i*z-d*_,Se=l*T-p*k,Le=l*z-d*k,Ze=p*z-d*T,Qe=P*ee-D*Q,vt=P*ue-O*Q,st=P*oe-q*Q,kt=D*ue-O*ee,lt=D*oe-q*ee,or=O*oe-q*ue,Bt=de*or-_e*lt+ve*kt+Se*st-Le*vt+Ze*Qe;return Bt?(e[0]=(k*or-T*lt+z*kt)*(Bt=1/Bt),e[1]=(p*lt-l*or-d*kt)*Bt,e[2]=(ee*Ze-ue*Le+oe*Se)*Bt,e[3]=(O*Le-D*Ze-q*Se)*Bt,e[4]=(T*st-_*or-z*vt)*Bt,e[5]=(i*or-p*st+d*vt)*Bt,e[6]=(ue*ve-Q*Ze-oe*_e)*Bt,e[7]=(P*Ze-O*ve+q*_e)*Bt,e[8]=(_*lt-k*st+z*Qe)*Bt,e[9]=(l*st-i*lt-d*Qe)*Bt,e[10]=(Q*Le-ee*ve+oe*de)*Bt,e[11]=(D*ve-P*Le-q*de)*Bt,e[12]=(k*vt-_*kt-T*Qe)*Bt,e[13]=(i*kt-l*vt+p*Qe)*Bt,e[14]=(ee*_e-Q*Se-ue*de)*Bt,e[15]=(P*Se-D*_e+O*de)*Bt,e):null},a.isChar=Ye,a.isMapboxURL=Hr,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=to,a.mapObject=Rt,a.mercatorXfromLng=Vf,a.mercatorYfromLat=Uf,a.mercatorZfromAltitude=jf,a.mul=Gh,a.multiply=so,a.mvt=hu,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],p=t[2],d=i*i+l*l+p*p;return d>0&&(d=1/Math.sqrt(d)),e[0]=t[0]*d,e[1]=t[1]*d,e[2]=t[2]*d,e},a.number=qr,a.offscreenCanvasSupported=An,a.ortho=function(e,t,i,l,p,d,_){var k=1/(t-i),T=1/(l-p),z=1/(d-_);return e[0]=-2*k,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*T,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*z,e[11]=0,e[12]=(t+i)*k,e[13]=(p+l)*T,e[14]=(_+d)*z,e[15]=1,e},a.parseGlyphPBF=function(e){return new Kc(e).readFields(s_,[])},a.pbf=Kc,a.performSymbolLayout=function(e,t,i,l,p,d,_){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var k=e.layers[0].layout,T=e.layers[0]._unevaluatedLayout._values,z={};if(e.textSizeData.kind==="composite"){var P=e.textSizeData,D=P.maxZoom;z.compositeTextSizes=[T["text-size"].possiblyEvaluate(new cr(P.minZoom),_),T["text-size"].possiblyEvaluate(new cr(D),_)]}if(e.iconSizeData.kind==="composite"){var O=e.iconSizeData,q=O.maxZoom;z.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new cr(O.minZoom),_),T["icon-size"].possiblyEvaluate(new cr(q),_)]}z.layoutTextSize=T["text-size"].possiblyEvaluate(new cr(e.zoom+1),_),z.layoutIconSize=T["icon-size"].possiblyEvaluate(new cr(e.zoom+1),_),z.textMaxSize=T["text-size"].possiblyEvaluate(new cr(18));for(var Q=24*k.get("text-line-height"),ee=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",ue=k.get("text-keep-upright"),oe=k.get("text-size"),de=function(){var Se=ve[_e],Le=k.get("text-font").evaluate(Se,{},_).join(","),Ze=oe.evaluate(Se,{},_),Qe=z.layoutTextSize.evaluate(Se,{},_),vt=z.layoutIconSize.evaluate(Se,{},_),st={horizontal:{},vertical:void 0},kt=Se.text,lt=[0,0];if(kt){var or=kt.toString(),Bt=24*k.get("text-letter-spacing").evaluate(Se,{},_),yt=function(pr){for(var Nr=0,Br=pr;Nr<Br.length;Nr+=1)if(xr=Br[Nr].charCodeAt(0),Ye.Arabic(xr)||Ye["Arabic Supplement"](xr)||Ye["Arabic Extended-A"](xr)||Ye["Arabic Presentation Forms-A"](xr)||Ye["Arabic Presentation Forms-B"](xr))return!1;var xr;return!0}(or)?Bt:0,sr=k.get("text-anchor").evaluate(Se,{},_),Yt=k.get("text-variable-anchor");if(!Yt){var _r=k.get("text-radial-offset").evaluate(Se,{},_);lt=_r?Cf(sr,[24*_r,op]):k.get("text-offset").evaluate(Se,{},_).map(function(pr){return 24*pr})}var Et=ee?"center":k.get("text-justify").evaluate(Se,{},_),br=k.get("symbol-placement"),ni=br==="point"?24*k.get("text-max-width").evaluate(Se,{},_):0,Si=function(){e.allowVerticalPlacement&&ol(or)&&(st.vertical=Hc(kt,t,i,p,Le,ni,Q,sr,"left",yt,lt,ea.vertical,!0,br,Qe,Ze))};if(!ee&&Yt){for(var yi=Et==="auto"?Yt.map(function(pr){return ap(pr)}):[Et],oi=!1,ki=0;ki<yi.length;ki++){var on=yi[ki];if(!st.horizontal[on])if(oi)st.horizontal[on]=st.horizontal[0];else{var an=Hc(kt,t,i,p,Le,ni,Q,"center",on,yt,lt,ea.horizontal,!1,br,Qe,Ze);an&&(st.horizontal[on]=an,oi=an.positionedLines.length===1)}}Si()}else{Et==="auto"&&(Et=ap(sr));var Yn=Hc(kt,t,i,p,Le,ni,Q,sr,Et,yt,lt,ea.horizontal,!1,br,Qe,Ze);Yn&&(st.horizontal[Et]=Yn),Si(),ol(or)&&ee&&ue&&(st.vertical=Hc(kt,t,i,p,Le,ni,Q,sr,Et,yt,lt,ea.vertical,!1,br,Qe,Ze))}}var yn=void 0,Qn=!1;if(Se.icon&&Se.icon.name){var Mi=l[Se.icon.name];Mi&&(yn=function(pr,Nr,Br){var xr=ip(Br),uo=Nr[0]-pr.displaySize[0]*xr.horizontalAlign,Nn=Nr[1]-pr.displaySize[1]*xr.verticalAlign;return{image:pr,top:Nn,bottom:Nn+pr.displaySize[1],left:uo,right:uo+pr.displaySize[0]}}(p[Se.icon.name],k.get("icon-offset").evaluate(Se,{},_),k.get("icon-anchor").evaluate(Se,{},_)),Qn=Mi.sdf,e.sdfIcons===void 0?e.sdfIcons=Mi.sdf:e.sdfIcons!==Mi.sdf&&ot("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Mi.pixelRatio!==e.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var _n=Mf(st.horizontal)||st.vertical;e.iconsInText=!!_n&&_n.iconsInText,(_n||yn)&&function(pr,Nr,Br,xr,uo,Nn,$r,Fi,Vn,wr,vs){var ta=Nn.textMaxSize.evaluate(Nr,{});ta===void 0&&(ta=$r);var xs,Di=pr.layers[0].layout,bs=Di.get("icon-offset").evaluate(Nr,{},vs),Na=Mf(Br.horizontal),wu=$r/24,Zl=pr.tilePixelRatio*wu,Su=pr.tilePixelRatio*ta/24,Gs=pr.tilePixelRatio*Fi,ku=pr.tilePixelRatio*Di.get("symbol-spacing"),oh=Di.get("text-padding")*pr.tilePixelRatio,Eu=Di.get("icon-padding")*pr.tilePixelRatio,sc=Di.get("text-max-angle")/180*Math.PI,ah=Di.get("text-rotation-alignment")==="map"&&Di.get("symbol-placement")!=="point",sh=Di.get("icon-rotation-alignment")==="map"&&Di.get("symbol-placement")!=="point",Ks=Di.get("symbol-placement"),lc=ku/2,Tu=Di.get("icon-text-fit");xr&&Tu!=="none"&&(pr.allowVerticalPlacement&&Br.vertical&&(xs=xf(xr,Br.vertical,Tu,Di.get("icon-text-fit-padding"),bs,wu)),Na&&(xr=xf(xr,Na,Tu,Di.get("icon-text-fit-padding"),bs,wu)));var ml=function(P_,yc){yc.x<0||yc.x>=8192||yc.y<0||yc.y>=8192||function(Li,Ya,M_,yl,mp,Hf,fh,ws,dh,_c,mh,yh,yp,Jf,gc,Yf,Qf,$f,ed,td,ra,_h,rd,Ss,D_){var id,Kl,Pu,Mu,Du,Lu=Li.addToLineVertexArray(Ya,M_),nd=0,od=0,ad=0,sd=0,_p=-1,gp=-1,Xs={},ld=Y(""),vp=0,xp=0;if(ws._unevaluatedLayout.getValue("text-radial-offset")===void 0?(vp=(id=ws.layout.get("text-offset").evaluate(ra,{},Ss).map(function(xc){return 24*xc}))[0],xp=id[1]):(vp=24*ws.layout.get("text-radial-offset").evaluate(ra,{},Ss),xp=op),Li.allowVerticalPlacement&&yl.vertical){var ud=ws.layout.get("text-rotate").evaluate(ra,{},Ss)+90;Mu=new eh(dh,Ya,_c,mh,yh,yl.vertical,yp,Jf,gc,ud),fh&&(Du=new eh(dh,Ya,_c,mh,yh,fh,Qf,$f,gc,ud))}if(mp){var bp=ws.layout.get("icon-rotate").evaluate(ra,{}),cd=ws.layout.get("icon-text-fit")!=="none",hd=Af(mp,bp,rd,cd),wp=fh?Af(fh,bp,rd,cd):void 0;Pu=new eh(dh,Ya,_c,mh,yh,mp,Qf,$f,!1,bp),nd=4*hd.length;var pd=Li.iconSizeData,vc=null;pd.kind==="source"?(vc=[128*ws.layout.get("icon-size").evaluate(ra,{})])[0]>32640&&ot(Li.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):pd.kind==="composite"&&((vc=[128*_h.compositeIconSizes[0].evaluate(ra,{},Ss),128*_h.compositeIconSizes[1].evaluate(ra,{},Ss)])[0]>32640||vc[1]>32640)&&ot(Li.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Li.addSymbols(Li.icon,hd,vc,td,ed,ra,!1,Ya,Lu.lineStartIndex,Lu.lineLength,-1,Ss),_p=Li.icon.placedSymbolArray.length-1,wp&&(od=4*wp.length,Li.addSymbols(Li.icon,wp,vc,td,ed,ra,ea.vertical,Ya,Lu.lineStartIndex,Lu.lineLength,-1,Ss),gp=Li.icon.placedSymbolArray.length-1)}for(var fd in yl.horizontal){var gh=yl.horizontal[fd];if(!Kl){ld=Y(gh.text);var L_=ws.layout.get("text-rotate").evaluate(ra,{},Ss);Kl=new eh(dh,Ya,_c,mh,yh,gh,yp,Jf,gc,L_)}var dd=gh.positionedLines.length===1;if(ad+=Pf(Li,Ya,gh,Hf,ws,gc,ra,Yf,Lu,yl.vertical?ea.horizontal:ea.horizontalOnly,dd?Object.keys(yl.horizontal):[fd],Xs,_p,_h,Ss),dd)break}yl.vertical&&(sd+=Pf(Li,Ya,yl.vertical,Hf,ws,gc,ra,Yf,Lu,ea.vertical,["vertical"],Xs,gp,_h,Ss));var R_=Kl?Kl.boxStartIndex:Li.collisionBoxArray.length,B_=Kl?Kl.boxEndIndex:Li.collisionBoxArray.length,F_=Mu?Mu.boxStartIndex:Li.collisionBoxArray.length,O_=Mu?Mu.boxEndIndex:Li.collisionBoxArray.length,N_=Pu?Pu.boxStartIndex:Li.collisionBoxArray.length,V_=Pu?Pu.boxEndIndex:Li.collisionBoxArray.length,U_=Du?Du.boxStartIndex:Li.collisionBoxArray.length,j_=Du?Du.boxEndIndex:Li.collisionBoxArray.length,ks=-1,vh=function(xc,yd){return xc&&xc.circleDiameter?Math.max(xc.circleDiameter,yd):yd};ks=vh(Kl,ks),ks=vh(Mu,ks),ks=vh(Pu,ks);var md=(ks=vh(Du,ks))>-1?1:0;md&&(ks*=D_/24),Li.glyphOffsetArray.length>=Fr.MAX_GLYPHS&&ot("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ra.sortKey!==void 0&&Li.addToSortKeyRanges(Li.symbolInstances.length,ra.sortKey),Li.symbolInstances.emplaceBack(Ya.x,Ya.y,Xs.right>=0?Xs.right:-1,Xs.center>=0?Xs.center:-1,Xs.left>=0?Xs.left:-1,Xs.vertical||-1,_p,gp,ld,R_,B_,F_,O_,N_,V_,U_,j_,_c,ad,sd,nd,od,md,0,yp,vp,xp,ks)}(pr,yc,P_,Br,xr,uo,xs,pr.layers[0],pr.collisionBoxArray,Nr.index,Nr.sourceLayerIndex,pr.index,Zl,oh,ah,Vn,Gs,Eu,sh,bs,Nr,Nn,wr,vs,$r)};if(Ks==="line")for(var Iu=0,lh=If(Nr.geometry,0,0,8192,8192);Iu<lh.length;Iu+=1)for(var uh=lh[Iu],uc=0,cc=d_(uh,ku,sc,Br.vertical||Na,xr,24,Su,pr.overscaling,8192);uc<cc.length;uc+=1){var ch=cc[uc];Na&&g_(pr,Na.text,lc,ch)||ml(uh,ch)}else if(Ks==="line-center")for(var hc=0,pc=Nr.geometry;hc<pc.length;hc+=1){var fc=pc[hc];if(fc.length>1){var hh=f_(fc,sc,Br.vertical||Na,xr,24,Su);hh&&ml(fc,hh)}}else if(Nr.type==="Polygon")for(var Au=0,ph=Qh(Nr.geometry,0);Au<ph.length;Au+=1){var zu=ph[Au],dc=y_(zu,16);ml(zu[0],new mu(dc.x,dc.y,0))}else if(Nr.type==="LineString")for(var Gl=0,mc=Nr.geometry;Gl<mc.length;Gl+=1){var Cu=mc[Gl];ml(Cu,new mu(Cu[0].x,Cu[0].y,0))}else if(Nr.type==="Point")for(var pp=0,Xf=Nr.geometry;pp<Xf.length;pp+=1)for(var fp=0,Wf=Xf[pp];fp<Wf.length;fp+=1){var dp=Wf[fp];ml([dp],new mu(dp.x,dp.y,0))}}(e,Se,st,yn,l,z,Qe,vt,lt,Qn,_)},_e=0,ve=e.features;_e<ve.length;_e+=1)de();d&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,p){var d,_=1/Math.tan(t/2);return e[0]=_/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=_,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,p!=null&&p!==1/0?(e[10]=(p+l)*(d=1/(l-p)),e[14]=2*p*l*d):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var p=t[l];p in e&&(i[p]=e[p])}return i},a.plugin=Uo,a.polygonIntersectsPolygon=ys,a.postMapLoadEvent=Ii,a.postTurnstileEvent=zo,a.potpack=yf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=at,a.registerForPluginStateChange=function(e){return e({pluginStatus:En,pluginURL:Jo}),ju.on("pluginStateChange",e),e},a.renderColorRamp=Jp,a.rotate=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],k=Math.sin(i),T=Math.cos(i);return e[0]=l*T+d*k,e[1]=p*T+_*k,e[2]=l*-k+d*T,e[3]=p*-k+_*T,e},a.rotateX=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[4],_=t[5],k=t[6],T=t[7],z=t[8],P=t[9],D=t[10],O=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=d*p+z*l,e[5]=_*p+P*l,e[6]=k*p+D*l,e[7]=T*p+O*l,e[8]=z*p-d*l,e[9]=P*p-_*l,e[10]=D*p-k*l,e[11]=O*p-T*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[0],_=t[1],k=t[2],T=t[3],z=t[4],P=t[5],D=t[6],O=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*p+z*l,e[1]=_*p+P*l,e[2]=k*p+D*l,e[3]=T*p+O*l,e[4]=z*p-d*l,e[5]=P*p-_*l,e[6]=D*p-k*l,e[7]=O*p-T*l,e},a.scale=function(e,t,i){var l=i[0],p=i[1],d=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*p,e[5]=t[5]*p,e[6]=t[6]*p,e[7]=t[7]*p,e[8]=t[8]*d,e[9]=t[9]*d,e[10]=t[10]*d,e[11]=t[11]*d,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){ji=e,Co=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),En==="deferred"||En==="loading"||En==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Jo=Ni.resolveURL(e),En="deferred",Bs=t,hs(),i||_a()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=U,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=p_,a.transformMat3=function(e,t,i){var l=t[0],p=t[1],d=t[2];return e[0]=l*i[0]+p*i[3]+d*i[6],e[1]=l*i[1]+p*i[4]+d*i[7],e[2]=l*i[2]+p*i[5]+d*i[8],e},a.transformMat4=su,a.translate=function(e,t,i){var l,p,d,_,k,T,z,P,D,O,q,Q,ee=i[0],ue=i[1],oe=i[2];return t===e?(e[12]=t[0]*ee+t[4]*ue+t[8]*oe+t[12],e[13]=t[1]*ee+t[5]*ue+t[9]*oe+t[13],e[14]=t[2]*ee+t[6]*ue+t[10]*oe+t[14],e[15]=t[3]*ee+t[7]*ue+t[11]*oe+t[15]):(p=t[1],d=t[2],_=t[3],k=t[4],T=t[5],z=t[6],P=t[7],D=t[8],O=t[9],q=t[10],Q=t[11],e[0]=l=t[0],e[1]=p,e[2]=d,e[3]=_,e[4]=k,e[5]=T,e[6]=z,e[7]=P,e[8]=D,e[9]=O,e[10]=q,e[11]=Q,e[12]=l*ee+k*ue+D*oe+t[12],e[13]=p*ee+T*ue+O*oe+t[13],e[14]=d*ee+z*ue+q*oe+t[14],e[15]=_*ee+P*ue+Q*oe+t[15]),e},a.triggerPluginCompletionEvent=Ml,a.uniqueId=Tt,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=eu,a.validateStyle=as,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=hu,a.version="1.13.2",a.warnOnce=ot,a.webpSupported=Sr,a.window=N,a.wrap=rt}),x(["./shared"],function(a){function A(M){var F=typeof M;if(F==="number"||F==="boolean"||F==="string"||M==null)return JSON.stringify(M);if(Array.isArray(M)){for(var V="[",K=0,J=M;K<J.length;K+=1)V+=A(J[K])+",";return V+"]"}for(var le=Object.keys(M).sort(),ce="{",U=0;U<le.length;U++)ce+=JSON.stringify(le[U])+":"+A(M[le[U]])+",";return ce+"}"}function I(M){for(var F="",V=0,K=a.refProperties;V<K.length;V+=1)F+="/"+A(M[K[V]]);return F}var B=function(M){this.keyCache={},M&&this.replace(M)};B.prototype.replace=function(M){this._layerConfigs={},this._layers={},this.update(M,[])},B.prototype.update=function(M,F){for(var V=this,K=0,J=M;K<J.length;K+=1){var le=J[K];this._layerConfigs[le.id]=le;var ce=this._layers[le.id]=a.createStyleLayer(le);ce._featureFilter=a.featureFilter(ce.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(var U=0,re=F;U<re.length;U+=1){var me=re[U];delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me]}this.familiesBySource={};for(var Re=0,Ne=function(qe,Xe){for(var jt={},et=0;et<qe.length;et++){var Kt=Xe&&Xe[qe[et].id]||I(qe[et]);Xe&&(Xe[qe[et].id]=Kt);var dr=jt[Kt];dr||(dr=jt[Kt]=[]),dr.push(qe[et])}var Ft=[];for(var $t in jt)Ft.push(jt[$t]);return Ft}(a.values(this._layerConfigs),this.keyCache);Re<Ne.length;Re+=1){var be=Ne[Re].map(function(qe){return V._layers[qe.id]}),Be=be[0];if(Be.visibility!=="none"){var nt=Be.source||"",it=this.familiesBySource[nt];it||(it=this.familiesBySource[nt]={});var we=Be.sourceLayer||"_geojsonTileLayer",$e=it[we];$e||($e=it[we]=[]),$e.push(be)}}};var L=function(M){var F={},V=[];for(var K in M){var J=M[K],le=F[K]={};for(var ce in J){var U=J[+ce];if(U&&U.bitmap.width!==0&&U.bitmap.height!==0){var re={x:0,y:0,w:U.bitmap.width+2,h:U.bitmap.height+2};V.push(re),le[ce]={rect:re,metrics:U.metrics}}}}var me=a.potpack(V),Re=new a.AlphaImage({width:me.w||1,height:me.h||1});for(var Ne in M){var be=M[Ne];for(var Be in be){var nt=be[+Be];if(nt&&nt.bitmap.width!==0&&nt.bitmap.height!==0){var it=F[Ne][Be].rect;a.AlphaImage.copy(nt.bitmap,Re,{x:0,y:0},{x:it.x+1,y:it.y+1},nt.bitmap)}}}this.image=Re,this.positions=F};a.register("GlyphAtlas",L);var j=function(M){this.tileID=new a.OverscaledTileID(M.tileID.overscaledZ,M.tileID.wrap,M.tileID.canonical.z,M.tileID.canonical.x,M.tileID.canonical.y),this.uid=M.uid,this.zoom=M.zoom,this.pixelRatio=M.pixelRatio,this.tileSize=M.tileSize,this.source=M.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=M.showCollisionBoxes,this.collectResourceTiming=!!M.collectResourceTiming,this.returnDependencies=!!M.returnDependencies,this.promoteId=M.promoteId};function N(M,F,V){for(var K=new a.EvaluationParameters(F),J=0,le=M;J<le.length;J+=1)le[J].recalculate(K,V)}function X(M,F){var V=a.getArrayBuffer(M.request,function(K,J,le,ce){K?F(K):J&&F(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(J)),rawData:J,cacheControl:le,expires:ce})});return function(){V.cancel(),F()}}j.prototype.parse=function(M,F,V,K,J){var le=this;this.status="parsing",this.data=M,this.collisionBoxArray=new a.CollisionBoxArray;var ce=new a.DictionaryCoder(Object.keys(M.layers).sort()),U=new a.FeatureIndex(this.tileID,this.promoteId);U.bucketLayerIDs=[];var re,me,Re,Ne,be={},Be={featureIndex:U,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},nt=F.familiesBySource[this.source];for(var it in nt){var we=M.layers[it];if(we){we.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+it+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var $e=ce.encode(it),qe=[],Xe=0;Xe<we.length;Xe++){var jt=we.feature(Xe),et=U.getId(jt,it);qe.push({feature:jt,id:et,index:Xe,sourceLayerIndex:$e})}for(var Kt=0,dr=nt[it];Kt<dr.length;Kt+=1){var Ft=dr[Kt],$t=Ft[0];$t.minzoom&&this.zoom<Math.floor($t.minzoom)||$t.maxzoom&&this.zoom>=$t.maxzoom||$t.visibility!=="none"&&(N(Ft,this.zoom,V),(be[$t.id]=$t.createBucket({index:U.bucketLayerIDs.length,layers:Ft,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:$e,sourceID:this.source})).populate(qe,Be,this.tileID.canonical),U.bucketLayerIDs.push(Ft.map(function(Xt){return Xt.id})))}}}var er=a.mapObject(Be.glyphDependencies,function(Xt){return Object.keys(Xt).map(Number)});Object.keys(er).length?K.send("getGlyphs",{uid:this.uid,stacks:er},function(Xt,qt){re||(re=Xt,me=qt,Cr.call(le))}):me={};var ai=Object.keys(Be.iconDependencies);ai.length?K.send("getImages",{icons:ai,source:this.source,tileID:this.tileID,type:"icons"},function(Xt,qt){re||(re=Xt,Re=qt,Cr.call(le))}):Re={};var rr=Object.keys(Be.patternDependencies);function Cr(){if(re)return J(re);if(me&&Re&&Ne){var Xt=new L(me),qt=new a.ImageAtlas(Re,Ne);for(var ir in be){var fi=be[ir];fi instanceof a.SymbolBucket?(N(fi.layers,this.zoom,V),a.performSymbolLayout(fi,me,Xt.positions,Re,qt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):fi.hasPattern&&(fi instanceof a.LineBucket||fi instanceof a.FillBucket||fi instanceof a.FillExtrusionBucket)&&(N(fi.layers,this.zoom,V),fi.addFeatures(Be,this.tileID.canonical,qt.patternPositions))}this.status="done",J(null,{buckets:a.values(be).filter(function(ro){return!ro.isEmpty()}),featureIndex:U,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xt.image,imageAtlas:qt,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Re:null,glyphPositions:this.returnDependencies?Xt.positions:null})}}rr.length?K.send("getImages",{icons:rr,source:this.source,tileID:this.tileID,type:"patterns"},function(Xt,qt){re||(re=Xt,Ne=qt,Cr.call(le))}):Ne={},Cr.call(this)};var pe=function(M,F,V,K){this.actor=M,this.layerIndex=F,this.availableImages=V,this.loadVectorData=K||X,this.loading={},this.loaded={}};pe.prototype.loadTile=function(M,F){var V=this,K=M.uid;this.loading||(this.loading={});var J=!!(M&&M.request&&M.request.collectResourceTiming)&&new a.RequestPerformance(M.request),le=this.loading[K]=new j(M);le.abort=this.loadVectorData(M,function(ce,U){if(delete V.loading[K],ce||!U)return le.status="done",V.loaded[K]=le,F(ce);var re=U.rawData,me={};U.expires&&(me.expires=U.expires),U.cacheControl&&(me.cacheControl=U.cacheControl);var Re={};if(J){var Ne=J.finish();Ne&&(Re.resourceTiming=JSON.parse(JSON.stringify(Ne)))}le.vectorTile=U.vectorTile,le.parse(U.vectorTile,V.layerIndex,V.availableImages,V.actor,function(be,Be){if(be||!Be)return F(be);F(null,a.extend({rawTileData:re.slice(0)},Be,me,Re))}),V.loaded=V.loaded||{},V.loaded[K]=le})},pe.prototype.reloadTile=function(M,F){var V=this,K=this.loaded,J=M.uid,le=this;if(K&&K[J]){var ce=K[J];ce.showCollisionBoxes=M.showCollisionBoxes;var U=function(re,me){var Re=ce.reloadCallback;Re&&(delete ce.reloadCallback,ce.parse(ce.vectorTile,le.layerIndex,V.availableImages,le.actor,Re)),F(re,me)};ce.status==="parsing"?ce.reloadCallback=U:ce.status==="done"&&(ce.vectorTile?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,U):U())}},pe.prototype.abortTile=function(M,F){var V=this.loading,K=M.uid;V&&V[K]&&V[K].abort&&(V[K].abort(),delete V[K]),F()},pe.prototype.removeTile=function(M,F){var V=this.loaded,K=M.uid;V&&V[K]&&delete V[K],F()};var De=a.window.ImageBitmap,Ie=function(){this.loaded={}};function rt(M,F){if(M.length!==0){Ge(M[0],F);for(var V=1;V<M.length;V++)Ge(M[V],!F)}}function Ge(M,F){for(var V=0,K=0,J=M.length,le=J-1;K<J;le=K++)V+=(M[K][0]-M[le][0])*(M[le][1]+M[K][1]);V>=0!=!!F&&M.reverse()}Ie.prototype.loadTile=function(M,F){var V=M.uid,K=M.encoding,J=M.rawImageData,le=De&&J instanceof De?this.getImageData(J):J,ce=new a.DEMData(V,le,K);this.loaded=this.loaded||{},this.loaded[V]=ce,F(null,ce)},Ie.prototype.getImageData=function(M){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(M.width,M.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=M.width,this.offscreenCanvas.height=M.height,this.offscreenCanvasContext.drawImage(M,0,0,M.width,M.height);var F=this.offscreenCanvasContext.getImageData(-1,-1,M.width+2,M.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:F.width,height:F.height},F.data)},Ie.prototype.removeTile=function(M){var F=this.loaded,V=M.uid;F&&F[V]&&delete F[V]};var Pt=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,Tt=function(M){this._feature=M,this.extent=a.EXTENT,this.type=M.type,this.properties=M.tags,"id"in M&&!isNaN(M.id)&&(this.id=parseInt(M.id,10))};Tt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var M=[],F=0,V=this._feature.geometry;F<V.length;F+=1){var K=V[F];M.push([new a.Point$1(K[0],K[1])])}return M}for(var J=[],le=0,ce=this._feature.geometry;le<ce.length;le+=1){for(var U=[],re=0,me=ce[le];re<me.length;re+=1){var Re=me[re];U.push(new a.Point$1(Re[0],Re[1]))}J.push(U)}return J},Tt.prototype.toGeoJSON=function(M,F,V){return Pt.call(this,M,F,V)};var ct=function(M){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=M.length,this._features=M};ct.prototype.feature=function(M){return new Tt(this._features[M])};var He=a.vectorTile.VectorTileFeature,Vt=Ht;function Ht(M,F){this.options=F||{},this.features=M,this.length=M.length}function Rt(M,F){this.id=typeof M.id=="number"?M.id:void 0,this.type=M.type,this.rawGeometry=M.type===1?[M.geometry]:M.geometry,this.properties=M.tags,this.extent=F||4096}Ht.prototype.feature=function(M){return new Rt(this.features[M],this.options.extent)},Rt.prototype.loadGeometry=function(){var M=this.rawGeometry;this.geometry=[];for(var F=0;F<M.length;F++){for(var V=M[F],K=[],J=0;J<V.length;J++)K.push(new a.Point$1(V[J][0],V[J][1]));this.geometry.push(K)}return this.geometry},Rt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var M=this.geometry,F=1/0,V=-1/0,K=1/0,J=-1/0,le=0;le<M.length;le++)for(var ce=M[le],U=0;U<ce.length;U++){var re=ce[U];F=Math.min(F,re.x),V=Math.max(V,re.x),K=Math.min(K,re.y),J=Math.max(J,re.y)}return[F,K,V,J]},Rt.prototype.toGeoJSON=He.prototype.toGeoJSON;var gt=At,Fe=Vt;function At(M){var F=new a.pbf;return function(V,K){for(var J in V.layers)K.writeMessage(3,ot,V.layers[J])}(M,F),F.finish()}function ot(M,F){var V;F.writeVarintField(15,M.version||1),F.writeStringField(1,M.name||""),F.writeVarintField(5,M.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<M.length;V++)K.feature=M.feature(V),F.writeMessage(2,xt,K);var J=K.keys;for(V=0;V<J.length;V++)F.writeStringField(3,J[V]);var le=K.values;for(V=0;V<le.length;V++)F.writeMessage(4,zt,le[V])}function xt(M,F){var V=M.feature;V.id!==void 0&&F.writeVarintField(1,V.id),F.writeMessage(2,Ve,M),F.writeVarintField(3,V.type),F.writeMessage(4,fr,V)}function Ve(M,F){var V=M.feature,K=M.keys,J=M.values,le=M.keycache,ce=M.valuecache;for(var U in V.properties){var re=le[U];re===void 0&&(K.push(U),le[U]=re=K.length-1),F.writeVarint(re);var me=V.properties[U],Re=typeof me;Re!=="string"&&Re!=="boolean"&&Re!=="number"&&(me=JSON.stringify(me));var Ne=Re+":"+me,be=ce[Ne];be===void 0&&(J.push(me),ce[Ne]=be=J.length-1),F.writeVarint(be)}}function Ue(M,F){return(F<<3)+(7&M)}function _t(M){return M<<1^M>>31}function fr(M,F){for(var V=M.loadGeometry(),K=M.type,J=0,le=0,ce=V.length,U=0;U<ce;U++){var re=V[U],me=1;K===1&&(me=re.length),F.writeVarint(Ue(1,me));for(var Re=K===3?re.length-1:re.length,Ne=0;Ne<Re;Ne++){Ne===1&&K!==1&&F.writeVarint(Ue(2,Re-1));var be=re[Ne].x-J,Be=re[Ne].y-le;F.writeVarint(_t(be)),F.writeVarint(_t(Be)),J+=be,le+=Be}K===3&&F.writeVarint(Ue(7,1))}}function zt(M,F){var V=typeof M;V==="string"?F.writeStringField(1,M):V==="boolean"?F.writeBooleanField(7,M):V==="number"&&(M%1!=0?F.writeDoubleField(3,M):M<0?F.writeSVarintField(6,M):F.writeVarintField(5,M))}function je(M,F,V,K){Ke(M,V,K),Ke(F,2*V,2*K),Ke(F,2*V+1,2*K+1)}function Ke(M,F,V){var K=M[F];M[F]=M[V],M[V]=K}function hr(M,F,V,K){var J=M-V,le=F-K;return J*J+le*le}gt.fromVectorTileJs=At,gt.fromGeojsonVt=function(M,F){F=F||{};var V={};for(var K in M)V[K]=new Vt(M[K].features,F),V[K].name=K,V[K].version=F.version,V[K].extent=F.extent;return At({layers:V})},gt.GeoJSONWrapper=Fe;var Vr=function(M){return M[0]},Ji=function(M){return M[1]},Yi=function(M,F,V,K,J){F===void 0&&(F=Vr),V===void 0&&(V=Ji),K===void 0&&(K=64),J===void 0&&(J=Float64Array),this.nodeSize=K,this.points=M;for(var le=M.length<65536?Uint16Array:Uint32Array,ce=this.ids=new le(M.length),U=this.coords=new J(2*M.length),re=0;re<M.length;re++)ce[re]=re,U[2*re]=F(M[re]),U[2*re+1]=V(M[re]);(function me(Re,Ne,be,Be,nt,it){if(!(nt-Be<=be)){var we=Be+nt>>1;(function $e(qe,Xe,jt,et,Kt,dr){for(;Kt>et;){if(Kt-et>600){var Ft=Kt-et+1,$t=jt-et+1,er=Math.log(Ft),ai=.5*Math.exp(2*er/3),rr=.5*Math.sqrt(er*ai*(Ft-ai)/Ft)*($t-Ft/2<0?-1:1);$e(qe,Xe,jt,Math.max(et,Math.floor(jt-$t*ai/Ft+rr)),Math.min(Kt,Math.floor(jt+(Ft-$t)*ai/Ft+rr)),dr)}var Cr=Xe[2*jt+dr],Xt=et,qt=Kt;for(je(qe,Xe,et,jt),Xe[2*Kt+dr]>Cr&&je(qe,Xe,et,Kt);Xt<qt;){for(je(qe,Xe,Xt,qt),Xt++,qt--;Xe[2*Xt+dr]<Cr;)Xt++;for(;Xe[2*qt+dr]>Cr;)qt--}Xe[2*et+dr]===Cr?je(qe,Xe,et,qt):je(qe,Xe,++qt,Kt),qt<=jt&&(et=qt+1),jt<=qt&&(Kt=qt-1)}})(Re,Ne,we,Be,nt,it%2),me(Re,Ne,be,Be,we-1,it+1),me(Re,Ne,be,we+1,nt,it+1)}})(ce,U,K,0,ce.length-1,0)};Yi.prototype.range=function(M,F,V,K){return function(J,le,ce,U,re,me,Re){for(var Ne,be,Be=[0,J.length-1,0],nt=[];Be.length;){var it=Be.pop(),we=Be.pop(),$e=Be.pop();if(we-$e<=Re)for(var qe=$e;qe<=we;qe++)be=le[2*qe+1],(Ne=le[2*qe])>=ce&&Ne<=re&&be>=U&&be<=me&&nt.push(J[qe]);else{var Xe=Math.floor(($e+we)/2);be=le[2*Xe+1],(Ne=le[2*Xe])>=ce&&Ne<=re&&be>=U&&be<=me&&nt.push(J[Xe]);var jt=(it+1)%2;(it===0?ce<=Ne:U<=be)&&(Be.push($e),Be.push(Xe-1),Be.push(jt)),(it===0?re>=Ne:me>=be)&&(Be.push(Xe+1),Be.push(we),Be.push(jt))}}return nt}(this.ids,this.coords,M,F,V,K,this.nodeSize)},Yi.prototype.within=function(M,F,V){return function(K,J,le,ce,U,re){for(var me=[0,K.length-1,0],Re=[],Ne=U*U;me.length;){var be=me.pop(),Be=me.pop(),nt=me.pop();if(Be-nt<=re)for(var it=nt;it<=Be;it++)hr(J[2*it],J[2*it+1],le,ce)<=Ne&&Re.push(K[it]);else{var we=Math.floor((nt+Be)/2),$e=J[2*we],qe=J[2*we+1];hr($e,qe,le,ce)<=Ne&&Re.push(K[we]);var Xe=(be+1)%2;(be===0?le-U<=$e:ce-U<=qe)&&(me.push(nt),me.push(we-1),me.push(Xe)),(be===0?le+U>=$e:ce+U>=qe)&&(me.push(we+1),me.push(Be),me.push(Xe))}}return Re}(this.ids,this.coords,M,F,V,this.nodeSize)};var _i={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(M){return M}},Gr=function(M){this.options=Vi(Object.create(_i),M),this.trees=new Array(this.options.maxZoom+1)};function Ni(M,F,V,K,J){return{x:M,y:F,zoom:1/0,id:V,parentId:-1,numPoints:K,properties:J}}function lr(M,F){var V=M.geometry.coordinates,K=V[1];return{x:Jt(V[0]),y:Gt(K),zoom:1/0,index:F,parentId:-1}}function Sr(M){return{type:"Feature",id:M.id,properties:dt(M),geometry:{type:"Point",coordinates:[(K=M.x,360*(K-.5)),(F=M.y,V=(180-360*F)*Math.PI/180,360*Math.atan(Math.exp(V))/Math.PI-90)]}};var F,V,K}function dt(M){var F=M.numPoints,V=F>=1e4?Math.round(F/1e3)+"k":F>=1e3?Math.round(F/100)/10+"k":F;return Vi(Vi({},M.properties),{cluster:!0,cluster_id:M.id,point_count:F,point_count_abbreviated:V})}function Jt(M){return M/360+.5}function Gt(M){var F=Math.sin(M*Math.PI/180),V=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return V<0?0:V>1?1:V}function Vi(M,F){for(var V in F)M[V]=F[V];return M}function Kr(M){return M.x}function Hr(M){return M.y}function Jr(M,F,V,K,J,le){var ce=J-V,U=le-K;if(ce!==0||U!==0){var re=((M-V)*ce+(F-K)*U)/(ce*ce+U*U);re>1?(V=J,K=le):re>0&&(V+=ce*re,K+=U*re)}return(ce=M-V)*ce+(U=F-K)*U}function Xr(M,F,V,K){var J={id:M===void 0?null:M,type:F,geometry:V,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(le){var ce=le.geometry,U=le.type;if(U==="Point"||U==="MultiPoint"||U==="LineString")Ui(le,ce);else if(U==="Polygon"||U==="MultiLineString")for(var re=0;re<ce.length;re++)Ui(le,ce[re]);else if(U==="MultiPolygon")for(re=0;re<ce.length;re++)for(var me=0;me<ce[re].length;me++)Ui(le,ce[re][me])}(J),J}function Ui(M,F){for(var V=0;V<F.length;V+=3)M.minX=Math.min(M.minX,F[V]),M.minY=Math.min(M.minY,F[V+1]),M.maxX=Math.max(M.maxX,F[V]),M.maxY=Math.max(M.maxY,F[V+1])}function Ei(M,F,V,K){if(F.geometry){var J=F.geometry.coordinates,le=F.geometry.type,ce=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),U=[],re=F.id;if(V.promoteId?re=F.properties[V.promoteId]:V.generateId&&(re=K||0),le==="Point")Ri(J,U);else if(le==="MultiPoint")for(var me=0;me<J.length;me++)Ri(J[me],U);else if(le==="LineString")sn(J,U,ce,!1);else if(le==="MultiLineString"){if(V.lineMetrics){for(me=0;me<J.length;me++)sn(J[me],U=[],ce,!1),M.push(Xr(re,"LineString",U,F.properties));return}gi(J,U,ce,!1)}else if(le==="Polygon")gi(J,U,ce,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(me=0;me<F.geometry.geometries.length;me++)Ei(M,{id:re,geometry:F.geometry.geometries[me],properties:F.properties},V,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<J.length;me++){var Re=[];gi(J[me],Re,ce,!0),U.push(Re)}}M.push(Xr(re,le,U,F.properties))}}function Ri(M,F){F.push(Ti(M[0])),F.push(gn(M[1])),F.push(0)}function sn(M,F,V,K){for(var J,le,ce=0,U=0;U<M.length;U++){var re=Ti(M[U][0]),me=gn(M[U][1]);F.push(re),F.push(me),F.push(0),U>0&&(ce+=K?(J*me-re*le)/2:Math.sqrt(Math.pow(re-J,2)+Math.pow(me-le,2))),J=re,le=me}var Re=F.length-3;F[2]=1,function Ne(be,Be,nt,it){for(var we,$e=it,qe=nt-Be>>1,Xe=nt-Be,jt=be[Be],et=be[Be+1],Kt=be[nt],dr=be[nt+1],Ft=Be+3;Ft<nt;Ft+=3){var $t=Jr(be[Ft],be[Ft+1],jt,et,Kt,dr);if($t>$e)we=Ft,$e=$t;else if($t===$e){var er=Math.abs(Ft-qe);er<Xe&&(we=Ft,Xe=er)}}$e>it&&(we-Be>3&&Ne(be,Be,we,it),be[we+2]=$e,nt-we>3&&Ne(be,we,nt,it))}(F,0,Re,V),F[Re+2]=1,F.size=Math.abs(ce),F.start=0,F.end=F.size}function gi(M,F,V,K){for(var J=0;J<M.length;J++){var le=[];sn(M[J],le,V,K),F.push(le)}}function Ti(M){return M/360+.5}function gn(M){var F=Math.sin(M*Math.PI/180),V=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return V<0?0:V>1?1:V}function Er(M,F,V,K,J,le,ce,U){if(K/=F,le>=(V/=F)&&ce<K)return M;if(ce<V||le>=K)return null;for(var re=[],me=0;me<M.length;me++){var Re=M[me],Ne=Re.geometry,be=Re.type,Be=J===0?Re.minX:Re.minY,nt=J===0?Re.maxX:Re.maxY;if(Be>=V&&nt<K)re.push(Re);else if(!(nt<V||Be>=K)){var it=[];if(be==="Point"||be==="MultiPoint")Yr(Ne,it,V,K,J);else if(be==="LineString")zo(Ne,it,V,K,J,!1,U.lineMetrics);else if(be==="MultiLineString")Ii(Ne,it,V,K,J,!1);else if(be==="Polygon")Ii(Ne,it,V,K,J,!0);else if(be==="MultiPolygon")for(var we=0;we<Ne.length;we++){var $e=[];Ii(Ne[we],$e,V,K,J,!0),$e.length&&it.push($e)}if(it.length){if(U.lineMetrics&&be==="LineString"){for(we=0;we<it.length;we++)re.push(Xr(Re.id,be,it[we],Re.tags));continue}be!=="LineString"&&be!=="MultiLineString"||(it.length===1?(be="LineString",it=it[0]):be="MultiLineString"),be!=="Point"&&be!=="MultiPoint"||(be=it.length===3?"Point":"MultiPoint"),re.push(Xr(Re.id,be,it,Re.tags))}}}return re.length?re:null}function Yr(M,F,V,K,J){for(var le=0;le<M.length;le+=3){var ce=M[le+J];ce>=V&&ce<=K&&(F.push(M[le]),F.push(M[le+1]),F.push(M[le+2]))}}function zo(M,F,V,K,J,le,ce){for(var U,re,me=pi(M),Re=J===0?Co:vn,Ne=M.start,be=0;be<M.length-3;be+=3){var Be=M[be],nt=M[be+1],it=M[be+2],we=M[be+3],$e=M[be+4],qe=J===0?Be:nt,Xe=J===0?we:$e,jt=!1;ce&&(U=Math.sqrt(Math.pow(Be-we,2)+Math.pow(nt-$e,2))),qe<V?Xe>V&&(re=Re(me,Be,nt,we,$e,V),ce&&(me.start=Ne+U*re)):qe>K?Xe<K&&(re=Re(me,Be,nt,we,$e,K),ce&&(me.start=Ne+U*re)):ji(me,Be,nt,it),Xe<V&&qe>=V&&(re=Re(me,Be,nt,we,$e,V),jt=!0),Xe>K&&qe<=K&&(re=Re(me,Be,nt,we,$e,K),jt=!0),!le&&jt&&(ce&&(me.end=Ne+U*re),F.push(me),me=pi(M)),ce&&(Ne+=U)}var et=M.length-3;Be=M[et],nt=M[et+1],it=M[et+2],(qe=J===0?Be:nt)>=V&&qe<=K&&ji(me,Be,nt,it),et=me.length-3,le&&et>=3&&(me[et]!==me[0]||me[et+1]!==me[1])&&ji(me,me[0],me[1],me[2]),me.length&&F.push(me)}function pi(M){var F=[];return F.size=M.size,F.start=M.start,F.end=M.end,F}function Ii(M,F,V,K,J,le){for(var ce=0;ce<M.length;ce++)zo(M[ce],F,V,K,J,le,!1)}function ji(M,F,V,K){M.push(F),M.push(V),M.push(K)}function Co(M,F,V,K,J,le){var ce=(le-F)/(K-F);return M.push(le),M.push(V+(J-V)*ce),M.push(1),ce}function vn(M,F,V,K,J,le){var ce=(le-V)/(J-V);return M.push(F+(K-F)*ce),M.push(le),M.push(1),ce}function ho(M,F){for(var V=[],K=0;K<M.length;K++){var J,le=M[K],ce=le.type;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")J=Un(le.geometry,F);else if(ce==="MultiLineString"||ce==="Polygon"){J=[];for(var U=0;U<le.geometry.length;U++)J.push(Un(le.geometry[U],F))}else if(ce==="MultiPolygon")for(J=[],U=0;U<le.geometry.length;U++){for(var re=[],me=0;me<le.geometry[U].length;me++)re.push(Un(le.geometry[U][me],F));J.push(re)}V.push(Xr(le.id,ce,J,le.tags))}return V}function Un(M,F){var V=[];V.size=M.size,M.start!==void 0&&(V.start=M.start,V.end=M.end);for(var K=0;K<M.length;K+=3)V.push(M[K]+F,M[K+1],M[K+2]);return V}function xn(M,F){if(M.transformed)return M;var V,K,J,le=1<<M.z,ce=M.x,U=M.y;for(V=0;V<M.features.length;V++){var re=M.features[V],me=re.geometry,Re=re.type;if(re.geometry=[],Re===1)for(K=0;K<me.length;K+=2)re.geometry.push(An(me[K],me[K+1],F,le,ce,U));else for(K=0;K<me.length;K++){var Ne=[];for(J=0;J<me[K].length;J+=2)Ne.push(An(me[K][J],me[K][J+1],F,le,ce,U));re.geometry.push(Ne)}}return M.transformed=!0,M}function An(M,F,V,K,J,le){return[Math.round(V*(M*K-J)),Math.round(V*(F*K-le))]}function Po(M,F,V,K,J){for(var le=F===J.maxZoom?0:J.tolerance/((1<<F)*J.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:K,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},U=0;U<M.length;U++){ce.numFeatures++,Mo(ce,M[U],le,J);var re=M[U].minX,me=M[U].minY,Re=M[U].maxX,Ne=M[U].maxY;re<ce.minX&&(ce.minX=re),me<ce.minY&&(ce.minY=me),Re>ce.maxX&&(ce.maxX=Re),Ne>ce.maxY&&(ce.maxY=Ne)}return ce}function Mo(M,F,V,K){var J=F.geometry,le=F.type,ce=[];if(le==="Point"||le==="MultiPoint")for(var U=0;U<J.length;U+=3)ce.push(J[U]),ce.push(J[U+1]),M.numPoints++,M.numSimplified++;else if(le==="LineString")Qi(ce,J,M,V,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(U=0;U<J.length;U++)Qi(ce,J[U],M,V,le==="Polygon",U===0);else if(le==="MultiPolygon")for(var re=0;re<J.length;re++){var me=J[re];for(U=0;U<me.length;U++)Qi(ce,me[U],M,V,!0,U===0)}if(ce.length){var Re=F.tags||null;if(le==="LineString"&&K.lineMetrics){for(var Ne in Re={},F.tags)Re[Ne]=F.tags[Ne];Re.mapbox_clip_start=J.start/J.size,Re.mapbox_clip_end=J.end/J.size}var be={geometry:ce,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Re};F.id!==null&&(be.id=F.id),M.features.push(be)}}function Qi(M,F,V,K,J,le){var ce=K*K;if(K>0&&F.size<(J?ce:K))V.numPoints+=F.length/3;else{for(var U=[],re=0;re<F.length;re+=3)(K===0||F[re+2]>ce)&&(V.numSimplified++,U.push(F[re]),U.push(F[re+1])),V.numPoints++;J&&function(me,Re){for(var Ne=0,be=0,Be=me.length,nt=Be-2;be<Be;nt=be,be+=2)Ne+=(me[be]-me[nt])*(me[be+1]+me[nt+1]);if(Ne>0===Re)for(be=0,Be=me.length;be<Be/2;be+=2){var it=me[be],we=me[be+1];me[be]=me[Be-2-be],me[be+1]=me[Be-1-be],me[Be-2-be]=it,me[Be-1-be]=we}}(U,le),M.push(U)}}function $i(M,F){var V=(F=this.options=function(J,le){for(var ce in le)J[ce]=le[ce];return J}(Object.create(this.options),F)).debug;if(V&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(J,le){var ce=[];if(J.type==="FeatureCollection")for(var U=0;U<J.features.length;U++)Ei(ce,J.features[U],le,U);else Ei(ce,J.type==="Feature"?J:{geometry:J},le);return ce}(M,F);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(K=function(J,le){var ce=le.buffer/le.extent,U=J,re=Er(J,1,-1-ce,ce,0,-1,2,le),me=Er(J,1,1-ce,2+ce,0,-1,2,le);return(re||me)&&(U=Er(J,1,-ce,1+ce,0,-1,2,le)||[],re&&(U=ho(re,1).concat(U)),me&&(U=U.concat(ho(me,-1)))),U}(K,F)).length&&this.splitTile(K,0,0,0),V&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ln(M,F,V){return 32*((1<<M)*V+F)+M}function to(M,F){var V=M.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);var K=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!K)return F(null,null);var J=new ct(K.features),le=gt(J);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),F(null,{vectorTile:J,rawData:le.buffer})}Gr.prototype.load=function(M){var F=this.options,V=F.log,K=F.minZoom,J=F.maxZoom,le=F.nodeSize;V&&console.time("total time");var ce="prepare "+M.length+" points";V&&console.time(ce),this.points=M;for(var U=[],re=0;re<M.length;re++)M[re].geometry&&U.push(lr(M[re],re));this.trees[J+1]=new Yi(U,Kr,Hr,le,Float32Array),V&&console.timeEnd(ce);for(var me=J;me>=K;me--){var Re=+Date.now();U=this._cluster(U,me),this.trees[me]=new Yi(U,Kr,Hr,le,Float32Array),V&&console.log("z%d: %d clusters in %dms",me,U.length,+Date.now()-Re)}return V&&console.timeEnd("total time"),this},Gr.prototype.getClusters=function(M,F){var V=((M[0]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,M[1])),J=M[2]===180?180:((M[2]+180)%360+360)%360-180,le=Math.max(-90,Math.min(90,M[3]));if(M[2]-M[0]>=360)V=-180,J=180;else if(V>J){var ce=this.getClusters([V,K,180,le],F),U=this.getClusters([-180,K,J,le],F);return ce.concat(U)}for(var re=this.trees[this._limitZoom(F)],me=[],Re=0,Ne=re.range(Jt(V),Gt(le),Jt(J),Gt(K));Re<Ne.length;Re+=1){var be=re.points[Ne[Re]];me.push(be.numPoints?Sr(be):this.points[be.index])}return me},Gr.prototype.getChildren=function(M){var F=this._getOriginId(M),V=this._getOriginZoom(M),K="No cluster with the specified id.",J=this.trees[V];if(!J)throw new Error(K);var le=J.points[F];if(!le)throw new Error(K);for(var ce=this.options.radius/(this.options.extent*Math.pow(2,V-1)),U=[],re=0,me=J.within(le.x,le.y,ce);re<me.length;re+=1){var Re=J.points[me[re]];Re.parentId===M&&U.push(Re.numPoints?Sr(Re):this.points[Re.index])}if(U.length===0)throw new Error(K);return U},Gr.prototype.getLeaves=function(M,F,V){var K=[];return this._appendLeaves(K,M,F=F||10,V=V||0,0),K},Gr.prototype.getTile=function(M,F,V){var K=this.trees[this._limitZoom(M)],J=Math.pow(2,M),le=this.options,ce=le.radius/le.extent,U=(V-ce)/J,re=(V+1+ce)/J,me={features:[]};return this._addTileFeatures(K.range((F-ce)/J,U,(F+1+ce)/J,re),K.points,F,V,J,me),F===0&&this._addTileFeatures(K.range(1-ce/J,U,1,re),K.points,J,V,J,me),F===J-1&&this._addTileFeatures(K.range(0,U,ce/J,re),K.points,-1,V,J,me),me.features.length?me:null},Gr.prototype.getClusterExpansionZoom=function(M){for(var F=this._getOriginZoom(M)-1;F<=this.options.maxZoom;){var V=this.getChildren(M);if(F++,V.length!==1)break;M=V[0].properties.cluster_id}return F},Gr.prototype._appendLeaves=function(M,F,V,K,J){for(var le=0,ce=this.getChildren(F);le<ce.length;le+=1){var U=ce[le],re=U.properties;if(re&&re.cluster?J+re.point_count<=K?J+=re.point_count:J=this._appendLeaves(M,re.cluster_id,V,K,J):J<K?J++:M.push(U),M.length===V)break}return J},Gr.prototype._addTileFeatures=function(M,F,V,K,J,le){for(var ce=0,U=M;ce<U.length;ce+=1){var re=F[U[ce]],me=re.numPoints,Re={type:1,geometry:[[Math.round(this.options.extent*(re.x*J-V)),Math.round(this.options.extent*(re.y*J-K))]],tags:me?dt(re):this.points[re.index].properties},Ne=void 0;me?Ne=re.id:this.options.generateId?Ne=re.index:this.points[re.index].id&&(Ne=this.points[re.index].id),Ne!==void 0&&(Re.id=Ne),le.features.push(Re)}},Gr.prototype._limitZoom=function(M){return Math.max(this.options.minZoom,Math.min(+M,this.options.maxZoom+1))},Gr.prototype._cluster=function(M,F){for(var V=[],K=this.options,J=K.reduce,le=K.minPoints,ce=K.radius/(K.extent*Math.pow(2,F)),U=0;U<M.length;U++){var re=M[U];if(!(re.zoom<=F)){re.zoom=F;for(var me=this.trees[F+1],Re=me.within(re.x,re.y,ce),Ne=re.numPoints||1,be=Ne,Be=0,nt=Re;Be<nt.length;Be+=1){var it=me.points[nt[Be]];it.zoom>F&&(be+=it.numPoints||1)}if(be>=le){for(var we=re.x*Ne,$e=re.y*Ne,qe=J&&Ne>1?this._map(re,!0):null,Xe=(U<<5)+(F+1)+this.points.length,jt=0,et=Re;jt<et.length;jt+=1){var Kt=me.points[et[jt]];if(!(Kt.zoom<=F)){Kt.zoom=F;var dr=Kt.numPoints||1;we+=Kt.x*dr,$e+=Kt.y*dr,Kt.parentId=Xe,J&&(qe||(qe=this._map(re,!0)),J(qe,this._map(Kt)))}}re.parentId=Xe,V.push(Ni(we/be,$e/be,Xe,be,qe))}else if(V.push(re),be>1)for(var Ft=0,$t=Re;Ft<$t.length;Ft+=1){var er=me.points[$t[Ft]];er.zoom<=F||(er.zoom=F,V.push(er))}}}return V},Gr.prototype._getOriginId=function(M){return M-this.points.length>>5},Gr.prototype._getOriginZoom=function(M){return(M-this.points.length)%32},Gr.prototype._map=function(M,F){if(M.numPoints)return F?Vi({},M.properties):M.properties;var V=this.points[M.index].properties,K=this.options.map(V);return F&&K===V?Vi({},K):K},$i.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$i.prototype.splitTile=function(M,F,V,K,J,le,ce){for(var U=[M,F,V,K],re=this.options,me=re.debug;U.length;){K=U.pop(),V=U.pop(),F=U.pop(),M=U.pop();var Re=1<<F,Ne=ln(F,V,K),be=this.tiles[Ne];if(!be&&(me>1&&console.time("creation"),be=this.tiles[Ne]=Po(M,F,V,K,re),this.tileCoords.push({z:F,x:V,y:K}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,V,K,be.numFeatures,be.numPoints,be.numSimplified),console.timeEnd("creation"));var Be="z"+F;this.stats[Be]=(this.stats[Be]||0)+1,this.total++}if(be.source=M,J){if(F===re.maxZoom||F===J)continue;var nt=1<<J-F;if(V!==Math.floor(le/nt)||K!==Math.floor(ce/nt))continue}else if(F===re.indexMaxZoom||be.numPoints<=re.indexMaxPoints)continue;if(be.source=null,M.length!==0){me>1&&console.time("clipping");var it,we,$e,qe,Xe,jt,et=.5*re.buffer/re.extent,Kt=.5-et,dr=.5+et,Ft=1+et;it=we=$e=qe=null,Xe=Er(M,Re,V-et,V+dr,0,be.minX,be.maxX,re),jt=Er(M,Re,V+Kt,V+Ft,0,be.minX,be.maxX,re),M=null,Xe&&(it=Er(Xe,Re,K-et,K+dr,1,be.minY,be.maxY,re),we=Er(Xe,Re,K+Kt,K+Ft,1,be.minY,be.maxY,re),Xe=null),jt&&($e=Er(jt,Re,K-et,K+dr,1,be.minY,be.maxY,re),qe=Er(jt,Re,K+Kt,K+Ft,1,be.minY,be.maxY,re),jt=null),me>1&&console.timeEnd("clipping"),U.push(it||[],F+1,2*V,2*K),U.push(we||[],F+1,2*V,2*K+1),U.push($e||[],F+1,2*V+1,2*K),U.push(qe||[],F+1,2*V+1,2*K+1)}}},$i.prototype.getTile=function(M,F,V){var K=this.options,J=K.extent,le=K.debug;if(M<0||M>24)return null;var ce=1<<M,U=ln(M,F=(F%ce+ce)%ce,V);if(this.tiles[U])return xn(this.tiles[U],J);le>1&&console.log("drilling down to z%d-%d-%d",M,F,V);for(var re,me=M,Re=F,Ne=V;!re&&me>0;)me--,Re=Math.floor(Re/2),Ne=Math.floor(Ne/2),re=this.tiles[ln(me,Re,Ne)];return re&&re.source?(le>1&&console.log("found parent tile z%d-%d-%d",me,Re,Ne),le>1&&console.time("drilling down"),this.splitTile(re.source,me,Re,Ne,M,F,V),le>1&&console.timeEnd("drilling down"),this.tiles[U]?xn(this.tiles[U],J):null):null};var jn=function(M){function F(V,K,J,le){M.call(this,V,K,J,to),le&&(this.loadGeoJSON=le)}return M&&(F.__proto__=M),(F.prototype=Object.create(M&&M.prototype)).constructor=F,F.prototype.loadData=function(V,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=K,this._pendingLoadDataParams=V,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},F.prototype._loadData=function(){var V=this;if(this._pendingCallback&&this._pendingLoadDataParams){var K=this._pendingCallback,J=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var le=!!(J&&J.request&&J.request.collectResourceTiming)&&new a.RequestPerformance(J.request);this.loadGeoJSON(J,function(ce,U){if(ce||!U)return K(ce);if(typeof U!="object")return K(new Error("Input data given to '"+J.source+"' is not a valid GeoJSON object."));(function be(Be,nt){var it,we=Be&&Be.type;if(we==="FeatureCollection")for(it=0;it<Be.features.length;it++)be(Be.features[it],nt);else if(we==="GeometryCollection")for(it=0;it<Be.geometries.length;it++)be(Be.geometries[it],nt);else if(we==="Feature")be(Be.geometry,nt);else if(we==="Polygon")rt(Be.coordinates,nt);else if(we==="MultiPolygon")for(it=0;it<Be.coordinates.length;it++)rt(Be.coordinates[it],nt);return Be})(U,!0);try{if(J.filter){var re=a.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(re.result==="error")throw new Error(re.value.map(function(be){return be.key+": "+be.message}).join(", "));var me=U.features.filter(function(be){return re.value.evaluate({zoom:0},be)});U={type:"FeatureCollection",features:me}}V._geoJSONIndex=J.cluster?new Gr(function(be){var Be=be.superclusterOptions,nt=be.clusterProperties;if(!nt||!Be)return Be;for(var it={},we={},$e={accumulated:null,zoom:0},qe={properties:null},Xe=Object.keys(nt),jt=0,et=Xe;jt<et.length;jt+=1){var Kt=et[jt],dr=nt[Kt],Ft=dr[0],$t=a.createExpression(dr[1]),er=a.createExpression(typeof Ft=="string"?[Ft,["accumulated"],["get",Kt]]:Ft);it[Kt]=$t.value,we[Kt]=er.value}return Be.map=function(ai){qe.properties=ai;for(var rr={},Cr=0,Xt=Xe;Cr<Xt.length;Cr+=1){var qt=Xt[Cr];rr[qt]=it[qt].evaluate($e,qe)}return rr},Be.reduce=function(ai,rr){qe.properties=rr;for(var Cr=0,Xt=Xe;Cr<Xt.length;Cr+=1){var qt=Xt[Cr];$e.accumulated=ai[qt],ai[qt]=we[qt].evaluate($e,qe)}},Be}(J)).load(U.features):function(be,Be){return new $i(be,Be)}(U,J.geojsonVtOptions)}catch(be){return K(be)}V.loaded={};var Re={};if(le){var Ne=le.finish();Ne&&(Re.resourceTiming={},Re.resourceTiming[J.source]=JSON.parse(JSON.stringify(Ne)))}K(null,Re)})}},F.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},F.prototype.reloadTile=function(V,K){var J=this.loaded;return J&&J[V.uid]?M.prototype.reloadTile.call(this,V,K):this.loadTile(V,K)},F.prototype.loadGeoJSON=function(V,K){if(V.request)a.getJSON(V.request,K);else{if(typeof V.data!="string")return K(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."));try{return K(null,JSON.parse(V.data))}catch{return K(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."))}}},F.prototype.removeSource=function(V,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()},F.prototype.getClusterExpansionZoom=function(V,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(J){K(J)}},F.prototype.getClusterChildren=function(V,K){try{K(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(J){K(J)}},F.prototype.getClusterLeaves=function(V,K){try{K(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(J){K(J)}},F}(pe),ar=function(M){var F=this;this.self=M,this.actor=new a.Actor(M,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:pe,geojson:jn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(V,K){if(F.workerSourceTypes[V])throw new Error('Worker source with name "'+V+'" already registered.');F.workerSourceTypes[V]=K},this.self.registerRTLTextPlugin=function(V){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=V.applyArabicShaping,a.plugin.processBidirectionalText=V.processBidirectionalText,a.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}};return ar.prototype.setReferrer=function(M,F){this.referrer=F},ar.prototype.setImages=function(M,F,V){for(var K in this.availableImages[M]=F,this.workerSources[M]){var J=this.workerSources[M][K];for(var le in J)J[le].availableImages=F}V()},ar.prototype.setLayers=function(M,F,V){this.getLayerIndex(M).replace(F),V()},ar.prototype.updateLayers=function(M,F,V){this.getLayerIndex(M).update(F.layers,F.removedIds),V()},ar.prototype.loadTile=function(M,F,V){this.getWorkerSource(M,F.type,F.source).loadTile(F,V)},ar.prototype.loadDEMTile=function(M,F,V){this.getDEMWorkerSource(M,F.source).loadTile(F,V)},ar.prototype.reloadTile=function(M,F,V){this.getWorkerSource(M,F.type,F.source).reloadTile(F,V)},ar.prototype.abortTile=function(M,F,V){this.getWorkerSource(M,F.type,F.source).abortTile(F,V)},ar.prototype.removeTile=function(M,F,V){this.getWorkerSource(M,F.type,F.source).removeTile(F,V)},ar.prototype.removeDEMTile=function(M,F){this.getDEMWorkerSource(M,F.source).removeTile(F)},ar.prototype.removeSource=function(M,F,V){if(this.workerSources[M]&&this.workerSources[M][F.type]&&this.workerSources[M][F.type][F.source]){var K=this.workerSources[M][F.type][F.source];delete this.workerSources[M][F.type][F.source],K.removeSource!==void 0?K.removeSource(F,V):V()}},ar.prototype.loadWorkerSource=function(M,F,V){try{this.self.importScripts(F.url),V()}catch(K){V(K.toString())}},ar.prototype.syncRTLPluginState=function(M,F,V){try{a.plugin.setState(F);var K=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&K!=null){this.self.importScripts(K);var J=a.plugin.isParsed();V(J?void 0:new Error("RTL Text Plugin failed to import scripts from "+K),J)}}catch(le){V(le.toString())}},ar.prototype.getAvailableImages=function(M){var F=this.availableImages[M];return F||(F=[]),F},ar.prototype.getLayerIndex=function(M){var F=this.layerIndexes[M];return F||(F=this.layerIndexes[M]=new B),F},ar.prototype.getWorkerSource=function(M,F,V){var K=this;return this.workerSources[M]||(this.workerSources[M]={}),this.workerSources[M][F]||(this.workerSources[M][F]={}),this.workerSources[M][F][V]||(this.workerSources[M][F][V]=new this.workerSourceTypes[F]({send:function(J,le,ce){K.actor.send(J,le,ce,M)}},this.getLayerIndex(M),this.getAvailableImages(M))),this.workerSources[M][F][V]},ar.prototype.getDEMWorkerSource=function(M,F){return this.demWorkerSources[M]||(this.demWorkerSources[M]={}),this.demWorkerSources[M][F]||(this.demWorkerSources[M][F]=new Ie),this.demWorkerSources[M][F]},ar.prototype.enforceCacheSizeLimit=function(M,F){a.enforceCacheSizeLimit(F)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ar(self)),ar}),x(["./shared"],function(a){var A=a.createCommonjsModule(function(n){function s(m){return!o(m)}function o(m){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,E,C=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(C);try{E=new Worker(R),S=!0}catch{S=!1}return E&&E.terminate(),URL.revokeObjectURL(R),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var E=S.getContext("2d");if(!E)return!1;var C=E.getImageData(0,0,1,1);return C&&C.width===S.width}()?(u[w=m&&m.failIfMajorPerformanceCaveat]===void 0&&(u[w]=function(S){var E=function(R){var Z=document.createElement("canvas"),G=Object.create(s.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=R,Z.probablySupportsContext?Z.probablySupportsContext("webgl",G)||Z.probablySupportsContext("experimental-webgl",G):Z.supportsContext?Z.supportsContext("webgl",G)||Z.supportsContext("experimental-webgl",G):Z.getContext("webgl",G)||Z.getContext("experimental-webgl",G)}(S);if(!E)return!1;var C=E.createShader(E.VERTEX_SHADER);return!(!C||E.isContextLost())&&(E.shaderSource(C,"void main() {}"),E.compileShader(C),E.getShaderParameter(C,E.COMPILE_STATUS)===!0)}(w)),u[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var u={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),I={create:function(n,s,o){var u=a.window.document.createElement(n);return s!==void 0&&(u.className=s),o&&o.appendChild(u),u},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},B=a.window.document&&a.window.document.documentElement.style;function L(n){if(!B)return n[0];for(var s=0;s<n.length;s++)if(n[s]in B)return n[s];return n[0]}var j,N=L(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);I.disableDrag=function(){B&&N&&(j=B[N],B[N]="none")},I.enableDrag=function(){B&&N&&(B[N]=j)};var X=L(["transform","WebkitTransform"]);I.setTransform=function(n,s){n.style[X]=s};var pe=!1;try{var De=Object.defineProperty({},"passive",{get:function(){pe=!0}});a.window.addEventListener("test",De,De),a.window.removeEventListener("test",De,De)}catch{pe=!1}I.addEventListener=function(n,s,o,u){u===void 0&&(u={}),n.addEventListener(s,o,"passive"in u&&pe?u:u.capture)},I.removeEventListener=function(n,s,o,u){u===void 0&&(u={}),n.removeEventListener(s,o,"passive"in u&&pe?u:u.capture)};var Ie=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",Ie,!0)};function rt(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}I.suppressClick=function(){a.window.addEventListener("click",Ie,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",Ie,!0)},0)},I.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},I.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),u=[],m=0;m<s.length;m++)u.push(new a.Point(s[m].clientX-o.left-n.clientLeft,s[m].clientY-o.top-n.clientTop));return u},I.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},I.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Ge=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var u=0,m=this.requestors;u<m.length;u+=1){var w=m[u];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,u){this._validate(o,u)&&(this.images[o]=u)},s.prototype._validate=function(o,u){var m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),m=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),m=!1),m},s.prototype._validateStretch=function(o,u){if(!o)return!0;for(var m=0,w=0,S=o;w<S.length;w+=1){var E=S[w];if(E[0]<m||E[1]<E[0]||u<E[1])return!1;m=E[1]}return!0},s.prototype._validateContent=function(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,u){var m=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(m=!1);this.isLoaded()||m?this._notify(o,u):this.requestors.push({ids:o,callback:u})},s.prototype._notify=function(o,u){for(var m={},w=0,S=o;w<S.length;w+=1){var E=S[w];this.images[E]||this.fire(new a.Event("styleimagemissing",{id:E}));var C=this.images[E];C?m[E]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:Boolean(C.userImage&&C.userImage.render)}:a.warnOnce('Image "'+E+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,m)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var u=this.patterns[o],m=this.getImage(o);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{var w={w:m.data.width+2,h:m.data.height+2,x:0,y:0},S=new a.ImagePosition(w,m);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var u in this.patterns)o.push(this.patterns[u].bin);var m=a.potpack(o),w=m.w,S=m.h,E=this.atlasImage;for(var C in E.resize({width:w||1,height:S||1}),this.patterns){var R=this.patterns[C].bin,Z=R.x+1,G=R.y+1,W=this.images[C].data,ie=W.width,te=W.height;a.RGBAImage.copy(W,E,{x:0,y:0},{x:Z,y:G},{width:ie,height:te}),a.RGBAImage.copy(W,E,{x:0,y:te-1},{x:Z,y:G-1},{width:ie,height:1}),a.RGBAImage.copy(W,E,{x:0,y:0},{x:Z,y:G+te},{width:ie,height:1}),a.RGBAImage.copy(W,E,{x:ie-1,y:0},{x:Z-1,y:G},{width:1,height:te}),a.RGBAImage.copy(W,E,{x:0,y:0},{x:Z+ie,y:G},{width:1,height:te})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var u=0,m=o;u<m.length;u+=1){var w=m[u];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];rt(S)&&this.updateImage(w,S)}}},s}(a.Evented),Pt=He,Tt=He,ct=1e20;function He(n,s,o,u,m,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=u||.25,this.fontFamily=m||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Vt(n,s,o,u,m,w,S){for(var E=0;E<s;E++){for(var C=0;C<o;C++)u[C]=n[C*s+E];for(Ht(u,m,w,S,o),C=0;C<o;C++)n[C*s+E]=m[C]}for(C=0;C<o;C++){for(E=0;E<s;E++)u[E]=n[C*s+E];for(Ht(u,m,w,S,s),E=0;E<s;E++)n[C*s+E]=Math.sqrt(m[E])}}function Ht(n,s,o,u,m){o[0]=0,u[0]=-ct,u[1]=+ct;for(var w=1,S=0;w<m;w++){for(var E=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);E<=u[S];)S--,E=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,u[S]=E,u[S+1]=+ct}for(w=0,S=0;w<m;w++){for(;u[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}He.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var m=s.data[4*u+3]/255;this.gridOuter[u]=m===1?0:m===0?ct:Math.pow(Math.max(0,.5-m),2),this.gridInner[u]=m===1?ct:m===0?0:Math.pow(Math.max(0,m-.5),2)}for(Vt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Vt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)o[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return o},Pt.default=Tt;var Rt=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};Rt.prototype.setURL=function(n){this.url=n},Rt.prototype.getGlyphs=function(n,s){var o=this,u=[];for(var m in n)for(var w=0,S=n[m];w<S.length;w+=1)u.push({stack:m,id:S[w]});a.asyncAll(u,function(E,C){var R=E.stack,Z=E.id,G=o.entries[R];G||(G=o.entries[R]={glyphs:{},requests:{},ranges:{}});var W=G.glyphs[Z];if(W===void 0){if(W=o._tinySDF(G,R,Z))return G.glyphs[Z]=W,void C(null,{stack:R,id:Z,glyph:W});var ie=Math.floor(Z/256);if(256*ie>65535)C(new Error("glyphs > 65535 not supported"));else if(G.ranges[ie])C(null,{stack:R,id:Z,glyph:W});else{var te=G.requests[ie];te||(te=G.requests[ie]=[],Rt.loadGlyphRange(R,ie,o.url,o.requestManager,function(se,Y){if(Y){for(var ae in Y)o._doesCharSupportLocalGlyph(+ae)||(G.glyphs[+ae]=Y[+ae]);G.ranges[ie]=!0}for(var he=0,ye=te;he<ye.length;he+=1)(0,ye[he])(se,Y);delete G.requests[ie]})),te.push(function(se,Y){se?C(se):Y&&C(null,{stack:R,id:Z,glyph:Y[Z]||null})})}}else C(null,{stack:R,id:Z,glyph:W})},function(E,C){if(E)s(E);else if(C){for(var R={},Z=0,G=C;Z<G.length;Z+=1){var W=G[Z],ie=W.stack,te=W.id,se=W.glyph;(R[ie]||(R[ie]={}))[te]=se&&{id:se.id,bitmap:se.bitmap.clone(),metrics:se.metrics}}s(null,R)}})},Rt.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},Rt.prototype._tinySDF=function(n,s,o){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(o)){var m=n.tinySDF;if(!m){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),m=n.tinySDF=new Rt.TinySDF(24,3,8,.25,u,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},m.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Rt.loadGlyphRange=function(n,s,o,u,m){var w=256*s,S=w+255,E=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(E,function(C,R){if(C)m(C);else if(R){for(var Z={},G=0,W=a.parseGlyphPBF(R);G<W.length;G+=1){var ie=W[G];Z[ie.id]=ie}m(null,Z)}})},Rt.TinySDF=Pt;var gt=function(){this.specification=a.styleSpec.light.position};gt.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},gt.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var Fe=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new gt,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),At=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(Fe),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,u){if(u===void 0&&(u={}),!this._validate(a.validateLight,o,u))for(var m in o){var w=o[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),w):this._transitionable.setValue(m,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,u,m){return(!m||m.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),ot=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ot.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},ot.prototype.getDashRanges=function(n,s,o){var u=[],m=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;u.push({left:m,right:w,isDash:S,zeroLength:n[0]===0});for(var E=n[0],C=1;C<n.length;C++){var R=n[C];u.push({left:m=E*o,right:w=(E+=R)*o,isDash:S=!S,zeroLength:R===0})}return u},ot.prototype.addRoundDash=function(n,s,o){for(var u=s/2,m=-o;m<=o;m++)for(var w=this.width*(this.nextRow+o+m),S=0,E=n[S],C=0;C<this.width;C++){C/E.right>1&&(E=n[++S]);var R=Math.abs(C-E.left),Z=Math.abs(C-E.right),G=Math.min(R,Z),W=void 0,ie=m/o*(u+1);if(E.isDash){var te=u-Math.abs(ie);W=Math.sqrt(G*G+te*te)}else W=u-Math.sqrt(G*G+ie*ie);this.data[w+C]=Math.max(0,Math.min(255,W+128))}},ot.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],u=n[s+1];o.zeroLength?n.splice(s,1):u&&u.isDash===o.isDash&&(u.left=o.left,n.splice(s,1))}var m=n[0],w=n[n.length-1];m.isDash===w.isDash&&(m.left=w.left-this.width,w.right=m.right+this.width);for(var S=this.width*this.nextRow,E=0,C=n[E],R=0;R<this.width;R++){R/C.right>1&&(C=n[++E]);var Z=Math.abs(R-C.left),G=Math.abs(R-C.right),W=Math.min(Z,G);this.data[S+R]=Math.max(0,Math.min(255,(C.isDash?W:-W)+128))}},ot.prototype.addDash=function(n,s){var o=s?7:0,u=2*o+1;if(this.nextRow+u>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var m=0,w=0;w<n.length;w++)m+=n[w];if(m!==0){var S=this.width/m,E=this.getDashRanges(n,this.width,S);s?this.addRoundDash(E,S,o):this.addRegularDash(E)}var C={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:m};return this.nextRow+=u,this.dirty=!0,C},ot.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var xt=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var u=this.workerPool.acquire(this.id),m=0;m<u.length;m++){var w=new n.Actor(u[m],o,this.id);w.name="Worker "+m,this.actors.push(w)}};function Ve(n,s,o){var u=function(m,w){if(m)return o(m);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(E){return E.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),u):a.browser.frame(function(){return u(null,n)})}xt.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(u,m){u.send(n,s,m)},o=o||function(){})},xt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},xt.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},xt.Actor=a.Actor;var Ue=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};Ue.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Ue.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),u=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),m=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<m&&n.y>=u&&n.y<w};var _t=function(n){function s(o,u,m,w){if(n.call(this),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ve(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new Ue(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var u=this;return this.setSourceProperty(function(){u._options.tiles=o}),this},s.prototype.setUrl=function(o){var u=this;return this.setSourceProperty(function(){u.url=o,u._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(m,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(E,C){return delete o.request,o.aborted?u(null):E&&E.status!==404?u(E):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),fr=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.dispatcher=m,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ve(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new Ue(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,u){var m=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,E){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(E){m.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var C=m.map.painter.context,R=C.gl;o.texture=m.map.painter.getTileTexture(E.width),o.texture?o.texture.update(E,{useMipmap:!0}):(o.texture=new a.Texture(C,E,R.RGBA,{useMipmap:!0}),o.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&R.texParameterf(R.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(m.dispatcher),u(null)}})},s.prototype.abortTile=function(o,u){o.request&&(o.request.cancel(),delete o.request),u()},s.prototype.unloadTile=function(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),zt=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,E){S&&(o.state="errored",u(S)),E&&(o.dem=E,o.needsHillshadePrepare=!0,o.state="loaded",u(null))}o.request=a.getImage(this.map._requestManager.transformRequest(m,a.ResourceType.Tile),function(S,E){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(E){this.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var C=a.window.ImageBitmap&&E instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?E:a.browser.getImageData(E,1),R={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:C,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",R,w.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var u=o.canonical,m=Math.pow(2,u.z),w=(u.x-1+m)%m,S=u.x===0?o.wrap-1:o.wrap,E=(u.x+1+m)%m,C=u.x+1===m?o.wrap+1:o.wrap,R={};return R[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y).key]={backfilled:!1},R[new a.OverscaledTileID(o.overscaledZ,C,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(R[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y-1).key]={backfilled:!1},R[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},R[new a.OverscaledTileID(o.overscaledZ,C,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<m&&(R[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y+1).key]={backfilled:!1},R[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},R[new a.OverscaledTileID(o.overscaledZ,C,u.z,E,u.y+1).key]={backfilled:!1}),R},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(fr),je=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(w),this._data=u.data,this._options=a.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*S,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.EXTENT,radius:(u.clusterRadius||50)*S,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)o.fire(new a.ErrorEvent(u));else{var m={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(m.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",m))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var u=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)u.fire(new a.ErrorEvent(m));else{var w={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(w.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this},s.prototype.getClusterChildren=function(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this},s.prototype.getClusterLeaves=function(o,u,m,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:m},w),this},s.prototype._updateWorkerData=function(o){var u=this;this._loaded=!1;var m=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(m.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(w),this.actor.send(this.type+".loadData",m,function(S,E){u._removed||E&&E.abandoned||(u._loaded=!0,E&&E.resourceTiming&&E.resourceTiming[u.id]&&(u._resourceTiming=E.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:m.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,u){var m=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,E){return delete o.request,o.unloadVectorData(),o.aborted?u(null):S?u(S):(o.loadVectorData(E,m.map.painter,w==="reloadTile"),u(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Ke=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),hr=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,u){var m=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){m._loaded=!0,w?m.fire(new a.ErrorEvent(w)):S&&(m.image=S,o&&(m.coordinates=o),u&&u(),m._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var u=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){u.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var u=this;this.coordinates=o;var m=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var E=1/0,C=1/0,R=-1/0,Z=-1/0,G=0,W=S;G<W.length;G+=1){var ie=W[G];E=Math.min(E,ie.x),C=Math.min(C,ie.y),R=Math.max(R,ie.x),Z=Math.max(Z,ie.y)}var te=Math.max(R-E,Z-C),se=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),Y=Math.pow(2,se);return new a.CanonicalTileID(se,Math.floor((E+R)/2*Y),Math.floor((C+Z)/2*Y))}(m),this.minzoom=this.maxzoom=this.tileID.z;var w=m.map(function(S){return u.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ke.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Vr=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),this.roundZoom=!0,this.type="video",this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var u=this.options;this.urls=[];for(var m=0,w=u.urls;m<w.length;m+=1)this.urls.push(this.map._requestManager.transformRequest(w[m],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,E){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):E&&(o.video=E,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ke.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(hr),Ji=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(E){return typeof E!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,m=u.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,Ke.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(u,this.canvas,m.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,u=[this.canvas.width,this.canvas.height];o<u.length;o+=1){var m=u[o];if(isNaN(m)||m<=0)return!0}return!1},s}(hr),Yi={vector:_t,raster:fr,"raster-dem":zt,geojson:je,video:Vr,image:hr,canvas:Ji};function _i(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function Gr(n,s,o,u,m,w){var S=function(se,Y,ae){if(se)for(var he=0,ye=se;he<ye.length;he+=1){var Ae=Y[ye[he]];if(Ae&&Ae.source===ae&&Ae.type==="fill-extrusion")return!0}else for(var xe in Y){var ze=Y[xe];if(ze.source===ae&&ze.type==="fill-extrusion")return!0}return!1}(m&&m.layers,s,n.id),E=w.maxPitchScaleFactor(),C=n.tilesIn(u,E,S);C.sort(Ni);for(var R=[],Z=0,G=C;Z<G.length;Z+=1){var W=G[Z];R.push({wrappedTileID:W.tileID.wrapped().key,queryResults:W.tile.queryRenderedFeatures(s,o,n._state,W.queryGeometry,W.cameraQueryGeometry,W.scale,m,w,E,_i(n.transform,W.tileID))})}var ie=function(se){for(var Y={},ae={},he=0,ye=se;he<ye.length;he+=1){var Ae=ye[he],xe=Ae.queryResults,ze=Ae.wrappedTileID,Oe=ae[ze]=ae[ze]||{};for(var Je in xe)for(var We=xe[Je],ut=Oe[Je]=Oe[Je]||{},St=Y[Je]=Y[Je]||[],Ct=0,It=We;Ct<It.length;Ct+=1){var vr=It[Ct];ut[vr.featureIndex]||(ut[vr.featureIndex]=!0,St.push(vr))}}return Y}(R);for(var te in ie)ie[te].forEach(function(se){var Y=se.feature,ae=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=ae});return ie}function Ni(n,s){var o=n.tileID,u=s.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}var lr=function(n,s){this.max=n,this.onRemove=s,this.reset()};lr.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var u=o[s];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},lr.prototype.add=function(n,s,o){var u=this,m=n.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){u.remove(n,w)},o)),this.data[m].push(w),this.order.push(m),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},lr.prototype.has=function(n){return n.wrapped().key in this.data},lr.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},lr.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},lr.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},lr.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},lr.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,u=s===void 0?0:this.data[o].indexOf(s),m=this.data[o][u];return this.data[o].splice(u,1),m.timeout&&clearTimeout(m.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(m.value),this.order.splice(this.order.indexOf(o),1),this},lr.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},lr.prototype.filter=function(n){var s=[];for(var o in this.data)for(var u=0,m=this.data[o];u<m.length;u+=1){var w=m[u];n(w.value)||s.push(w)}for(var S=0,E=s;S<E.length;S+=1){var C=E[S];this.remove(C.value.tileID,C)}};var Sr=function(n,s,o){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Sr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Sr.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Sr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var dt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Jt=function(n,s,o,u){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=u,this.context=n;var m=n.gl;this.buffer=m.createBuffer(),n.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Jt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Jt.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},Jt.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var u=s.attributes[this.attributes[o].name];u!==void 0&&n.enableVertexAttribArray(u)}},Jt.prototype.setVertexAttribPointers=function(n,s,o){for(var u=0;u<this.attributes.length;u++){var m=this.attributes[u],w=s.attributes[m.name];w!==void 0&&n.vertexAttribPointer(w,m.components,n[dt[m.type]],!1,this.itemSize,m.offset+this.itemSize*(o||0))}},Jt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Gt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Gt.prototype.get=function(){return this.current},Gt.prototype.set=function(n){},Gt.prototype.getDefault=function(){return this.default},Gt.prototype.setDefault=function(){this.set(this.default)};var Vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Gt),Kr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Gt),Hr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Gt),Jr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Gt),Xr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Gt),Ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Gt),Ei=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Gt),Ri=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Gt),sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Gt),gi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Gt),Ti=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Gt),gn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Gt),Er=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}},s}(Gt),Yr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Gt),zo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Gt),pi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Gt),Ii=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}},s}(Gt),ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Gt),Co=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Gt),vn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Gt),ho=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Gt),Un=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Gt),xn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),An=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),Po=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Gt),Mo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),Qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Gt),$i=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Gt),ln=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Gt),to=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Gt),jn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Gt),ar=function(n){function s(o,u){n.call(this,o),this.context=o,this.parent=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Gt),M=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(ar),F=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(ar),V=function(n,s,o,u){this.context=n,this.width=s,this.height=o;var m=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new M(n,m),u&&(this.depthAttachment=new F(n,m))};V.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var K=function(n,s,o){this.func=n,this.mask=s,this.range=o};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var J=function(n,s,o,u,m,w){this.test=n,this.ref=s,this.mask=o,this.fail=u,this.depthFail=m,this.pass=w};J.disabled=new J({func:519,mask:0},0,0,7680,7680,7680);var le=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};le.disabled=new le(le.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),le.unblended=new le(le.Replace,a.Color.transparent,[!0,!0,!0,!0]),le.alphaBlended=new le([1,771],a.Color.transparent,[!0,!0,!0,!0]);var ce=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};ce.disabled=new ce(!1,1029,2305),ce.backCCW=new ce(!0,1029,2305);var U=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Vi(this),this.clearDepth=new Kr(this),this.clearStencil=new Hr(this),this.colorMask=new Jr(this),this.depthMask=new Xr(this),this.stencilMask=new Ui(this),this.stencilFunc=new Ei(this),this.stencilOp=new Ri(this),this.stencilTest=new sn(this),this.depthRange=new gi(this),this.depthTest=new Ti(this),this.depthFunc=new gn(this),this.blend=new Er(this),this.blendFunc=new Yr(this),this.blendColor=new zo(this),this.blendEquation=new pi(this),this.cullFace=new Ii(this),this.cullFaceSide=new ji(this),this.frontFace=new Co(this),this.program=new vn(this),this.activeTexture=new ho(this),this.viewport=new Un(this),this.bindFramebuffer=new xn(this),this.bindRenderbuffer=new An(this),this.bindTexture=new Po(this),this.bindVertexBuffer=new Mo(this),this.bindElementBuffer=new Qi(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $i(this),this.pixelStoreUnpack=new ln(this),this.pixelStoreUnpackPremultiplyAlpha=new to(this),this.pixelStoreUnpackFlipY=new jn(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};U.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},U.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},U.prototype.createIndexBuffer=function(n,s){return new Sr(this,n,s)},U.prototype.createVertexBuffer=function(n,s,o){return new Jt(this,n,s,o)},U.prototype.createRenderbuffer=function(n,s,o){var u=this.gl,m=u.createRenderbuffer();return this.bindRenderbuffer.set(m),u.renderbufferStorage(u.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),m},U.prototype.createFramebuffer=function(n,s,o){return new V(this,n,s,o)},U.prototype.clear=function(n){var s=n.color,o=n.depth,u=this.gl,m=0;s&&(m|=u.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u.clear(m)},U.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},U.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},U.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},U.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},U.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var re=function(n){function s(o,u,m){var w=this;n.call(this),this.id=o,this.dispatcher=m,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,E,C,R){var Z=new Yi[E.type](S,E,C,R);if(Z.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+Z.id);return a.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(o,u,m,this),this._tiles={},this._cache=new lr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,u){return this._source.loadTile(o,u)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var m=this._tiles[u];m.upload(o),m.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(me).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var u=this,m=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&m.push(this._tiles[w]);return o?m.sort(function(S,E){var C=S.tileID,R=E.tileID,Z=new a.Point(C.canonical.x,C.canonical.y)._rotate(u.transform.angle),G=new a.Point(R.canonical.x,R.canonical.y)._rotate(u.transform.angle);return C.overscaledZ-R.overscaledZ||G.y-Z.y||G.x-Z.x}).map(function(S){return S.tileID.key}):m.map(function(S){return S.tileID}).sort(me).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)},s.prototype._isIdRenderable=function(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,u){var m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=u),this._loadTile(m,this._tileLoaded.bind(this,m,o,u)))},s.prototype._tileLoaded=function(o,u,m,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var u=this.getRenderableIds(),m=0;m<u.length;m++){var w=u[m];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);E(o,S),E(S,o)}}function E(C,R){C.needsHillshadePrepare=!0;var Z=R.tileID.canonical.x-C.tileID.canonical.x,G=R.tileID.canonical.y-C.tileID.canonical.y,W=Math.pow(2,C.tileID.canonical.z),ie=R.tileID.key;Z===0&&G===0||Math.abs(G)>1||(Math.abs(Z)>1&&(Math.abs(Z+W)===1?Z+=W:Math.abs(Z-W)===1&&(Z-=W)),R.dem&&C.dem&&(C.dem.backfillBorder(R.dem,Z,G),C.neighboringTiles&&C.neighboringTiles[ie]&&(C.neighboringTiles[ie].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,u,m,w){for(var S in this._tiles){var E=this._tiles[S];if(!(w[S]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>m)){for(var C=E.tileID;E&&E.tileID.overscaledZ>u+1;){var R=E.tileID.scaledTo(E.tileID.overscaledZ-1);(E=this._tiles[R.key])&&E.hasData()&&(C=R)}for(var Z=C;Z.overscaledZ>u;)if(o[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){w[C.key]=C;break}}}},s.prototype.findLoadedParent=function(o,u){if(o.key in this._loadedParentTiles){var m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=u?m:null}for(var w=o.overscaledZ-1;w>=u;w--){var S=o.scaledTo(w),E=this._getLoadedTile(S);if(E)return E}},s.prototype._getLoadedTile=function(o){var u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var u=Math.ceil(o.width/this._source.tileSize)+1,m=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(u*m*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){var m={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),m[S.tileID.key]=S}for(var E in this._tiles=m,this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(var C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}},s.prototype.update=function(o){var u=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var m;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?m=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Oe){return new a.OverscaledTileID(Oe.canonical.z,Oe.wrap,Oe.canonical.z,Oe.canonical.x,Oe.canonical.y)}):(m=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(m=m.filter(function(Oe){return u._source.hasTile(Oe)}))):m=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),E=Math.max(w+s.maxUnderzooming,this._source.minzoom),C=this._updateRetainedTiles(m,w);if(Re(this._source.type)){for(var R={},Z={},G=0,W=Object.keys(C);G<W.length;G+=1){var ie=W[G],te=C[ie],se=this._tiles[ie];if(se&&!(se.fadeEndTime&&se.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent(te,S);Y&&(this._addTile(Y.tileID),R[Y.tileID.key]=Y.tileID),Z[ie]=te}}for(var ae in this._retainLoadedChildren(Z,w,E,C),R)C[ae]||(this._coveredTiles[ae]=!0,C[ae]=R[ae])}for(var he in C)this._tiles[he].clearFadeHold();for(var ye=0,Ae=a.keysDifference(this._tiles,C);ye<Ae.length;ye+=1){var xe=Ae[ye],ze=this._tiles[xe];ze.hasSymbolBuckets&&!ze.holdingForFade()?ze.setHoldDuration(this.map._fadeDuration):ze.hasSymbolBuckets&&!ze.symbolFadeFinished()||this._removeTile(xe)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,u){for(var m={},w={},S=Math.max(u-s.maxOverzooming,this._source.minzoom),E=Math.max(u+s.maxUnderzooming,this._source.minzoom),C={},R=0,Z=o;R<Z.length;R+=1){var G=Z[R],W=this._addTile(G);m[G.key]=G,W.hasData()||u<this._source.maxzoom&&(C[G.key]=G)}this._retainLoadedChildren(C,u,E,m);for(var ie=0,te=o;ie<te.length;ie+=1){var se=te[ie],Y=this._tiles[se.key];if(!Y.hasData()){if(u+1>this._source.maxzoom){var ae=se.children(this._source.maxzoom)[0],he=this.getTile(ae);if(he&&he.hasData()){m[ae.key]=ae;continue}}else{var ye=se.children(this._source.maxzoom);if(m[ye[0].key]&&m[ye[1].key]&&m[ye[2].key]&&m[ye[3].key])continue}for(var Ae=Y.wasRequested(),xe=se.overscaledZ-1;xe>=S;--xe){var ze=se.scaledTo(xe);if(w[ze.key]||(w[ze.key]=!0,!(Y=this.getTile(ze))&&Ae&&(Y=this._addTile(ze)),Y&&(m[ze.key]=ze,Ae=Y.wasRequested(),Y.hasData())))break}}}return m},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var u=[],m=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){m=this._loadedParentTiles[w.key];break}u.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(m=this._getLoadedTile(S))break;w=S}for(var E=0,C=u;E<C.length;E+=1)this._loadedParentTiles[C[E]]=m}},s.prototype._addTile=function(o){var u=this._tiles[o.key];if(u)return u;(u=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));var m=Boolean(u);return m||(u=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u?(u.uses++,this._tiles[o.key]=u,m||this._source.fire(new a.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},s.prototype._setTileReloadTimer=function(o,u){var m=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=u.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){m._reloadTile(o,"expired"),delete m._timers[o]},w))},s.prototype._removeTile=function(o){var u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,u,m){var w=this,S=[],E=this.transform;if(!E)return S;for(var C=m?E.getCameraQueryGeometry(o):o,R=o.map(function(xe){return E.pointCoordinate(xe)}),Z=C.map(function(xe){return E.pointCoordinate(xe)}),G=this.getIds(),W=1/0,ie=1/0,te=-1/0,se=-1/0,Y=0,ae=Z;Y<ae.length;Y+=1){var he=ae[Y];W=Math.min(W,he.x),ie=Math.min(ie,he.y),te=Math.max(te,he.x),se=Math.max(se,he.y)}for(var ye=function(xe){var ze=w._tiles[G[xe]];if(!ze.holdingForFade()){var Oe=ze.tileID,Je=Math.pow(2,E.zoom-ze.tileID.overscaledZ),We=u*ze.queryPadding*a.EXTENT/ze.tileSize/Je,ut=[Oe.getTilePoint(new a.MercatorCoordinate(W,ie)),Oe.getTilePoint(new a.MercatorCoordinate(te,se))];if(ut[0].x-We<a.EXTENT&&ut[0].y-We<a.EXTENT&&ut[1].x+We>=0&&ut[1].y+We>=0){var St=R.map(function(It){return Oe.getTilePoint(It)}),Ct=Z.map(function(It){return Oe.getTilePoint(It)});S.push({tile:ze,tileID:Oe,queryGeometry:St,cameraQueryGeometry:Ct,scale:Je})}}},Ae=0;Ae<G.length;Ae++)ye(Ae);return S},s.prototype.getVisibleCoordinates=function(o){for(var u=this,m=this.getRenderableIds(o).map(function(C){return u._tiles[C].tileID}),w=0,S=m;w<S.length;w+=1){var E=S[w];E.posMatrix=this.transform.calculatePosMatrix(E.toUnwrapped())}return m},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Re(this._source.type))for(var o in this._tiles){var u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,u,m){this._state.updateState(o=o||"_geojsonTileLayer",u,m)},s.prototype.removeFeatureState=function(o,u,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,m)},s.prototype.getFeatureState=function(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)},s.prototype.setDependencies=function(o,u,m){var w=this._tiles[o];w&&w.setDependencies(u,m)},s.prototype.reloadTilesForDependencies=function(o,u){for(var m in this._tiles)this._tiles[m].hasDependency(o,u)&&this._reloadTile(m,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,u)})},s}(a.Evented);function me(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||u-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Re(n){return n==="raster"||n==="image"||n==="video"}function Ne(){return new a.window.Worker(au.workerUrl)}re.maxOverzooming=10,re.maxUnderzooming=3;var be="mapboxgl_preloaded_worker_pool",Be=function(){this.active={}};Be.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Be.workerCount;)this.workers.push(new Ne);return this.active[n]=!0,this.workers.slice()},Be.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Be.prototype.isPreloaded=function(){return!!this.active[be]},Be.prototype.numActive=function(){return Object.keys(this.active).length};var nt,it=Math.floor(a.browser.hardwareConcurrency/2);function we(){return nt||(nt=new Be),nt}function $e(n,s){var o={};for(var u in n)u!=="ref"&&(o[u]=n[u]);return a.refProperties.forEach(function(m){m in s&&(o[m]=s[m])}),o}function qe(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=$e(n[u],s[n[u].ref]));return n}Be.workerCount=Math.max(Math.min(it,6),1);var Xe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function jt(n,s,o){o.push({command:Xe.addSource,args:[n,s[n]]})}function et(n,s,o){s.push({command:Xe.removeSource,args:[n]}),o[n]=!0}function Kt(n,s,o,u){et(n,o,u),jt(n,s,o)}function dr(n,s,o){var u;for(u in n[o])if(n[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;for(u in s[o])if(s[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;return!0}function Ft(n,s,o,u,m,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[u,S,s[S],m]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[u,S,s[S],m]}))}function $t(n){return n.id}function er(n,s){return n[s.id]=s,n}var ai=function(n,s){this.reset(n,s)};ai.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ai.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],u=n*this.paddedLength+this.padding;o<u&&s<this._distances.length;)o=this._distances[++s];var m=s-1,w=this._distances[m],S=o-w,E=S>0?(u-w)/S:0;return this.points[m].mult(1-E).add(this.points[s].mult(E))};var rr=function(n,s,o){var u=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)u.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Cr(n,s,o,u,m){var w=a.create();return s?(a.scale(w,w,[1/m,1/m,1]),o||a.rotateZ(w,w,u.angle)):a.multiply(w,u.labelPlaneMatrix,n),w}function Xt(n,s,o,u,m){if(s){var w=a.clone(n);return a.scale(w,w,[m,m,1]),o||a.rotateZ(w,w,-u.angle),w}return u.glCoordMatrix}function qt(n,s){var o=[n.x,n.y,0,1];jr(o,o,s);var u=o[3];return{point:new a.Point(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function ir(n,s){return .5+n/s*.5}function fi(n,s){var o=n[0]/n[3],u=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&u>=-s[1]&&u<=s[1]}function ro(n,s,o,u,m,w,S,E){var C=u?n.textSizeData:n.iconSizeData,R=a.evaluateSizeForZoom(C,o.transform.zoom),Z=[256/o.width*2+1,256/o.height*2+1],G=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;G.clear();for(var W=n.lineVertexArray,ie=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,te=o.transform.width/o.transform.height,se=!1,Y=0;Y<ie.length;Y++){var ae=ie.get(Y);if(ae.hidden||ae.writingMode===a.WritingMode.vertical&&!se)di(ae.numGlyphs,G);else{se=!1;var he=[ae.anchorX,ae.anchorY,0,1];if(a.transformMat4(he,he,s),fi(he,Z)){var ye=ir(o.transform.cameraToCenterDistance,he[3]),Ae=a.evaluateSizeForFeature(C,R,ae),xe=S?Ae/ye:Ae*ye,ze=new a.Point(ae.anchorX,ae.anchorY),Oe=qt(ze,m).point,Je={},We=Zo(ae,xe,!1,E,s,m,w,n.glyphOffsetArray,W,G,Oe,ze,Je,te);se=We.useVertical,(We.notEnoughRoom||se||We.needsFlipping&&Zo(ae,xe,!0,E,s,m,w,n.glyphOffsetArray,W,G,Oe,ze,Je,te).notEnoughRoom)&&di(ae.numGlyphs,G)}else di(ae.numGlyphs,G)}}u?n.text.dynamicLayoutVertexBuffer.updateData(G):n.icon.dynamicLayoutVertexBuffer.updateData(G)}function Pr(n,s,o,u,m,w,S,E,C,R,Z){var G=E.glyphStartIndex+E.numGlyphs,W=E.lineStartIndex,ie=E.lineStartIndex+E.lineLength,te=s.getoffsetX(E.glyphStartIndex),se=s.getoffsetX(G-1),Y=Mr(n*te,o,u,m,w,S,E.segment,W,ie,C,R,Z);if(!Y)return null;var ae=Mr(n*se,o,u,m,w,S,E.segment,W,ie,C,R,Z);return ae?{first:Y,last:ae}:null}function Ur(n,s,o,u){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*u?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Zo(n,s,o,u,m,w,S,E,C,R,Z,G,W,ie){var te,se=s/24,Y=n.lineOffsetX*se,ae=n.lineOffsetY*se;if(n.numGlyphs>1){var he=n.glyphStartIndex+n.numGlyphs,ye=n.lineStartIndex,Ae=n.lineStartIndex+n.lineLength,xe=Pr(se,E,Y,ae,o,Z,G,n,C,w,W);if(!xe)return{notEnoughRoom:!0};var ze=qt(xe.first.point,S).point,Oe=qt(xe.last.point,S).point;if(u&&!o){var Je=Ur(n.writingMode,ze,Oe,ie);if(Je)return Je}te=[xe.first];for(var We=n.glyphStartIndex+1;We<he-1;We++)te.push(Mr(se*E.getoffsetX(We),Y,ae,o,Z,G,n.segment,ye,Ae,C,w,W));te.push(xe.last)}else{if(u&&!o){var ut=qt(G,m).point,St=n.lineStartIndex+n.segment+1,Ct=new a.Point(C.getx(St),C.gety(St)),It=qt(Ct,m),vr=It.signedDistanceFromCamera>0?It.point:po(G,Ct,ut,1,m),ht=Ur(n.writingMode,ut,vr,ie);if(ht)return ht}var Zt=Mr(se*E.getoffsetX(n.glyphStartIndex),Y,ae,o,Z,G,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,C,w,W);if(!Zt)return{notEnoughRoom:!0};te=[Zt]}for(var nr=0,Ut=te;nr<Ut.length;nr+=1){var Nt=Ut[nr];a.addDynamicAttributes(R,Nt.point,Nt.angle)}return{}}function po(n,s,o,u,m){var w=qt(n.add(n.sub(s)._unit()),m).point,S=o.sub(w);return o.add(S._mult(u/S.mag()))}function Mr(n,s,o,u,m,w,S,E,C,R,Z,G){var W=u?n-s:n+s,ie=W>0?1:-1,te=0;u&&(ie*=-1,te=Math.PI),ie<0&&(te+=Math.PI);for(var se=ie>0?E+S:E+S+1,Y=m,ae=m,he=0,ye=0,Ae=Math.abs(W),xe=[];he+ye<=Ae;){if((se+=ie)<E||se>=C)return null;if(ae=Y,xe.push(Y),(Y=G[se])===void 0){var ze=new a.Point(R.getx(se),R.gety(se)),Oe=qt(ze,Z);if(Oe.signedDistanceFromCamera>0)Y=G[se]=Oe.point;else{var Je=se-ie;Y=po(he===0?w:new a.Point(R.getx(Je),R.gety(Je)),ze,ae,Ae-he+1,Z)}}he+=ye,ye=ae.dist(Y)}var We=(Ae-he)/ye,ut=Y.sub(ae),St=ut.mult(We)._add(ae);St._add(ut._unit()._perp()._mult(o*ie));var Ct=te+Math.atan2(Y.y-ae.y,Y.x-ae.x);return xe.push(St),{point:St,angle:Ct,path:xe}}rr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},rr.prototype.insert=function(n,s,o,u,m){this._forEachCell(s,o,u,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(m)},rr.prototype.insertCircle=function(n,s,o,u){this._forEachCell(s-u,o-u,s+u,o+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(u)},rr.prototype._insertBoxCell=function(n,s,o,u,m,w){this.boxCells[m].push(w)},rr.prototype._insertCircleCell=function(n,s,o,u,m,w){this.circleCells[m].push(w)},rr.prototype._query=function(n,s,o,u,m,w){if(o<0||n>this.width||u<0||s>this.height)return!m&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=u){if(m)return!0;for(var E=0;E<this.boxKeys.length;E++)S.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(var C=0;C<this.circleKeys.length;C++){var R=this.circles[3*C],Z=this.circles[3*C+1],G=this.circles[3*C+2];S.push({key:this.circleKeys[C],x1:R-G,y1:Z-G,x2:R+G,y2:Z+G})}return w?S.filter(w):S}return this._forEachCell(n,s,o,u,this._queryCell,S,{hitTest:m,seenUids:{box:{},circle:{}}},w),m?S.length>0:S},rr.prototype._queryCircle=function(n,s,o,u,m){var w=n-o,S=n+o,E=s-o,C=s+o;if(S<0||w>this.width||C<0||E>this.height)return!u&&[];var R=[];return this._forEachCell(w,E,S,C,this._queryCellCircle,R,{hitTest:u,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},m),u?R.length>0:R},rr.prototype.query=function(n,s,o,u,m){return this._query(n,s,o,u,!1,m)},rr.prototype.hitTest=function(n,s,o,u,m){return this._query(n,s,o,u,!0,m)},rr.prototype.hitTestCircle=function(n,s,o,u){return this._queryCircle(n,s,o,!0,u)},rr.prototype._queryCell=function(n,s,o,u,m,w,S,E){var C=S.seenUids,R=this.boxCells[m];if(R!==null)for(var Z=this.bboxes,G=0,W=R;G<W.length;G+=1){var ie=W[G];if(!C.box[ie]){C.box[ie]=!0;var te=4*ie;if(n<=Z[te+2]&&s<=Z[te+3]&&o>=Z[te+0]&&u>=Z[te+1]&&(!E||E(this.boxKeys[ie]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[ie],x1:Z[te],y1:Z[te+1],x2:Z[te+2],y2:Z[te+3]})}}}var se=this.circleCells[m];if(se!==null)for(var Y=this.circles,ae=0,he=se;ae<he.length;ae+=1){var ye=he[ae];if(!C.circle[ye]){C.circle[ye]=!0;var Ae=3*ye;if(this._circleAndRectCollide(Y[Ae],Y[Ae+1],Y[Ae+2],n,s,o,u)&&(!E||E(this.circleKeys[ye]))){if(S.hitTest)return w.push(!0),!0;var xe=Y[Ae],ze=Y[Ae+1],Oe=Y[Ae+2];w.push({key:this.circleKeys[ye],x1:xe-Oe,y1:ze-Oe,x2:xe+Oe,y2:ze+Oe})}}}},rr.prototype._queryCellCircle=function(n,s,o,u,m,w,S,E){var C=S.circle,R=S.seenUids,Z=this.boxCells[m];if(Z!==null)for(var G=this.bboxes,W=0,ie=Z;W<ie.length;W+=1){var te=ie[W];if(!R.box[te]){R.box[te]=!0;var se=4*te;if(this._circleAndRectCollide(C.x,C.y,C.radius,G[se+0],G[se+1],G[se+2],G[se+3])&&(!E||E(this.boxKeys[te])))return w.push(!0),!0}}var Y=this.circleCells[m];if(Y!==null)for(var ae=this.circles,he=0,ye=Y;he<ye.length;he+=1){var Ae=ye[he];if(!R.circle[Ae]){R.circle[Ae]=!0;var xe=3*Ae;if(this._circlesCollide(ae[xe],ae[xe+1],ae[xe+2],C.x,C.y,C.radius)&&(!E||E(this.circleKeys[Ae])))return w.push(!0),!0}}},rr.prototype._forEachCell=function(n,s,o,u,m,w,S,E){for(var C=this._convertToXCellCoord(n),R=this._convertToYCellCoord(s),Z=this._convertToXCellCoord(o),G=this._convertToYCellCoord(u),W=C;W<=Z;W++)for(var ie=R;ie<=G;ie++)if(m.call(this,n,s,o,u,this.xCellCount*ie+W,w,S,E))return},rr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},rr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},rr.prototype._circlesCollide=function(n,s,o,u,m,w){var S=u-n,E=m-s,C=o+w;return C*C>S*S+E*E},rr.prototype._circleAndRectCollide=function(n,s,o,u,m,w,S){var E=(w-u)/2,C=Math.abs(n-(u+E));if(C>E+o)return!1;var R=(S-m)/2,Z=Math.abs(s-(m+R));if(Z>R+o)return!1;if(C<=E||Z<=R)return!0;var G=C-E,W=Z-R;return G*G+W*W<=o*o};var zn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function di(n,s){for(var o=0;o<n;o++){var u=s.length;s.resize(u+4),s.float32.set(zn,3*u)}}function jr(n,s,o){var u=s[0],m=s[1];return n[0]=o[0]*u+o[4]*m+o[12],n[1]=o[1]*u+o[5]*m+o[13],n[3]=o[3]*u+o[7]*m+o[15],n}var Ai=function(n,s,o){s===void 0&&(s=new rr(n.width+200,n.height+200,25)),o===void 0&&(o=new rr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function yr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}Ai.prototype.placeCollisionBox=function(n,s,o,u,m){var w=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,E=n.x1*S+w.point.x,C=n.y1*S+w.point.y,R=n.x2*S+w.point.x,Z=n.y2*S+w.point.y;return!this.isInsideGrid(E,C,R,Z)||!s&&this.grid.hitTest(E,C,R,Z,m)?{box:[],offscreen:!1}:{box:[E,C,R,Z],offscreen:this.isOffscreen(E,C,R,Z)}},Ai.prototype.placeCollisionCircles=function(n,s,o,u,m,w,S,E,C,R,Z,G,W){var ie=[],te=new a.Point(s.anchorX,s.anchorY),se=qt(te,w),Y=ir(this.transform.cameraToCenterDistance,se.signedDistanceFromCamera),ae=(R?m/Y:m*Y)/a.ONE_EM,he=qt(te,S).point,ye=Pr(ae,u,s.lineOffsetX*ae,s.lineOffsetY*ae,!1,he,te,s,o,S,{}),Ae=!1,xe=!1,ze=!0;if(ye){for(var Oe=.5*G*Y+W,Je=new a.Point(-100,-100),We=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),ut=new ai,St=ye.first,Ct=ye.last,It=[],vr=St.path.length-1;vr>=1;vr--)It.push(St.path[vr]);for(var ht=1;ht<Ct.path.length;ht++)It.push(Ct.path[ht]);var Zt=2.5*Oe;if(E){var nr=It.map(function($o){return qt($o,E)});It=nr.some(function($o){return $o.signedDistanceFromCamera<=0})?[]:nr.map(function($o){return $o.point})}var Ut=[];if(It.length>0){for(var Nt=It[0].clone(),tr=It[0].clone(),Ot=1;Ot<It.length;Ot++)Nt.x=Math.min(Nt.x,It[Ot].x),Nt.y=Math.min(Nt.y,It[Ot].y),tr.x=Math.max(tr.x,It[Ot].x),tr.y=Math.max(tr.y,It[Ot].y);Ut=Nt.x>=Je.x&&tr.x<=We.x&&Nt.y>=Je.y&&tr.y<=We.y?[It]:tr.x<Je.x||Nt.x>We.x||tr.y<Je.y||Nt.y>We.y?[]:a.clipLine([It],Je.x,Je.y,We.x,We.y)}for(var Lt=0,rn=Ut;Lt<rn.length;Lt+=1){var wi;ut.reset(rn[Lt],.25*Oe),wi=ut.length<=.5*Oe?1:Math.ceil(ut.paddedLength/Zt)+1;for(var On=0;On<wi;On++){var dn=On/Math.max(wi-1,1),mi=ut.lerp(dn),Pi=mi.x+100,Io=mi.y+100;ie.push(Pi,Io,Oe,0);var Hn=Pi-Oe,ys=Io-Oe,ao=Pi+Oe,xa=Io+Oe;if(ze=ze&&this.isOffscreen(Hn,ys,ao,xa),xe=xe||this.isInsideGrid(Hn,ys,ao,xa),!n&&this.grid.hitTestCircle(Pi,Io,Oe,Z)&&(Ae=!0,!C))return{circles:[],offscreen:!1,collisionDetected:Ae}}}}return{circles:!C&&Ae||!xe?[]:ie,offscreen:ze,collisionDetected:Ae}},Ai.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,u=1/0,m=-1/0,w=-1/0,S=0,E=n;S<E.length;S+=1){var C=E[S],R=new a.Point(C.x+100,C.y+100);o=Math.min(o,R.x),u=Math.min(u,R.y),m=Math.max(m,R.x),w=Math.max(w,R.y),s.push(R)}for(var Z={},G={},W=0,ie=this.grid.query(o,u,m,w).concat(this.ignoredGrid.query(o,u,m,w));W<ie.length;W+=1){var te=ie[W],se=te.key;if(Z[se.bucketInstanceId]===void 0&&(Z[se.bucketInstanceId]={}),!Z[se.bucketInstanceId][se.featureIndex]){var Y=[new a.Point(te.x1,te.y1),new a.Point(te.x2,te.y1),new a.Point(te.x2,te.y2),new a.Point(te.x1,te.y2)];a.polygonIntersectsPolygon(s,Y)&&(Z[se.bucketInstanceId][se.featureIndex]=!0,G[se.bucketInstanceId]===void 0&&(G[se.bucketInstanceId]=[]),G[se.bucketInstanceId].push(se.featureIndex))}}return G},Ai.prototype.insertCollisionBox=function(n,s,o,u,m){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:u,collisionGroupID:m},n[0],n[1],n[2],n[3])},Ai.prototype.insertCollisionCircles=function(n,s,o,u,m){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:u,collisionGroupID:m},E=0;E<n.length;E+=4)w.insertCircle(S,n[E],n[E+1],n[E+2])},Ai.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var u=[s,o,0,1];return jr(u,u,n),{point:new a.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},Ai.prototype.isOffscreen=function(n,s,o,u){return o<100||n>=this.screenRightBoundary||u<100||s>this.screenBottomBoundary},Ai.prototype.isInsideGrid=function(n,s,o,u){return o>=0&&n<this.gridRightBoundary&&u>=0&&s<this.gridBottomBoundary},Ai.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Cn=function(n,s,o,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):u&&o?1:0,this.placed=o};Cn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var qi=function(n,s,o,u,m){this.text=new Cn(n?n.text:null,s,o,m),this.icon=new Cn(n?n.icon:null,s,u,m)};qi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Go=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},Qr=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},fo=function(n,s,o,u,m){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=u,this.tileID=m},ei=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function ti(n,s,o,u,m){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,E=-(w.verticalAlign-.5)*o,C=a.evaluateVariableOffset(n,u);return new a.Point(S+C[0]*m,E+C[1]*m)}function bn(n,s,o,u,m,w){var S=n.x1,E=n.x2,C=n.y1,R=n.y2,Z=n.anchorPointX,G=n.anchorPointY,W=new a.Point(s,o);return u&&W._rotate(m?w:-w),{x1:S+W.x,y1:C+W.y,x2:E+W.x,y2:R+W.y,anchorPointX:Z,anchorPointY:G}}ei.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var zi=function(n,s,o,u){this.transform=n.clone(),this.collisionIndex=new Ai(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new ei(o),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function io(n,s,o,u,m){n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0)}zi.prototype.getBucketParts=function(n,s,o,u){var m=o.getBucket(s),w=o.latestFeatureIndex;if(m&&w&&s.id===m.layerIds[0]){var S=o.collisionBoxArray,E=m.layers[0].layout,C=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),R=o.tileSize/a.EXTENT,Z=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),G=E.get("text-pitch-alignment")==="map",W=E.get("text-rotation-alignment")==="map",ie=yr(o,1,this.transform.zoom),te=Cr(Z,G,W,this.transform,ie),se=null;if(G){var Y=Xt(Z,G,W,this.transform,ie);se=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[m.bucketInstanceId]=new fo(m.bucketInstanceId,w,m.sourceLayerIndex,m.index,o.tileID);var ae={bucket:m,layout:E,posMatrix:Z,textLabelPlaneMatrix:te,labelToScreenMatrix:se,scale:C,textPixelRatio:R,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(u)for(var he=0,ye=m.sortKeyRanges;he<ye.length;he+=1){var Ae=ye[he];n.push({sortKey:Ae.sortKey,symbolInstanceStart:Ae.symbolInstanceStart,symbolInstanceEnd:Ae.symbolInstanceEnd,parameters:ae})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:ae})}},zi.prototype.attemptAnchorPlacement=function(n,s,o,u,m,w,S,E,C,R,Z,G,W,ie,te){var se,Y=[G.textOffset0,G.textOffset1],ae=ti(n,o,u,Y,m),he=this.collisionIndex.placeCollisionBox(bn(s,ae.x,ae.y,w,S,this.transform.angle),Z,E,C,R.predicate);if(!te||this.collisionIndex.placeCollisionBox(bn(te,ae.x,ae.y,w,S,this.transform.angle),Z,E,C,R.predicate).box.length!==0)return he.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(se=this.prevPlacement.variableOffsets[G.crossTileID].anchor),this.variableOffsets[G.crossTileID]={textOffset:Y,width:o,height:u,anchor:n,textBoxScale:m,prevAnchor:se},this.markUsedJustification(W,n,G,ie),W.allowVerticalPlacement&&(this.markUsedOrientation(W,ie,G),this.placedOrientations[G.crossTileID]=ie),{shift:ae,placedGlyphBoxes:he}):void 0},zi.prototype.placeLayerBucketPart=function(n,s,o){var u=this,m=n.parameters,w=m.bucket,S=m.layout,E=m.posMatrix,C=m.textLabelPlaneMatrix,R=m.labelToScreenMatrix,Z=m.textPixelRatio,G=m.holdingForFade,W=m.collisionBoxArray,ie=m.partiallyEvaluatedTextSize,te=m.collisionGroup,se=S.get("text-optional"),Y=S.get("icon-optional"),ae=S.get("text-allow-overlap"),he=S.get("icon-allow-overlap"),ye=S.get("text-rotation-alignment")==="map",Ae=S.get("text-pitch-alignment")==="map",xe=S.get("icon-text-fit")!=="none",ze=S.get("symbol-z-order")==="viewport-y",Oe=ae&&(he||!w.hasIconData()||Y),Je=he&&(ae||!w.hasTextData()||se);!w.collisionArrays&&W&&w.deserializeCollisionBoxes(W);var We=function(ht,Zt){if(!s[ht.crossTileID])if(G)u.placements[ht.crossTileID]=new Go(!1,!1,!1);else{var nr,Ut=!1,Nt=!1,tr=!0,Ot=null,Lt={box:null,offscreen:null},rn={box:null,offscreen:null},wi=null,On=null,dn=0,mi=0,Pi=0;Zt.textFeatureIndex?dn=Zt.textFeatureIndex:ht.useRuntimeCollisionCircles&&(dn=ht.featureIndex),Zt.verticalTextFeatureIndex&&(mi=Zt.verticalTextFeatureIndex);var Io=Zt.textBox;if(Io){var Hn=function(kr){var jo=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!kr&&u.prevPlacement){var so=u.prevPlacement.placedOrientations[ht.crossTileID];so&&(u.placedOrientations[ht.crossTileID]=so,u.markUsedOrientation(w,jo=so,ht))}return jo},ys=function(kr,jo){if(w.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&Zt.verticalTextBox)for(var so=0,Us=w.writingModes;so<Us.length&&(Us[so]===a.WritingMode.vertical?(Lt=jo(),rn=Lt):Lt=kr(),!(Lt&&Lt.box&&Lt.box.length));so+=1);else Lt=kr()};if(S.get("text-variable-anchor")){var ao=S.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[ht.crossTileID]){var xa=u.prevPlacement.variableOffsets[ht.crossTileID];ao.indexOf(xa.anchor)>0&&(ao=ao.filter(function(kr){return kr!==xa.anchor})).unshift(xa.anchor)}var $o=function(kr,jo,so){for(var Us=kr.x2-kr.x1,Gh=kr.y2-kr.y1,su=ht.textBoxScale,Kh=xe&&!he?jo:null,Nl={box:[],offscreen:!1},Uc=ae?2*ao.length:ao.length,pl=0;pl<Uc;++pl){var lu=u.attemptAnchorPlacement(ao[pl%ao.length],kr,Us,Gh,su,ye,Ae,Z,E,te,pl>=ao.length,ht,w,so,Kh);if(lu&&(Nl=lu.placedGlyphBoxes)&&Nl.box&&Nl.box.length){Ut=!0,Ot=lu.shift;break}}return Nl};ys(function(){return $o(Io,Zt.iconBox,a.WritingMode.horizontal)},function(){var kr=Zt.verticalTextBox;return w.allowVerticalPlacement&&!(Lt&&Lt.box&&Lt.box.length)&&ht.numVerticalGlyphVertices>0&&kr?$o(kr,Zt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Lt&&(Ut=Lt.box,tr=Lt.offscreen);var Bl=Hn(Lt&&Lt.box);if(!Ut&&u.prevPlacement){var cl=u.prevPlacement.variableOffsets[ht.crossTileID];cl&&(u.variableOffsets[ht.crossTileID]=cl,u.markUsedJustification(w,cl.anchor,ht,Bl))}}else{var _s=function(kr,jo){var so=u.collisionIndex.placeCollisionBox(kr,ae,Z,E,te.predicate);return so&&so.box&&so.box.length&&(u.markUsedOrientation(w,jo,ht),u.placedOrientations[ht.crossTileID]=jo),so};ys(function(){return _s(Io,a.WritingMode.horizontal)},function(){var kr=Zt.verticalTextBox;return w.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&kr?_s(kr,a.WritingMode.vertical):{box:null,offscreen:null}}),Hn(Lt&&Lt.box&&Lt.box.length)}}if(Ut=(nr=Lt)&&nr.box&&nr.box.length>0,tr=nr&&nr.offscreen,ht.useRuntimeCollisionCircles){var hl=w.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex),Fl=a.evaluateSizeForFeature(w.textSizeData,ie,hl),Fa=S.get("text-padding");wi=u.collisionIndex.placeCollisionCircles(ae,hl,w.lineVertexArray,w.glyphOffsetArray,Fl,E,C,R,o,Ae,te.predicate,ht.collisionCircleDiameter,Fa),Ut=ae||wi.circles.length>0&&!wi.collisionDetected,tr=tr&&wi.offscreen}if(Zt.iconFeatureIndex&&(Pi=Zt.iconFeatureIndex),Zt.iconBox){var Ol=function(kr){var jo=xe&&Ot?bn(kr,Ot.x,Ot.y,ye,Ae,u.transform.angle):kr;return u.collisionIndex.placeCollisionBox(jo,he,Z,E,te.predicate)};Nt=rn&&rn.box&&rn.box.length&&Zt.verticalIconBox?(On=Ol(Zt.verticalIconBox)).box.length>0:(On=Ol(Zt.iconBox)).box.length>0,tr=tr&&On.offscreen}var Oa=se||ht.numHorizontalGlyphVertices===0&&ht.numVerticalGlyphVertices===0,nn=Y||ht.numIconVertices===0;if(Oa||nn?nn?Oa||(Nt=Nt&&Ut):Ut=Nt&&Ut:Nt=Ut=Nt&&Ut,Ut&&nr&&nr.box&&u.collisionIndex.insertCollisionBox(nr.box,S.get("text-ignore-placement"),w.bucketInstanceId,rn&&rn.box&&mi?mi:dn,te.ID),Nt&&On&&u.collisionIndex.insertCollisionBox(On.box,S.get("icon-ignore-placement"),w.bucketInstanceId,Pi,te.ID),wi&&(Ut&&u.collisionIndex.insertCollisionCircles(wi.circles,S.get("text-ignore-placement"),w.bucketInstanceId,dn,te.ID),o)){var Wa=w.bucketInstanceId,gs=u.collisionCircleArrays[Wa];gs===void 0&&(gs=u.collisionCircleArrays[Wa]=new Qr);for(var Vs=0;Vs<wi.circles.length;Vs+=4)gs.circles.push(wi.circles[Vs+0]),gs.circles.push(wi.circles[Vs+1]),gs.circles.push(wi.circles[Vs+2]),gs.circles.push(wi.collisionDetected?1:0)}u.placements[ht.crossTileID]=new Go(Ut||Oe,Nt||Je,tr||w.justReloaded),s[ht.crossTileID]=!0}};if(ze)for(var ut=w.getSortedSymbolIndexes(this.transform.angle),St=ut.length-1;St>=0;--St){var Ct=ut[St];We(w.symbolInstances.get(Ct),w.collisionArrays[Ct])}else for(var It=n.symbolInstanceStart;It<n.symbolInstanceEnd;It++)We(w.symbolInstances.get(It),w.collisionArrays[It]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var vr=this.collisionCircleArrays[w.bucketInstanceId];a.invert(vr.invProjMatrix,E),vr.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},zi.prototype.markUsedJustification=function(n,s,o,u){var m;m=u===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var E=S[w];E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=m>=0&&E!==m?0:o.crossTileID)}},zi.prototype.markUsedOrientation=function(n,s,o){for(var u=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,m=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=u;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=m)},zi.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var u=s?s.symbolFadeChange(n):1,m=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var E in this.placements){var C=this.placements[E],R=m[E];R?(this.opacities[E]=new qi(R,u,C.text,C.icon),o=o||C.text!==R.text.placed||C.icon!==R.icon.placed):(this.opacities[E]=new qi(null,u,C.text,C.icon,C.skipFade),o=o||C.text||C.icon)}for(var Z in m){var G=m[Z];if(!this.opacities[Z]){var W=new qi(G,u,!1,!1);W.isHidden()||(this.opacities[Z]=W,o=o||G.text.placed||G.icon.placed)}}for(var ie in w)this.variableOffsets[ie]||!this.opacities[ie]||this.opacities[ie].isHidden()||(this.variableOffsets[ie]=w[ie]);for(var te in S)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=S[te]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},zi.prototype.updateLayerOpacities=function(n,s){for(var o={},u=0,m=s;u<m.length;u+=1){var w=m[u],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},zi.prototype.updateBucketOpacities=function(n,s,o){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var m=n.layers[0].layout,w=new qi(null,0,!1,!1,!0),S=m.get("text-allow-overlap"),E=m.get("icon-allow-overlap"),C=m.get("text-variable-anchor"),R=m.get("text-rotation-alignment")==="map",Z=m.get("text-pitch-alignment")==="map",G=m.get("icon-text-fit")!=="none",W=new qi(null,0,S&&(E||!n.hasIconData()||m.get("icon-optional")),E&&(S||!n.hasTextData()||m.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var ie=function(ae,he,ye){for(var Ae=0;Ae<he/4;Ae++)ae.opacityVertexArray.emplaceBack(ye)},te=function(ae){var he=n.symbolInstances.get(ae),ye=he.numHorizontalGlyphVertices,Ae=he.numVerticalGlyphVertices,xe=he.crossTileID,ze=u.opacities[xe];s[xe]?ze=w:ze||(u.opacities[xe]=ze=W),s[xe]=!0;var Oe=he.numIconVertices>0,Je=u.placedOrientations[he.crossTileID],We=Je===a.WritingMode.vertical,ut=Je===a.WritingMode.horizontal||Je===a.WritingMode.horizontalOnly;if(ye>0||Ae>0){var St=rs(ze.text);ie(n.text,ye,We?qn:St),ie(n.text,Ae,ut?qn:St);var Ct=ze.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(function(Lt){Lt>=0&&(n.text.placedSymbolArray.get(Lt).hidden=Ct||We?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=Ct||ut?1:0);var It=u.variableOffsets[he.crossTileID];It&&u.markUsedJustification(n,It.anchor,he,Je);var vr=u.placedOrientations[he.crossTileID];vr&&(u.markUsedJustification(n,"left",he,vr),u.markUsedOrientation(n,vr,he))}if(Oe){var ht=rs(ze.icon),Zt=!(G&&he.verticalPlacedIconSymbolIndex&&We);he.placedIconSymbolIndex>=0&&(ie(n.icon,he.numIconVertices,Zt?ht:qn),n.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=ze.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(ie(n.icon,he.numVerticalIconVertices,Zt?qn:ht),n.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=ze.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var nr=n.collisionArrays[ae];if(nr){var Ut=new a.Point(0,0);if(nr.textBox||nr.verticalTextBox){var Nt=!0;if(C){var tr=u.variableOffsets[xe];tr?(Ut=ti(tr.anchor,tr.width,tr.height,tr.textOffset,tr.textBoxScale),R&&Ut._rotate(Z?u.transform.angle:-u.transform.angle)):Nt=!1}nr.textBox&&io(n.textCollisionBox.collisionVertexArray,ze.text.placed,!Nt||We,Ut.x,Ut.y),nr.verticalTextBox&&io(n.textCollisionBox.collisionVertexArray,ze.text.placed,!Nt||ut,Ut.x,Ut.y)}var Ot=Boolean(!ut&&nr.verticalIconBox);nr.iconBox&&io(n.iconCollisionBox.collisionVertexArray,ze.icon.placed,Ot,G?Ut.x:0,G?Ut.y:0),nr.verticalIconBox&&io(n.iconCollisionBox.collisionVertexArray,ze.icon.placed,!Ot,G?Ut.x:0,G?Ut.y:0)}}},se=0;se<n.symbolInstances.length;se++)te(se);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},zi.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},zi.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},zi.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},zi.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},zi.prototype.setStale=function(){this.stale=!0};var Pn=Math.pow(2,25),mo=Math.pow(2,24),en=Math.pow(2,17),Do=Math.pow(2,16),ba=Math.pow(2,9),wa=Math.pow(2,8),Sa=Math.pow(2,1);function rs(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*Pn+s*mo+o*en+s*Do+o*ba+s*wa+o*Sa+s}var qn=0,Ko=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ko.prototype.continuePlacement=function(n,s,o,u,m){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,E){return S.sortKey-E.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,m())return!0;return!1};var ca=function(n,s,o,u,m,w,S){this.placement=new zi(n,m,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=u,this._done=!1};ca.prototype.isDone=function(){return this._done},ca.prototype.continuePlacement=function(n,s,o){for(var u=this,m=a.browser.now(),w=function(){var C=a.browser.now()-m;return!u._forceFullPlacement&&C>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=E)&&(!S.maxzoom||S.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Ko(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ca.prototype.commit=function(n){return this.placement.commit(n),this.placement};var is=512/a.EXTENT/2,Mn=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var u=0;u<s.length;u++){var m=s.get(u),w=m.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:m.crossTileID,coord:this.getScaledCoordinates(m,n)})}};Mn.prototype.getScaledCoordinates=function(n,s){var o=is/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},Mn.prototype.findMatches=function(n,s,o){for(var u=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),m=0;m<n.length;m++){var w=n.get(m);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var E=this.getScaledCoordinates(w,s),C=0,R=S;C<R.length;C+=1){var Z=R[C];if(Math.abs(Z.coord.x-E.x)<=u&&Math.abs(Z.coord.y-E.y)<=u&&!o[Z.crossTileID]){o[Z.crossTileID]=!0,w.crossTileID=Z.crossTileID;break}}}}};var wn=function(){this.maxCrossTileID=0};wn.prototype.generate=function(){return++this.maxCrossTileID};var Zi=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Zi.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var u=this.indexes[o],m={};for(var w in u){var S=u[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),m[S.tileID.key]=S}this.indexes[o]=m}this.lng=n},Zi.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<s.symbolInstances.length;u++)s.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var m=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var E in S){var C=S[E];C.tileID.isChildOf(n)&&C.findMatches(s.symbolInstances,n,m)}else{var R=S[n.scaledTo(Number(w)).key];R&&R.findMatches(s.symbolInstances,n,m)}}for(var Z=0;Z<s.symbolInstances.length;Z++){var G=s.symbolInstances.get(Z);G.crossTileID||(G.crossTileID=o.generate(),m[G.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Mn(n,s.symbolInstances,s.bucketInstanceId),!0},Zi.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var u=0,m=s.indexedSymbolInstances[o];u<m.length;u+=1)delete this.usedCrossTileIDs[n][m[u].crossTileID]},Zi.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var u=this.indexes[o];for(var m in u)n[u[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,u[m]),delete u[m],s=!0)}return s};var fe=function(){this.layerIndexes={},this.crossTileIDs=new wn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};fe.prototype.addLayer=function(n,s,o){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new Zi);var m=!1,w={};u.handleWrapJump(o);for(var S=0,E=s;S<E.length;S+=1){var C=E[S],R=C.getBucket(n);R&&n.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(C.tileID,R,this.crossTileIDs)&&(m=!0),w[R.bucketInstanceId]=!0)}return u.removeStaleBuckets(w)&&(m=!0),m},fe.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(u){s[u]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var ri=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Ci=a.pick(Xe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Tr=a.pick(Xe,["setCenter","setZoom","setBearing","setPitch"]),yo=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var u,m=a.styleSpec.$root[o];m.required&&(u=o==="version"?s:m.type==="array"?[]:{})!=null&&(n[o]=u)}return n}(),Sn=function(n){function s(o,u){var m=this;u===void 0&&(u={}),n.call(this),this.map=o,this.dispatcher=new xt(we(),this),this.imageManager=new Ge,this.imageManager.setEventedParent(this),this.glyphManager=new Rt(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new ot(256,512),this.crossTileSymbolIndex=new fe,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(E,C){if(a.triggerPluginCompletionEvent(E),C&&C.every(function(Z){return Z}))for(var R in w.sourceCaches)w.sourceCaches[R].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var E=m.sourceCaches[S.sourceId];if(E){var C=E.getSource();if(C&&C.vectorLayerIds)for(var R in m._layers){var Z=m._layers[R];Z.source===C.id&&m._validateLayer(Z)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof u.validate=="boolean"?u.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(E,C){m._request=null,E?m.fire(new a.ErrorEvent(E)):C&&m._load(C,w)})},s.prototype.loadJSON=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){m._request=null,m._load(o,u.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(yo,!1)},s.prototype._load=function(o,u){if(!u||!ri(this,a.validateStyle(o))){for(var m in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(m,o.sources[m],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=qe(this.stylesheet.layers);this._order=w.map(function(R){return R.id}),this._layers={},this._serializedLayers={};for(var S=0,E=w;S<E.length;S+=1){var C=E[S];(C=a.createStyleLayer(C)).setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new At(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var u=this;this._spriteRequest=function(m,w,S){var E,C,R,Z=a.browser.devicePixelRatio>1?"@2x":"",G=a.getJSON(w.transformRequest(w.normalizeSpriteURL(m,Z,".json"),a.ResourceType.SpriteJSON),function(te,se){G=null,R||(R=te,E=se,ie())}),W=a.getImage(w.transformRequest(w.normalizeSpriteURL(m,Z,".png"),a.ResourceType.SpriteImage),function(te,se){W=null,R||(R=te,C=se,ie())});function ie(){if(R)S(R);else if(E&&C){var te=a.browser.getImageData(C),se={};for(var Y in E){var ae=E[Y],he=ae.width,ye=ae.height,Ae=ae.x,xe=ae.y,ze=ae.sdf,Oe=ae.pixelRatio,Je=ae.stretchX,We=ae.stretchY,ut=ae.content,St=new a.RGBAImage({width:he,height:ye});a.RGBAImage.copy(te,St,{x:Ae,y:xe},{x:0,y:0},{width:he,height:ye}),se[Y]={data:St,pixelRatio:Oe,sdf:ze,stretchX:Je,stretchY:We,content:ut}}S(null,se)}}return{cancel:function(){G&&(G.cancel(),G=null),W&&(W.cancel(),W=null)}}}(o,this.map._requestManager,function(m,w){if(u._spriteRequest=null,m)u.fire(new a.ErrorEvent(m));else if(w)for(var S in w)u.imageManager.addImage(S,w[S]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var u=this.sourceCaches[o.source];if(u){var m=o.sourceLayer;if(m){var w=u.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(m)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+m+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var u=[],m=0,w=o;m<w.length;m+=1){var S=this._layers[w[m]];S.type!=="custom"&&u.push(S.serialize())}return u},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var u=this._changed;if(this._changed){var m=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(m.length||w.length)&&this._updateWorkerLayers(m,w),this._updatedSources){var E=this._updatedSources[S];E==="reload"?this._reloadSource(S):E==="clear"&&this._clearSource(S)}for(var C in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[C].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var R={};for(var Z in this.sourceCaches){var G=this.sourceCaches[Z];R[Z]=G.used,G.used=!1}for(var W=0,ie=this._order;W<ie.length;W+=1){var te=this._layers[ie[W]];te.recalculate(o,this._availableImages),!te.isHidden(o.zoom)&&te.source&&(this.sourceCaches[te.source].used=!0)}for(var se in R){var Y=this.sourceCaches[se];R[se]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:se}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var u=this;if(this._checkLoaded(),ri(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=qe(o.layers);var m=function(S,E){if(!S)return[{command:Xe.setStyle,args:[E]}];var C=[];try{if(!a.deepEqual(S.version,E.version))return[{command:Xe.setStyle,args:[E]}];a.deepEqual(S.center,E.center)||C.push({command:Xe.setCenter,args:[E.center]}),a.deepEqual(S.zoom,E.zoom)||C.push({command:Xe.setZoom,args:[E.zoom]}),a.deepEqual(S.bearing,E.bearing)||C.push({command:Xe.setBearing,args:[E.bearing]}),a.deepEqual(S.pitch,E.pitch)||C.push({command:Xe.setPitch,args:[E.pitch]}),a.deepEqual(S.sprite,E.sprite)||C.push({command:Xe.setSprite,args:[E.sprite]}),a.deepEqual(S.glyphs,E.glyphs)||C.push({command:Xe.setGlyphs,args:[E.glyphs]}),a.deepEqual(S.transition,E.transition)||C.push({command:Xe.setTransition,args:[E.transition]}),a.deepEqual(S.light,E.light)||C.push({command:Xe.setLight,args:[E.light]});var R={},Z=[];(function(W,ie,te,se){var Y;for(Y in ie=ie||{},W=W||{})W.hasOwnProperty(Y)&&(ie.hasOwnProperty(Y)||et(Y,te,se));for(Y in ie)ie.hasOwnProperty(Y)&&(W.hasOwnProperty(Y)?a.deepEqual(W[Y],ie[Y])||(W[Y].type==="geojson"&&ie[Y].type==="geojson"&&dr(W,ie,Y)?te.push({command:Xe.setGeoJSONSourceData,args:[Y,ie[Y].data]}):Kt(Y,ie,te,se)):jt(Y,ie,te))})(S.sources,E.sources,Z,R);var G=[];S.layers&&S.layers.forEach(function(W){R[W.source]?C.push({command:Xe.removeLayer,args:[W.id]}):G.push(W)}),C=C.concat(Z),function(W,ie,te){ie=ie||[];var se,Y,ae,he,ye,Ae,xe,ze=(W=W||[]).map($t),Oe=ie.map($t),Je=W.reduce(er,{}),We=ie.reduce(er,{}),ut=ze.slice(),St=Object.create(null);for(se=0,Y=0;se<ze.length;se++)We.hasOwnProperty(ae=ze[se])?Y++:(te.push({command:Xe.removeLayer,args:[ae]}),ut.splice(ut.indexOf(ae,Y),1));for(se=0,Y=0;se<Oe.length;se++)ut[ut.length-1-se]!==(ae=Oe[Oe.length-1-se])&&(Je.hasOwnProperty(ae)?(te.push({command:Xe.removeLayer,args:[ae]}),ut.splice(ut.lastIndexOf(ae,ut.length-Y),1)):Y++,te.push({command:Xe.addLayer,args:[We[ae],Ae=ut[ut.length-se]]}),ut.splice(ut.length-se,0,ae),St[ae]=!0);for(se=0;se<Oe.length;se++)if(he=Je[ae=Oe[se]],ye=We[ae],!St[ae]&&!a.deepEqual(he,ye))if(a.deepEqual(he.source,ye.source)&&a.deepEqual(he["source-layer"],ye["source-layer"])&&a.deepEqual(he.type,ye.type)){for(xe in Ft(he.layout,ye.layout,te,ae,null,Xe.setLayoutProperty),Ft(he.paint,ye.paint,te,ae,null,Xe.setPaintProperty),a.deepEqual(he.filter,ye.filter)||te.push({command:Xe.setFilter,args:[ae,ye.filter]}),a.deepEqual(he.minzoom,ye.minzoom)&&a.deepEqual(he.maxzoom,ye.maxzoom)||te.push({command:Xe.setLayerZoomRange,args:[ae,ye.minzoom,ye.maxzoom]}),he)he.hasOwnProperty(xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?Ft(he[xe],ye[xe],te,ae,xe.slice(6),Xe.setPaintProperty):a.deepEqual(he[xe],ye[xe])||te.push({command:Xe.setLayerProperty,args:[ae,xe,ye[xe]]}));for(xe in ye)ye.hasOwnProperty(xe)&&!he.hasOwnProperty(xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?Ft(he[xe],ye[xe],te,ae,xe.slice(6),Xe.setPaintProperty):a.deepEqual(he[xe],ye[xe])||te.push({command:Xe.setLayerProperty,args:[ae,xe,ye[xe]]}))}else te.push({command:Xe.removeLayer,args:[ae]}),Ae=ut[ut.lastIndexOf(ae)+1],te.push({command:Xe.addLayer,args:[ye,Ae]})}(G,E.layers,C)}catch(W){console.warn("Unable to compute style diff:",W),C=[{command:Xe.setStyle,args:[E]}]}return C}(this.serialize(),o).filter(function(S){return!(S.command in Tr)});if(m.length===0)return!1;var w=m.filter(function(S){return!(S.command in Ci)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return m.forEach(function(S){S.command!=="setTransition"&&u[S.command].apply(u,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,u){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,u),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,u){this.imageManager.updateImage(o,u)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,u,m){var w=this;if(m===void 0&&(m={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,u,null,m))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var S=this.sourceCaches[o]=new re(o,u,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+u+'" is using it.')));var m=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],m.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),m.setEventedParent(null),m.clearTiles(),m.onRemove&&m.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,u){this._checkLoaded(),this.sourceCaches[o].getSource().setData(u),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(ri(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},m))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var E=u?this._order.indexOf(u):this._order.length;if(u&&E===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(E,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var C=this._removedLayers[w];delete this._removedLayers[w],C.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,u){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==u){var m=this._order.indexOf(o);this._order.splice(m,1);var w=u?this._order.indexOf(u):this._order.length;u&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var u=this._layers[o];if(u){u.setEventedParent(null);var m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,u,m){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===u&&w.maxzoom===m||(u!=null&&(w.minzoom=u),m!=null&&(w.maxzoom=m),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,u))return u==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",u,null,m)||(w.filter=a.clone$1(u),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,u,m,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(u),m)||(S.setLayoutProperty(u,m,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,u){var m=this.getLayer(o);if(m)return m.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,u,m,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(u),m)||(S.setPaintProperty(u,m,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,u){return this.getLayer(o).getPaintProperty(u)},s.prototype.setFeatureState=function(o,u){this._checkLoaded();var m=o.source,w=o.sourceLayer,S=this.sourceCaches[m];if(S!==void 0){var E=S.getSource().type;E==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,u)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,u){this._checkLoaded();var m=o.source,w=this.sourceCaches[m];if(w!==void 0){var S=w.getSource().type,E=S==="vector"?o.sourceLayer:void 0;S!=="vector"||E?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(E,o.id,u):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var u=o.source,m=o.sourceLayer,w=this.sourceCaches[u];if(w!==void 0){if(w.getSource().type!=="vector"||m)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(m,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var u=this,m=function(Je){return u._layers[Je].type==="fill-extrusion"},w={},S=[],E=this._order.length-1;E>=0;E--){var C=this._order[E];if(m(C)){w[C]=E;for(var R=0,Z=o;R<Z.length;R+=1){var G=Z[R][C];if(G)for(var W=0,ie=G;W<ie.length;W+=1)S.push(ie[W])}}}S.sort(function(Je,We){return We.intersectionZ-Je.intersectionZ});for(var te=[],se=this._order.length-1;se>=0;se--){var Y=this._order[se];if(m(Y))for(var ae=S.length-1;ae>=0;ae--){var he=S[ae].feature;if(w[he.layer.id]<se)break;te.push(he),S.pop()}else for(var ye=0,Ae=o;ye<Ae.length;ye+=1){var xe=Ae[ye][Y];if(xe)for(var ze=0,Oe=xe;ze<Oe.length;ze+=1)te.push(Oe[ze].feature)}}return te},s.prototype.queryRenderedFeatures=function(o,u,m){u&&u.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var w={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,E=u.layers;S<E.length;S+=1){var C=E[S],R=this._layers[C];if(!R)return this.fire(new a.ErrorEvent(new Error("The layer '"+C+"' does not exist in the map's style and cannot be queried for features."))),[];w[R.source]=!0}}var Z=[];for(var G in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!w[G]||Z.push(Gr(this.sourceCaches[G],this._layers,this._serializedLayers,o,u,m));return this.placement&&Z.push(function(W,ie,te,se,Y,ae,he){for(var ye={},Ae=ae.queryRenderedSymbols(se),xe=[],ze=0,Oe=Object.keys(Ae).map(Number);ze<Oe.length;ze+=1)xe.push(he[Oe[ze]]);xe.sort(Ni);for(var Je=function(){var It=ut[We],vr=It.featureIndex.lookupSymbolFeatures(Ae[It.bucketInstanceId],ie,It.bucketIndex,It.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,W);for(var ht in vr){var Zt=ye[ht]=ye[ht]||[],nr=vr[ht];nr.sort(function(tr,Ot){var Lt=It.featureSortOrder;if(Lt){var rn=Lt.indexOf(tr.featureIndex);return Lt.indexOf(Ot.featureIndex)-rn}return Ot.featureIndex-tr.featureIndex});for(var Ut=0,Nt=nr;Ut<Nt.length;Ut+=1)Zt.push(Nt[Ut])}},We=0,ut=xe;We<ut.length;We+=1)Je();var St=function(It){ye[It].forEach(function(vr){var ht=vr.feature,Zt=te[W[It].source].getFeatureState(ht.layer["source-layer"],ht.id);ht.source=ht.layer.source,ht.layer["source-layer"]&&(ht.sourceLayer=ht.layer["source-layer"]),ht.state=Zt})};for(var Ct in ye)St(Ct);return ye}(this._layers,this._serializedLayers,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},s.prototype.querySourceFeatures=function(o,u){u&&u.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var m=this.sourceCaches[o];return m?function(w,S){for(var E=w.getRenderableIds().map(function(ie){return w.getTileByID(ie)}),C=[],R={},Z=0;Z<E.length;Z++){var G=E[Z],W=G.tileID.canonical.key;R[W]||(R[W]=!0,G.querySourceFeatures(C,S))}return C}(m,u):[]},s.prototype.addSourceType=function(o,u,m){return s.getSourceType(o)?m(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},m):m(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,u){u===void 0&&(u={}),this._checkLoaded();var m=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],m[S])){w=!0;break}if(w){var E={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(E)}},s.prototype._validate=function(o,u,m,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&ri(this,o.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:m,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var u in this.sourceCaches)this.sourceCaches[u].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,u,m,w,S){S===void 0&&(S=!1);for(var E=!1,C=!1,R={},Z=0,G=this._order;Z<G.length;Z+=1){var W=this._layers[G[Z]];if(W.type==="symbol"){if(!R[W.source]){var ie=this.sourceCaches[W.source];R[W.source]=ie.getRenderableIds(!0).map(function(he){return ie.getTileByID(he)}).sort(function(he,ye){return ye.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(ye.tileID)?-1:1)})}var te=this.crossTileSymbolIndex.addLayer(W,R[W.source],o.center.lng);E=E||te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new ca(o,this._order,S,u,m,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),C=!0),E&&this.pauseablePlacement.placement.setStale()),C||E)for(var se=0,Y=this._order;se<Y.length;se+=1){var ae=this._layers[Y[se]];ae.type==="symbol"&&this.placement.updateLayerOpacities(ae,R[ae.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();var w=this.sourceCaches[u.source];w&&w.setDependencies(u.tileID.key,u.type,u.icons)},s.prototype.getGlyphs=function(o,u,m){this.glyphManager.getGlyphs(u.stacks,m)},s.prototype.getResource=function(o,u,m){return a.makeRequest(u,m)},s}(a.Evented);Sn.getSourceType=function(n){return Yi[n]},Sn.setSourceType=function(n,s){Yi[n]=s},Sn.registerForPluginStateChange=a.registerForPluginStateChange;var qr=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Lo=Dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Hs=Dr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wl=Dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),ka=Dr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),As=Dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),_o=Dr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Zn=Dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ro=Dr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Js=Dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Va=Dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Sl=Dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ua=Dr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Bo=Dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ja=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Bi=Dr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),zs=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Dn=Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),un=Dr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ha=Dr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ea=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),pa=Dr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Xo=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),cn=Dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),fa=Dr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Cs=Dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),go=Dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Dr(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=s.match(/attribute ([\w]+) ([\w]+)/g),m=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(m):m,E={};return{fragmentSource:n=n.replace(o,function(C,R,Z,G,W){return E[W]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_`+W+`
varying `+Z+" "+G+" "+W+`;
#else
uniform `+Z+" "+G+" u_"+W+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+W+`
    `+Z+" "+G+" "+W+" = u_"+W+`;
#endif
`}),vertexSource:s=s.replace(o,function(C,R,Z,G,W){var ie=G==="float"?"vec2":"vec4",te=W.match(/color/)?"color":ie;return E[W]?R==="define"?`
#ifndef HAS_UNIFORM_u_`+W+`
uniform lowp float u_`+W+`_t;
attribute `+Z+" "+ie+" a_"+W+`;
varying `+Z+" "+G+" "+W+`;
#else
uniform `+Z+" "+G+" u_"+W+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+W+`
    `+W+" = a_"+W+`;
#else
    `+Z+" "+G+" "+W+" = u_"+W+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+W+`
    `+W+" = unpack_mix_"+te+"(a_"+W+", u_"+W+`_t);
#else
    `+Z+" "+G+" "+W+" = u_"+W+`;
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_`+W+`
uniform lowp float u_`+W+`_t;
attribute `+Z+" "+ie+" a_"+W+`;
#else
uniform `+Z+" "+G+" u_"+W+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+W+`
    `+Z+" "+G+" "+W+" = a_"+W+`;
#else
    `+Z+" "+G+" "+W+" = u_"+W+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+W+`
    `+Z+" "+G+" "+W+" = unpack_mix_"+te+"(a_"+W+", u_"+W+`_t);
#else
    `+Z+" "+G+" "+W+" = u_"+W+`;
#endif
`}),staticAttributes:u,staticUniforms:S}}var Ys=Object.freeze({__proto__:null,prelude:Lo,background:Hs,backgroundPattern:wl,circle:ka,clippingMask:As,heatmap:_o,heatmapTexture:Zn,collisionBox:Ro,collisionCircle:Js,debug:Va,fill:Sl,fillOutline:Ua,fillOutlinePattern:Bo,fillPattern:ja,fillExtrusion:Bi,fillExtrusionPattern:zs,hillshadePrepare:Dn,hillshade:un,line:ha,lineGradient:Ea,linePattern:pa,lineSDF:Xo,raster:cn,symbolIcon:fa,symbolSDF:Cs,symbolTextAndIcon:go}),Gn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function hn(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var u=n[o].split(" ");s.push(u.pop())}return s}Gn.prototype.bind=function(n,s,o,u,m,w,S,E){this.context=n;for(var C=this.boundPaintVertexBuffers.length!==u.length,R=0;!C&&R<u.length;R++)this.boundPaintVertexBuffers[R]!==u[R]&&(C=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!C&&this.boundIndexBuffer===m&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===E?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),m&&m.dynamicDraw&&m.bind(),E&&E.bind()):this.freshBind(s,o,u,m,w,S,E)},Gn.prototype.freshBind=function(n,s,o,u,m,w,S){var E,C=n.numAttributes,R=this.context,Z=R.gl;if(R.extVertexArrayObject)this.vao&&this.destroy(),this.vao=R.extVertexArrayObject.createVertexArrayOES(),R.bindVertexArrayOES.set(this.vao),E=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=u,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{E=R.currentNumAttributes||0;for(var G=C;G<E;G++)Z.disableVertexAttribArray(G)}s.enableAttributes(Z,n);for(var W=0,ie=o;W<ie.length;W+=1)ie[W].enableAttributes(Z,n);w&&w.enableAttributes(Z,n),S&&S.enableAttributes(Z,n),s.bind(),s.setVertexAttribPointers(Z,n,m);for(var te=0,se=o;te<se.length;te+=1){var Y=se[te];Y.bind(),Y.setVertexAttribPointers(Z,n,m)}w&&(w.bind(),w.setVertexAttribPointers(Z,n,m)),u&&u.bind(),S&&(S.bind(),S.setVertexAttribPointers(Z,n,m)),R.currentNumAttributes=C},Gn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var kl=function(n,s,o,u,m,w){var S=n.gl;this.program=S.createProgram();for(var E=hn(o.staticAttributes),C=u?u.getBinderAttributes():[],R=E.concat(C),Z=o.staticUniforms?hn(o.staticUniforms):[],G=u?u.getBinderUniforms():[],W=[],ie=0,te=Z.concat(G);ie<te.length;ie+=1){var se=te[ie];W.indexOf(se)<0&&W.push(se)}var Y=u?u.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var ae=Y.concat(Lo.fragmentSource,o.fragmentSource).join(`
`),he=Y.concat(Lo.vertexSource,o.vertexSource).join(`
`),ye=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(ye,ae),S.compileShader(ye),S.attachShader(this.program,ye);var Ae=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Ae,he),S.compileShader(Ae),S.attachShader(this.program,Ae),this.attributes={};var xe={};this.numAttributes=R.length;for(var ze=0;ze<this.numAttributes;ze++)R[ze]&&(S.bindAttribLocation(this.program,ze,R[ze]),this.attributes[R[ze]]=ze);S.linkProgram(this.program),S.deleteShader(Ae),S.deleteShader(ye);for(var Oe=0;Oe<W.length;Oe++){var Je=W[Oe];if(Je&&!xe[Je]){var We=S.getUniformLocation(this.program,Je);We&&(xe[Je]=We)}}this.fixedUniforms=m(n,xe),this.binderUniforms=u?u.getUniforms(n,xe):[]}}};function da(n,s,o){var u=1/yr(o,1,s.transform.tileZoom),m=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/m,S=w*(o.tileID.canonical.x+o.tileID.wrap*m),E=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,E>>16],u_pixel_coord_lower:[65535&S,65535&E]}}kl.prototype.draw=function(n,s,o,u,m,w,S,E,C,R,Z,G,W,ie,te,se){var Y,ae=n.gl;if(!this.failedToCreate){for(var he in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(u),n.setColorMode(m),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[he].set(S[he]);ie&&ie.setUniforms(n,this.binderUniforms,G,{zoom:W});for(var ye=(Y={},Y[ae.LINES]=2,Y[ae.TRIANGLES]=3,Y[ae.LINE_STRIP]=1,Y)[s],Ae=0,xe=Z.get();Ae<xe.length;Ae+=1){var ze=xe[Ae],Oe=ze.vaos||(ze.vaos={});(Oe[E]||(Oe[E]=new Gn)).bind(n,this,C,ie?ie.getPaintVertexBuffers():[],R,ze.vertexOffset,te,se),ae.drawElements(s,ze.primitiveLength*ye,ae.UNSIGNED_SHORT,ze.primitiveOffset*ye*2)}}};var El=function(n,s,o,u){var m=s.style.light,w=m.properties.get("position"),S=[w.x,w.y,w.z],E=a.create$1();m.properties.get("anchor")==="viewport"&&a.fromRotation(E,-s.transform.angle),a.transformMat3(S,S,E);var C=m.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+o,u_opacity:u}},Ta=function(n,s,o,u,m,w,S){return a.extend(El(n,s,o,u),da(w,s,S),{u_height_factor:-Math.pow(2,m.overscaledZ)/S.tileSize/8})},Ln=function(n){return{u_matrix:n}},Ia=function(n,s,o,u){return a.extend(Ln(n),da(o,s,u))},pn=function(n,s){return{u_matrix:n,u_world:s}},Tl=function(n,s,o,u,m){return a.extend(Ia(n,s,o,u),{u_world:m})},Aa=function(n,s,o,u){var m,w,S=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var E=yr(o,1,S.zoom);m=!0,w=[E,E]}else m=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},vi=function(n,s,o){var u=yr(o,1,s.zoom),m=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[s.pixelsToGLUnits[0]/(u*m),s.pixelsToGLUnits[1]/(u*m)],u_overscale_factor:w}},Ql=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},za=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},xi=function(n){return{u_matrix:n}},Il=function(n,s,o,u){return{u_matrix:n,u_extrude_scale:yr(s,1,o),u_intensity:u}},Ca=function(n,s,o){var u=n.transform;return{u_matrix:Fo(n,s,o),u_ratio:1/yr(s,1,u.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},mr=function(n,s,o,u){return a.extend(Ca(n,s,o),{u_image:0,u_image_height:u})},ge=function(n,s,o,u){var m=n.transform,w=Rn(s,m);return{u_matrix:Fo(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/yr(s,1,m.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},bt=function(n,s,o,u,m){var w=n.lineAtlas,S=Rn(s,n.transform),E=o.layout.get("line-cap")==="round",C=w.getDash(u.from,E),R=w.getDash(u.to,E),Z=C.width*m.fromScale,G=R.width*m.toScale;return a.extend(Ca(n,s,o),{u_patternscale_a:[S/Z,-C.height/2],u_patternscale_b:[S/G,-R.height/2],u_sdfgamma:w.width/(256*Math.min(Z,G)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:R.y,u_mix:m.t})};function Rn(n,s){return 1/yr(n,1,s.tileZoom)}function Fo(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var ns=function(n,s,o,u,m){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(S=m.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=m.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:qa(m.paint.get("raster-hue-rotate"))};var w,S};function qa(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var no,vo=function(n,s,o,u,m,w,S,E,C,R){var Z=m.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Z.width/Z.height,u_fade_change:m.options.fadeDuration?m.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:E,u_is_text:+C,u_pitch_with_map:+u,u_texsize:R,u_texture:0}},Oo=function(n,s,o,u,m,w,S,E,C,R,Z){var G=m.transform;return a.extend(vo(n,s,o,u,m,w,S,E,C,R),{u_gamma_scale:u?Math.cos(G._pitch)*G.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+Z})},kn=function(n,s,o,u,m,w,S,E,C,R){return a.extend(Oo(n,s,o,u,m,w,S,E,!0,C,!0),{u_texsize_icon:R,u_texture_icon:1})},No=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},xo=function(n,s,o,u,m,w){return a.extend(function(S,E,C,R){var Z=C.imageManager.getPattern(S.from.toString()),G=C.imageManager.getPattern(S.to.toString()),W=C.imageManager.getPixelSize(),ie=W.width,te=W.height,se=Math.pow(2,R.tileID.overscaledZ),Y=R.tileSize*Math.pow(2,C.transform.tileZoom)/se,ae=Y*(R.tileID.canonical.x+R.tileID.wrap*se),he=Y*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[ie,te],u_mix:E.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/yr(R,1,C.transform.tileZoom),u_pixel_coord_upper:[ae>>16,he>>16],u_pixel_coord_lower:[65535&ae,65535&he]}}(u,w,o,m),{u_matrix:n,u_opacity:s})},Za={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Ga(n,s,o,u,m,w,S){for(var E=n.context,C=E.gl,R=n.useProgram("collisionBox"),Z=[],G=0,W=0,ie=0;ie<u.length;ie++){var te=u[ie],se=s.getTile(te),Y=se.getBucket(o);if(Y){var ae=te.posMatrix;m[0]===0&&m[1]===0||(ae=n.translatePosMatrix(te.posMatrix,se,m,w));var he=S?Y.textCollisionBox:Y.iconCollisionBox,ye=Y.collisionCircleArray;if(ye.length>0){var Ae=a.create(),xe=ae;a.mul(Ae,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Ae,Ae,Y.placementViewportMatrix),Z.push({circleArray:ye,circleOffset:W,transform:xe,invTransform:Ae}),W=G+=ye.length/4}he&&R.draw(E,C.LINES,K.disabled,J.disabled,n.colorModeForRenderPass(),ce.disabled,vi(ae,n.transform,se),o.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,n.transform.zoom,null,null,he.collisionVertexBuffer)}}if(S&&Z.length){var ze=n.useProgram("collisionCircle"),Oe=new a.StructArrayLayout2f1f2i16;Oe.resize(4*G),Oe._trim();for(var Je=0,We=0,ut=Z;We<ut.length;We+=1)for(var St=ut[We],Ct=0;Ct<St.circleArray.length/4;Ct++){var It=4*Ct,vr=St.circleArray[It+0],ht=St.circleArray[It+1],Zt=St.circleArray[It+2],nr=St.circleArray[It+3];Oe.emplace(Je++,vr,ht,Zt,nr,0),Oe.emplace(Je++,vr,ht,Zt,nr,1),Oe.emplace(Je++,vr,ht,Zt,nr,2),Oe.emplace(Je++,vr,ht,Zt,nr,3)}(!no||no.length<2*G)&&(no=function(wi){var On=2*wi,dn=new a.StructArrayLayout3ui6;dn.resize(On),dn._trim();for(var mi=0;mi<On;mi++){var Pi=6*mi;dn.uint16[Pi+0]=4*mi+0,dn.uint16[Pi+1]=4*mi+1,dn.uint16[Pi+2]=4*mi+2,dn.uint16[Pi+3]=4*mi+2,dn.uint16[Pi+4]=4*mi+3,dn.uint16[Pi+5]=4*mi+0}return dn}(G));for(var Ut=E.createIndexBuffer(no,!0),Nt=E.createVertexBuffer(Oe,a.collisionCircleLayout.members,!0),tr=0,Ot=Z;tr<Ot.length;tr+=1){var Lt=Ot[tr],rn=Ql(Lt.transform,Lt.invTransform,n.transform);ze.draw(E,C.TRIANGLES,K.disabled,J.disabled,n.colorModeForRenderPass(),ce.disabled,rn,o.id,Nt,Ut,a.SegmentVector.simpleSegment(0,2*Lt.circleOffset,Lt.circleArray.length,Lt.circleArray.length/2),null,n.transform.zoom,null,null,null)}Nt.destroy(),Ut.destroy()}}var bo=a.identity(new Float32Array(16));function Al(n,s,o,u,m,w){var S=a.getAnchorAlignment(n),E=-(S.horizontalAlign-.5)*s,C=-(S.verticalAlign-.5)*o,R=a.evaluateVariableOffset(n,u);return new a.Point((E/m+R[0])*w,(C/m+R[1])*w)}function zl(n,s,o,u,m,w,S,E,C,R,Z){var G=n.text.placedSymbolArray,W=n.text.dynamicLayoutVertexArray,ie=n.icon.dynamicLayoutVertexArray,te={};W.clear();for(var se=0;se<G.length;se++){var Y=G.get(se),ae=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:u[Y.crossTileID];if(ae){var he=new a.Point(Y.anchorX,Y.anchorY),ye=qt(he,o?E:S),Ae=ir(w.cameraToCenterDistance,ye.signedDistanceFromCamera),xe=m.evaluateSizeForFeature(n.textSizeData,R,Y)*Ae/a.ONE_EM;o&&(xe*=n.tilePixelRatio/C);for(var ze=Al(ae.anchor,ae.width,ae.height,ae.textOffset,ae.textBoxScale,xe),Oe=o?qt(he.add(ze),S).point:ye.point.add(s?ze.rotate(-w.angle):ze),Je=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,We=0;We<Y.numGlyphs;We++)a.addDynamicAttributes(W,Oe,Je);Z&&Y.associatedIconIndex>=0&&(te[Y.associatedIconIndex]={shiftedAnchor:Oe,angle:Je})}else di(Y.numGlyphs,W)}if(Z){ie.clear();for(var ut=n.icon.placedSymbolArray,St=0;St<ut.length;St++){var Ct=ut.get(St);if(Ct.hidden)di(Ct.numGlyphs,ie);else{var It=te[St];if(It)for(var vr=0;vr<Ct.numGlyphs;vr++)a.addDynamicAttributes(ie,It.shiftedAnchor,It.angle);else di(Ct.numGlyphs,ie)}}n.icon.dynamicLayoutVertexBuffer.updateData(ie)}n.text.dynamicLayoutVertexBuffer.updateData(W)}function Cl(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function tn(n,s,o,u,m,w,S,E,C,R,Z,G){for(var W=n.context,ie=W.gl,te=n.transform,se=E==="map",Y=C==="map",ae=se&&o.layout.get("symbol-placement")!=="point",he=se&&!Y&&!ae,ye=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ae=!1,xe=n.depthModeForSublayer(0,K.ReadOnly),ze=o.layout.get("text-variable-anchor"),Oe=[],Je=0,We=u;Je<We.length;Je+=1){var ut=We[Je],St=s.getTile(ut),Ct=St.getBucket(o);if(Ct){var It=m?Ct.text:Ct.icon;if(It&&It.segments.get().length){var vr=It.programConfigurations.get(o.id),ht=m||Ct.sdfIcons,Zt=m?Ct.textSizeData:Ct.iconSizeData,nr=Y||te.pitch!==0,Ut=n.useProgram(Cl(ht,m,Ct),vr),Nt=a.evaluateSizeForZoom(Zt,te.zoom),tr=void 0,Ot=[0,0],Lt=void 0,rn=void 0,wi=null,On=void 0;if(m)Lt=St.glyphAtlasTexture,rn=ie.LINEAR,tr=St.glyphAtlasTexture.size,Ct.iconsInText&&(Ot=St.imageAtlasTexture.size,wi=St.imageAtlasTexture,On=nr||n.options.rotating||n.options.zooming||Zt.kind==="composite"||Zt.kind==="camera"?ie.LINEAR:ie.NEAREST);else{var dn=o.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;Lt=St.imageAtlasTexture,rn=ht||n.options.rotating||n.options.zooming||dn||nr?ie.LINEAR:ie.NEAREST,tr=St.imageAtlasTexture.size}var mi=yr(St,1,n.transform.zoom),Pi=Cr(ut.posMatrix,Y,se,n.transform,mi),Io=Xt(ut.posMatrix,Y,se,n.transform,mi),Hn=ze&&Ct.hasTextData(),ys=o.layout.get("icon-text-fit")!=="none"&&Hn&&Ct.hasIconData();ae&&ro(Ct,ut.posMatrix,n,m,Pi,Io,Y,R);var ao=n.translatePosMatrix(ut.posMatrix,St,w,S),xa=ae||m&&ze||ys?bo:Pi,$o=n.translatePosMatrix(Io,St,w,S,!0),Bl=ht&&o.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0,cl={program:Ut,buffers:It,uniformValues:ht?Ct.iconsInText?kn(Zt.kind,Nt,he,Y,n,ao,xa,$o,tr,Ot):Oo(Zt.kind,Nt,he,Y,n,ao,xa,$o,m,tr,!0):vo(Zt.kind,Nt,he,Y,n,ao,xa,$o,m,tr),atlasTexture:Lt,atlasTextureIcon:wi,atlasInterpolation:rn,atlasInterpolationIcon:On,isSDF:ht,hasHalo:Bl};if(ye&&Ct.canOverlap){Ae=!0;for(var _s=0,hl=It.segments.get();_s<hl.length;_s+=1){var Fl=hl[_s];Oe.push({segments:new a.SegmentVector([Fl]),sortKey:Fl.sortKey,state:cl})}}else Oe.push({segments:It.segments,sortKey:0,state:cl})}}}Ae&&Oe.sort(function(gs,Vs){return gs.sortKey-Vs.sortKey});for(var Fa=0,Ol=Oe;Fa<Ol.length;Fa+=1){var Oa=Ol[Fa],nn=Oa.state;if(W.activeTexture.set(ie.TEXTURE0),nn.atlasTexture.bind(nn.atlasInterpolation,ie.CLAMP_TO_EDGE),nn.atlasTextureIcon&&(W.activeTexture.set(ie.TEXTURE1),nn.atlasTextureIcon&&nn.atlasTextureIcon.bind(nn.atlasInterpolationIcon,ie.CLAMP_TO_EDGE)),nn.isSDF){var Wa=nn.uniformValues;nn.hasHalo&&(Wa.u_is_halo=1,Wo(nn.buffers,Oa.segments,o,n,nn.program,xe,Z,G,Wa)),Wa.u_is_halo=0}Wo(nn.buffers,Oa.segments,o,n,nn.program,xe,Z,G,nn.uniformValues)}}function Wo(n,s,o,u,m,w,S,E,C){var R=u.context;m.draw(R,R.gl.TRIANGLES,w,S,E,ce.disabled,C,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,u.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Ps(n,s,o,u,m,w,S){var E,C,R,Z,G,W=n.context.gl,ie=o.paint.get("fill-pattern"),te=ie&&ie.constantOr(1),se=o.getCrossfadeParameters();S?(C=te&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",E=W.LINES):(C=te?"fillPattern":"fill",E=W.TRIANGLES);for(var Y=0,ae=u;Y<ae.length;Y+=1){var he=ae[Y],ye=s.getTile(he);if(!te||ye.patternsLoaded()){var Ae=ye.getBucket(o);if(Ae){var xe=Ae.programConfigurations.get(o.id),ze=n.useProgram(C,xe);te&&(n.context.activeTexture.set(W.TEXTURE0),ye.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),xe.updatePaintBuffers(se));var Oe=ie.constantOr(null);if(Oe&&ye.imageAtlas){var Je=ye.imageAtlas,We=Je.patternPositions[Oe.to.toString()],ut=Je.patternPositions[Oe.from.toString()];We&&ut&&xe.setConstantPatternPositions(We,ut)}var St=n.translatePosMatrix(he.posMatrix,ye,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){Z=Ae.indexBuffer2,G=Ae.segments2;var Ct=[W.drawingBufferWidth,W.drawingBufferHeight];R=C==="fillOutlinePattern"&&te?Tl(St,n,se,ye,Ct):pn(St,Ct)}else Z=Ae.indexBuffer,G=Ae.segments,R=te?Ia(St,n,se,ye):Ln(St);ze.draw(n.context,E,m,n.stencilModeForClipping(he),w,ce.disabled,R,o.id,Ae.layoutVertexBuffer,Z,G,o.paint,n.transform.zoom,xe)}}}}function ma(n,s,o,u,m,w,S){for(var E=n.context,C=E.gl,R=o.paint.get("fill-extrusion-pattern"),Z=R.constantOr(1),G=o.getCrossfadeParameters(),W=o.paint.get("fill-extrusion-opacity"),ie=0,te=u;ie<te.length;ie+=1){var se=te[ie],Y=s.getTile(se),ae=Y.getBucket(o);if(ae){var he=ae.programConfigurations.get(o.id),ye=n.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",he);Z&&(n.context.activeTexture.set(C.TEXTURE0),Y.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),he.updatePaintBuffers(G));var Ae=R.constantOr(null);if(Ae&&Y.imageAtlas){var xe=Y.imageAtlas,ze=xe.patternPositions[Ae.to.toString()],Oe=xe.patternPositions[Ae.from.toString()];ze&&Oe&&he.setConstantPatternPositions(ze,Oe)}var Je=n.translatePosMatrix(se.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),We=o.paint.get("fill-extrusion-vertical-gradient"),ut=Z?Ta(Je,n,We,W,se,G,Y):El(Je,n,We,W);ye.draw(E,E.gl.TRIANGLES,m,w,S,ce.backCCW,ut,o.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,o.paint,n.transform.zoom,he)}}}function Ms(n,s,o,u,m,w){var S=n.context,E=S.gl,C=s.fbo;if(C){var R=n.useProgram("hillshade");S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,C.colorAttachment.get());var Z=function(G,W,ie){var te=ie.paint.get("hillshade-shadow-color"),se=ie.paint.get("hillshade-highlight-color"),Y=ie.paint.get("hillshade-accent-color"),ae=ie.paint.get("hillshade-illumination-direction")*(Math.PI/180);ie.paint.get("hillshade-illumination-anchor")==="viewport"&&(ae-=G.transform.angle);var he,ye,Ae,xe=!G.options.moving;return{u_matrix:G.transform.calculatePosMatrix(W.tileID.toUnwrapped(),xe),u_image:0,u_latrange:(he=W.tileID,ye=Math.pow(2,he.canonical.z),Ae=he.canonical.y,[new a.MercatorCoordinate(0,Ae/ye).toLngLat().lat,new a.MercatorCoordinate(0,(Ae+1)/ye).toLngLat().lat]),u_light:[ie.paint.get("hillshade-exaggeration"),ae],u_shadow:te,u_highlight:se,u_accent:Y}}(n,s,o);R.draw(S,E.TRIANGLES,u,m,w,ce.disabled,Z,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function $l(n,s,o,u,m,w){var S=n.context,E=S.gl,C=s.dem;if(C&&C.data){var R=C.dim,Z=C.stride,G=C.getPixels();if(S.activeTexture.set(E.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(Z),s.demTexture){var W=s.demTexture;W.update(G,{premultiply:!1}),W.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,G,E.RGBA,{premultiply:!1}),s.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);S.activeTexture.set(E.TEXTURE0);var ie=s.fbo;if(!ie){var te=new a.Texture(S,{width:R,height:R,data:null},E.RGBA);te.bind(E.LINEAR,E.CLAMP_TO_EDGE),(ie=s.fbo=S.createFramebuffer(R,R,!0)).colorAttachment.set(te.texture)}S.bindFramebuffer.set(ie.framebuffer),S.viewport.set([0,0,R,R]),n.useProgram("hillshadePrepare").draw(S,E.TRIANGLES,u,m,w,ce.disabled,function(se,Y){var ae=Y.stride,he=a.create();return a.ortho(he,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(he,he,[0,-a.EXTENT,0]),{u_matrix:he,u_image:1,u_dimension:[ae,ae],u_zoom:se.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,C),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function wo(n,s,o,u,m){var w=u.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),E=(S-n.timeAdded)/w,C=s?(S-s.timeAdded)/w:-1,R=o.getSource(),Z=m.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),G=!s||Math.abs(s.tileID.overscaledZ-Z)>Math.abs(n.tileID.overscaledZ-Z),W=G&&n.refreshedUponExpiration?1:a.clamp(G?E:1-C,0,1);return n.refreshedUponExpiration&&E>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-W}:{opacity:W,mix:0}}return{opacity:1,mix:0}}var Qs=new a.Color(1,0,0,1),$s=new a.Color(0,1,0,1),Pl=new a.Color(0,0,1,1),Ds=new a.Color(1,0,1,1),el=new a.Color(0,1,1,1);function tl(n,s,o,u){os(n,0,s+o/2,n.transform.width,o,u)}function So(n,s,o,u){os(n,s-o/2,0,o,n.transform.height,u)}function os(n,s,o,u,m,w){var S=n.context,E=S.gl;E.enable(E.SCISSOR_TEST),E.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,u*a.browser.devicePixelRatio,m*a.browser.devicePixelRatio),S.clear({color:w}),E.disable(E.SCISSOR_TEST)}function rl(n,s,o){var u=n.context,m=u.gl,w=o.posMatrix,S=n.useProgram("debug"),E=K.disabled,C=J.disabled,R=n.colorModeForRenderPass();u.activeTexture.set(m.TEXTURE0),n.emptyTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),S.draw(u,m.LINE_STRIP,E,C,R,ce.disabled,za(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var Z=s.getTileByID(o.key).latestRawTileData,G=Math.floor((Z&&Z.byteLength||0)/1024),W=s.getTile(o).tileSize,ie=512/Math.min(W,512)*(o.overscaledZ/n.transform.zoom)*.5,te=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(te+=" => "+o.overscaledZ),function(se,Y){se.initDebugOverlayCanvas();var ae=se.debugOverlayCanvas,he=se.context.gl,ye=se.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,ae.width,ae.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(Y,5,5),ye.strokeText(Y,5,5),se.debugOverlayTexture.update(ae),se.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(n,te+" "+G+"kb"),S.draw(u,m.TRIANGLES,E,C,le.alphaBlended,ce.disabled,za(w,a.Color.transparent,ie),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Pa={symbol:function(n,s,o,u,m){if(n.renderPass==="translucent"){var w=J.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(E,C,R,Z,G,W,ie){for(var te=C.transform,se=G==="map",Y=W==="map",ae=0,he=E;ae<he.length;ae+=1){var ye=he[ae],Ae=Z.getTile(ye),xe=Ae.getBucket(R);if(xe&&xe.text&&xe.text.segments.get().length){var ze=a.evaluateSizeForZoom(xe.textSizeData,te.zoom),Oe=yr(Ae,1,C.transform.zoom),Je=Cr(ye.posMatrix,Y,se,C.transform,Oe),We=R.layout.get("icon-text-fit")!=="none"&&xe.hasIconData();if(ze){var ut=Math.pow(2,te.zoom-Ae.tileID.overscaledZ);zl(xe,se,Y,ie,a.symbolSize,te,Je,ye.posMatrix,ut,ze,We)}}}}(u,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),m),o.paint.get("icon-opacity").constantOr(1)!==0&&tn(n,s,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&tn(n,s,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(Ga(n,s,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Ga(n,s,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),E=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(m.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var C=n.context,R=C.gl,Z=n.depthModeForSublayer(0,K.ReadOnly),G=J.disabled,W=n.colorModeForRenderPass(),ie=[],te=0;te<u.length;te++){var se=u[te],Y=s.getTile(se),ae=Y.getBucket(o);if(ae){var he=ae.programConfigurations.get(o.id),ye={programConfiguration:he,program:n.useProgram("circle",he),layoutVertexBuffer:ae.layoutVertexBuffer,indexBuffer:ae.indexBuffer,uniformValues:Aa(n,se,Y,o)};if(E)for(var Ae=0,xe=ae.segments.get();Ae<xe.length;Ae+=1){var ze=xe[Ae];ie.push({segments:new a.SegmentVector([ze]),sortKey:ze.sortKey,state:ye})}else ie.push({segments:ae.segments,sortKey:0,state:ye})}}E&&ie.sort(function(St,Ct){return St.sortKey-Ct.sortKey});for(var Oe=0,Je=ie;Oe<Je.length;Oe+=1){var We=Je[Oe],ut=We.state;ut.program.draw(C,R.TRIANGLES,Z,G,W,ce.disabled,ut.uniformValues,o.id,ut.layoutVertexBuffer,ut.indexBuffer,We.segments,o.paint,n.transform.zoom,ut.programConfiguration)}}}},heatmap:function(n,s,o,u){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var m=n.context,w=m.gl,S=J.disabled,E=new le([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(ie,te,se){var Y=ie.gl;ie.activeTexture.set(Y.TEXTURE1),ie.viewport.set([0,0,te.width/4,te.height/4]);var ae=se.heatmapFbo;if(ae)Y.bindTexture(Y.TEXTURE_2D,ae.colorAttachment.get()),ie.bindFramebuffer.set(ae.framebuffer);else{var he=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,he),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),ae=se.heatmapFbo=ie.createFramebuffer(te.width/4,te.height/4,!1),function(ye,Ae,xe,ze){var Oe=ye.gl;Oe.texImage2D(Oe.TEXTURE_2D,0,Oe.RGBA,Ae.width/4,Ae.height/4,0,Oe.RGBA,ye.extRenderToTextureHalfFloat?ye.extTextureHalfFloat.HALF_FLOAT_OES:Oe.UNSIGNED_BYTE,null),ze.colorAttachment.set(xe)}(ie,te,he,ae)}})(m,n,o),m.clear({color:a.Color.transparent});for(var C=0;C<u.length;C++){var R=u[C];if(!s.hasRenderableParent(R)){var Z=s.getTile(R),G=Z.getBucket(o);if(G){var W=G.programConfigurations.get(o.id);n.useProgram("heatmap",W).draw(m,w.TRIANGLES,K.disabled,S,E,ce.disabled,Il(R.posMatrix,Z,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,o.paint,n.transform.zoom,W)}}}m.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(ie,te){var se=ie.context,Y=se.gl,ae=te.heatmapFbo;if(ae){se.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ae.colorAttachment.get()),se.activeTexture.set(Y.TEXTURE1);var he=te.colorRampTexture;he||(he=te.colorRampTexture=new a.Texture(se,te.colorRamp,Y.RGBA)),he.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),ie.useProgram("heatmapTexture").draw(se,Y.TRIANGLES,K.disabled,J.disabled,ie.colorModeForRenderPass(),ce.disabled,function(ye,Ae,xe,ze){var Oe=a.create();a.ortho(Oe,0,ye.width,ye.height,0,0,1);var Je=ye.context.gl;return{u_matrix:Oe,u_world:[Je.drawingBufferWidth,Je.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ae.paint.get("heatmap-opacity")}}(ie,te),te.id,ie.viewportBuffer,ie.quadTriangleIndexBuffer,ie.viewportSegments,te.paint,ie.transform.zoom)}}(n,o))},line:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(m.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,K.ReadOnly),E=n.colorModeForRenderPass(),C=o.paint.get("line-dasharray"),R=o.paint.get("line-pattern"),Z=R.constantOr(1),G=o.paint.get("line-gradient"),W=o.getCrossfadeParameters(),ie=Z?"linePattern":C?"lineSDF":G?"lineGradient":"line",te=n.context,se=te.gl,Y=!0,ae=0,he=u;ae<he.length;ae+=1){var ye=he[ae],Ae=s.getTile(ye);if(!Z||Ae.patternsLoaded()){var xe=Ae.getBucket(o);if(xe){var ze=xe.programConfigurations.get(o.id),Oe=n.context.program.get(),Je=n.useProgram(ie,ze),We=Y||Je.program!==Oe,ut=R.constantOr(null);if(ut&&Ae.imageAtlas){var St=Ae.imageAtlas,Ct=St.patternPositions[ut.to.toString()],It=St.patternPositions[ut.from.toString()];Ct&&It&&ze.setConstantPatternPositions(Ct,It)}var vr=Z?ge(n,Ae,o,W):C?bt(n,Ae,o,C,W):G?mr(n,Ae,o,xe.lineClipsArray.length):Ca(n,Ae,o);if(Z)te.activeTexture.set(se.TEXTURE0),Ae.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),ze.updatePaintBuffers(W);else if(C&&(We||n.lineAtlas.dirty))te.activeTexture.set(se.TEXTURE0),n.lineAtlas.bind(te);else if(G){var ht=xe.gradients[o.id],Zt=ht.texture;if(o.gradientVersion!==ht.version){var nr=256;if(o.stepInterpolant){var Ut=s.getSource().maxzoom,Nt=ye.canonical.z===Ut?Math.ceil(1<<n.transform.maxZoom-ye.canonical.z):1;nr=a.clamp(a.nextPowerOfTwo(xe.maxLineLength/a.EXTENT*1024*Nt),256,te.maxTextureSize)}ht.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:nr,image:ht.gradient||void 0,clips:xe.lineClipsArray}),ht.texture?ht.texture.update(ht.gradient):ht.texture=new a.Texture(te,ht.gradient,se.RGBA),ht.version=o.gradientVersion,Zt=ht.texture}te.activeTexture.set(se.TEXTURE0),Zt.bind(o.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}Je.draw(te,se.TRIANGLES,S,n.stencilModeForClipping(ye),E,ce.disabled,vr,o.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,o.paint,n.transform.zoom,ze,xe.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,u){var m=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),E=o.paint.get("fill-pattern"),C=n.opaquePassEnabledForLayer()&&!E.constantOr(1)&&m.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===C){var R=n.depthModeForSublayer(1,n.renderPass==="opaque"?K.ReadWrite:K.ReadOnly);Ps(n,s,o,u,R,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var Z=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);Ps(n,s,o,u,Z,S,!0)}}},"fill-extrusion":function(n,s,o,u){var m=o.paint.get("fill-extrusion-opacity");if(m!==0&&n.renderPass==="translucent"){var w=new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D);if(m!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))ma(n,s,o,u,w,J.disabled,le.disabled),ma(n,s,o,u,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();ma(n,s,o,u,w,J.disabled,S)}}},hillshade:function(n,s,o,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var m=n.context,w=n.depthModeForSublayer(0,K.ReadOnly),S=n.colorModeForRenderPass(),E=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],C=E[0],R=0,Z=E[1];R<Z.length;R+=1){var G=Z[R],W=s.getTile(G);W.needsHillshadePrepare&&n.renderPass==="offscreen"?$l(n,W,o,w,J.disabled,S):n.renderPass==="translucent"&&Ms(n,W,o,w,C[G.overscaledZ],S)}m.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,u){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&u.length)for(var m=n.context,w=m.gl,S=s.getSource(),E=n.useProgram("raster"),C=n.colorModeForRenderPass(),R=S instanceof hr?[{},u]:n.stencilConfigForOverlap(u),Z=R[0],G=R[1],W=G[G.length-1].overscaledZ,ie=!n.options.moving,te=0,se=G;te<se.length;te+=1){var Y=se[te],ae=n.depthModeForSublayer(Y.overscaledZ-W,o.paint.get("raster-opacity")===1?K.ReadWrite:K.ReadOnly,w.LESS),he=s.getTile(Y),ye=n.transform.calculatePosMatrix(Y.toUnwrapped(),ie);he.registerFadeDuration(o.paint.get("raster-fade-duration"));var Ae=s.findLoadedParent(Y,0),xe=wo(he,Ae,s,o,n.transform),ze=void 0,Oe=void 0,Je=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;m.activeTexture.set(w.TEXTURE0),he.texture.bind(Je,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),m.activeTexture.set(w.TEXTURE1),Ae?(Ae.texture.bind(Je,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),ze=Math.pow(2,Ae.tileID.overscaledZ-he.tileID.overscaledZ),Oe=[he.tileID.canonical.x*ze%1,he.tileID.canonical.y*ze%1]):he.texture.bind(Je,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var We=ns(ye,Oe||[0,0],ze||1,xe,o);S instanceof hr?E.draw(m,w.TRIANGLES,ae,J.disabled,C,ce.disabled,We,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):E.draw(m,w.TRIANGLES,ae,Z[Y.overscaledZ],C,ce.disabled,We,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var u=o.paint.get("background-color"),m=o.paint.get("background-opacity");if(m!==0){var w=n.context,S=w.gl,E=n.transform,C=E.tileSize,R=o.paint.get("background-pattern");if(!n.isPatternMissing(R)){var Z=!R&&u.a===1&&m===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===Z){var G=J.disabled,W=n.depthModeForSublayer(0,Z==="opaque"?K.ReadWrite:K.ReadOnly),ie=n.colorModeForRenderPass(),te=n.useProgram(R?"backgroundPattern":"background"),se=E.coveringTiles({tileSize:C});R&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),ae=0,he=se;ae<he.length;ae+=1){var ye=he[ae],Ae=n.transform.calculatePosMatrix(ye.toUnwrapped()),xe=R?xo(Ae,m,n,R,{tileID:ye,tileSize:C},Y):No(Ae,m,u);te.draw(w,S.TRIANGLES,W,G,ie,ce.disabled,xe,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var u=0;u<o.length;u++)rl(n,s,o[u])},custom:function(n,s,o){var u=n.context,m=o.implementation;if(n.renderPass==="offscreen"){var w=m.prerender;w&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),w.call(m,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode(J.disabled);var S=m.renderingMode==="3d"?new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,K.ReadOnly);u.setDepthMode(S),m.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Zr=function(n,s){this.context=new U(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=re.maxUnderzooming+re.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fe,this.gpuTimers={}};Zr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,u=this.style._order;o<u.length;o+=1)this.style._layers[u[o]].resize()},Zr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,qr.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,qr.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var u=new a.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(a.EXTENT,0,a.EXTENT,0),u.emplaceBack(0,a.EXTENT,0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,Ke.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(m,qr.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var E=this.context.gl;this.stencilClearMode=new J({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)},Zr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,K.disabled,this.stencilClearMode,le.disabled,ce.disabled,xi(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Zr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,u=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(le.disabled),o.setDepthMode(K.disabled);var m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var E=S[w],C=this._tileClippingMaskIDs[E.key]=this.nextStencilID++;m.draw(o,u.TRIANGLES,K.disabled,new J({func:u.ALWAYS,mask:0},C,255,u.KEEP,u.KEEP,u.REPLACE),le.disabled,ce.disabled,xi(E.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Zr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new J({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Zr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new J({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Zr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,u=n.sort(function(C,R){return R.overscaledZ-C.overscaledZ}),m=u[u.length-1].overscaledZ,w=u[0].overscaledZ-m+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},E=0;E<w;E++)S[E+m]=new J({func:o.GEQUAL,mask:255},E+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,u]}return[(s={},s[m]=J.disabled,s),u]},Zr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new le([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?le.unblended:le.alphaBlended},Zr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return K.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new K(o||this.context.gl.LEQUAL,s,[u,u])},Zr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Zr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var u=this.style._order,m=this.style.sourceCaches;for(var w in m){var S=m[w];S.used&&S.prepare(this.context)}var E,C,R={},Z={},G={};for(var W in m){var ie=m[W];R[W]=ie.getVisibleCoordinates(),Z[W]=R[W].slice().reverse(),G[W]=ie.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var te=0;te<u.length;te++)if(this.style._layers[u[te]].is3D()){this.opaquePassCutoff=te;break}this.renderPass="offscreen";for(var se=0,Y=u;se<Y.length;se+=1){var ae=this.style._layers[Y[se]];if(ae.hasOffscreenPass()&&!ae.isHidden(this.transform.zoom)){var he=Z[ae.source];(ae.type==="custom"||he.length)&&this.renderLayer(this,m[ae.source],ae,he)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ye=this.style._layers[u[this.currentLayer]],Ae=m[ye.source],xe=R[ye.source];this._renderTileClippingMasks(ye,xe),this.renderLayer(this,Ae,ye,xe)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var ze=this.style._layers[u[this.currentLayer]],Oe=m[ze.source],Je=(ze.type==="symbol"?G:Z)[ze.source];this._renderTileClippingMasks(ze,R[ze.source]),this.renderLayer(this,Oe,ze,Je)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(We){We.source&&!We.isHidden(o.transform.zoom)&&(We.source!==(C&&C.id)&&(C=o.style.sourceCaches[We.source]),(!E||E.getSource().maxzoom<C.getSource().maxzoom)&&(E=C))}),E&&Pa.debug(this,E,E.getVisibleCoordinates())),this.options.showPadding&&function(We){var ut=We.transform.padding;tl(We,We.transform.height-(ut.top||0),3,Qs),tl(We,ut.bottom||0,3,$s),So(We,ut.left||0,3,Pl),So(We,We.transform.width-(ut.right||0),3,Ds);var St=We.transform.centerPoint;(function(Ct,It,vr,ht){os(Ct,It-1,vr-10,2,20,ht),os(Ct,It-10,vr-1,20,2,ht)})(We,St.x,We.transform.height-St.y,el)}(this),this.context.setDefault()},Zr.prototype.renderLayer=function(n,s,o,u){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||u.length)&&(this.id=o.id,this.gpuTimingStart(o),Pa[o.type](n,s,o,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Zr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Zr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Zr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Zr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var u=n[o],m=this.context.extTimerQuery,w=m.getQueryObjectEXT(u.query,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(u.query),s[o]=w}return s},Zr.prototype.translatePosMatrix=function(n,s,o,u,m){if(!o[0]&&!o[1])return n;var w=m?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),E=Math.cos(w);o=[o[0]*E-o[1]*S,o[0]*S+o[1]*E]}var C=[m?o[0]:yr(s,o[0],this.transform.zoom),m?o[1]:yr(s,o[1],this.transform.zoom),0],R=new Float32Array(16);return a.translate(R,n,C),R},Zr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Zr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Zr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Zr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new kl(this.context,n,Ys[n],s,Za[n],this._showOverdrawInspector)),this.cache[o]},Zr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Zr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Zr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Zr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ls=function(n,s){this.points=n,this.planes=s};Ls.fromInvProjectionMatrix=function(n,s,o){var u=Math.pow(2,o),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*u)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var E=a.sub([],m[S[0]],m[S[1]]),C=a.sub([],m[S[2]],m[S[1]]),R=a.normalize([],a.cross([],E,C)),Z=-a.dot(R,m[S[1]]);return R.concat(Z)});return new Ls(m,w)};var Ma=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};Ma.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),u=a.clone$2(this.max),m=0;m<s.length;m++)o[m]=s[m]?this.min[m]:this.center[m],u[m]=s[m]?this.center[m]:this.max[m];return u[2]=this.max[2],new Ma(o,u)},Ma.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},Ma.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},Ma.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,u=0;u<n.planes.length;u++){for(var m=n.planes[u],w=0,S=0;S<s.length;S++)w+=a.dot$1(m,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var E=0;E<3;E++){for(var C=Number.MAX_VALUE,R=-Number.MAX_VALUE,Z=0;Z<n.points.length;Z++){var G=n.points[Z][E]-this.min[E];C=Math.min(C,G),R=Math.max(R,G)}if(R<0||C>this.max[E]-this.min[E])return 0}return 1};var Vo=function(n,s,o,u){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=u};Vo.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Vo.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),u=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,u)},Vo.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Vo.prototype.clone=function(){return new Vo(this.top,this.bottom,this.left,this.right)},Vo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ur=function(n,s,o,u,m){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=m===void 0||m,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o==null?0:o,this._maxPitch=u==null?60:u,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Vo,this._posMatrixCache={},this._alignedPosMatrixCache={}},Lr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ur.prototype.clone=function(){var n=new ur(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Lr.minZoom.get=function(){return this._minZoom},Lr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Lr.maxZoom.get=function(){return this._maxZoom},Lr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Lr.minPitch.get=function(){return this._minPitch},Lr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Lr.maxPitch.get=function(){return this._maxPitch},Lr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Lr.renderWorldCopies.get=function(){return this._renderWorldCopies},Lr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Lr.worldSize.get=function(){return this.tileSize*this.scale},Lr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Lr.size.get=function(){return new a.Point(this.width,this.height)},Lr.bearing.get=function(){return-this.angle/Math.PI*180},Lr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Lr.pitch.get=function(){return this._pitch/Math.PI*180},Lr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Lr.fov.get=function(){return this._fov/Math.PI*180},Lr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Lr.zoom.get=function(){return this._zoom},Lr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Lr.center.get=function(){return this._center},Lr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Lr.padding.get=function(){return this._edgeInsets.toJSON()},Lr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Lr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ur.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},ur.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},ur.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},ur.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),u=this.pointCoordinate(new a.Point(this.width,0)),m=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,u.x,m.x,w.x)),E=Math.floor(Math.max(o.x,u.x,m.x,w.x)),C=S-1;C<=E+1;C++)C!==0&&s.push(new a.UnwrappedTileID(C,n));return s},ur.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var u=a.MercatorCoordinate.fromLngLat(this.center),m=Math.pow(2,s),w=[m*u.x,m*u.y,0],S=Ls.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),E=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(E=s);var C=function(We){return{aabb:new Ma([We*m,0,0],[(We+1)*m,m,0]),zoom:0,x:0,y:0,wrap:We,fullyVisible:!1}},R=[],Z=[],G=s,W=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var ie=1;ie<=3;ie++)R.push(C(-ie)),R.push(C(ie));for(R.push(C(0));R.length>0;){var te=R.pop(),se=te.x,Y=te.y,ae=te.fullyVisible;if(!ae){var he=te.aabb.intersects(S);if(he===0)continue;ae=he===2}var ye=te.aabb.distanceX(w),Ae=te.aabb.distanceY(w),xe=Math.max(Math.abs(ye),Math.abs(Ae));if(te.zoom===G||xe>3+(1<<G-te.zoom)-2&&te.zoom>=E)Z.push({tileID:new a.OverscaledTileID(te.zoom===G?W:te.zoom,te.wrap,te.zoom,se,Y),distanceSq:a.sqrLen([w[0]-.5-se,w[1]-.5-Y])});else for(var ze=0;ze<4;ze++){var Oe=(se<<1)+ze%2,Je=(Y<<1)+(ze>>1);R.push({aabb:te.aabb.quadrant(ze),zoom:te.zoom+1,x:Oe,y:Je,wrap:te.wrap,fullyVisible:ae})}}return Z.sort(function(We,ut){return We.distanceSq-ut.distanceSq}).map(function(We){return We.tileID})},ur.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Lr.unmodified.get=function(){return this._unmodified},ur.prototype.zoomScale=function(n){return Math.pow(2,n)},ur.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},ur.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},ur.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Lr.point.get=function(){return this.project(this.center)},ur.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),u=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(n),w=new a.MercatorCoordinate(m.x-(o.x-u.x),m.y-(o.y-u.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},ur.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},ur.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},ur.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},ur.prototype.coordinateLocation=function(n){return n.toLngLat()},ur.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var u=s[3],m=o[3],w=s[1]/u,S=o[1]/m,E=s[2]/u,C=o[2]/m,R=E===C?0:(0-E)/(C-E);return new a.MercatorCoordinate(a.number(s[0]/u,o[0]/m,R)/this.worldSize,a.number(w,S,R)/this.worldSize)},ur.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},ur.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},ur.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ur.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ur.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,u=s?this._alignedPosMatrixCache:this._posMatrixCache;if(u[o])return u[o];var m=n.canonical,w=this.worldSize/this.zoomScale(m.z),S=m.x+Math.pow(2,m.z)*n.wrap,E=a.identity(new Float64Array(16));return a.translate(E,E,[S*w,m.y*w,0]),a.scale(E,E,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(E,s?this.alignedProjMatrix:this.projMatrix,E),u[o]=new Float32Array(E),u[o]},ur.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ur.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,u,m=-90,w=90,S=-180,E=180,C=this.size,R=this._unmodified;if(this.latRange){var Z=this.latRange;m=a.mercatorYfromLat(Z[1])*this.worldSize,n=(w=a.mercatorYfromLat(Z[0])*this.worldSize)-m<C.y?C.y/(w-m):0}if(this.lngRange){var G=this.lngRange;S=a.mercatorXfromLng(G[0])*this.worldSize,s=(E=a.mercatorXfromLng(G[1])*this.worldSize)-S<C.x?C.x/(E-S):0}var W=this.point,ie=Math.max(s||0,n||0);if(ie)return this.center=this.unproject(new a.Point(s?(E+S)/2:W.x,n?(w+m)/2:W.y)),this.zoom+=this.scaleZoom(ie),this._unmodified=R,void(this._constraining=!1);if(this.latRange){var te=W.y,se=C.y/2;te-se<m&&(u=m+se),te+se>w&&(u=w-se)}if(this.lngRange){var Y=W.x,ae=C.x/2;Y-ae<S&&(o=S+ae),Y+ae>E&&(o=E-ae)}o===void 0&&u===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:W.x,u!==void 0?u:W.y))),this._unmodified=R,this._constraining=!1}},ur.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),u=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),m=this.point,w=m.x,S=m.y,E=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),C=this.height/50,R=new Float64Array(16);a.perspective(R,this._fov,this.width/this.height,C,E),R[8]=2*-n.x/this.width,R[9]=2*n.y/this.height,a.scale(R,R,[1,-1,1]),a.translate(R,R,[0,0,-this.cameraToCenterDistance]),a.rotateX(R,R,this._pitch),a.rotateZ(R,R,this.angle),a.translate(R,R,[-w,-S,0]),this.mercatorMatrix=a.scale([],R,[this.worldSize,this.worldSize,this.worldSize]),a.scale(R,R,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=R,this.invProjMatrix=a.invert([],this.projMatrix);var Z=this.width%2/2,G=this.height%2/2,W=Math.cos(this.angle),ie=Math.sin(this.angle),te=w-Math.round(w)+W*Z+ie*G,se=S-Math.round(S)+W*G+ie*Z,Y=new Float64Array(R);if(a.translate(Y,Y,[te>.5?te-1:te,se>.5?se-1:se,0]),this.alignedProjMatrix=Y,R=a.create(),a.scale(R,R,[this.width/2,-this.height/2,1]),a.translate(R,R,[1,-1,0]),this.labelPlaneMatrix=R,R=a.create(),a.scale(R,R,[1,-1,1]),a.translate(R,R,[-1,-1,0]),a.scale(R,R,[2/this.width,2/this.height,1]),this.glCoordMatrix=R,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(R=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=R,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ur.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},ur.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},ur.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,u=s.y,m=s.x,w=s.y,S=0,E=n;S<E.length;S+=1){var C=E[S];o=Math.min(o,C.x),u=Math.min(u,C.y),m=Math.max(m,C.x),w=Math.max(w,C.y)}return[new a.Point(o,u),new a.Point(m,u),new a.Point(m,w),new a.Point(o,w),new a.Point(o,u)]},Object.defineProperties(ur.prototype,Lr);var Kn=function(n){var s,o,u,m;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,u=null,m=function(){u=null,o&&(s(),u=setTimeout(m,300),o=!1)},function(){return o=!0,u||m(),u})};Kn.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Kn.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Kn.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,u=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,u),w=Math.round(s.lng*m)/m,S=Math.round(s.lat*m)/m,E=this._map.getBearing(),C=this._map.getPitch(),R="";if(R+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(E||C)&&(R+="/"+Math.round(10*E)/10),C&&(R+="/"+Math.round(C)),this._hashName){var Z=this._hashName,G=!1,W=a.window.location.hash.slice(1).split("&").map(function(ie){var te=ie.split("=")[0];return te===Z?(G=!0,te+"="+R):ie}).filter(function(ie){return ie});return G||W.push(Z+"="+R),"#"+W.join("&")}return"#"+R},Kn.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===s._hashName&&(n=u)}),(n&&n[1]||"").split("/")):o.split("/")},Kn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Kn.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var ko={linearity:.3,easing:a.bezier(0,0,.3,1)},Ka=a.extend({deceleration:2500,maxSpeed:1400},ko),as=a.extend({deceleration:20,maxSpeed:1400},ko),eu=a.extend({deceleration:1e3,maxSpeed:360},ko),tu=a.extend({deceleration:1e3,maxSpeed:90},ko),ss=function(n){this._map=n,this.clear()};function ls(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Ho(n,s,o){var u=o.maxSpeed,m=o.linearity,w=o.deceleration,S=a.clamp(n*m/(s/1e3),-u,u),E=Math.abs(S)/(w*m);return{easing:o.easing,duration:1e3*E,amount:S*(E/2)}}ss.prototype.clear=function(){this._inertiaBuffer=[]},ss.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},ss.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},ss.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,u=this._inertiaBuffer;o<u.length;o+=1){var m=u[o].settings;s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var E=Ho(s.pan.mag(),w,a.extend({},Ka,n||{}));S.offset=s.pan.mult(E.amount/s.pan.mag()),S.center=this._map.transform.center,ls(S,E)}if(s.zoom){var C=Ho(s.zoom,w,as);S.zoom=this._map.transform.zoom+C.amount,ls(S,C)}if(s.bearing){var R=Ho(s.bearing,w,eu);S.bearing=this._map.transform.bearing+a.clamp(R.amount,-179,179),ls(S,R)}if(s.pitch){var Z=Ho(s.pitch,w,tu);S.pitch=this._map.transform.pitch+Z.amount,ls(S,Z)}if(S.zoom||S.bearing){var G=s.pinchAround===void 0?s.around:s.pinchAround;S.around=G?this._map.unproject(G):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var bi=function(n){function s(u,m,w,S){S===void 0&&(S={});var E=I.mousePos(m.getCanvasContainer(),w),C=m.unproject(E);n.call(this,u,a.extend({point:E,lngLat:C,originalEvent:w},S)),this._defaultPrevented=!1,this.target=m}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),us=function(n){function s(u,m,w){var S=u==="touchend"?w.changedTouches:w.touches,E=I.touchPos(m.getCanvasContainer(),S),C=E.map(function(G){return m.unproject(G)}),R=E.reduce(function(G,W,ie,te){return G.add(W.div(te.length))},new a.Point(0,0)),Z=m.unproject(R);n.call(this,u,{points:E,point:R,lngLats:C,lngLat:Z,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),il=function(n){function s(u,m,w){n.call(this,u,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),si=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};si.prototype.reset=function(){delete this._mousedownPos},si.prototype.wheel=function(n){return this._firePreventable(new il(n.type,this._map,n))},si.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new bi(n.type,this._map,n))},si.prototype.mouseup=function(n){this._map.fire(new bi(n.type,this._map,n))},si.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new bi(n.type,this._map,n))},si.prototype.dblclick=function(n){return this._firePreventable(new bi(n.type,this._map,n))},si.prototype.mouseover=function(n){this._map.fire(new bi(n.type,this._map,n))},si.prototype.mouseout=function(n){this._map.fire(new bi(n.type,this._map,n))},si.prototype.touchstart=function(n){return this._firePreventable(new us(n.type,this._map,n))},si.prototype.touchmove=function(n){this._map.fire(new us(n.type,this._map,n))},si.prototype.touchend=function(n){this._map.fire(new us(n.type,this._map,n))},si.prototype.touchcancel=function(n){this._map.fire(new us(n.type,this._map,n))},si.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},si.prototype.isEnabled=function(){return!0},si.prototype.isActive=function(){return!1},si.prototype.enable=function(){},si.prototype.disable=function(){};var at=function(n){this._map=n};at.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},at.prototype.mousemove=function(n){this._map.fire(new bi(n.type,this._map,n))},at.prototype.mousedown=function(){this._delayContextMenu=!0},at.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},at.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new bi(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},at.prototype.isEnabled=function(){return!0},at.prototype.isActive=function(){return!1},at.prototype.enable=function(){},at.prototype.disable=function(){};var Gi=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Rs(n,s){for(var o={},u=0;u<n.length;u++)o[n[u].identifier]=s[u];return o}Gi.prototype.isEnabled=function(){return!!this._enabled},Gi.prototype.isActive=function(){return!!this._active},Gi.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Gi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Gi.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(I.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Gi.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=o,this._box||(this._box=I.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var m=Math.min(u.x,o.x),w=Math.max(u.x,o.x),S=Math.min(u.y,o.y),E=Math.max(u.y,o.y);I.setTransform(this._box,"translate("+m+"px,"+S+"px)"),this._box.style.width=w-m+"px",this._box.style.height=E-S+"px"}}},Gi.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var u=this._startPos,m=s;if(this.reset(),I.suppressClick(),u.x!==m.x||u.y!==m.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(u,m,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Gi.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Gi.prototype.blur=function(){this.reset()},Gi.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(I.remove(this._box),this._box=null),I.enableDrag(),delete this._startPos,delete this._lastPos},Gi.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var Da=function(n){this.reset(),this.numTouches=n.numTouches};Da.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Da.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(u){for(var m=new a.Point(0,0),w=0,S=u;w<S.length;w+=1)m._add(S[w]);return m.div(u.length)}(s),this.touches=Rs(o,s)))},Da.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var u=Rs(o,s);for(var m in this.touches){var w=u[m];(!w||w.dist(this.touches[m])>30)&&(this.aborted=!0)}}},Da.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var Eo=function(n){this.singleTap=new Da(n),this.numTaps=n.numTaps,this.reset()};Eo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Eo.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},Eo.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},Eo.prototype.touchend=function(n,s,o){var u=this.singleTap.touchend(n,s,o);if(u){var m=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(u)<30;if(m&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var Bn=function(){this._zoomIn=new Eo({numTouches:1,numTaps:2}),this._zoomOut=new Eo({numTouches:2,numTaps:1}),this.reset()};Bn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Bn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Bn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Bn.prototype.touchend=function(n,s,o){var u=this,m=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return m?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(m)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Bn.prototype.touchcancel=function(){this.reset()},Bn.prototype.enable=function(){this._enabled=!0},Bn.prototype.disable=function(){this._enabled=!1,this.reset()},Bn.prototype.isEnabled=function(){return this._enabled},Bn.prototype.isActive=function(){return this._active};var nl={0:1,2:2},Ye=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Ye.prototype.blur=function(){this.reset()},Ye.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ye.prototype._correctButton=function(n,s){return!1},Ye.prototype._move=function(n,s){return{}},Ye.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=I.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},Ye.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(u,m){var w=nl[m];return u.buttons===void 0||(u.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},Ye.prototype.mouseupWindow=function(n){this._lastPoint&&I.mouseButton(n)===this._eventButton&&(this._moved&&I.suppressClick(),this.reset())},Ye.prototype.enable=function(){this._enabled=!0},Ye.prototype.disable=function(){this._enabled=!1,this.reset()},Ye.prototype.isEnabled=function(){return this._enabled},Ye.prototype.isActive=function(){return this._active};var ol=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,u){n.prototype.mousedown.call(this,o,u),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,u){return u===0&&!o.ctrlKey},s.prototype._move=function(o,u){return{around:u,panDelta:u.sub(o)}},s}(Ye),cs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=.8*(u.x-o.x);if(m)return this._active=!0,{bearingDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(Ye),al=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=-.5*(u.y-o.y);if(m)return this._active=!0,{pitchDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(Ye),oo=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};oo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},oo.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},oo.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},oo.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},oo.prototype.touchcancel=function(){this.reset()},oo.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var u=Rs(o,s),m=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var E in u){var C=u[E],R=this._touches[E];R&&(m._add(C),w._add(C.sub(R)),S++,u[E]=C)}if(this._touches=u,!(S<this._minTouches)&&w.mag()){var Z=w.div(S);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:m.div(S),panDelta:Z}}},oo.prototype.enable=function(){this._enabled=!0},oo.prototype.disable=function(){this._enabled=!1,this.reset()},oo.prototype.isEnabled=function(){return this._enabled},oo.prototype.isActive=function(){return this._active};var Fn=function(){this.reset()};function ya(n,s,o){for(var u=0;u<n.length;u++)if(n[u].identifier===o)return s[u]}function Bs(n,s){return Math.log(n/s)/Math.LN2}Fn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Fn.prototype._start=function(n){},Fn.prototype._move=function(n,s,o){return{}},Fn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Fn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,m=u[1],w=ya(o,s,u[0]),S=ya(o,s,m);if(w&&S){var E=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],E,n)}}},Fn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var u=this._firstTwoTouches,m=u[1],w=ya(o,s,u[0]),S=ya(o,s,m);w&&S||(this._active&&I.suppressClick(),this.reset())}},Fn.prototype.touchcancel=function(){this.reset()},Fn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Fn.prototype.disable=function(){this._enabled=!1,this.reset()},Fn.prototype.isEnabled=function(){return this._enabled},Fn.prototype.isActive=function(){return this._active};var En=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Bs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Bs(this._distance,m),pinchAround:u}},s}(Fn);function Jo(n,s){return 180*n.angleWith(s)/Math.PI}var Ml=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Jo(this._vector,m),pinchAround:u}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var u=25/(Math.PI*this._minDiameter)*360,m=Jo(o,this._startVector);return Math.abs(m)<u},s}(Fn);function hs(n){return Math.abs(n.y)>Math.abs(n.x)}var ju=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,hs(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,u,m){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,m.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,u,m){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=u.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;var E=o.y>0==u.y>0;return hs(o)&&hs(u)&&E}},s}(Fn),qu={panStep:100,bearingStep:15,pitchStep:10},_a=function(){var n=qu;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Uo(n){return n*(2-n)}_a.prototype.blur=function(){this.reset()},_a.prototype.reset=function(){this._active=!1},_a.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,u=0,m=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?m=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?m=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(u=0,m=0),{cameraAnimation:function(E){var C=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Uo,zoom:o?Math.round(C)+o*(n.shiftKey?2:1):C,bearing:E.getBearing()+u*s._bearingStep,pitch:E.getPitch()+m*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:E.getCenter()},{originalEvent:n})}}}},_a.prototype.enable=function(){this._enabled=!0},_a.prototype.disable=function(){this._enabled=!1,this.reset()},_a.prototype.isEnabled=function(){return this._enabled},_a.prototype.isActive=function(){return this._active},_a.prototype.disableRotation=function(){this._rotationDisabled=!0},_a.prototype.enableRotation=function(){this._rotationDisabled=!1};var cr=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};cr.prototype.setZoomRate=function(n){this._defaultZoomRate=n},cr.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},cr.prototype.isEnabled=function(){return!!this._enabled},cr.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},cr.prototype.isZooming=function(){return!!this._zooming},cr.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},cr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},cr.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),u=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},cr.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},cr.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=I.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},cr.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&u!==0&&(u=1/u);var m=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(m*u))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,E=this._startZoom,C=this._easing,R=!1;if(this._type==="wheel"&&E&&C){var Z=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),G=C(Z);w=a.number(E,S,G),Z<1?this._frameId||(this._frameId=!0):R=!0}else w=S,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!R,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},cr.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,u=(a.browser.now()-o.start)/o.duration,m=o.easing(u+.01)-o.easing(u),w=.27/Math.sqrt(m*m+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},cr.prototype.blur=function(){this.reset()},cr.prototype.reset=function(){this._active=!1};var La=function(n,s){this._clickZoom=n,this._tapZoom=s};La.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},La.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},La.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},La.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Yo=function(){this.reset()};Yo.prototype.reset=function(){this._active=!1},Yo.prototype.blur=function(){this.reset()},Yo.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},Yo.prototype.enable=function(){this._enabled=!0},Yo.prototype.disable=function(){this._enabled=!1,this.reset()},Yo.prototype.isEnabled=function(){return this._enabled},Yo.prototype.isActive=function(){return this._active};var Tn=function(){this._tap=new Eo({numTouches:1,numTaps:1}),this.reset()};Tn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Tn.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},Tn.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var u=s[0],m=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(n,s,o)},Tn.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},Tn.prototype.touchcancel=function(){this.reset()},Tn.prototype.enable=function(){this._enabled=!0},Tn.prototype.disable=function(){this._enabled=!1,this.reset()},Tn.prototype.isEnabled=function(){return this._enabled},Tn.prototype.isActive=function(){return this._active};var Fs=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};Fs.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Fs.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Fs.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Fs.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ps=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};ps.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ps.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ps.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ps.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ga=function(n,s,o,u){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};ga.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ga.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ga.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ga.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ga.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ga.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Xn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Dl=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function wt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var mt=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ss(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var u=0,m=this._listeners;u<m.length;u+=1){var w=m[u],S=w[0];I.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};mt.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],u=o[0];I.removeEventListener(u,o[1],u===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},mt.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new si(s,n));var u=s.boxZoom=new Gi(s,n);this._add("boxZoom",u);var m=new Bn,w=new Yo;s.doubleClickZoom=new La(w,m),this._add("tapZoom",m),this._add("clickZoom",w);var S=new Tn;this._add("tapDragZoom",S);var E=s.touchPitch=new ju;this._add("touchPitch",E);var C=new cs(n),R=new al(n);s.dragRotate=new ps(n,C,R),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]);var Z=new ol(n),G=new oo(n);s.dragPan=new Fs(o,Z,G),this._add("mousePan",Z),this._add("touchPan",G,["touchZoom","touchRotate"]);var W=new Ml,ie=new En;s.touchZoomRotate=new ga(o,ie,W,S),this._add("touchRotate",W,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]);var te=s.scrollZoom=new cr(s,this);this._add("scrollZoom",te,["mousePan"]);var se=s.keyboard=new _a;this._add("keyboard",se),this._add("blockableMapEvent",new at(s));for(var Y=0,ae=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<ae.length;Y+=1){var he=ae[Y];n.interactive&&n[he]&&s[he].enable(n[he])}},mt.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},mt.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},mt.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},mt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},mt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},mt.prototype.isMoving=function(){return Boolean(Xn(this._eventsInProgress))||this.isZooming()},mt.prototype._blockedByActive=function(n,s,o){for(var u in n)if(u!==o&&(!s||s.indexOf(u)<0))return!0;return!1},mt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},mt.prototype._getMapTouches=function(n){for(var s=[],o=0,u=n;o<u.length;o+=1){var m=u[o];this._el.contains(m.target)&&s.push(m)}return s},mt.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},m={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,E=S?I.touchPos(this._el,S):I.mousePos(this._el,n),C=0,R=this._handlers;C<R.length;C+=1){var Z=R[C],G=Z.handlerName,W=Z.handler,ie=Z.allowed;if(W.isEnabled()){var te=void 0;this._blockedByActive(w,ie,G)?W.reset():W[s||n.type]&&(te=W[s||n.type](n,E,S),this.mergeHandlerResult(u,m,te,G,o),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||W.isActive())&&(w[G]=W)}}var se={};for(var Y in this._previousActiveHandlers)w[Y]||(se[Y]=o);this._previousActiveHandlers=w,(Object.keys(se).length||wt(u))&&(this._changes.push([u,m,se]),this._triggerRenderFrame()),(Object.keys(w).length||wt(u))&&this._map._stop(!0),this._updatingCamera=!1;var ae=u.cameraAnimation;ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ae(this._map))},mt.prototype.mergeHandlerResult=function(n,s,o,u,m){if(o){a.extend(n,o);var w={handlerName:u,originalEvent:o.originalEvent||m};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},mt.prototype._applyChanges=function(){for(var n={},s={},o={},u=0,m=this._changes;u<m.length;u+=1){var w=m[u],S=w[0],E=w[1],C=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,E),a.extend(o,C)}this._updateMapTransform(n,s,o),this._changes=[]},mt.prototype._updateMapTransform=function(n,s,o){var u=this._map,m=u.transform;if(!wt(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,E=n.bearingDelta,C=n.pitchDelta,R=n.around,Z=n.pinchAround;Z!==void 0&&(R=Z),u._stop(!0),R=R||u.transform.centerPoint;var G=m.pointLocation(w?R.sub(w):R);E&&(m.bearing+=E),C&&(m.pitch+=C),S&&(m.zoom+=S),m.setLocationAtPoint(G,R),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},mt.prototype._fireEvents=function(n,s,o){var u=this,m=Xn(this._eventsInProgress),w=Xn(n),S={};for(var E in n)this._eventsInProgress[E]||(S[E+"start"]=n[E].originalEvent),this._eventsInProgress[E]=n[E];for(var C in!m&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(C,S[C]);for(var R in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(R,n[R].originalEvent);var Z,G={};for(var W in this._eventsInProgress){var ie=this._eventsInProgress[W],te=ie.handlerName,se=ie.originalEvent;this._handlersById[te].isActive()||(delete this._eventsInProgress[W],G[W+"end"]=Z=s[te]||se)}for(var Y in G)this._fireEvent(Y,G[Y]);var ae=Xn(this._eventsInProgress);if(o&&(m||w)&&!ae){this._updatingCamera=!0;var he=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ye=function(Ae){return Ae!==0&&-u._bearingSnap<Ae&&Ae<u._bearingSnap};he?(ye(he.bearing||this._map.getBearing())&&(he.bearing=0),this._map.easeTo(he,{originalEvent:Z})):(this._map.fire(new a.Event("moveend",{originalEvent:Z})),ye(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},mt.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},mt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new Dl("renderFrame",{timeStamp:s})),n._applyChanges()})},mt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var ru=function(n){function s(o,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,u){return this.jumpTo({center:o},u)},s.prototype.panBy=function(o,u,m){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},u),m)},s.prototype.panTo=function(o,u,m){return this.easeTo(a.extend({center:o},u),m)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,u){return this.jumpTo({zoom:o},u),this},s.prototype.zoomTo=function(o,u,m){return this.easeTo(a.extend({zoom:o},u),m)},s.prototype.zoomIn=function(o,u){return this.zoomTo(this.getZoom()+1,o,u),this},s.prototype.zoomOut=function(o,u){return this.zoomTo(this.getZoom()-1,o,u),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,u){return this.jumpTo({bearing:o},u),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,u){return this.jumpTo({padding:o},u),this},s.prototype.rotateTo=function(o,u,m){return this.easeTo(a.extend({bearing:o},u),m)},s.prototype.resetNorth=function(o,u){return this.rotateTo(0,a.extend({duration:1e3},o),u),this},s.prototype.resetNorthPitch=function(o,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),u),this},s.prototype.snapToNorth=function(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,u){return this.jumpTo({pitch:o},u),this},s.prototype.cameraForBounds=function(o,u){o=a.LngLatBounds.convert(o);var m=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),m,u)},s.prototype._cameraForBoxAndBearing=function(o,u,m,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var E=w.padding;w.padding={top:E,bottom:E,right:E,left:E}}w.padding=a.extend(S,w.padding);var C=this.transform,R=C.padding,Z=C.project(a.LngLat.convert(o)),G=C.project(a.LngLat.convert(u)),W=Z.rotate(-m*Math.PI/180),ie=G.rotate(-m*Math.PI/180),te=new a.Point(Math.max(W.x,ie.x),Math.max(W.y,ie.y)),se=new a.Point(Math.min(W.x,ie.x),Math.min(W.y,ie.y)),Y=te.sub(se),ae=(C.width-(R.left+R.right+w.padding.left+w.padding.right))/Y.x,he=(C.height-(R.top+R.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(he<0||ae<0)){var ye=Math.min(C.scaleZoom(C.scale*Math.min(ae,he)),w.maxZoom),Ae=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),xe=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(m*Math.PI/180),ze=Ae.add(xe).mult(C.scale/C.zoomScale(ye));return{center:C.unproject(Z.add(G).div(2).sub(ze)),zoom:ye,bearing:m}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,u,m){return this._fitInternal(this.cameraForBounds(o,u),u,m)},s.prototype.fitScreenCoordinates=function(o,u,m,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(u)),m,w),w,S)},s.prototype._fitInternal=function(o,u,m){return o?(delete(u=a.extend(o,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this},s.prototype.jumpTo=function(o,u){this.stop();var m=this.transform,w=!1,S=!1,E=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(w=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=a.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(S=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(E=!0,m.pitch=+o.pitch),o.padding==null||m.isPaddingEqual(o.padding)||(m.padding=o.padding),this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),w&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),S&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),E&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u))},s.prototype.easeTo=function(o,u){var m=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),E=this.getBearing(),C=this.getPitch(),R=this.getPadding(),Z="zoom"in o?+o.zoom:S,G="bearing"in o?this._normalizeBearing(o.bearing,E):E,W="pitch"in o?+o.pitch:C,ie="padding"in o?o.padding:w.padding,te=a.Point.convert(o.offset),se=w.centerPoint.add(te),Y=w.pointLocation(se),ae=a.LngLat.convert(o.center||Y);this._normalizeCenter(ae);var he,ye,Ae=w.project(Y),xe=w.project(ae).sub(Ae),ze=w.zoomScale(Z-S);o.around&&(he=a.LngLat.convert(o.around),ye=w.locationPoint(he));var Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==S,this._rotating=this._rotating||E!==G,this._pitching=this._pitching||W!==C,this._padding=!w.isPaddingEqual(ie),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Oe),this._ease(function(Je){if(m._zooming&&(w.zoom=a.number(S,Z,Je)),m._rotating&&(w.bearing=a.number(E,G,Je)),m._pitching&&(w.pitch=a.number(C,W,Je)),m._padding&&(w.interpolatePadding(R,ie,Je),se=w.centerPoint.add(te)),he)w.setLocationAtPoint(he,ye);else{var We=w.zoomScale(w.zoom-S),ut=Z>S?Math.min(2,ze):Math.max(.5,ze),St=Math.pow(ut,1-Je),Ct=w.unproject(Ae.add(xe.mult(Je*St)).mult(We));w.setLocationAtPoint(w.renderWorldCopies?Ct.wrap():Ct,se)}m._fireMoveEvents(u)},function(Je){m._afterEase(u,Je)},o),this},s.prototype._prepareEase=function(o,u,m){m===void 0&&(m={}),this._moving=!0,u||m.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var m=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,u){var m=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,u)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,E=this.getZoom(),C=this.getBearing(),R=this.getPitch(),Z=this.getPadding(),G="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):E,W="bearing"in o?this._normalizeBearing(o.bearing,C):C,ie="pitch"in o?+o.pitch:R,te="padding"in o?o.padding:S.padding,se=S.zoomScale(G-E),Y=a.Point.convert(o.offset),ae=S.centerPoint.add(Y),he=S.pointLocation(ae),ye=a.LngLat.convert(o.center||he);this._normalizeCenter(ye);var Ae=S.project(he),xe=S.project(ye).sub(Ae),ze=o.curve,Oe=Math.max(S.width,S.height),Je=Oe/se,We=xe.mag();if("minZoom"in o){var ut=a.clamp(Math.min(o.minZoom,E,G),S.minZoom,S.maxZoom),St=Oe/S.zoomScale(ut-E);ze=Math.sqrt(St/We*2)}var Ct=ze*ze;function It(Ot){var Lt=(Je*Je-Oe*Oe+(Ot?-1:1)*Ct*Ct*We*We)/(2*(Ot?Je:Oe)*Ct*We);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function vr(Ot){return(Math.exp(Ot)-Math.exp(-Ot))/2}function ht(Ot){return(Math.exp(Ot)+Math.exp(-Ot))/2}var Zt=It(0),nr=function(Ot){return ht(Zt)/ht(Zt+ze*Ot)},Ut=function(Ot){return Oe*((ht(Zt)*(vr(Lt=Zt+ze*Ot)/ht(Lt))-vr(Zt))/Ct)/We;var Lt},Nt=(It(1)-Zt)/ze;if(Math.abs(We)<1e-6||!isFinite(Nt)){if(Math.abs(Oe-Je)<1e-6)return this.easeTo(o,u);var tr=Je<Oe?-1:1;Nt=Math.abs(Math.log(Je/Oe))/ze,Ut=function(){return 0},nr=function(Ot){return Math.exp(tr*ze*Ot)}}return o.duration="duration"in o?+o.duration:1e3*Nt/("screenSpeed"in o?+o.screenSpeed/ze:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=C!==W,this._pitching=ie!==R,this._padding=!S.isPaddingEqual(te),this._prepareEase(u,!1),this._ease(function(Ot){var Lt=Ot*Nt,rn=1/nr(Lt);S.zoom=Ot===1?G:E+S.scaleZoom(rn),m._rotating&&(S.bearing=a.number(C,W,Ot)),m._pitching&&(S.pitch=a.number(R,ie,Ot)),m._padding&&(S.interpolatePadding(Z,te,Ot),ae=S.centerPoint.add(Y));var wi=Ot===1?ye:S.unproject(Ae.add(xe.mult(Ut(Lt))).mult(rn));S.setLocationAtPoint(S.renderWorldCopies?wi.wrap():wi,ae),m._fireMoveEvents(u)},function(){return m._afterEase(u)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,u)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,u,m){m.animate===!1||m.duration===0?(o(1),u()):(this._easeStart=a.browser.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,u){o=a.wrap(o,-180,180);var m=Math.abs(o-u);return Math.abs(o-360-u)<m&&(o-=360),Math.abs(o+360-u)<m&&(o+=360),o},s.prototype._normalizeCenter=function(o){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var m=o.lng-u.center.lng;o.lng+=m>180?-360:m<-180?360:0}},s}(a.Evented),Wn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Wn.prototype.getDefaultPosition=function(){return"bottom-right"},Wn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=I.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=I.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Wn.prototype.onRemove=function(){I.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Wn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},Wn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Wn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(u,m,w){return m.value&&(u+=m.key+"="+m.value+(w<s.length-1?"&":"")),u},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Wn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Wn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(E){return typeof E!="string"?"":E})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var u in o){var m=o[u];if(m.used){var w=m.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(E,C){return E.length-C.length});var S=(n=n.filter(function(E,C){for(var R=C+1;R<n.length;R++)if(n[R].indexOf(E)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Wn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var va=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};va.prototype.onAdd=function(n){this._map=n,this._container=I.create("div","mapboxgl-ctrl");var s=I.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},va.prototype.onRemove=function(){I.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},va.prototype.getDefaultPosition=function(){return"bottom-left"},va.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},va.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},va.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var In=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};In.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},In.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,u=s?this._queue.concat(s):this._queue;o<u.length;o+=1){var m=u[o];if(m.id===n)return void(m.cancelled=!0)}},In.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,u=s;o<u.length;o+=1){var m=u[o];if(!m.cancelled&&(m.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},In.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ra={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Zu=a.window.HTMLImageElement,iu=a.window.HTMLElement,Rr=a.window.ImageBitmap,fn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Vc=function(n){function s(u){var m=this;if((u=a.extend({},fn,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new ur(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,w,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new In,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ra,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new a.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=a.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof iu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return m._update(!1)}),this.on("moveend",function(){return m._update(!1)}),this.on("zoom",function(){return m._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new mt(this,u),this._hash=u.hash&&new Kn(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,a.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Wn({customAttribution:u.customAttribution})),this.addControl(new va,u.logoPosition),this.on("style.load",function(){m.transform.unmodified&&m.jumpTo(m.style.stylesheet)}),this.on("data",function(S){m._update(S.dataType==="style"),m.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){m.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(u,m){if(m===void 0&&(m=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=u.onAdd(this);this._controls.push(u);var S=this._controlPositions[m];return m.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var m=this._controls.indexOf(u);return m>-1&&this._controls.splice(m,1),u.onRemove(this),this},s.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},s.prototype.resize=function(u){var m=this._containerDimensions(),w=m[0],S=m[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var E=!this._moving;return E&&this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),this.fire(new a.Event("resize",u)),E&&this.fire(new a.Event("moveend",u)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(a.LngLatBounds.convert(u)),this._update()},s.prototype.setMinZoom=function(u){if((u=u==null?-2:u)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(u){if((u=u==null?22:u)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(u){if((u=u==null?0:u)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(u){if((u=u==null?60:u)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},s.prototype.project=function(u){return this.transform.locationPoint(a.LngLat.convert(u))},s.prototype.unproject=function(u){return this.transform.pointLocation(a.Point.convert(u))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(u,m,w){var S,E=this;if(u==="mouseenter"||u==="mouseover"){var C=!1;return{layer:m,listener:w,delegates:{mousemove:function(Z){var G=E.getLayer(m)?E.queryRenderedFeatures(Z.point,{layers:[m]}):[];G.length?C||(C=!0,w.call(E,new bi(u,E,Z.originalEvent,{features:G}))):C=!1},mouseout:function(){C=!1}}}}if(u==="mouseleave"||u==="mouseout"){var R=!1;return{layer:m,listener:w,delegates:{mousemove:function(Z){(E.getLayer(m)?E.queryRenderedFeatures(Z.point,{layers:[m]}):[]).length?R=!0:R&&(R=!1,w.call(E,new bi(u,E,Z.originalEvent)))},mouseout:function(Z){R&&(R=!1,w.call(E,new bi(u,E,Z.originalEvent)))}}}}return{layer:m,listener:w,delegates:(S={},S[u]=function(Z){var G=E.getLayer(m)?E.queryRenderedFeatures(Z.point,{layers:[m]}):[];G.length&&(Z.features=G,w.call(E,Z),delete Z.features)},S)}},s.prototype.on=function(u,m,w){if(w===void 0)return n.prototype.on.call(this,u,m);var S=this._createDelegatedListener(u,m,w);for(var E in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(S),S.delegates)this.on(E,S.delegates[E]);return this},s.prototype.once=function(u,m,w){if(w===void 0)return n.prototype.once.call(this,u,m);var S=this._createDelegatedListener(u,m,w);for(var E in S.delegates)this.once(E,S.delegates[E]);return this},s.prototype.off=function(u,m,w){var S=this;return w===void 0?n.prototype.off.call(this,u,m):(this._delegatedListeners&&this._delegatedListeners[u]&&function(E){for(var C=E[u],R=0;R<C.length;R++){var Z=C[R];if(Z.layer===m&&Z.listener===w){for(var G in Z.delegates)S.off(G,Z.delegates[G]);return C.splice(R,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(u,m){if(!this.style)return[];var w;if(m!==void 0||u===void 0||u instanceof a.Point||Array.isArray(u)||(m=u,u=void 0),m=m||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof u[0]=="number")w=[a.Point.convert(u)];else{var S=a.Point.convert(u[0]),E=a.Point.convert(u[1]);w=[S,new a.Point(E.x,S.y),E,new a.Point(S.x,E.y),S]}return this.style.queryRenderedFeatures(w,m,this.transform)},s.prototype.querySourceFeatures=function(u,m){return this.style.querySourceFeatures(u,m)},s.prototype.setStyle=function(u,m){return(m=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},m)).diff!==!1&&m.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,m),this):(this._localIdeographFontFamily=m.localIdeographFontFamily,this._updateStyle(u,m))},s.prototype._getUIString=function(u){var m=this._locale[u];if(m==null)throw new Error("Missing UI string '"+u+"'");return m},s.prototype._updateStyle=function(u,m){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new Sn(this,m||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Sn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(u,m){var w=this;if(typeof u=="string"){var S=this._requestManager.normalizeStyleURL(u),E=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(E,function(C,R){C?w.fire(new a.ErrorEvent(C)):R&&w._updateDiff(R,m)})}else typeof u=="object"&&this._updateDiff(u,m)},s.prototype._updateDiff=function(u,m){try{this.style.setState(u)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(u,m)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(u,m){return this._lazyInitEmptyStyle(),this.style.addSource(u,m),this._update(!0)},s.prototype.isSourceLoaded=function(u){var m=this.style&&this.style.sourceCaches[u];if(m!==void 0)return m.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},s.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var m in u){var w=u[m]._tiles;for(var S in w){var E=w[S];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(u,m,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,m,w)},s.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},s.prototype.getSource=function(u){return this.style.getSource(u)},s.prototype.addImage=function(u,m,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var E=w.sdf;E===void 0&&(E=!1);var C=w.stretchX,R=w.stretchY,Z=w.content;if(this._lazyInitEmptyStyle(),m instanceof Zu||Rr&&m instanceof Rr){var G=a.browser.getImageData(m);this.style.addImage(u,{data:new a.RGBAImage({width:G.width,height:G.height},G.data),pixelRatio:S,stretchX:C,stretchY:R,content:Z,sdf:E,version:0})}else{if(m.width===void 0||m.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var W=m;this.style.addImage(u,{data:new a.RGBAImage({width:m.width,height:m.height},new Uint8Array(m.data)),pixelRatio:S,stretchX:C,stretchY:R,content:Z,sdf:E,version:0,userImage:W}),W.onAdd&&W.onAdd(this,u)}},s.prototype.updateImage=function(u,m){var w=this.style.getImage(u);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=m instanceof Zu||Rr&&m instanceof Rr?a.browser.getImageData(m):m,E=S.width,C=S.height,R=S.data;return E===void 0||C===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):E!==w.data.width||C!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(R,!(m instanceof Zu||Rr&&m instanceof Rr)),void this.style.updateImage(u,w))},s.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(u){this.style.removeImage(u)},s.prototype.loadImage=function(u,m){a.getImage(this._requestManager.transformRequest(u,a.ResourceType.Image),m)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(u,m){return this._lazyInitEmptyStyle(),this.style.addLayer(u,m),this._update(!0)},s.prototype.moveLayer=function(u,m){return this.style.moveLayer(u,m),this._update(!0)},s.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},s.prototype.getLayer=function(u){return this.style.getLayer(u)},s.prototype.setLayerZoomRange=function(u,m,w){return this.style.setLayerZoomRange(u,m,w),this._update(!0)},s.prototype.setFilter=function(u,m,w){return w===void 0&&(w={}),this.style.setFilter(u,m,w),this._update(!0)},s.prototype.getFilter=function(u){return this.style.getFilter(u)},s.prototype.setPaintProperty=function(u,m,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(u,m,w,S),this._update(!0)},s.prototype.getPaintProperty=function(u,m){return this.style.getPaintProperty(u,m)},s.prototype.setLayoutProperty=function(u,m,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(u,m,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(u,m){return this.style.getLayoutProperty(u,m)},s.prototype.setLight=function(u,m){return m===void 0&&(m={}),this._lazyInitEmptyStyle(),this.style.setLight(u,m),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(u,m){return this.style.setFeatureState(u,m),this._update()},s.prototype.removeFeatureState=function(u,m){return this.style.removeFeatureState(u,m),this._update()},s.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var u=0,m=0;return this._container&&(u=this._container.clientWidth||400,m=this._container.clientHeight||300),[u,m]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=I.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var m=this._canvasContainer=I.create("div","mapboxgl-canvas-container",u);this._interactive&&m.classList.add("mapboxgl-interactive"),this._canvas=I.create("canvas","mapboxgl-canvas",m),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=I.create("div","mapboxgl-control-container",u),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(C){E[C]=I.create("div","mapboxgl-ctrl-"+C,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(u,m){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*u,this._canvas.height=w*m,this._canvas.style.width=u+"px",this._canvas.style.height=m+"px"},s.prototype._setupPainter=function(){var u=a.extend({},A.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),m=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);m?(this.painter=new Zr(m,this.transform),a.webpSupported.testSupport(m)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:u}))},s.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:u}))},s.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},s.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},s.prototype._render=function(u){var m,w=this,S=0,E=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(m=E.createQueryEXT(),E.beginQueryEXT(E.TIME_ELAPSED_EXT,m),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var R=this.transform.zoom,Z=a.browser.now();this.style.zoomHistory.update(R,Z);var G=new a.EvaluationParameters(R,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=G.crossFadingFactor();W===1&&W===this._crossFadingFactor||(C=!0,this._crossFadingFactor=W),this.style.update(G)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var ie=a.browser.now()-S;E.endQueryEXT(E.TIME_ELAPSED_EXT,m),setTimeout(function(){var Y=E.getQueryObjectEXT(m,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(m),w.fire(new a.Event("gpu-timing-frame",{cpuTime:ie,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var te=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(te);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var se=this._sourcesDirty||this._styleDirty||this._placementDirty;return se||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||se||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,m=this._controls;u<m.length;u+=1)m[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),Os(this._canvasContainer),Os(this._controlContainer),Os(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(m){u._frame=null,u._render(m)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(u){this._vertices=u,this._update()},s.prototype._setCacheLimits=function(u,m){a.setCacheLimits(u,m)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(ru);function Os(n){n.parentNode&&n.parentNode.removeChild(n)}var Gu={showCompass:!0,showZoom:!0,visualizePitch:!1},Xa=function(n){var s=this;this.options=a.extend({},Gu,n),this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),I.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),I.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=I.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Xa.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Xa.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Xa.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new To(this._map,this._compass,this.options.visualizePitch)),this._container},Xa.prototype.onRemove=function(){I.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Xa.prototype._createButton=function(n,s){var o=I.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Xa.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var To=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new cs({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new al({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),I.addEventListener(s,"mousedown",this.mousedown),I.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),I.addEventListener(s,"touchmove",this.touchmove),I.addEventListener(s,"touchend",this.touchend),I.addEventListener(s,"touchcancel",this.reset)};function sl(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var u=new a.LngLat(n.lng-360,n.lat),m=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(u).distSqr(s)<w?n=u:o.locationPoint(m).distSqr(s)<w&&(n=m)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}To.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),I.disableDrag()},To.prototype.move=function(n,s){var o=this.map,u=this.mouseRotate.mousemoveWindow(n,s);if(u&&u.bearingDelta&&o.setBearing(o.getBearing()+u.bearingDelta),this.mousePitch){var m=this.mousePitch.mousemoveWindow(n,s);m&&m.pitchDelta&&o.setPitch(o.getPitch()+m.pitchDelta)}},To.prototype.off=function(){var n=this.element;I.removeEventListener(n,"mousedown",this.mousedown),I.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),I.removeEventListener(n,"touchmove",this.touchmove),I.removeEventListener(n,"touchend",this.touchend),I.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},To.prototype.offTemp=function(){I.enableDrag(),I.removeEventListener(a.window,"mousemove",this.mousemove),I.removeEventListener(a.window,"mouseup",this.mouseup)},To.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),I.mousePos(this.element,n)),I.addEventListener(a.window,"mousemove",this.mousemove),I.addEventListener(a.window,"mouseup",this.mouseup)},To.prototype.mousemove=function(n){this.move(n,I.mousePos(this.element,n))},To.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},To.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=I.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},To.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=I.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},To.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},To.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ba={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function nu(n,s,o){var u=n.classList;for(var m in Ba)u.remove("mapboxgl-"+o+"-anchor-"+m);u.add("mapboxgl-"+o+"-anchor-"+s)}var ll,Ll=function(n){function s(o,u){if(n.call(this),(o instanceof a.window.HTMLElement||u)&&(o=a.extend({element:o},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=I.create("div"),this._element.setAttribute("aria-label","Map marker");var m=I.createNS("http://www.w3.org/2000/svg","svg");m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height","41px"),m.setAttributeNS(null,"width","27px"),m.setAttributeNS(null,"viewBox","0 0 27 41");var w=I.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=I.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var E=I.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");for(var C=0,R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];C<R.length;C+=1){var Z=R[C],G=I.createNS("http://www.w3.org/2000/svg","ellipse");G.setAttributeNS(null,"opacity","0.04"),G.setAttributeNS(null,"cx","10.5"),G.setAttributeNS(null,"cy","5.80029008"),G.setAttributeNS(null,"rx",Z.rx),G.setAttributeNS(null,"ry",Z.ry),E.appendChild(G)}var W=I.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"fill",this._color);var ie=I.createNS("http://www.w3.org/2000/svg","path");ie.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),W.appendChild(ie);var te=I.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");var se=I.createNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(se);var Y=I.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var ae=I.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");var he=I.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");var ye=I.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#FFFFFF"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962"),ae.appendChild(he),ae.appendChild(ye),S.appendChild(E),S.appendChild(W),S.appendChild(te),S.appendChild(Y),S.appendChild(ae),m.appendChild(S),m.setAttributeNS(null,"height",41*this._scale+"px"),m.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(m),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ae){Ae.preventDefault()}),this._element.addEventListener("mousedown",function(Ae){Ae.preventDefault()}),nu(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),I.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var u=o.code,m=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var u=o.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=sl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),I.setTransform(this._element,Ba[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+m+" "+u)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),Ku={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ul=0,Ns=!1,Xu=function(n){function s(o){n.call(this),this.options=a.extend({},Ku,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var u;return this._map=o,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,ll!==void 0?u(ll):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(m){u(ll=m.state!=="denied")}):u(ll=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),I.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ul=0,Ns=!1},s.prototype._isOutOfMapMaxBounds=function(o){var u=this._map.getMaxBounds(),m=o.coords;return u&&(m.longitude<u.getWest()||m.longitude>u.getEast()||m.latitude<u.getSouth()||m.latitude>u.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude),m=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(m),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,u=this._map.unproject([0,o]),m=this._map.unproject([1,o]),w=u.distanceTo(m),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Ns)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var u=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=I.create("button","mapboxgl-ctrl-geolocate",this._container),I.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ll(this._dotElement),this._circleElement=I.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ll({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||u._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ul--,Ns=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ul>1?(o={maximumAge:6e5,timeout:0},Ns=!0):(o=this.options.positionOptions,Ns=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),fs={maxWidth:100,unit:"metric"},ds=function(n){this.options=a.extend({},fs,n),a.bindAll(["_onMove","setUnit"],this)};function ou(n,s,o){var u=o&&o.maxWidth||100,m=n._container.clientHeight/2,w=n.unproject([0,m]),S=n.unproject([u,m]),E=w.distanceTo(S);if(o&&o.unit==="imperial"){var C=3.2808*E;C>5280?ms(s,u,C/5280,n._getUIString("ScaleControl.Miles")):ms(s,u,C,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?ms(s,u,E/1852,n._getUIString("ScaleControl.NauticalMiles")):E>=1e3?ms(s,u,E/1e3,n._getUIString("ScaleControl.Kilometers")):ms(s,u,E,n._getUIString("ScaleControl.Meters"))}function ms(n,s,o,u){var m,w,S,E=(m=o,(w=Math.pow(10,(""+Math.floor(m)).length-1))*(S=(S=m/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(C){var R=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*R)/R}(S)));n.style.width=s*(E/o)+"px",n.innerHTML=E+"&nbsp;"+u}ds.prototype.getDefaultPosition=function(){return"bottom-left"},ds.prototype._onMove=function(){ou(this._map,this._container,this.options)},ds.prototype.onAdd=function(n){return this._map=n,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ds.prototype.onRemove=function(){I.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ds.prototype.setUnit=function(n){this.options.unit=n,ou(this._map,this._container,this.options)};var Qo=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};Qo.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Qo.prototype.onRemove=function(){I.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Qo.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},Qo.prototype._setupUI=function(){var n=this._fullscreenButton=I.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);I.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Qo.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},Qo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Qo.prototype._isFullscreen=function(){return this._fullscreen},Qo.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Qo.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Wu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Rl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Hu=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(Wu),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&I.remove(this._content),this._container&&(I.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var u,m=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;u=w.firstChild;)m.appendChild(u);return this.setDOMContent(m)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=I.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=I.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=I.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=I.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(G){return u._container.classList.add(G)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=sl(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var m=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function G(W){if(W){if(typeof W=="number"){var ie=Math.round(Math.sqrt(.5*Math.pow(W,2)));return{center:new a.Point(0,0),top:new a.Point(0,W),"top-left":new a.Point(ie,ie),"top-right":new a.Point(-ie,ie),bottom:new a.Point(0,-W),"bottom-left":new a.Point(ie,-ie),"bottom-right":new a.Point(-ie,-ie),left:new a.Point(W,0),right:new a.Point(-W,0)}}if(W instanceof a.Point||Array.isArray(W)){var te=a.Point.convert(W);return{center:te,top:te,"top-left":te,"top-right":te,bottom:te,"bottom-left":te,"bottom-right":te,left:te,right:te}}return{center:a.Point.convert(W.center||[0,0]),top:a.Point.convert(W.top||[0,0]),"top-left":a.Point.convert(W["top-left"]||[0,0]),"top-right":a.Point.convert(W["top-right"]||[0,0]),bottom:a.Point.convert(W.bottom||[0,0]),"bottom-left":a.Point.convert(W["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(W["bottom-right"]||[0,0]),left:a.Point.convert(W.left||[0,0]),right:a.Point.convert(W.right||[0,0])}}return G(new a.Point(0,0))}(this.options.offset);if(!w){var E,C=this._container.offsetWidth,R=this._container.offsetHeight;E=m.y+S.bottom.y<R?["top"]:m.y>this._map.transform.height-R?["bottom"]:[],m.x<C/2?E.push("left"):m.x>this._map.transform.width-C/2&&E.push("right"),w=E.length===0?"bottom":E.join("-")}var Z=m.add(S[w]).round();I.setTransform(this._container,Ba[w]+" translate("+Z.x+"px,"+Z.y+"px)"),nu(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Rl);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),au={version:a.version,supported:A,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:Vc,NavigationControl:Xa,GeolocateControl:Xu,AttributionControl:Wn,ScaleControl:ds,FullscreenControl:Qo,Popup:Hu,Marker:Ll,Style:Sn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){we().acquire(be)},clearPrewarmedResources:function(){var n=nt;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(be),nt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return Be.workerCount},set workerCount(n){Be.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return au}),v})})(Tc);const N0=Tc.exports;function dm(c){let h;const f=c[15].default,y=Fu(f,c,c[14],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,x){y&&y.m(v,x),h=!0},p(v,x){y&&y.p&&(!h||x&16384)&&Ou(y,f,v,v[14],h?Vu(f,v[14],x,null):Nu(v[14]),null)},i(v){h||(Mt(y,v),h=!0)},o(v){Wt(y,v),h=!1},d(v){y&&y.d(v)}}}function V0(c){let h,f,y,v=c[0]&&dm(c);return{c(){h=Pe("div"),v&&v.c(),this.h()},l(x){h=Me(x,"DIV",{class:!0,id:!0});var a=Ce(h);v&&v.l(a),a.forEach(H),this.h()},h(){$(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),$(h,"id",c[1]),Np(()=>c[16].call(h))},m(x,a){ke(x,h,a),v&&v.m(h,null),f=Vp(h,c[16].bind(h)),c[17](h),y=!0},p(x,[a]){x[0]?v?(v.p(x,a),a&1&&Mt(v,1)):(v=dm(x),v.c(),Mt(v,1),v.m(h,null)):v&&($a(),Wt(v,1,1,()=>{v=null}),es()),(!y||a&2)&&$(h,"id",x[1])},i(x){y||(Mt(v),y=!0)},o(x){Wt(v),y=!1},d(x){x&&H(h),v&&v.d(),f(),c[17](null)}}}function U0(c,h,f){let{$$slots:y={},$$scope:v}=h,{map:x}=h,{id:a="map"}=h,{location:A={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:I="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:B=!0}=h,{minzoom:L=0}=h,{maxzoom:j=14}=h,{zoom:N=null}=h,{scrollzoom:X=!0}=h,{geolocate:pe=!0}=h,{zoomcontrol:De=!0}=h,{options:Ie={}}=h,rt,Ge;Nm("map",{getMap:()=>x}),A.bounds?Ie={...Ie,bounds:A.bounds}:A.lon&&A.lat&&(Ie={...Ie,center:[A.lon,A.lat]},A.zoom&&(Ie.zoom=A.zoom)),Om(()=>{const He=document.createElement("link");return He.rel="stylesheet",He.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",He.onload=()=>{f(0,x=new Tc.exports.Map({container:rt,style:I,minZoom:L,maxZoom:j,interactive:B,...Ie})),De&&x.addControl(new Tc.exports.NavigationControl({showCompass:!1})),X||x.scrollZoom.disable(),pe&&x.addControl(new Tc.exports.GeolocateControl),x.on("load",()=>{f(4,N=x.getZoom())}),x.on("zoom",()=>{f(4,N=x.getZoom())})},document.head.appendChild(He),()=>{x.remove(),He.parentNode.removeChild(He)}});function Pt(){let He=document.getElementsByClassName("mapboxgl-canvas");He[0]&&(He[0].style.width="100%",x.resize())}function Tt(){Ge=this.clientWidth,f(2,Ge)}function ct(He){Ws[He?"unshift":"push"](()=>{rt=He,f(3,rt)})}return c.$$set=He=>{"map"in He&&f(0,x=He.map),"id"in He&&f(1,a=He.id),"location"in He&&f(6,A=He.location),"style"in He&&f(7,I=He.style),"interactive"in He&&f(8,B=He.interactive),"minzoom"in He&&f(9,L=He.minzoom),"maxzoom"in He&&f(10,j=He.maxzoom),"zoom"in He&&f(4,N=He.zoom),"scrollzoom"in He&&f(11,X=He.scrollzoom),"geolocate"in He&&f(12,pe=He.geolocate),"zoomcontrol"in He&&f(13,De=He.zoomcontrol),"options"in He&&f(5,Ie=He.options),"$$scope"in He&&f(14,v=He.$$scope)},c.$$.update=()=>{c.$$.dirty&4&&Ge&&Pt()},[x,a,Ge,rt,N,Ie,A,I,B,L,j,X,pe,De,v,y,Tt,ct]}class j0 extends sa{constructor(h){super(),la(this,h,U0,V0,ua,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function mm(c){let h;const f=c[11].default,y=Fu(f,c,c[10],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,x){y&&y.m(v,x),h=!0},p(v,x){y&&y.p&&(!h||x&1024)&&Ou(y,f,v,v[10],h?Vu(f,v[10],x,null):Nu(v[10]),null)},i(v){h||(Mt(y,v),h=!0)},o(v){Wt(y,v),h=!1},d(v){y&&y.d(v)}}}function q0(c){let h,f,y=c[0]&&mm(c);return{c(){y&&y.c(),h=Or()},l(v){y&&y.l(v),h=Or()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,[x]){v[0]?y?(y.p(v,x),x&1&&Mt(y,1)):(y=mm(v),y.c(),Mt(y,1),y.m(h.parentNode,h)):y&&($a(),Wt(y,1,1,()=>{y=null}),es())},i(v){f||(Mt(y),f=!0)},o(v){Wt(y),f=!1},d(v){y&&y.d(v),v&&H(h)}}}function Z0(c,h,f){let{$$slots:y={},$$scope:v}=h,{id:x}=h,{type:a}=h,{url:A=null}=h,{props:I={}}=h,{data:B=null}=h,{layer:L=null}=h,{promoteId:j=null}=h,{minzoom:N=null}=h,{maxzoom:X=null}=h,pe=!1;const{getMap:De}=Cc("map"),Ie=De();Ie.getSource(x)&&Ie.removeSource(x);function rt(){Ie.isSourceLoaded(x)?(f(0,pe=!0),console.log(x+" loaded!")):setTimeout(()=>{console.log("..."),rt()},500)}function Ge(){Ie.isStyleLoaded(x)?(Pt(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),Ge()},500)}N&&(I.minzoom=N),X&&(I.maxzoom=X),L&&j?(I.promoteId={},I.promoteId[L]=j):j&&(I.promoteId=j);function Pt(){console.log(x+" map source loading..."),a=="geojson"?B?(Ie.addSource(x,{type:a,data:B,...I}),rt()):A&&(Ie.addSource(x,{type:a,data:A,...I}),rt()):a=="vector"&&(Ie.addSource(x,{type:a,tiles:[A],...I}),rt())}Ge();function Tt(){Ie.getSource(x).setData(B)}return c.$$set=ct=>{"id"in ct&&f(2,x=ct.id),"type"in ct&&f(3,a=ct.type),"url"in ct&&f(4,A=ct.url),"props"in ct&&f(1,I=ct.props),"data"in ct&&f(5,B=ct.data),"layer"in ct&&f(6,L=ct.layer),"promoteId"in ct&&f(7,j=ct.promoteId),"minzoom"in ct&&f(8,N=ct.minzoom),"maxzoom"in ct&&f(9,X=ct.maxzoom),"$$scope"in ct&&f(10,v=ct.$$scope)},c.$$.update=()=>{c.$$.dirty&33&&pe&&B&&Tt()},[pe,I,x,a,A,B,L,j,N,X,v,y]}class cy extends sa{constructor(h){super(),la(this,h,Z0,q0,ua,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function G0(c,h,f){const{Popup:y}=N0,v=Vm(),x=new y({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:A}=h,{sourceLayer:I=null}=h,{type:B}=h,{filter:L=null}=h,{layout:j={}}=h,{paint:N={}}=h,{data:X=null}=h,{code:pe=null}=h,{name:De="name"}=h,{colorCode:Ie=null}=h,{click:rt=!1}=h,{ignoreClick:Ge=!1}=h,{clickCenter:Pt=!1}=h,{selected:Tt=null}=h,{hover:ct=!1}=h,{hovered:He=null}=h,{highlight:Vt=!1}=h,{highlightKey:Ht="highlighted"}=h,{highlighted:Rt=[]}=h,{order:gt=null}=h,{maxzoom:Fe=null}=h,{minzoom:At=null}=h,{isChild:ot=!1}=h;const{getMap:xt}=Cc("map"),Ve=xt();let Ue=null,_t=null,fr=[];Ve.getLayer(a)&&Ve.removeLayer(a);let zt={id:a,type:B,source:A,paint:N,layout:j};L&&(zt.filter=L),I&&(zt["source-layer"]=I),Fe&&(zt.maxzoom=Fe),At&&(zt.minzoom=At),Ve.addLayer(zt,gt);function je(){console.log("updating colors..."),X.forEach(Ke=>{Ve.setFeatureState({source:A,sourceLayer:I,id:Ke[pe]},{color:Ke[Ie]})})}return rt&&Ve.on("click",a,Ke=>{if(Ke.features.length>0&&!Ge){let hr=Ke.features[0].id;if(ot&&Rt.includes(hr)||!ot&&Tt!=hr){if(f(0,Tt=hr),v("select",{code:Tt}),Ue&&Ve.setFeatureState({source:A,sourceLayer:I,id:Ue},{selected:!1}),Ve.setFeatureState({source:A,sourceLayer:I,id:Tt},{selected:!0}),Pt){let Vr=centroid(Ke.features[0].toJSON().geometry);Ve.flyTo({center:Vr.geometry.coordinates})}f(24,Ue=Tt)}}}),ct&&(Ve.on("mousemove",a,Ke=>{if(Ke.features.length>0){let hr=Ke.features[0].id;He&&Ve.setFeatureState({source:A,sourceLayer:I,id:He},{hovered:!1}),ot&&Rt.includes(hr)||!ot&&Tt!=hr?(f(1,He=f(25,_t=hr)),Ve.setFeatureState({source:A,sourceLayer:I,id:He},{hovered:!0}),Ve.getCanvas().style.cursor="pointer",x.setLngLat(Ke.lngLat).setHTML(`<strong>${Ke.features[0].properties[De]?Ke.features[0].properties[De]:Ke.features[0].properties[pe]}</strong>`).addTo(Ve)):x.remove()}}),Ve.on("mouseleave",a,Ke=>{He&&Ve.setFeatureState({source:A,sourceLayer:I,id:He},{hovered:!1}),f(1,He=f(25,_t=null)),Ve.getCanvas().style.cursor="",x.remove()})),c.$$set=Ke=>{"id"in Ke&&f(2,a=Ke.id),"source"in Ke&&f(3,A=Ke.source),"sourceLayer"in Ke&&f(4,I=Ke.sourceLayer),"type"in Ke&&f(5,B=Ke.type),"filter"in Ke&&f(6,L=Ke.filter),"layout"in Ke&&f(7,j=Ke.layout),"paint"in Ke&&f(8,N=Ke.paint),"data"in Ke&&f(9,X=Ke.data),"code"in Ke&&f(10,pe=Ke.code),"name"in Ke&&f(11,De=Ke.name),"colorCode"in Ke&&f(12,Ie=Ke.colorCode),"click"in Ke&&f(13,rt=Ke.click),"ignoreClick"in Ke&&f(14,Ge=Ke.ignoreClick),"clickCenter"in Ke&&f(15,Pt=Ke.clickCenter),"selected"in Ke&&f(0,Tt=Ke.selected),"hover"in Ke&&f(16,ct=Ke.hover),"hovered"in Ke&&f(1,He=Ke.hovered),"highlight"in Ke&&f(17,Vt=Ke.highlight),"highlightKey"in Ke&&f(18,Ht=Ke.highlightKey),"highlighted"in Ke&&f(19,Rt=Ke.highlighted),"order"in Ke&&f(20,gt=Ke.order),"maxzoom"in Ke&&f(21,Fe=Ke.maxzoom),"minzoom"in Ke&&f(22,At=Ke.minzoom),"isChild"in Ke&&f(23,ot=Ke.isChild)},c.$$.update=()=>{c.$$.dirty[0]&4096&&Ie&&je(),c.$$.dirty[0]&68026392&&Vt&&Rt!=fr&&(fr[0]&&fr.forEach(Ke=>{let hr={};hr[Ht]=!1,Ve.setFeatureState({source:A,sourceLayer:I,id:Ke},hr)}),f(26,fr=Rt),Rt[0]&&Rt.forEach(Ke=>{let hr={};hr[Ht]=!0,Ve.setFeatureState({source:A,sourceLayer:I,id:Ke},hr)})),c.$$.dirty[0]&16777241&&Tt!=Ue&&(Ue&&Ve.setFeatureState({source:A,sourceLayer:I,id:Ue},{selected:!1}),Tt&&Ve.setFeatureState({source:A,sourceLayer:I,id:Tt},{selected:!0}),f(24,Ue=Tt)),c.$$.dirty[0]&33619994&&ct&&He!=_t&&(_t&&Ve.setFeatureState({source:A,sourceLayer:I,id:_t},{hovered:!1}),He&&Ve.setFeatureState({source:A,sourceLayer:I,id:He},{hovered:!0}),f(25,_t=He))},[Tt,He,a,A,I,B,L,j,N,X,pe,De,Ie,rt,Ge,Pt,ct,Vt,Ht,Rt,gt,Fe,At,ot,Ue,_t,fr]}class Bu extends sa{constructor(h){super(),la(this,h,G0,null,ua,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function ym(c,h,f){const y=c.slice();return y[23]=h[f],y[25]=f,y}function _m(c,h,f){const y=c.slice();return y[26]=h[f],y[25]=f,y}function gm(c,h,f){const y=c.slice();return y[28]=h[f],y}function vm(c,h,f){const y=c.slice();return y[28]=h[f],y}function xm(c,h,f){const y=c.slice();return y[26]=h[f],y[25]=f,y}function bm(c){let h,f,y,v,x,a,A=" &gt; ",I,B,L,j,N,X=c[1].name+"",pe,De,Ie,rt,Ge,Pt,Tt,ct,He,Vt,Ht,Rt,gt,Fe,At,ot,xt,Ve,Ue,_t,fr,zt,je,Ke,hr,Vr,Ji,Yi,_i,Gr,Ni,lr,Sr,dt,Jt,Gt,Vi,Kr,Hr,Jr,Xr,Ui,Ei,Ri,sn=c[1].data.population.value[2011].all.toLocaleString()+"",gi,Ti,gn,Er,Yr,zo,pi,Ii,ji,Co,vn,ho,Un,xn,An,Po,Mo,Qi,$i=c[1].data.households.value[2011].all_households.toLocaleString()+"",ln,to,jn,ar,M,F,V,K,J,le,ce,U,re,me,Re,Ne,be,Be,nt,it,we,$e,qe,Xe,jt,et,Kt,dr,Ft,$t,er,ai,rr,Cr,Xt,qt,ir,fi,ro,Pr,Ur,Zo,po,Mr,zn,di,jr,Ai,yr,Cn,qi,Go,Qr,fo,ei,ti=c[1].name+"",bn,zi,io,Pn,mo,en,Do,ba,wa,Sa,rs,qn,Ko,ca,is,Mn,wn,Zi,fe,ri,Ci,Tr,yo,Sn,qr,Lo,Hs,wl,ka,As,_o,Zn,Ro,Js,Va,Sl,Ua,Bo,ja,Bi,zs,Dn,un,ha,Ea;function pa(ge,bt){return ge[1].parents[0]?X0:K0}let Xo=pa(c),cn=Xo(c);function fa(ge,bt){return ge[1].parents[0]?W0:H0}let Cs=fa(c),go=Cs(c);Fe=new O0({props:{options:c[0],group:"typestr",search:!0}}),Fe.$on("select",c[13]);function Dr(ge,bt){return ge[1].type=="ew"||ge[1].type=="ctry"?Y0:J0}let Ys=Dr(c),Gn=Ys(c),hn=c[9]&&Sm(c);const kl=[a1,o1],da=[];function El(ge,bt){return ge[4]?ge[9]?1:-1:0}~(Er=El(c))&&(Yr=da[Er]=kl[Er](c));const Ta=[d1,f1],Ln=[];function Ia(ge,bt){return ge[4]?ge[9]?1:-1:0}~(ar=Ia(c))&&(M=Ln[ar]=Ta[ar](c)),nt=new Vv({props:{data:c[1]&&c[11](["broad_age_bands_years","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null}});let pn=c[10]&&!(c[4]&&!c[9])&&Im(c);function Tl(ge,bt){if(ge[4])return g1;if(ge[9])return _1}let Aa=Tl(c),vi=Aa&&Aa(c);Kt=new wc({props:{data:c[1]&&c[11](["population","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),rr=new wc({props:{data:c[1]&&c[11](["country_of_birth","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}});function Ql(ge){c[17](ge)}let za={location:{bounds:c[1].bounds},options:{fitBoundsOptions:{padding:20}},style:X_,$$slots:{default:[b1]},$$scope:{ctx:c}};c[6]!==void 0&&(za.map=c[6]),Ur=new j0({props:za}),Ws.push(()=>Z_(Ur,"map",Ql));let xi=c[1].parents[0]&&Lm(c);function Il(ge,bt){return ge[2].children[0]?S1:w1}let Ca=Il(c),mr=Ca(c);return Mn=new wc({props:{data:c[1]&&c[11](["religion","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),ka=new wc({props:{data:c[1]&&c[11](["religion_or_religion_brought_up_in","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),Dn=new wc({props:{data:c[1]&&c[11](["ethnic_group","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),{c(){h=Pe("div"),f=Pe("div"),y=Pe("span"),v=Pe("a"),x=Ee("Home"),a=new Um(!1),I=pt(),cn.c(),B=pt(),L=Pe("br"),j=pt(),N=Pe("span"),pe=Ee(X),De=pt(),Ie=Pe("div"),rt=Ee(`Compare to:
			`),go.c(),Ge=pt(),Pt=Pe("button"),Tt=Ee("2001 Census"),ct=pt(),He=Pe("div"),Vt=Pe("div"),Ht=Pe("b"),Rt=Ee("Search"),gt=Ee(` for your Local Government District:
			`),li(Fe.$$.fragment),At=pt(),ot=Pe("script"),xt=Ee(`// Share button
			// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button
			
			
 				function copyToClipboard(text) {
					var inputc = document.body.appendChild(document.createElement("input"));
					inputc.value = window.location.href;
					inputc.select();
					document.execCommand('copy');
					inputc.parentNode.removeChild(inputc);
					alert("URL Copied.");
					
				}



			
			
				(function (win, doc) {
					const testButton = doc.createElement('button');
					testButton.setAttribute('type','share');
					if (testButton.type != 'share') {
					win.addEventListener('click', function(ev) {
						ev = ev || win.event;
						let target = ev.target;
						let button = target.closest('button[type="share"]');
						if (button) {
						const title = "Share URL";
						const url = win.location.href;
						if (navigator.share) {
							navigator.share({ title: title, url: url });
						} else {
							copyToClipboard();
						}
						}
					});
				}
			}(this, this.document));`),Ve=pt(),Ue=Pe("div"),_t=Pe("button"),fr=Ee("Print"),zt=pt(),je=Pe("button"),Ke=Ee("Menu"),hr=pt(),Vr=Pe("button"),Ji=Ee("Share"),Yi=pt(),_i=Pe("div"),Gr=Pe("h2"),Ni=Ee("Census 2011"),lr=pt(),Sr=Pe("div"),dt=Pe("div"),Jt=Pe("h3"),Gt=Ee("Overview"),Vi=pt(),Gn.c(),Kr=pt(),hn&&hn.c(),Hr=pt(),Jr=Pe("div"),Xr=Pe("h3"),Ui=Ee("Population"),Ei=pt(),Ri=Pe("span"),gi=Ee(sn),Ti=Pe("br"),gn=pt(),Yr&&Yr.c(),zo=pt(),pi=Pe("div"),Ii=Pe("div"),ji=Pe("div"),Co=Ee("Households "),vn=Pe("span"),ho=Ee("[?]"),Un=pt(),xn=Pe("div"),An=Pe("div"),Po=Ee("A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area."),Mo=pt(),Qi=Pe("span"),ln=Ee($i),to=Pe("br"),jn=pt(),M&&M.c(),F=pt(),V=Pe("div"),K=Pe("div"),J=Pe("div"),le=Ee("Broad age bands (years) "),ce=Pe("span"),U=Ee("[?]"),re=pt(),me=Pe("div"),Re=Pe("div"),Ne=Ee("A grouping of ages were a person\u2019s age is their age at their last birthday on or prior to census"),be=pt(),Be=Pe("div"),li(nt.$$.fragment),it=pt(),pn&&pn.c(),we=pt(),vi&&vi.c(),$e=pt(),qe=Pe("div"),Xe=Pe("div"),jt=Ee("Sex"),et=pt(),li(Kt.$$.fragment),dr=pt(),Ft=Pe("div"),$t=Pe("h3"),er=Ee("Country of birth"),ai=pt(),li(rr.$$.fragment),Cr=pt(),Xt=Pe("div"),qt=Pe("div"),ir=Pe("h3"),fi=Ee("Explore related areas"),ro=pt(),Pr=Pe("div"),li(Ur.$$.fragment),po=pt(),Mr=Pe("div"),zn=Pe("span"),xi&&xi.c(),di=pt(),jr=Pe("div"),Ai=Pe("span"),yr=Pe("ul"),mr.c(),qi=pt(),Go=Pe("div"),Qr=Pe("h2"),fo=Ee("Religion and Ethnicity Statistics "),ei=Pe("span"),bn=Ee(ti),zi=Ee(" - Census 2011"),io=pt(),Pn=Pe("div"),mo=Pe("div"),en=Pe("div"),Do=Pe("div"),ba=Ee("Religion "),wa=Pe("span"),Sa=Ee("[?]"),rs=pt(),qn=Pe("div"),Ko=Pe("div"),ca=Ee("Religion, religious denomination or body the respondent indicated they belong to"),is=pt(),li(Mn.$$.fragment),wn=pt(),Zi=Pe("div"),fe=Pe("div"),ri=Pe("div"),Ci=Ee("Religion/religion brought up in "),Tr=Pe("span"),yo=Ee("[?]"),Sn=pt(),qr=Pe("div"),Lo=Pe("div"),Hs=Ee("Religion, religious denomination or body the respondent indicated they belong to, or for people who do not regard themselves as belonging to any religion, the religious group brought up in"),wl=pt(),li(ka.$$.fragment),As=pt(),_o=Pe("div"),Zn=Pe("div"),Ro=Pe("div"),Js=Ee("Ethnic Group "),Va=Pe("span"),Sl=Ee("[?]"),Ua=pt(),Bo=Pe("div"),ja=Pe("div"),Bi=Ee("Respondents own perceived ethnic group and cultural background"),zs=pt(),li(Dn.$$.fragment),this.h()},l(ge){h=Me(ge,"DIV",{class:!0});var bt=Ce(h);f=Me(bt,"DIV",{});var Rn=Ce(f);y=Me(Rn,"SPAN",{class:!0});var Fo=Ce(y);v=Me(Fo,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var ns=Ce(v);x=Te(ns,"Home"),ns.forEach(H),a=jm(Fo,!1),I=ft(Fo),cn.l(Fo),B=ft(Fo),Fo.forEach(H),L=Me(Rn,"BR",{}),j=ft(Rn),N=Me(Rn,"SPAN",{class:!0});var qa=Ce(N);pe=Te(qa,X),qa.forEach(H),De=ft(Rn),Ie=Me(Rn,"DIV",{class:!0,style:!0});var no=Ce(Ie);rt=Te(no,`Compare to:
			`),go.l(no),Ge=ft(no),Pt=Me(no,"BUTTON",{class:!0});var vo=Ce(Pt);Tt=Te(vo,"2001 Census"),vo.forEach(H),no.forEach(H),Rn.forEach(H),ct=ft(bt),He=Me(bt,"DIV",{});var Oo=Ce(He);Vt=Me(Oo,"DIV",{style:!0,class:!0});var kn=Ce(Vt);Ht=Me(kn,"B",{});var No=Ce(Ht);Rt=Te(No,"Search"),No.forEach(H),gt=Te(kn,` for your Local Government District:
			`),ui(Fe.$$.fragment,kn),At=ft(kn),ot=Me(kn,"SCRIPT",{});var xo=Ce(ot);xt=Te(xo,`// Share button
			// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button
			
			
 				function copyToClipboard(text) {
					var inputc = document.body.appendChild(document.createElement("input"));
					inputc.value = window.location.href;
					inputc.select();
					document.execCommand('copy');
					inputc.parentNode.removeChild(inputc);
					alert("URL Copied.");
					
				}



			
			
				(function (win, doc) {
					const testButton = doc.createElement('button');
					testButton.setAttribute('type','share');
					if (testButton.type != 'share') {
					win.addEventListener('click', function(ev) {
						ev = ev || win.event;
						let target = ev.target;
						let button = target.closest('button[type="share"]');
						if (button) {
						const title = "Share URL";
						const url = win.location.href;
						if (navigator.share) {
							navigator.share({ title: title, url: url });
						} else {
							copyToClipboard();
						}
						}
					});
				}
			}(this, this.document));`),xo.forEach(H),Ve=ft(kn),Ue=Me(kn,"DIV",{width:!0});var Za=Ce(Ue);_t=Me(Za,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var Ga=Ce(_t);fr=Te(Ga,"Print"),Ga.forEach(H),zt=ft(Za),je=Me(Za,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var bo=Ce(je);Ke=Te(bo,"Menu"),bo.forEach(H),hr=ft(Za),Vr=Me(Za,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var Al=Ce(Vr);Ji=Te(Al,"Share"),Al.forEach(H),Za.forEach(H),kn.forEach(H),Oo.forEach(H),bt.forEach(H),Yi=ft(ge),_i=Me(ge,"DIV",{});var zl=Ce(_i);Gr=Me(zl,"H2",{});var Cl=Ce(Gr);Ni=Te(Cl,"Census 2011"),Cl.forEach(H),zl.forEach(H),lr=ft(ge),Sr=Me(ge,"DIV",{id:!0,class:!0});var tn=Ce(Sr);dt=Me(tn,"DIV",{class:!0,style:!0});var Wo=Ce(dt);Jt=Me(Wo,"H3",{style:!0,class:!0});var Ps=Ce(Jt);Gt=Te(Ps,"Overview"),Ps.forEach(H),Vi=ft(Wo),Gn.l(Wo),Kr=ft(Wo),hn&&hn.l(Wo),Wo.forEach(H),Hr=ft(tn),Jr=Me(tn,"DIV",{class:!0});var ma=Ce(Jr);Xr=Me(ma,"H3",{style:!0,class:!0});var Ms=Ce(Xr);Ui=Te(Ms,"Population"),Ms.forEach(H),Ei=ft(ma),Ri=Me(ma,"SPAN",{class:!0,style:!0});var $l=Ce(Ri);gi=Te($l,sn),$l.forEach(H),Ti=Me(ma,"BR",{}),gn=ft(ma),Yr&&Yr.l(ma),ma.forEach(H),zo=ft(tn),pi=Me(tn,"DIV",{class:!0});var wo=Ce(pi);Ii=Me(wo,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Qs=Ce(Ii);ji=Me(Qs,"DIV",{class:!0,style:!0});var $s=Ce(ji);Co=Te($s,"Households "),vn=Me($s,"SPAN",{style:!0});var Pl=Ce(vn);ho=Te(Pl,"[?]"),Pl.forEach(H),$s.forEach(H),Qs.forEach(H),Un=ft(wo),xn=Me(wo,"DIV",{class:!0,id:!0});var Ds=Ce(xn);An=Me(Ds,"DIV",{class:!0});var el=Ce(An);Po=Te(el,"A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area."),el.forEach(H),Ds.forEach(H),Mo=ft(wo),Qi=Me(wo,"SPAN",{class:!0,style:!0});var tl=Ce(Qi);ln=Te(tl,$i),tl.forEach(H),to=Me(wo,"BR",{}),jn=ft(wo),M&&M.l(wo),wo.forEach(H),F=ft(tn),V=Me(tn,"DIV",{class:!0});var So=Ce(V);K=Me(So,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var os=Ce(K);J=Me(os,"DIV",{class:!0,style:!0});var rl=Ce(J);le=Te(rl,"Broad age bands (years) "),ce=Me(rl,"SPAN",{style:!0});var Pa=Ce(ce);U=Te(Pa,"[?]"),Pa.forEach(H),rl.forEach(H),os.forEach(H),re=ft(So),me=Me(So,"DIV",{class:!0,id:!0});var Zr=Ce(me);Re=Me(Zr,"DIV",{class:!0});var Ls=Ce(Re);Ne=Te(Ls,"A grouping of ages were a person\u2019s age is their age at their last birthday on or prior to census"),Ls.forEach(H),Zr.forEach(H),be=ft(So),Be=Me(So,"DIV",{class:!0,style:!0});var Ma=Ce(Be);ui(nt.$$.fragment,Ma),Ma.forEach(H),it=ft(So),pn&&pn.l(So),we=ft(So),vi&&vi.l(So),So.forEach(H),$e=ft(tn),qe=Me(tn,"DIV",{class:!0});var Vo=Ce(qe);Xe=Me(Vo,"DIV",{class:!0,style:!0});var ur=Ce(Xe);jt=Te(ur,"Sex"),ur.forEach(H),et=ft(Vo),ui(Kt.$$.fragment,Vo),Vo.forEach(H),dr=ft(tn),Ft=Me(tn,"DIV",{class:!0});var Lr=Ce(Ft);$t=Me(Lr,"H3",{style:!0,class:!0});var Kn=Ce($t);er=Te(Kn,"Country of birth"),Kn.forEach(H),ai=ft(Lr),ui(rr.$$.fragment,Lr),Lr.forEach(H),tn.forEach(H),Cr=ft(ge),Xt=Me(ge,"DIV",{class:!0});var ko=Ce(Xt);qt=Me(ko,"DIV",{style:!0});var Ka=Ce(qt);ir=Me(Ka,"H3",{class:!0});var as=Ce(ir);fi=Te(as,"Explore related areas"),as.forEach(H),Ka.forEach(H),ro=ft(ko),Pr=Me(ko,"DIV",{id:!0,style:!0,class:!0});var eu=Ce(Pr);ui(Ur.$$.fragment,eu),eu.forEach(H),po=ft(ko),Mr=Me(ko,"DIV",{});var tu=Ce(Mr);zn=Me(tu,"SPAN",{});var ss=Ce(zn);xi&&xi.l(ss),ss.forEach(H),tu.forEach(H),di=ft(ko),jr=Me(ko,"DIV",{});var ls=Ce(jr);Ai=Me(ls,"SPAN",{});var Ho=Ce(Ai);yr=Me(Ho,"UL",{style:!0});var bi=Ce(yr);mr.l(bi),bi.forEach(H),Ho.forEach(H),ls.forEach(H),ko.forEach(H),qi=ft(ge),Go=Me(ge,"DIV",{});var us=Ce(Go);Qr=Me(us,"H2",{});var il=Ce(Qr);fo=Te(il,"Religion and Ethnicity Statistics "),ei=Me(il,"SPAN",{class:!0});var si=Ce(ei);bn=Te(si,ti),zi=Te(si," - Census 2011"),si.forEach(H),il.forEach(H),us.forEach(H),io=ft(ge),Pn=Me(ge,"DIV",{class:!0});var at=Ce(Pn);mo=Me(at,"DIV",{class:!0});var Gi=Ce(mo);en=Me(Gi,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Rs=Ce(en);Do=Me(Rs,"DIV",{class:!0,style:!0});var Da=Ce(Do);ba=Te(Da,"Religion "),wa=Me(Da,"SPAN",{style:!0});var Eo=Ce(wa);Sa=Te(Eo,"[?]"),Eo.forEach(H),Da.forEach(H),Rs.forEach(H),rs=ft(Gi),qn=Me(Gi,"DIV",{class:!0,id:!0});var Bn=Ce(qn);Ko=Me(Bn,"DIV",{class:!0});var nl=Ce(Ko);ca=Te(nl,"Religion, religious denomination or body the respondent indicated they belong to"),nl.forEach(H),Bn.forEach(H),is=ft(Gi),ui(Mn.$$.fragment,Gi),Gi.forEach(H),wn=ft(at),Zi=Me(at,"DIV",{class:!0});var Ye=Ce(Zi);fe=Me(Ye,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ol=Ce(fe);ri=Me(ol,"DIV",{class:!0,style:!0});var cs=Ce(ri);Ci=Te(cs,"Religion/religion brought up in "),Tr=Me(cs,"SPAN",{style:!0});var al=Ce(Tr);yo=Te(al,"[?]"),al.forEach(H),cs.forEach(H),ol.forEach(H),Sn=ft(Ye),qr=Me(Ye,"DIV",{class:!0,id:!0});var oo=Ce(qr);Lo=Me(oo,"DIV",{class:!0});var Fn=Ce(Lo);Hs=Te(Fn,"Religion, religious denomination or body the respondent indicated they belong to, or for people who do not regard themselves as belonging to any religion, the religious group brought up in"),Fn.forEach(H),oo.forEach(H),wl=ft(Ye),ui(ka.$$.fragment,Ye),Ye.forEach(H),As=ft(at),_o=Me(at,"DIV",{class:!0});var ya=Ce(_o);Zn=Me(ya,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Bs=Ce(Zn);Ro=Me(Bs,"DIV",{class:!0,style:!0});var En=Ce(Ro);Js=Te(En,"Ethnic Group "),Va=Me(En,"SPAN",{style:!0});var Jo=Ce(Va);Sl=Te(Jo,"[?]"),Jo.forEach(H),En.forEach(H),Bs.forEach(H),Ua=ft(ya),Bo=Me(ya,"DIV",{class:!0,id:!0});var Ml=Ce(Bo);ja=Me(Ml,"DIV",{class:!0});var hs=Ce(ja);Bi=Te(hs,"Respondents own perceived ethnic group and cultural background"),hs.forEach(H),Ml.forEach(H),zs=ft(ya),ui(Dn.$$.fragment,ya),ya.forEach(H),at.forEach(H),this.h()},h(){$(v,"href",Is+"/"),$(v,"sveltekit:noscroll",""),$(v,"class","svelte-d76ur"),a.a=I,$(y,"class","text-small"),$(N,"class","text-big title svelte-d76ur"),$(Pt,"class","btn svelte-d76ur"),Oi(Pt,"btn-active",c[4]),$(Ie,"class","text-bold"),tt(Ie,"font-size","0.85em"),$(_t,"class","btn svelte-d76ur"),tt(_t,"width","33%"),$(_t,"title","Click to print this page"),$(_t,"onclick","window.print();return false;"),$(je,"class","btn svelte-d76ur"),tt(je,"width","33%"),$(je,"alt","Return to the landing page"),$(je,"onclick","window.location.href='"+Is+"';"),$(Vr,"class","btn svelte-d76ur"),tt(Vr,"width","30%"),$(Vr,"type","share"),$(Vr,"alt","Share this page"),$(Ue,"width","100%"),tt(Vt,"width","350px"),tt(Vt,"padding-top","5px"),$(Vt,"class","svelte-d76ur"),Oi(Vt,"float-right",c[5]>1),$(h,"class","grid mtl svelte-d76ur"),tt(Jt,"margin","0 0 10px 0"),tt(Jt,"line-height","1.78"),$(Jt,"class","svelte-d76ur"),$(dt,"class","div-grey-box svelte-d76ur"),tt(dt,"line-height","1.3"),tt(Xr,"margin","0"),$(Xr,"class","svelte-d76ur"),$(Ri,"class","text-big"),tt(Ri,"font-size","2.8em"),$(Jr,"class","div-grey-box svelte-d76ur"),tt(vn,"color","gray"),$(ji,"class","blocktitle svelte-d76ur"),tt(ji,"margin","0"),tt(ji,"width","100%"),$(Ii,"class","row"),tt(Ii,"display","flex"),tt(Ii,"cursor","pointer"),$(Ii,"data-bs-toggle","collapse"),$(Ii,"data-bs-target","#households-info"),$(Ii,"aria-expanded","false"),$(Ii,"aria-controls","households-info"),$(An,"class","card card-body svelte-d76ur"),$(xn,"class","collapse svelte-d76ur"),$(xn,"id","households-info"),$(Qi,"class","text-big"),tt(Qi,"font-size","2.8em"),$(pi,"class","div-grey-box svelte-d76ur"),tt(ce,"color","gray"),$(J,"class","blocktitle svelte-d76ur"),tt(J,"margin","0"),tt(J,"width","100%"),$(K,"class","row"),tt(K,"display","flex"),tt(K,"cursor","pointer"),$(K,"data-bs-toggle","collapse"),$(K,"data-bs-target","#broadagebands-info"),$(K,"aria-expanded","false"),$(K,"aria-controls","broadagebands-info"),$(Re,"class","card card-body svelte-d76ur"),$(me,"class","collapse svelte-d76ur"),$(me,"id","broadagebands-info"),$(Be,"class","chart svelte-d76ur"),tt(Be,"height","100px"),tt(Be,"padding-bottom","5px"),$(V,"class","div-grey-box svelte-d76ur"),$(Xe,"class","blocktitle svelte-d76ur"),tt(Xe,"margin","0"),tt(Xe,"width","100%"),$(qe,"class","div-grey-box svelte-d76ur"),tt($t,"margin","0"),$($t,"class","svelte-d76ur"),$(Ft,"class","div-grey-box svelte-d76ur"),$(Sr,"id","grid"),$(Sr,"class","grid mt svelte-d76ur"),$(ir,"class","svelte-d76ur"),tt(qt,"grid-column","span "+c[5]),$(Pr,"id","map"),tt(Pr,"grid-column","span "+(c[5]==2?2:c[5]&&c[5]>2?c[5]-1:1)),$(Pr,"class","svelte-d76ur"),tt(yr,"padding-left","0"),$(Xt,"class","grid mt svelte-d76ur"),Np(()=>c[18].call(Xt)),$(ei,"class","title-inset muted svelte-d76ur"),tt(wa,"color","gray"),$(Do,"class","blocktitle svelte-d76ur"),tt(Do,"margin","0"),tt(Do,"width","100%"),$(en,"class","row"),tt(en,"display","flex"),tt(en,"cursor","pointer"),$(en,"data-bs-toggle","collapse"),$(en,"data-bs-target","#religion-info"),$(en,"aria-expanded","false"),$(en,"aria-controls","religion-info"),$(Ko,"class","card card-body svelte-d76ur"),$(qn,"class","collapse svelte-d76ur"),$(qn,"id","religion-info"),$(mo,"class","div-grey-box svelte-d76ur"),tt(Tr,"color","gray"),$(ri,"class","blocktitle svelte-d76ur"),tt(ri,"margin","0"),tt(ri,"width","100%"),$(fe,"class","row"),tt(fe,"display","flex"),tt(fe,"cursor","pointer"),$(fe,"data-bs-toggle","collapse"),$(fe,"data-bs-target","#religionbup-info"),$(fe,"aria-expanded","false"),$(fe,"aria-controls","religionbup-info"),$(Lo,"class","card card-body svelte-d76ur"),$(qr,"class","collapse svelte-d76ur"),$(qr,"id","religionbup-info"),$(Zi,"class","div-grey-box svelte-d76ur"),tt(Va,"color","gray"),$(Ro,"class","blocktitle svelte-d76ur"),tt(Ro,"margin","0"),tt(Ro,"width","100%"),$(Zn,"class","row"),tt(Zn,"display","flex"),tt(Zn,"cursor","pointer"),$(Zn,"data-bs-toggle","collapse"),$(Zn,"data-bs-target","#ethnic-info"),$(Zn,"aria-expanded","false"),$(Zn,"aria-controls","ethnic-info"),$(ja,"class","card card-body svelte-d76ur"),$(Bo,"class","collapse svelte-d76ur"),$(Bo,"id","ethnic-info"),$(_o,"class","div-grey-box svelte-d76ur"),$(Pn,"class","grid mt svelte-d76ur")},m(ge,bt){ke(ge,h,bt),ne(h,f),ne(f,y),ne(y,v),ne(v,x),a.m(A,y),ne(y,I),cn.m(y,null),ne(y,B),ne(f,L),ne(f,j),ne(f,N),ne(N,pe),ne(f,De),ne(f,Ie),ne(Ie,rt),go.m(Ie,null),ne(Ie,Ge),ne(Ie,Pt),ne(Pt,Tt),ne(h,ct),ne(h,He),ne(He,Vt),ne(Vt,Ht),ne(Ht,Rt),ne(Vt,gt),ci(Fe,Vt,null),ne(Vt,At),ne(Vt,ot),ne(ot,xt),ne(Vt,Ve),ne(Vt,Ue),ne(Ue,_t),ne(_t,fr),ne(Ue,zt),ne(Ue,je),ne(je,Ke),ne(Ue,hr),ne(Ue,Vr),ne(Vr,Ji),ke(ge,Yi,bt),ke(ge,_i,bt),ne(_i,Gr),ne(Gr,Ni),ke(ge,lr,bt),ke(ge,Sr,bt),ne(Sr,dt),ne(dt,Jt),ne(Jt,Gt),ne(dt,Vi),Gn.m(dt,null),ne(dt,Kr),hn&&hn.m(dt,null),ne(Sr,Hr),ne(Sr,Jr),ne(Jr,Xr),ne(Xr,Ui),ne(Jr,Ei),ne(Jr,Ri),ne(Ri,gi),ne(Jr,Ti),ne(Jr,gn),~Er&&da[Er].m(Jr,null),ne(Sr,zo),ne(Sr,pi),ne(pi,Ii),ne(Ii,ji),ne(ji,Co),ne(ji,vn),ne(vn,ho),ne(pi,Un),ne(pi,xn),ne(xn,An),ne(An,Po),ne(pi,Mo),ne(pi,Qi),ne(Qi,ln),ne(pi,to),ne(pi,jn),~ar&&Ln[ar].m(pi,null),ne(Sr,F),ne(Sr,V),ne(V,K),ne(K,J),ne(J,le),ne(J,ce),ne(ce,U),ne(V,re),ne(V,me),ne(me,Re),ne(Re,Ne),ne(V,be),ne(V,Be),ci(nt,Be,null),ne(V,it),pn&&pn.m(V,null),ne(V,we),vi&&vi.m(V,null),ne(Sr,$e),ne(Sr,qe),ne(qe,Xe),ne(Xe,jt),ne(qe,et),ci(Kt,qe,null),ne(Sr,dr),ne(Sr,Ft),ne(Ft,$t),ne($t,er),ne(Ft,ai),ci(rr,Ft,null),ke(ge,Cr,bt),ke(ge,Xt,bt),ne(Xt,qt),ne(qt,ir),ne(ir,fi),ne(Xt,ro),ne(Xt,Pr),ci(Ur,Pr,null),ne(Xt,po),ne(Xt,Mr),ne(Mr,zn),xi&&xi.m(zn,null),ne(Xt,di),ne(Xt,jr),ne(jr,Ai),ne(Ai,yr),mr.m(yr,null),Cn=Vp(Xt,c[18].bind(Xt)),ke(ge,qi,bt),ke(ge,Go,bt),ne(Go,Qr),ne(Qr,fo),ne(Qr,ei),ne(ei,bn),ne(ei,zi),ke(ge,io,bt),ke(ge,Pn,bt),ne(Pn,mo),ne(mo,en),ne(en,Do),ne(Do,ba),ne(Do,wa),ne(wa,Sa),ne(mo,rs),ne(mo,qn),ne(qn,Ko),ne(Ko,ca),ne(mo,is),ci(Mn,mo,null),ne(Pn,wn),ne(Pn,Zi),ne(Zi,fe),ne(fe,ri),ne(ri,Ci),ne(ri,Tr),ne(Tr,yo),ne(Zi,Sn),ne(Zi,qr),ne(qr,Lo),ne(Lo,Hs),ne(Zi,wl),ci(ka,Zi,null),ne(Pn,As),ne(Pn,_o),ne(_o,Zn),ne(Zn,Ro),ne(Ro,Js),ne(Ro,Va),ne(Va,Sl),ne(_o,Ua),ne(_o,Bo),ne(Bo,ja),ne(ja,Bi),ne(_o,zs),ci(Dn,_o,null),un=!0,ha||(Ea=aa(Pt,"click",c[16]),ha=!0)},p(ge,bt){Xo===(Xo=pa(ge))&&cn?cn.p(ge,bt):(cn.d(1),cn=Xo(ge),cn&&(cn.c(),cn.m(y,B))),(!un||bt[0]&2)&&X!==(X=ge[1].name+"")&&Dt(pe,X),Cs===(Cs=fa(ge))&&go?go.p(ge,bt):(go.d(1),go=Cs(ge),go&&(go.c(),go.m(Ie,Ge))),bt[0]&16&&Oi(Pt,"btn-active",ge[4]);const Rn={};bt[0]&1&&(Rn.options=ge[0]),Fe.$set(Rn),bt[0]&32&&Oi(Vt,"float-right",ge[5]>1),Ys===(Ys=Dr(ge))&&Gn?Gn.p(ge,bt):(Gn.d(1),Gn=Ys(ge),Gn&&(Gn.c(),Gn.m(dt,Kr))),ge[9]?hn?hn.p(ge,bt):(hn=Sm(ge),hn.c(),hn.m(dt,null)):hn&&(hn.d(1),hn=null),(!un||bt[0]&2)&&sn!==(sn=ge[1].data.population.value[2011].all.toLocaleString()+"")&&Dt(gi,sn);let Fo=Er;Er=El(ge),Er===Fo?~Er&&da[Er].p(ge,bt):(Yr&&($a(),Wt(da[Fo],1,1,()=>{da[Fo]=null}),es()),~Er?(Yr=da[Er],Yr?Yr.p(ge,bt):(Yr=da[Er]=kl[Er](ge),Yr.c()),Mt(Yr,1),Yr.m(Jr,null)):Yr=null),(!un||bt[0]&2)&&$i!==($i=ge[1].data.households.value[2011].all_households.toLocaleString()+"")&&Dt(ln,$i);let ns=ar;ar=Ia(ge),ar===ns?~ar&&Ln[ar].p(ge,bt):(M&&($a(),Wt(Ln[ns],1,1,()=>{Ln[ns]=null}),es()),~ar?(M=Ln[ar],M?M.p(ge,bt):(M=Ln[ar]=Ta[ar](ge),M.c()),Mt(M,1),M.m(pi,null)):M=null);const qa={};bt[0]&2&&(qa.data=ge[1]&&ge[11](["broad_age_bands_years","perc","2011"])),bt[0]&530&&(qa.zKey=ge[4]&&ge[9]?"prev":!ge[4]&&ge[1].type!="ew"?"ew":null),nt.$set(qa),ge[10]&&!(ge[4]&&!ge[9])?pn?pn.p(ge,bt):(pn=Im(ge),pn.c(),pn.m(V,we)):pn&&(pn.d(1),pn=null),Aa===(Aa=Tl(ge))&&vi?vi.p(ge,bt):(vi&&vi.d(1),vi=Aa&&Aa(ge),vi&&(vi.c(),vi.m(V,null)));const no={};bt[0]&2&&(no.data=ge[1]&&ge[11](["population","perc","2011"])),bt[0]&530&&(no.zKey=ge[4]&&ge[9]?"prev":!ge[4]&&ge[1].type!="ew"?"ew":null),bt[0]&1024&&(no.label=ge[10]),Kt.$set(no);const vo={};bt[0]&2&&(vo.data=ge[1]&&ge[11](["country_of_birth","perc","2011"])),bt[0]&530&&(vo.zKey=ge[4]&&ge[9]?"prev":!ge[4]&&ge[1].type!="ew"?"ew":null),bt[0]&1024&&(vo.label=ge[10]),rr.$set(vo),(!un||bt[0]&32)&&tt(qt,"grid-column","span "+ge[5]);const Oo={};bt[0]&2&&(Oo.location={bounds:ge[1].bounds}),bt[0]&384|bt[1]&8&&(Oo.$$scope={dirty:bt,ctx:ge}),!Zo&&bt[0]&64&&(Zo=!0,Oo.map=ge[6],G_(()=>Zo=!1)),Ur.$set(Oo),(!un||bt[0]&32)&&tt(Pr,"grid-column","span "+(ge[5]==2?2:ge[5]&&ge[5]>2?ge[5]-1:1)),ge[1].parents[0]?xi?xi.p(ge,bt):(xi=Lm(ge),xi.c(),xi.m(zn,null)):xi&&(xi.d(1),xi=null),Ca===(Ca=Il(ge))&&mr?mr.p(ge,bt):(mr.d(1),mr=Ca(ge),mr&&(mr.c(),mr.m(yr,null))),(!un||bt[0]&2)&&ti!==(ti=ge[1].name+"")&&Dt(bn,ti);const kn={};bt[0]&2&&(kn.data=ge[1]&&ge[11](["religion","perc","2011"])),bt[0]&530&&(kn.zKey=ge[4]&&ge[9]?"prev":!ge[4]&&ge[1].type!="ew"?"ew":null),bt[0]&1024&&(kn.label=ge[10]),Mn.$set(kn);const No={};bt[0]&2&&(No.data=ge[1]&&ge[11](["religion_or_religion_brought_up_in","perc","2011"])),bt[0]&530&&(No.zKey=ge[4]&&ge[9]?"prev":!ge[4]&&ge[1].type!="ew"?"ew":null),bt[0]&1024&&(No.label=ge[10]),ka.$set(No);const xo={};bt[0]&2&&(xo.data=ge[1]&&ge[11](["ethnic_group","perc","2011"])),bt[0]&530&&(xo.zKey=ge[4]&&ge[9]?"prev":!ge[4]&&ge[1].type!="ew"?"ew":null),bt[0]&1024&&(xo.label=ge[10]),Dn.$set(xo)},i(ge){un||(Mt(Fe.$$.fragment,ge),Mt(Yr),Mt(M),Mt(nt.$$.fragment,ge),Mt(Kt.$$.fragment,ge),Mt(rr.$$.fragment,ge),Mt(Ur.$$.fragment,ge),Mt(Mn.$$.fragment,ge),Mt(ka.$$.fragment,ge),Mt(Dn.$$.fragment,ge),un=!0)},o(ge){Wt(Fe.$$.fragment,ge),Wt(Yr),Wt(M),Wt(nt.$$.fragment,ge),Wt(Kt.$$.fragment,ge),Wt(rr.$$.fragment,ge),Wt(Ur.$$.fragment,ge),Wt(Mn.$$.fragment,ge),Wt(ka.$$.fragment,ge),Wt(Dn.$$.fragment,ge),un=!1},d(ge){ge&&H(h),cn.d(),go.d(),hi(Fe),ge&&H(Yi),ge&&H(_i),ge&&H(lr),ge&&H(Sr),Gn.d(),hn&&hn.d(),~Er&&da[Er].d(),~ar&&Ln[ar].d(),hi(nt),pn&&pn.d(),vi&&vi.d(),hi(Kt),hi(rr),ge&&H(Cr),ge&&H(Xt),hi(Ur),xi&&xi.d(),mr.d(),Cn(),ge&&H(qi),ge&&H(Go),ge&&H(io),ge&&H(Pn),hi(Mn),hi(ka),hi(Dn),ha=!1,Ea()}}}function K0(c){let h=c[1].name+"",f;return{c(){f=Ee(h)},l(y){f=Te(y,h)},m(y,v){ke(y,f,v)},p(y,v){v[0]&2&&h!==(h=y[1].name+"")&&Dt(f,h)},d(y){y&&H(f)}}}function X0(c){let h,f=c[1].name+"",y,v=[...c[1].parents].reverse(),x=[];for(let a=0;a<v.length;a+=1)x[a]=wm(xm(c,v,a));return{c(){for(let a=0;a<x.length;a+=1)x[a].c();h=pt(),y=Ee(f)},l(a){for(let A=0;A<x.length;A+=1)x[A].l(a);h=ft(a),y=Te(a,f)},m(a,A){for(let I=0;I<x.length;I+=1)x[I].m(a,A);ke(a,h,A),ke(a,y,A)},p(a,A){if(A[0]&2){v=[...a[1].parents].reverse();let I;for(I=0;I<v.length;I+=1){const B=xm(a,v,I);x[I]?x[I].p(B,A):(x[I]=wm(B),x[I].c(),x[I].m(h.parentNode,h))}for(;I<x.length;I+=1)x[I].d(1);x.length=v.length}A[0]&2&&f!==(f=a[1].name+"")&&Dt(y,f)},d(a){ts(x,a),a&&H(h),a&&H(y)}}}function wm(c){let h,f=c[26].name+"",y,v,x,a=" &gt; ",A;return{c(){h=Pe("a"),y=Ee(f),x=new Um(!1),A=Or(),this.h()},l(I){h=Me(I,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var B=Ce(h);y=Te(B,f),B.forEach(H),x=jm(I,!1),A=Or(),this.h()},h(){$(h,"href",v=Is+"/"+c[26].code+"/"),$(h,"sveltekit:noscroll",""),$(h,"class","svelte-d76ur"),x.a=A},m(I,B){ke(I,h,B),ne(h,y),x.m(a,I,B),ke(I,A,B)},p(I,B){B[0]&2&&f!==(f=I[26].name+"")&&Dt(y,f),B[0]&2&&v!==(v=Is+"/"+I[26].code+"/")&&$(h,"href",v)},d(I){I&&H(h),I&&H(A),I&&x.d()}}}function W0(c){let h,f,y,v;return{c(){h=Pe("button"),f=Ee("Northern Ireland"),this.h()},l(x){h=Me(x,"BUTTON",{class:!0});var a=Ce(h);f=Te(a,"Northern Ireland"),a.forEach(H),this.h()},h(){$(h,"class","btn svelte-d76ur"),Oi(h,"btn-active",!c[4])},m(x,a){ke(x,h,a),ne(h,f),y||(v=aa(h,"click",c[15]),y=!0)},p(x,a){a[0]&16&&Oi(h,"btn-active",!x[4])},d(x){x&&H(h),y=!1,v()}}}function H0(c){let h,f,y,v;return{c(){h=Pe("button"),f=Ee("No comparison"),this.h()},l(x){h=Me(x,"BUTTON",{class:!0});var a=Ce(h);f=Te(a,"No comparison"),a.forEach(H),this.h()},h(){$(h,"class","btn svelte-d76ur"),Oi(h,"btn-active",!c[4])},m(x,a){ke(x,h,a),ne(h,f),y||(v=aa(h,"click",c[14]),y=!0)},p(x,a){a[0]&16&&Oi(h,"btn-active",!x[4])},d(x){x&&H(h),y=!1,v()}}}function J0(c){let h,f=c[1].name+"",y,v,x=c[1].data.population.value[2011].all.toLocaleString()+"",a,A,I;function B(N,X){return N[1].data.population.value_rank[2011].all==1?t1:N[1].data.population.value_rank[2011].all==N[1].count?e1:N[1].data.population.value_rank[2011].all<=(N[1].count+1)/2&&N[1].data.population.value_rank[2011].all!=1?$0:Q0}let L=B(c),j=L(c);return{c(){h=Ee("The population of "),y=Ee(f),v=Ee(" was "),a=Ee(x),A=Ee(` at the time of the 2011 Census, which made it the 
			`),j.c(),I=Or()},l(N){h=Te(N,"The population of "),y=Te(N,f),v=Te(N," was "),a=Te(N,x),A=Te(N,` at the time of the 2011 Census, which made it the 
			`),j.l(N),I=Or()},m(N,X){ke(N,h,X),ke(N,y,X),ke(N,v,X),ke(N,a,X),ke(N,A,X),j.m(N,X),ke(N,I,X)},p(N,X){X[0]&2&&f!==(f=N[1].name+"")&&Dt(y,f),X[0]&2&&x!==(x=N[1].data.population.value[2011].all.toLocaleString()+"")&&Dt(a,x),L===(L=B(N))&&j?j.p(N,X):(j.d(1),j=L(N),j&&(j.c(),j.m(I.parentNode,I)))},d(N){N&&H(h),N&&H(y),N&&H(v),N&&H(a),N&&H(A),j.d(N),N&&H(I)}}}function Y0(c){let h,f=c[1].name+"",y,v,x=c[1].data.population.value[2011].all.toLocaleString()+"",a,A;return{c(){h=Ee("The population of "),y=Ee(f),v=Ee(" was "),a=Ee(x),A=Ee(" at the time of the 2011 Census.")},l(I){h=Te(I,"The population of "),y=Te(I,f),v=Te(I," was "),a=Te(I,x),A=Te(I," at the time of the 2011 Census.")},m(I,B){ke(I,h,B),ke(I,y,B),ke(I,v,B),ke(I,a,B),ke(I,A,B)},p(I,B){B[0]&2&&f!==(f=I[1].name+"")&&Dt(y,f),B[0]&2&&x!==(x=I[1].data.population.value[2011].all.toLocaleString()+"")&&Dt(a,x)},d(I){I&&H(h),I&&H(y),I&&H(v),I&&H(a),I&&H(A)}}}function Q0(c){let h=c[1].count+1-c[1].data.population.value_rank[2011].all.toLocaleString()+"",f,y=bl(c[1].count+1-c[1].data.population.value_rank[2011].all)+"",v,x;return{c(){f=Ee(h),v=Ee(y),x=Ee(" smallest area.")},l(a){f=Te(a,h),v=Te(a,y),x=Te(a," smallest area.")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].count+1-a[1].data.population.value_rank[2011].all.toLocaleString()+"")&&Dt(f,h),A[0]&2&&y!==(y=bl(a[1].count+1-a[1].data.population.value_rank[2011].all)+"")&&Dt(v,y)},d(a){a&&H(f),a&&H(v),a&&H(x)}}}function $0(c){let h=c[1].data.population.value_rank[2011].all.toLocaleString()+"",f,y=bl(c[1].data.population.value_rank[2011].all)+"",v,x;return{c(){f=Ee(h),v=Ee(y),x=Ee(" largest area.")},l(a){f=Te(a,h),v=Te(a,y),x=Te(a," largest area.")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].data.population.value_rank[2011].all.toLocaleString()+"")&&Dt(f,h),A[0]&2&&y!==(y=bl(a[1].data.population.value_rank[2011].all)+"")&&Dt(v,y)},d(a){a&&H(f),a&&H(v),a&&H(x)}}}function e1(c){let h;return{c(){h=Ee("smallest area.")},l(f){h=Te(f,"smallest area.")},m(f,y){ke(f,h,y)},p:co,d(f){f&&H(h)}}}function t1(c){let h;return{c(){h=Ee("largest area.")},l(f){h=Te(f,"largest area.")},m(f,y){ke(f,h,y)},p:co,d(f){f&&H(h)}}}function Sm(c){let h;function f(x,a){return x[1].data.population.value.change.all==0?n1:x[1].data.population.value.change.all>0?i1:r1}let y=f(c),v=y(c);return{c(){v.c(),h=Or()},l(x){v.l(x),h=Or()},m(x,a){v.m(x,a),ke(x,h,a)},p(x,a){y===(y=f(x))&&v?v.p(x,a):(v.d(1),v=y(x),v&&(v.c(),v.m(h.parentNode,h)))},d(x){v.d(x),x&&H(h)}}}function r1(c){let h,f=gr(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=Ee("A decrease of "),y=Ee(f),v=Ee(" since the 2001 Census.")},l(x){h=Te(x,"A decrease of "),y=Te(x,f),v=Te(x," since the 2001 Census.")},m(x,a){ke(x,h,a),ke(x,y,a),ke(x,v,a)},p(x,a){a[0]&2&&f!==(f=gr(x[1].data.population.value.change.all,"%",1)+"")&&Dt(y,f)},d(x){x&&H(h),x&&H(y),x&&H(v)}}}function i1(c){let h,f=gr(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=Ee("An increase of "),y=Ee(f),v=Ee(" since the 2001 Census.")},l(x){h=Te(x,"An increase of "),y=Te(x,f),v=Te(x," since the 2001 Census.")},m(x,a){ke(x,h,a),ke(x,y,a),ke(x,v,a)},p(x,a){a[0]&2&&f!==(f=gr(x[1].data.population.value.change.all,"%",1)+"")&&Dt(y,f)},d(x){x&&H(h),x&&H(y),x&&H(v)}}}function n1(c){let h;return{c(){h=Ee("No change in population since the 2001 Census.")},l(f){h=Te(f,"No change in population since the 2001 Census.")},m(f,y){ke(f,h,y)},p:co,d(f){f&&H(h)}}}function o1(c){let h,f,y,v;return f=new Zh({props:{$$slots:{default:[s1]},$$scope:{ctx:c}}}),{c(){h=Pe("span"),li(f.$$.fragment),y=Ee(" since 2001 Census"),this.h()},l(x){h=Me(x,"SPAN",{class:!0});var a=Ce(h);ui(f.$$.fragment,a),y=Te(a," since 2001 Census"),a.forEach(H),this.h()},h(){$(h,"class","text-small ")},m(x,a){ke(x,h,a),ci(f,h,null),ne(h,y),v=!0},p(x,a){const A={};a[0]&2|a[1]&8&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(Mt(f.$$.fragment,x),v=!0)},o(x){Wt(f.$$.fragment,x),v=!1},d(x){x&&H(h),hi(f)}}}function a1(c){let h,f,y=c[1].type!="ew"&&km(c);return{c(){y&&y.c(),h=Or()},l(v){y&&y.l(v),h=Or()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,x){v[1].type!="ew"?y?(y.p(v,x),x[0]&2&&Mt(y,1)):(y=km(v),y.c(),Mt(y,1),y.m(h.parentNode,h)):y&&($a(),Wt(y,1,1,()=>{y=null}),es())},i(v){f||(Mt(y),f=!0)},o(v){Wt(y),f=!1},d(v){y&&y.d(v),v&&H(h)}}}function s1(c){let h,f=gr(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=Pe("span"),y=Ee(f),this.h()},l(x){h=Me(x,"SPAN",{class:!0});var a=Ce(h);y=Te(a,f),a.forEach(H),this.h()},h(){$(h,"class",v=Ph(Lh(c[1].data.population.value.change.all))+" svelte-d76ur")},m(x,a){ke(x,h,a),ne(h,y)},p(x,a){a[0]&2&&f!==(f=gr(x[1].data.population.value.change.all,"%",1)+"")&&Dt(y,f),a[0]&2&&v!==(v=Ph(Lh(x[1].data.population.value.change.all))+" svelte-d76ur")&&$(h,"class",v)},d(x){x&&H(h)}}}function km(c){let h,f,y,v,x,a;f=new Zh({props:{$$slots:{default:[l1]},$$scope:{ctx:c}}});let A=c[1].type!="ctry"&&Em(c);return{c(){h=Pe("span"),li(f.$$.fragment),y=Ee(" of Northern Ireland population"),v=pt(),A&&A.c(),x=Or(),this.h()},l(I){h=Me(I,"SPAN",{class:!0});var B=Ce(h);ui(f.$$.fragment,B),y=Te(B," of Northern Ireland population"),B.forEach(H),v=ft(I),A&&A.l(I),x=Or(),this.h()},h(){$(h,"class","text-small ")},m(I,B){ke(I,h,B),ci(f,h,null),ne(h,y),ke(I,v,B),A&&A.m(I,B),ke(I,x,B),a=!0},p(I,B){const L={};B[0]&6|B[1]&8&&(L.$$scope={dirty:B,ctx:I}),f.$set(L),I[1].type!="ctry"?A?A.p(I,B):(A=Em(I),A.c(),A.m(x.parentNode,x)):A&&(A.d(1),A=null)},i(I){a||(Mt(f.$$.fragment,I),a=!0)},o(I){Wt(f.$$.fragment,I),a=!1},d(I){I&&H(h),hi(f),I&&H(v),A&&A.d(I),I&&H(x)}}}function l1(c){let h=(c[1].data.population.value[2011].all/c[2].data.population.value[2011].all>=.001?(c[1].data.population.value[2011].all/c[2].data.population.value[2011].all*100).toFixed(1):"<0.1")+"",f,y;return{c(){f=Ee(h),y=Ee("%")},l(v){f=Te(v,h),y=Te(v,"%")},m(v,x){ke(v,f,x),ke(v,y,x)},p(v,x){x[0]&6&&h!==(h=(v[1].data.population.value[2011].all/v[2].data.population.value[2011].all>=.001?(v[1].data.population.value[2011].all/v[2].data.population.value[2011].all*100).toFixed(1):"<0.1")+"")&&Dt(f,h)},d(v){v&&H(f),v&&H(y)}}}function Em(c){let h,f,y=c[1].count.toLocaleString()+"",v,x,a=Ec[c[1].type].pl.toLowerCase()+"",A;function I(j,N){return j[1].data.population.value_rank[2011].all==1?p1:j[1].data.population.value_rank[2011].all==j[1].count?h1:j[1].data.population.value_rank[2011].all<=(j[1].count+1)/2&&j[1].data.population.value_rank[2011].all!=1?c1:u1}let B=I(c),L=B(c);return{c(){h=Pe("div"),L.c(),f=Ee(`
			 population of `),v=Ee(y),x=pt(),A=Ee(a),this.h()},l(j){h=Me(j,"DIV",{class:!0});var N=Ce(h);L.l(N),f=Te(N,`
			 population of `),v=Te(N,y),x=ft(N),A=Te(N,a),N.forEach(H),this.h()},h(){$(h,"class","text-small ")},m(j,N){ke(j,h,N),L.m(h,null),ne(h,f),ne(h,v),ne(h,x),ne(h,A)},p(j,N){B===(B=I(j))&&L?L.p(j,N):(L.d(1),L=B(j),L&&(L.c(),L.m(h,f))),N[0]&2&&y!==(y=j[1].count.toLocaleString()+"")&&Dt(v,y),N[0]&2&&a!==(a=Ec[j[1].type].pl.toLowerCase()+"")&&Dt(A,a)},d(j){j&&H(h),L.d()}}}function u1(c){let h=c[1].count+1-c[1].data.population.value_rank[2011].all.toLocaleString()+"",f,y=bl(c[1].count+1-c[1].data.population.value_rank[2011].all)+"",v,x;return{c(){f=Ee(h),v=Ee(y),x=Ee(" smallest")},l(a){f=Te(a,h),v=Te(a,y),x=Te(a," smallest")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].count+1-a[1].data.population.value_rank[2011].all.toLocaleString()+"")&&Dt(f,h),A[0]&2&&y!==(y=bl(a[1].count+1-a[1].data.population.value_rank[2011].all)+"")&&Dt(v,y)},d(a){a&&H(f),a&&H(v),a&&H(x)}}}function c1(c){let h=c[1].data.population.value_rank[2011].all.toLocaleString()+"",f,y=bl(c[1].data.population.value_rank[2011].all)+"",v,x;return{c(){f=Ee(h),v=Ee(y),x=Ee(" largest")},l(a){f=Te(a,h),v=Te(a,y),x=Te(a," largest")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].data.population.value_rank[2011].all.toLocaleString()+"")&&Dt(f,h),A[0]&2&&y!==(y=bl(a[1].data.population.value_rank[2011].all)+"")&&Dt(v,y)},d(a){a&&H(f),a&&H(v),a&&H(x)}}}function h1(c){let h;return{c(){h=Ee("The smallest")},l(f){h=Te(f,"The smallest")},m(f,y){ke(f,h,y)},p:co,d(f){f&&H(h)}}}function p1(c){let h;return{c(){h=Ee("The largest")},l(f){h=Te(f,"The largest")},m(f,y){ke(f,h,y)},p:co,d(f){f&&H(h)}}}function f1(c){let h,f,y,v;return f=new Zh({props:{$$slots:{default:[m1]},$$scope:{ctx:c}}}),{c(){h=Pe("span"),li(f.$$.fragment),y=Ee(" since 2001 Census"),this.h()},l(x){h=Me(x,"SPAN",{class:!0});var a=Ce(h);ui(f.$$.fragment,a),y=Te(a," since 2001 Census"),a.forEach(H),this.h()},h(){$(h,"class","text-small")},m(x,a){ke(x,h,a),ci(f,h,null),ne(h,y),v=!0},p(x,a){const A={};a[0]&2|a[1]&8&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(Mt(f.$$.fragment,x),v=!0)},o(x){Wt(f.$$.fragment,x),v=!1},d(x){x&&H(h),hi(f)}}}function d1(c){let h,f,y=c[1].type!="ew"&&Tm(c);return{c(){y&&y.c(),h=Or()},l(v){y&&y.l(v),h=Or()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,x){v[1].type!="ew"?y?(y.p(v,x),x[0]&2&&Mt(y,1)):(y=Tm(v),y.c(),Mt(y,1),y.m(h.parentNode,h)):y&&($a(),Wt(y,1,1,()=>{y=null}),es())},i(v){f||(Mt(y),f=!0)},o(v){Wt(y),f=!1},d(v){y&&y.d(v),v&&H(h)}}}function m1(c){let h,f=gr(c[1].data.households.value.change.all_households,"%",1)+"",y,v;return{c(){h=Pe("span"),y=Ee(f),this.h()},l(x){h=Me(x,"SPAN",{class:!0});var a=Ce(h);y=Te(a,f),a.forEach(H),this.h()},h(){$(h,"class",v=Ph(Lh(c[1].data.households.value.change.all_households))+" svelte-d76ur")},m(x,a){ke(x,h,a),ne(h,y)},p(x,a){a[0]&2&&f!==(f=gr(x[1].data.households.value.change.all_households,"%",1)+"")&&Dt(y,f),a[0]&2&&v!==(v=Ph(Lh(x[1].data.households.value.change.all_households))+" svelte-d76ur")&&$(h,"class",v)},d(x){x&&H(h)}}}function Tm(c){let h,f,y,v;return f=new Zh({props:{$$slots:{default:[y1]},$$scope:{ctx:c}}}),{c(){h=Pe("span"),li(f.$$.fragment),y=Ee(" of Northern Ireland households"),this.h()},l(x){h=Me(x,"SPAN",{class:!0});var a=Ce(h);ui(f.$$.fragment,a),y=Te(a," of Northern Ireland households"),a.forEach(H),this.h()},h(){$(h,"class","text-small")},m(x,a){ke(x,h,a),ci(f,h,null),ne(h,y),v=!0},p(x,a){const A={};a[0]&6|a[1]&8&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(Mt(f.$$.fragment,x),v=!0)},o(x){Wt(f.$$.fragment,x),v=!1},d(x){x&&H(h),hi(f)}}}function y1(c){let h=(c[1].data.households.value[2011].all_households/c[2].data.households.value[2011].all_households>=.001?(c[1].data.households.value[2011].all_households/c[2].data.households.value[2011].all_households*100).toFixed(1):"<0.1")+"",f,y;return{c(){f=Ee(h),y=Ee("%")},l(v){f=Te(v,h),y=Te(v,"%")},m(v,x){ke(v,f,x),ke(v,y,x)},p(v,x){x[0]&6&&h!==(h=(v[1].data.households.value[2011].all_households/v[2].data.households.value[2011].all_households>=.001?(v[1].data.households.value[2011].all_households/v[2].data.households.value[2011].all_households*100).toFixed(1):"<0.1")+"")&&Dt(f,h)},d(v){v&&H(f),v&&H(y)}}}function Im(c){let h,f,y,v,x;return{c(){h=Pe("div"),f=$n("svg"),y=$n("rect"),v=pt(),x=Ee(c[10]),this.h()},l(a){h=Me(a,"DIV",{class:!0});var A=Ce(h);f=eo(A,"svg",{width:!0,height:!0,style:!0});var I=Ce(f);y=eo(I,"rect",{width:!0,height:!0,style:!0});var B=Ce(y);B.forEach(H),I.forEach(H),v=ft(A),x=Te(A,c[10]),A.forEach(H),this.h()},h(){$(y,"width","25"),$(y,"height","4"),tt(y,"fill","#CEDC20"),$(f,"width","25"),$(f,"height","4"),tt(f,"display","inline-block"),tt(f,"margin-bottom","3px"),$(h,"class","text-small muted; ")},m(a,A){ke(a,h,A),ne(h,f),ne(f,y),ne(h,v),ne(h,x)},p(a,A){A[0]&1024&&Dt(x,a[10])},d(a){a&&H(h)}}}function _1(c){let h,f,y=gr(c[1].data.broad_age_bands_years.perc[2011].a0to14_years,"%",0)+"",v,x,a,A,I,B,L=gr(c[1].data.broad_age_bands_years.perc[2011].a15to44_years,"%",0)+"",j,N,X,pe,De,Ie,rt=gr(c[1].data.broad_age_bands_years.perc[2011].a45to64_years,"%",0)+"",Ge,Pt,Tt,ct,He,Vt,Ht=gr(c[1].data.broad_age_bands_years.perc[2011].a65plus_years,"%",0)+"",Rt,gt,Fe,At=c[1].parents[0]&&Am(c),ot=c[1].parents[0]&&zm(c),xt=c[1].parents[0]&&Cm(c),Ve=c[1].parents[0]&&Pm(c);return{c(){h=Pe("span"),f=Ee("0-14 years "),v=Ee(y),x=pt(),At&&At.c(),a=Pe("br"),A=pt(),I=Pe("span"),B=Ee("15-44 years "),j=Ee(L),N=pt(),ot&&ot.c(),X=Pe("br"),pe=pt(),De=Pe("span"),Ie=Ee("45-64 years "),Ge=Ee(rt),Pt=pt(),xt&&xt.c(),Tt=Pe("br"),ct=pt(),He=Pe("span"),Vt=Ee("65+ years "),Rt=Ee(Ht),gt=pt(),Ve&&Ve.c(),Fe=Or(),this.h()},l(Ue){h=Me(Ue,"SPAN",{class:!0});var _t=Ce(h);f=Te(_t,"0-14 years "),v=Te(_t,y),x=ft(_t),_t.forEach(H),At&&At.l(Ue),a=Me(Ue,"BR",{}),A=ft(Ue),I=Me(Ue,"SPAN",{class:!0});var fr=Ce(I);B=Te(fr,"15-44 years "),j=Te(fr,L),N=ft(fr),fr.forEach(H),ot&&ot.l(Ue),X=Me(Ue,"BR",{}),pe=ft(Ue),De=Me(Ue,"SPAN",{class:!0});var zt=Ce(De);Ie=Te(zt,"45-64 years "),Ge=Te(zt,rt),Pt=ft(zt),zt.forEach(H),xt&&xt.l(Ue),Tt=Me(Ue,"BR",{}),ct=ft(Ue),He=Me(Ue,"SPAN",{class:!0});var je=Ce(He);Vt=Te(je,"65+ years "),Rt=Te(je,Ht),gt=ft(je),je.forEach(H),Ve&&Ve.l(Ue),Fe=Or(),this.h()},h(){$(h,"class","text-small"),$(I,"class","text-small"),$(De,"class","text-small"),$(He,"class","text-small")},m(Ue,_t){ke(Ue,h,_t),ne(h,f),ne(h,v),ne(h,x),At&&At.m(Ue,_t),ke(Ue,a,_t),ke(Ue,A,_t),ke(Ue,I,_t),ne(I,B),ne(I,j),ne(I,N),ot&&ot.m(Ue,_t),ke(Ue,X,_t),ke(Ue,pe,_t),ke(Ue,De,_t),ne(De,Ie),ne(De,Ge),ne(De,Pt),xt&&xt.m(Ue,_t),ke(Ue,Tt,_t),ke(Ue,ct,_t),ke(Ue,He,_t),ne(He,Vt),ne(He,Rt),ne(He,gt),Ve&&Ve.m(Ue,_t),ke(Ue,Fe,_t)},p(Ue,_t){_t[0]&2&&y!==(y=gr(Ue[1].data.broad_age_bands_years.perc[2011].a0to14_years,"%",0)+"")&&Dt(v,y),Ue[1].parents[0]?At?At.p(Ue,_t):(At=Am(Ue),At.c(),At.m(a.parentNode,a)):At&&(At.d(1),At=null),_t[0]&2&&L!==(L=gr(Ue[1].data.broad_age_bands_years.perc[2011].a15to44_years,"%",0)+"")&&Dt(j,L),Ue[1].parents[0]?ot?ot.p(Ue,_t):(ot=zm(Ue),ot.c(),ot.m(X.parentNode,X)):ot&&(ot.d(1),ot=null),_t[0]&2&&rt!==(rt=gr(Ue[1].data.broad_age_bands_years.perc[2011].a45to64_years,"%",0)+"")&&Dt(Ge,rt),Ue[1].parents[0]?xt?xt.p(Ue,_t):(xt=Cm(Ue),xt.c(),xt.m(Tt.parentNode,Tt)):xt&&(xt.d(1),xt=null),_t[0]&2&&Ht!==(Ht=gr(Ue[1].data.broad_age_bands_years.perc[2011].a65plus_years,"%",0)+"")&&Dt(Rt,Ht),Ue[1].parents[0]?Ve?Ve.p(Ue,_t):(Ve=Pm(Ue),Ve.c(),Ve.m(Fe.parentNode,Fe)):Ve&&(Ve.d(1),Ve=null)},d(Ue){Ue&&H(h),At&&At.d(Ue),Ue&&H(a),Ue&&H(A),Ue&&H(I),ot&&ot.d(Ue),Ue&&H(X),Ue&&H(pe),Ue&&H(De),xt&&xt.d(Ue),Ue&&H(Tt),Ue&&H(ct),Ue&&H(He),Ve&&Ve.d(Ue),Ue&&H(Fe)}}}function g1(c){let h,f,y=gr(c[1].data.broad_age_bands_years.perc[2011].a0to14_years,"%",0)+"",v,x,a,A,I=gr(c[1].data.broad_age_bands_years.perc[2001].a0to14_years,"%",0)+"",B,L,j,N,X,pe,De=gr(c[1].data.broad_age_bands_years.perc[2011].a15to44_years,"%",0)+"",Ie,rt,Ge,Pt,Tt=gr(c[1].data.broad_age_bands_years.perc[2001].a15to44_years,"%",0)+"",ct,He,Vt,Ht,Rt,gt,Fe=gr(c[1].data.broad_age_bands_years.perc[2011].a45to64_years,"%",0)+"",At,ot,xt,Ve,Ue=gr(c[1].data.broad_age_bands_years.perc[2001].a45to64_years,"%",0)+"",_t,fr,zt,je,Ke,hr,Vr=gr(c[1].data.broad_age_bands_years.perc[2011].a65plus_years,"%",0)+"",Ji,Yi,_i,Gr,Ni=gr(c[1].data.broad_age_bands_years.perc[2001].a65plus_years,"%",0)+"",lr,Sr;return{c(){h=Pe("span"),f=Ee("0-14 years "),v=Ee(y),x=pt(),a=Pe("span"),A=Ee("(2001 "),B=Ee(I),L=Ee(")"),j=Pe("br"),N=pt(),X=Pe("span"),pe=Ee("15-44 years "),Ie=Ee(De),rt=pt(),Ge=Pe("span"),Pt=Ee("(2001 "),ct=Ee(Tt),He=Ee(")"),Vt=Pe("br"),Ht=pt(),Rt=Pe("span"),gt=Ee("45-64 years "),At=Ee(Fe),ot=pt(),xt=Pe("span"),Ve=Ee("(2001 "),_t=Ee(Ue),fr=Ee(")"),zt=Pe("br"),je=pt(),Ke=Pe("span"),hr=Ee("65+ years "),Ji=Ee(Vr),Yi=pt(),_i=Pe("span"),Gr=Ee("(2001 "),lr=Ee(Ni),Sr=Ee(")"),this.h()},l(dt){h=Me(dt,"SPAN",{class:!0});var Jt=Ce(h);f=Te(Jt,"0-14 years "),v=Te(Jt,y),x=ft(Jt),Jt.forEach(H),a=Me(dt,"SPAN",{class:!0,style:!0});var Gt=Ce(a);A=Te(Gt,"(2001 "),B=Te(Gt,I),L=Te(Gt,")"),Gt.forEach(H),j=Me(dt,"BR",{}),N=ft(dt),X=Me(dt,"SPAN",{class:!0});var Vi=Ce(X);pe=Te(Vi,"15-44 years "),Ie=Te(Vi,De),rt=ft(Vi),Vi.forEach(H),Ge=Me(dt,"SPAN",{class:!0,style:!0});var Kr=Ce(Ge);Pt=Te(Kr,"(2001 "),ct=Te(Kr,Tt),He=Te(Kr,")"),Kr.forEach(H),Vt=Me(dt,"BR",{}),Ht=ft(dt),Rt=Me(dt,"SPAN",{class:!0});var Hr=Ce(Rt);gt=Te(Hr,"45-64 years "),At=Te(Hr,Fe),ot=ft(Hr),Hr.forEach(H),xt=Me(dt,"SPAN",{class:!0,style:!0});var Jr=Ce(xt);Ve=Te(Jr,"(2001 "),_t=Te(Jr,Ue),fr=Te(Jr,")"),Jr.forEach(H),zt=Me(dt,"BR",{}),je=ft(dt),Ke=Me(dt,"SPAN",{class:!0});var Xr=Ce(Ke);hr=Te(Xr,"65+ years "),Ji=Te(Xr,Vr),Yi=ft(Xr),Xr.forEach(H),_i=Me(dt,"SPAN",{class:!0,style:!0});var Ui=Ce(_i);Gr=Te(Ui,"(2001 "),lr=Te(Ui,Ni),Sr=Te(Ui,")"),Ui.forEach(H),this.h()},h(){$(h,"class","text-small"),$(a,"class","text-small"),tt(a,"color","#3878C5"),$(X,"class","text-small"),$(Ge,"class","text-small"),tt(Ge,"color","#3878C5"),$(Rt,"class","text-small"),$(xt,"class","text-small"),tt(xt,"color","#3878C5"),$(Ke,"class","text-small"),$(_i,"class","text-small"),tt(_i,"color","#3878C5")},m(dt,Jt){ke(dt,h,Jt),ne(h,f),ne(h,v),ne(h,x),ke(dt,a,Jt),ne(a,A),ne(a,B),ne(a,L),ke(dt,j,Jt),ke(dt,N,Jt),ke(dt,X,Jt),ne(X,pe),ne(X,Ie),ne(X,rt),ke(dt,Ge,Jt),ne(Ge,Pt),ne(Ge,ct),ne(Ge,He),ke(dt,Vt,Jt),ke(dt,Ht,Jt),ke(dt,Rt,Jt),ne(Rt,gt),ne(Rt,At),ne(Rt,ot),ke(dt,xt,Jt),ne(xt,Ve),ne(xt,_t),ne(xt,fr),ke(dt,zt,Jt),ke(dt,je,Jt),ke(dt,Ke,Jt),ne(Ke,hr),ne(Ke,Ji),ne(Ke,Yi),ke(dt,_i,Jt),ne(_i,Gr),ne(_i,lr),ne(_i,Sr)},p(dt,Jt){Jt[0]&2&&y!==(y=gr(dt[1].data.broad_age_bands_years.perc[2011].a0to14_years,"%",0)+"")&&Dt(v,y),Jt[0]&2&&I!==(I=gr(dt[1].data.broad_age_bands_years.perc[2001].a0to14_years,"%",0)+"")&&Dt(B,I),Jt[0]&2&&De!==(De=gr(dt[1].data.broad_age_bands_years.perc[2011].a15to44_years,"%",0)+"")&&Dt(Ie,De),Jt[0]&2&&Tt!==(Tt=gr(dt[1].data.broad_age_bands_years.perc[2001].a15to44_years,"%",0)+"")&&Dt(ct,Tt),Jt[0]&2&&Fe!==(Fe=gr(dt[1].data.broad_age_bands_years.perc[2011].a45to64_years,"%",0)+"")&&Dt(At,Fe),Jt[0]&2&&Ue!==(Ue=gr(dt[1].data.broad_age_bands_years.perc[2001].a45to64_years,"%",0)+"")&&Dt(_t,Ue),Jt[0]&2&&Vr!==(Vr=gr(dt[1].data.broad_age_bands_years.perc[2011].a65plus_years,"%",0)+"")&&Dt(Ji,Vr),Jt[0]&2&&Ni!==(Ni=gr(dt[1].data.broad_age_bands_years.perc[2001].a65plus_years,"%",0)+"")&&Dt(lr,Ni)},d(dt){dt&&H(h),dt&&H(a),dt&&H(j),dt&&H(N),dt&&H(X),dt&&H(Ge),dt&&H(Vt),dt&&H(Ht),dt&&H(Rt),dt&&H(xt),dt&&H(zt),dt&&H(je),dt&&H(Ke),dt&&H(_i)}}}function Am(c){let h,f,y=gr(c[2].data.broad_age_bands_years.perc[2011].a0to14_years,"%",0)+"",v,x;return{c(){h=Pe("span"),f=Ee("(NI "),v=Ee(y),x=Ee(")"),this.h()},l(a){h=Me(a,"SPAN",{class:!0,style:!0});var A=Ce(h);f=Te(A,"(NI "),v=Te(A,y),x=Te(A,")"),A.forEach(H),this.h()},h(){$(h,"class","text-small"),tt(h,"color","#3878C5")},m(a,A){ke(a,h,A),ne(h,f),ne(h,v),ne(h,x)},p(a,A){A[0]&4&&y!==(y=gr(a[2].data.broad_age_bands_years.perc[2011].a0to14_years,"%",0)+"")&&Dt(v,y)},d(a){a&&H(h)}}}function zm(c){let h,f,y=gr(c[2].data.broad_age_bands_years.perc[2011].a15to44_years,"%",0)+"",v,x;return{c(){h=Pe("span"),f=Ee("(NI "),v=Ee(y),x=Ee(")"),this.h()},l(a){h=Me(a,"SPAN",{class:!0,style:!0});var A=Ce(h);f=Te(A,"(NI "),v=Te(A,y),x=Te(A,")"),A.forEach(H),this.h()},h(){$(h,"class","text-small"),tt(h,"color","#3878C5")},m(a,A){ke(a,h,A),ne(h,f),ne(h,v),ne(h,x)},p(a,A){A[0]&4&&y!==(y=gr(a[2].data.broad_age_bands_years.perc[2011].a15to44_years,"%",0)+"")&&Dt(v,y)},d(a){a&&H(h)}}}function Cm(c){let h,f,y=gr(c[2].data.broad_age_bands_years.perc[2011].a45to64_years,"%",0)+"",v,x;return{c(){h=Pe("span"),f=Ee("(NI "),v=Ee(y),x=Ee(")"),this.h()},l(a){h=Me(a,"SPAN",{class:!0,style:!0});var A=Ce(h);f=Te(A,"(NI "),v=Te(A,y),x=Te(A,")"),A.forEach(H),this.h()},h(){$(h,"class","text-small"),tt(h,"color","#3878C5")},m(a,A){ke(a,h,A),ne(h,f),ne(h,v),ne(h,x)},p(a,A){A[0]&4&&y!==(y=gr(a[2].data.broad_age_bands_years.perc[2011].a45to64_years,"%",0)+"")&&Dt(v,y)},d(a){a&&H(h)}}}function Pm(c){let h,f,y=gr(c[2].data.broad_age_bands_years.perc[2011].a65plus_years,"%",0)+"",v,x;return{c(){h=Pe("span"),f=Ee("(NI "),v=Ee(y),x=Ee(")"),this.h()},l(a){h=Me(a,"SPAN",{class:!0,style:!0});var A=Ce(h);f=Te(A,"(NI "),v=Te(A,y),x=Te(A,")"),A.forEach(H),this.h()},h(){$(h,"class","text-small"),tt(h,"color","#3878C5")},m(a,A){ke(a,h,A),ne(h,f),ne(h,v),ne(h,x)},p(a,A){A[0]&4&&y!==(y=gr(a[2].data.broad_age_bands_years.perc[2011].a65plus_years,"%",0)+"")&&Dt(v,y)},d(a){a&&H(h)}}}function v1(c){let h,f,y,v,x,a;const A=[na[c[28]],{id:c[28]+"-fill"},{type:"fill"},{isChild:c[8][c[28]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[28]||c[7].childType==c[28]?"visible":"none"}},{paint:c[7].type==c[28]?zr["fill-self"]:c[7].childType==c[28]?zr["fill-child"]:zr.fill}];let I={};for(let X=0;X<A.length;X+=1)I=gl(I,A[X]);h=new Bu({props:I}),h.$on("select",c[12]);const B=[na[c[28]],{id:c[28]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[28]||c[7].childType==c[28]?"visible":"none"}},{paint:c[7].type==c[28]?zr["line-active"]:c[7].childType==c[28]?zr["line-child"]:zr.line}];let L={};for(let X=0;X<B.length;X+=1)L=gl(L,B[X]);y=new Bu({props:L});const j=[na[c[28]],{id:c[28]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[28]?"visible":"none"}},{paint:c[7].type==c[28]?zr["line-self"]:zr.line}];let N={};for(let X=0;X<j.length;X+=1)N=gl(N,j[X]);return x=new Bu({props:N}),{c(){li(h.$$.fragment),f=pt(),li(y.$$.fragment),v=pt(),li(x.$$.fragment)},l(X){ui(h.$$.fragment,X),f=ft(X),ui(y.$$.fragment,X),v=ft(X),ui(x.$$.fragment,X)},m(X,pe){ci(h,X,pe),ke(X,f,pe),ci(y,X,pe),ke(X,v,pe),ci(x,X,pe),a=!0},p(X,pe){const De=pe[0]&384?vl(A,[pe&0&&xl(na[X[28]]),A[1],A[2],pe[0]&256&&{isChild:X[8][X[28]]},A[4],pe[0]&128&&{selected:X[7].selected},A[6],pe[0]&128&&{highlighted:X[7].highlighted},A[8],pe[0]&128&&{hovered:X[7].hovered},pe[0]&128&&{layout:{visibility:X[7].type==X[28]||X[7].childType==X[28]?"visible":"none"}},pe[0]&128&&{paint:X[7].type==X[28]?zr["fill-self"]:X[7].childType==X[28]?zr["fill-child"]:zr.fill}]):{};h.$set(De);const Ie=pe[0]&128?vl(B,[pe&0&&xl(na[X[28]]),B[1],B[2],pe[0]&128&&{selected:X[7].selected},B[4],pe[0]&128&&{highlighted:X[7].highlighted},pe[0]&128&&{layout:{visibility:X[7].type==X[28]||X[7].childType==X[28]?"visible":"none"}},pe[0]&128&&{paint:X[7].type==X[28]?zr["line-active"]:X[7].childType==X[28]?zr["line-child"]:zr.line}]):{};y.$set(Ie);const rt=pe[0]&128?vl(j,[pe&0&&xl(na[X[28]]),j[1],j[2],pe[0]&128&&{selected:X[7].selected},pe[0]&128&&{layout:{visibility:X[7].type==X[28]?"visible":"none"}},pe[0]&128&&{paint:X[7].type==X[28]?zr["line-self"]:zr.line}]):{};x.$set(rt)},i(X){a||(Mt(h.$$.fragment,X),Mt(y.$$.fragment,X),Mt(x.$$.fragment,X),a=!0)},o(X){Wt(h.$$.fragment,X),Wt(y.$$.fragment,X),Wt(x.$$.fragment,X),a=!1},d(X){hi(h,X),X&&H(f),hi(y,X),X&&H(v),hi(x,X)}}}function Mm(c){let h,f;const y=[Dh[c[28]]];let v={$$slots:{default:[v1]},$$scope:{ctx:c}};for(let x=0;x<y.length;x+=1)v=gl(v,y[x]);return h=new cy({props:v}),{c(){li(h.$$.fragment)},l(x){ui(h.$$.fragment,x)},m(x,a){ci(h,x,a),f=!0},p(x,a){const A=a&0?vl(y,[xl(Dh[x[28]])]):{};a[0]&384|a[1]&8&&(A.$$scope={dirty:a,ctx:x}),h.$set(A)},i(x){f||(Mt(h.$$.fragment,x),f=!0)},o(x){Wt(h.$$.fragment,x),f=!1},d(x){hi(h,x)}}}function Dm(c){let h,f,y,v,x,a;const A=[na[c[28]],{id:c[28]+"-fill"},{type:"fill"},{isChild:c[8][c[28]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[28]||c[7].childType==c[28]?"visible":"none"}},{paint:c[7].type==c[28]?zr["fill-self"]:c[7].childType==c[28]?zr["fill-child"]:zr.fill}];let I={};for(let X=0;X<A.length;X+=1)I=gl(I,A[X]);h=new Bu({props:I}),h.$on("select",c[12]);const B=[na[c[28]],{id:c[28]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[28]||c[7].childType==c[28]?"visible":"none"}},{paint:c[7].type==c[28]?zr["line-active"]:c[7].childType==c[28]?zr["line-child"]:zr.line}];let L={};for(let X=0;X<B.length;X+=1)L=gl(L,B[X]);y=new Bu({props:L});const j=[na[c[28]],{id:c[28]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[28]?"visible":"none"}},{paint:c[7].type==c[28]?zr["line-self"]:zr.line}];let N={};for(let X=0;X<j.length;X+=1)N=gl(N,j[X]);return x=new Bu({props:N}),{c(){li(h.$$.fragment),f=pt(),li(y.$$.fragment),v=pt(),li(x.$$.fragment)},l(X){ui(h.$$.fragment,X),f=ft(X),ui(y.$$.fragment,X),v=ft(X),ui(x.$$.fragment,X)},m(X,pe){ci(h,X,pe),ke(X,f,pe),ci(y,X,pe),ke(X,v,pe),ci(x,X,pe),a=!0},p(X,pe){const De=pe[0]&384?vl(A,[pe&0&&xl(na[X[28]]),A[1],A[2],pe[0]&256&&{isChild:X[8][X[28]]},A[4],pe[0]&128&&{selected:X[7].selected},A[6],pe[0]&128&&{highlighted:X[7].highlighted},A[8],pe[0]&128&&{hovered:X[7].hovered},pe[0]&128&&{layout:{visibility:X[7].type==X[28]||X[7].childType==X[28]?"visible":"none"}},pe[0]&128&&{paint:X[7].type==X[28]?zr["fill-self"]:X[7].childType==X[28]?zr["fill-child"]:zr.fill}]):{};h.$set(De);const Ie=pe[0]&128?vl(B,[pe&0&&xl(na[X[28]]),B[1],B[2],pe[0]&128&&{selected:X[7].selected},B[4],pe[0]&128&&{highlighted:X[7].highlighted},pe[0]&128&&{layout:{visibility:X[7].type==X[28]||X[7].childType==X[28]?"visible":"none"}},pe[0]&128&&{paint:X[7].type==X[28]?zr["line-active"]:X[7].childType==X[28]?zr["line-child"]:zr.line}]):{};y.$set(Ie);const rt=pe[0]&128?vl(j,[pe&0&&xl(na[X[28]]),j[1],j[2],pe[0]&128&&{selected:X[7].selected},pe[0]&128&&{layout:{visibility:X[7].type==X[28]?"visible":"none"}},pe[0]&128&&{paint:X[7].type==X[28]?zr["line-self"]:zr.line}]):{};x.$set(rt)},i(X){a||(Mt(h.$$.fragment,X),Mt(y.$$.fragment,X),Mt(x.$$.fragment,X),a=!0)},o(X){Wt(h.$$.fragment,X),Wt(y.$$.fragment,X),Wt(x.$$.fragment,X),a=!1},d(X){hi(h,X),X&&H(f),hi(y,X),X&&H(v),hi(x,X)}}}function x1(c){let h,f,y=["lgd"],v=[];for(let a=0;a<1;a+=1)v[a]=Dm(gm(c,y,a));const x=a=>Wt(v[a],1,1,()=>{v[a]=null});return{c(){for(let a=0;a<1;a+=1)v[a].c();h=Or()},l(a){for(let A=0;A<1;A+=1)v[A].l(a);h=Or()},m(a,A){for(let I=0;I<1;I+=1)v[I].m(a,A);ke(a,h,A),f=!0},p(a,A){if(A[0]&4480){y=["lgd"];let I;for(I=0;I<1;I+=1){const B=gm(a,y,I);v[I]?(v[I].p(B,A),Mt(v[I],1)):(v[I]=Dm(B),v[I].c(),Mt(v[I],1),v[I].m(h.parentNode,h))}for($a(),I=1;I<1;I+=1)x(I);es()}},i(a){if(!f){for(let A=0;A<1;A+=1)Mt(v[A]);f=!0}},o(a){v=v.filter(Boolean);for(let A=0;A<1;A+=1)Wt(v[A]);f=!1},d(a){ts(v,a),a&&H(h)}}}function b1(c){let h,f,y,v=["dea"],x=[];for(let B=0;B<1;B+=1)x[B]=Mm(vm(c,v,B));const a=B=>Wt(x[B],1,1,()=>{x[B]=null}),A=[Dh.crd];let I={$$slots:{default:[x1]},$$scope:{ctx:c}};for(let B=0;B<A.length;B+=1)I=gl(I,A[B]);return f=new cy({props:I}),{c(){for(let B=0;B<1;B+=1)x[B].c();h=pt(),li(f.$$.fragment)},l(B){for(let L=0;L<1;L+=1)x[L].l(B);h=ft(B),ui(f.$$.fragment,B)},m(B,L){for(let j=0;j<1;j+=1)x[j].m(B,L);ke(B,h,L),ci(f,B,L),y=!0},p(B,L){if(L[0]&4480){v=["dea"];let N;for(N=0;N<1;N+=1){const X=vm(B,v,N);x[N]?(x[N].p(X,L),Mt(x[N],1)):(x[N]=Mm(X),x[N].c(),Mt(x[N],1),x[N].m(h.parentNode,h))}for($a(),N=1;N<1;N+=1)a(N);es()}const j=L&0?vl(A,[xl(Dh.crd)]):{};L[0]&384|L[1]&8&&(j.$$scope={dirty:L,ctx:B}),f.$set(j)},i(B){if(!y){for(let L=0;L<1;L+=1)Mt(x[L]);Mt(f.$$.fragment,B),y=!0}},o(B){x=x.filter(Boolean);for(let L=0;L<1;L+=1)Wt(x[L]);Wt(f.$$.fragment,B),y=!1},d(B){ts(x,B),B&&H(h),hi(f,B)}}}function Lm(c){let h,f=[...c[1].parents].reverse(),y=[];for(let v=0;v<f.length;v+=1)y[v]=Rm(_m(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Or()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=Or()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);ke(v,h,x)},p(v,x){if(x[0]&2){f=[...v[1].parents].reverse();let a;for(a=0;a<f.length;a+=1){const A=_m(v,f,a);y[a]?y[a].p(A,x):(y[a]=Rm(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){ts(y,v),v&&H(h)}}}function Rm(c){let h,f=c[1].name+"",y,v,x,a,A=c[26].name+"",I,B;return{c(){h=Pe("span"),y=Ee(f),v=Ee(" is located in "),x=Pe("span"),a=Pe("a"),I=Ee(A),this.h()},l(L){h=Me(L,"SPAN",{});var j=Ce(h);y=Te(j,f),v=Te(j," is located in "),j.forEach(H),x=Me(L,"SPAN",{class:!0});var N=Ce(x);a=Me(N,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var X=Ce(a);I=Te(X,A),X.forEach(H),N.forEach(H),this.h()},h(){$(a,"href",B=Is+"/"+c[26].code+"/"),$(a,"sveltekit:noscroll",""),$(a,"class","svelte-d76ur"),$(x,"class","text-bold")},m(L,j){ke(L,h,j),ne(h,y),ne(h,v),ke(L,x,j),ne(x,a),ne(a,I)},p(L,j){j[0]&2&&f!==(f=L[1].name+"")&&Dt(y,f),j[0]&2&&A!==(A=L[26].name+"")&&Dt(I,A),j[0]&2&&B!==(B=Is+"/"+L[26].code+"/")&&$(a,"href",B)},d(L){L&&H(h),L&&H(x)}}}function w1(c){let h,f,y=c[1].name+"",v;return{c(){h=Pe("span"),f=Ee("No areas within "),v=Ee(y),this.h()},l(x){h=Me(x,"SPAN",{class:!0});var a=Ce(h);f=Te(a,"No areas within "),v=Te(a,y),a.forEach(H),this.h()},h(){$(h,"class","muted")},m(x,a){ke(x,h,a),ne(h,f),ne(h,v)},p(x,a){a[0]&2&&y!==(y=x[1].name+"")&&Dt(v,y)},d(x){x&&H(h)}}}function S1(c){let h,f,y,v,x,a=c[2].children,A=[];for(let I=0;I<a.length;I+=1)A[I]=Bm(ym(c,a,I));return{c(){h=Pe("span"),f=Ee("Districts within Northern Ireland"),y=Pe("br"),v=pt();for(let I=0;I<A.length;I+=1)A[I].c();x=Or(),this.h()},l(I){h=Me(I,"SPAN",{class:!0});var B=Ce(h);f=Te(B,"Districts within Northern Ireland"),B.forEach(H),y=Me(I,"BR",{}),v=ft(I);for(let L=0;L<A.length;L+=1)A[L].l(I);x=Or(),this.h()},h(){$(h,"class","text-bold")},m(I,B){ke(I,h,B),ne(h,f),ke(I,y,B),ke(I,v,B);for(let L=0;L<A.length;L+=1)A[L].m(I,B);ke(I,x,B)},p(I,B){if(B[0]&4){a=I[2].children;let L;for(L=0;L<a.length;L+=1){const j=ym(I,a,L);A[L]?A[L].p(j,B):(A[L]=Bm(j),A[L].c(),A[L].m(x.parentNode,x))}for(;L<A.length;L+=1)A[L].d(1);A.length=a.length}},d(I){I&&H(h),I&&H(y),I&&H(v),ts(A,I),I&&H(x)}}}function Bm(c){let h,f,y=c[23].name+"",v,x,a=(c[25]<c[2].children.length-1,""),A;return{c(){h=Pe("li"),f=Pe("a"),v=Ee(y),A=Ee(a),this.h()},l(I){h=Me(I,"LI",{style:!0});var B=Ce(h);f=Me(B,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var L=Ce(f);v=Te(L,y),L.forEach(H),A=Te(B,a),B.forEach(H),this.h()},h(){$(f,"href",x=Is+"/"+c[23].code+"/"),$(f,"sveltekit:noscroll",""),$(f,"class","svelte-d76ur"),tt(h,"margin","3px"),tt(h,"display","block"),tt(h,"line-height","20px"),tt(h,"padding-bottom","5px")},m(I,B){ke(I,h,B),ne(h,f),ne(f,v),ne(h,A)},p(I,B){B[0]&4&&y!==(y=I[23].name+"")&&Dt(v,y),B[0]&4&&x!==(x=Is+"/"+I[23].code+"/")&&$(f,"href",x),B[0]&4&&a!==(a=(I[25]<I[2].children.length-1,""))&&Dt(A,a)},d(I){I&&H(h)}}}function k1(c){let h,f,y=c[1]&&c[2]&&bm(c);return{c(){y&&y.c(),h=Or()},l(v){y&&y.l(v),h=Or()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,x){v[1]&&v[2]?y?(y.p(v,x),x[0]&6&&Mt(y,1)):(y=bm(v),y.c(),Mt(y,1),y.m(h.parentNode,h)):y&&($a(),Wt(y,1,1,()=>{y=null}),es())},i(v){f||(Mt(y),f=!0)},o(v){Wt(y),f=!1},d(v){y&&y.d(v),v&&H(h)}}}function E1(c){let h,f,y,v,x,a,A,I,B,L,j,N,X,pe;return document.title=h=c[1].name+" Census Data",X=new K_({props:{column:"wide",$$slots:{default:[k1]},$$scope:{ctx:c}}}),{c(){f=Pe("meta"),y=Pe("meta"),x=Pe("meta"),a=Pe("meta"),I=Pe("meta"),L=Pe("meta"),N=pt(),li(X.$$.fragment),this.h()},l(De){const Ie=q_('[data-svelte="svelte-wtlqhu"]',document.head);f=Me(Ie,"META",{name:!0,content:!0}),y=Me(Ie,"META",{property:!0,content:!0}),x=Me(Ie,"META",{property:!0,content:!0}),a=Me(Ie,"META",{property:!0,content:!0}),I=Me(Ie,"META",{property:!0,content:!0}),L=Me(Ie,"META",{name:!0,content:!0}),Ie.forEach(H),N=ft(De),ui(X.$$.fragment,De),this.h()},h(){$(f,"name","description"),$(f,"content",""),$(y,"property","og:title"),$(y,"content",v=c[1].name+" Census Data"),$(x,"property","og:type"),$(x,"content","website"),$(a,"property","og:url"),$(a,"content",A=Mh.base+"/"+c[1].code+"/"),$(I,"property","og:description"),$(I,"content",B="Explore census data for "+c[1].name+"."),$(L,"name","description"),$(L,"content",j="Explore census data for "+c[1].name+".")},m(De,Ie){ne(document.head,f),ne(document.head,y),ne(document.head,x),ne(document.head,a),ne(document.head,I),ne(document.head,L),ke(De,N,Ie),ci(X,De,Ie),pe=!0},p(De,Ie){(!pe||Ie[0]&2)&&h!==(h=De[1].name+" Census Data")&&(document.title=h),(!pe||Ie[0]&2&&v!==(v=De[1].name+" Census Data"))&&$(y,"content",v),(!pe||Ie[0]&2&&A!==(A=Mh.base+"/"+De[1].code+"/"))&&$(a,"content",A),(!pe||Ie[0]&2&&B!==(B="Explore census data for "+De[1].name+"."))&&$(I,"content",B),(!pe||Ie[0]&2&&j!==(j="Explore census data for "+De[1].name+"."))&&$(L,"content",j);const rt={};Ie[0]&2047|Ie[1]&8&&(rt.$$scope={dirty:Ie,ctx:De}),X.$set(rt)},i(De){pe||(Mt(X.$$.fragment,De),pe=!0)},o(De){Wt(X.$$.fragment,De),pe=!1},d(De){H(f),H(y),H(x),H(a),H(I),H(L),De&&H(N),hi(X,De)}}}const P1=!0;async function Fm(c,h){return await(await h(Mh.places+c+".json")).json()}async function M1({params:c,fetch:h}){let f=c.code,y=await rg(Mh.options,h),v={};y.forEach(I=>v[I.code]=I.name),y.forEach(I=>{I.typepl=Ec[I.type].pl,I.typenm=Ec[I.type].name,I.typestr=v[I.parent]?`${Ec[I.type].name} within ${v[I.parent]}`:""});let x=y.sort((I,B)=>I.name.localeCompare(B.name)),a=await Fm("N92000002",h),A=await Fm(f,h);return{props:{options:x,place:A,ew:a}}}function T1(c,h,f){let y,v,{options:x,place:a,ew:A}=h,I,B,L=null,j=!1,N={selected:null,type:null,childType:null,highlighted:[],hovered:null},X={};Object.keys(na).forEach(gt=>f(8,X[gt]=!1,X));function pe(gt){const Fe=(je,Ke)=>je+Ke;let At=gt[0],ot=gt[1],xt=a.data[At][ot][2011],Ve=a.data[At][ot][2001],Ue=A.data[At][ot][2011],_t=gd[At].map(je=>je.code),fr=gd[At].map(je=>je.label?je.label:je.code);return _t.map((je,Ke)=>Array.isArray(je)?{x:fr[Ke],y:je.map(hr=>xt[hr]).reduce(Fe,0),ew:je.map(hr=>Ue[hr]).reduce(Fe,0),prev:je.map(hr=>Ve[hr]).reduce(Fe,0)}:{x:fr[Ke],y:xt[je],ew:Ue[je],prev:Ve[je]})}function De(gt){L&&L.fitBounds(gt,{padding:20})}function Ie(gt){let Fe=JSON.parse(JSON.stringify(N)),At=gt.code,ot=gt.type,xt=gt.children[0]?gt.children.map(zt=>zt.code):[],Ve=gt.type=="rgn"?"cty":xt[0]?gt.children[0].type:null;f(7,N.selected=At,N),f(7,N.type=ot,N),f(7,N.childType=Ve,N),f(7,N.highlighted=xt,N);let Ue=Object.keys(na),_t=["fill-color","fill-opacity"],fr=["line-color","line-width","line-opacity"];L&&(N.type!=Fe.type||N.childType!=Fe.childType)&&(Ue.forEach(zt=>{let je=zt==ot||Ve&&zt==Ve?"visible":"none";L.setLayoutProperty(zt+"-fill","visibility",je),L.setLayoutProperty(zt+"-bounds","visibility",je),gt.parents[0]&&L.setLayoutProperty(zt+"-self","visibility",je),f(8,X[zt]=zt==Ve,X)}),gt.parents[0]&&(_t.forEach(zt=>L.setPaintProperty(ot+"-fill",zt,zr[xt[0]?"fill-active":"fill-self"][zt])),fr.forEach(zt=>{L.setPaintProperty(ot+"-bounds",zt,zr["line-active"][zt]),L.setPaintProperty(ot+"-self",zt,zr["line-self"][zt])})),Ve&&(_t.forEach(zt=>L.setPaintProperty(Ve+"-fill",zt,zr["fill-child"][zt])),fr.forEach(zt=>L.setPaintProperty(Ve+"-bounds",zt,zr["line-child"][zt]))))}function rt(gt){Ie(gt),De(gt.bounds)}function Ge(gt){bd(`${Is}/${gt.detail.code}/`,{noscroll:!0})}function Pt(gt){bd(`${Is}/${gt.detail.value}/`,{noscroll:!0})}function Tt(){f(5,B=I<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}const ct=()=>f(4,j=!1),He=()=>f(4,j=!1),Vt=()=>f(4,j=!0);function Ht(gt){L=gt,f(6,L)}function Rt(){I=this.clientWidth,f(3,I)}return c.$$set=gt=>{"options"in gt&&f(0,x=gt.options),"place"in gt&&f(1,a=gt.place),"ew"in gt&&f(2,A=gt.ew)},c.$$.update=()=>{c.$$.dirty[0]&8&&I&&Tt(),c.$$.dirty[0]&18&&f(10,y=j?"2001 comparison":a&&a.parents[0]?"Northern Ireland comparison":null),c.$$.dirty[0]&2&&a&&rt(a),c.$$.dirty[0]&2&&f(9,v=a&&a.data.population.value.change.all!=null)},[x,a,A,I,j,B,L,N,X,v,y,pe,Ge,Pt,ct,He,Vt,Ht,Rt]}class D1 extends sa{constructor(h){super(),la(this,h,T1,E1,ua,{options:0,place:1,ew:2},null,[-1,-1])}}export{D1 as default,M1 as load,P1 as prerender};
